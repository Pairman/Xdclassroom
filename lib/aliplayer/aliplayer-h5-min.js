/*! aliyun-aliplayer - v2.18.1 - 2023-11-02 15.10.32 */
!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Aliplayer=e()}(function(){var define,module,exports;return function i(n,o,a){function s(t,e){if(!o[t]){if(!n[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(l)return l(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}r=o[t]={exports:{}},n[t][0].call(r.exports,function(e){return s(n[t][1][e]||e)},r,r.exports,i,n,o,a)}return o[t].exports}for(var l="function"==typeof require&&require,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(e,t,r){},{}],2:[function(y,r,i){!function(f){!function(){var e,t;e=this,t=function(){var i,c=Math;if("undefined"!=typeof window&&window.crypto&&(i=window.crypto),"undefined"!=typeof self&&self.crypto&&(i=self.crypto),!(i=!(i=!(i="undefined"!=typeof globalThis&&globalThis.crypto?globalThis.crypto:i)&&"undefined"!=typeof window&&window.msCrypto?window.msCrypto:i)&&void 0!==f&&f.crypto?f.crypto:i)&&"function"==typeof y)try{i=y("crypto")}catch(e){}var r=Object.create||function(e){return t.prototype=e,e=new t,t.prototype=null,e};function t(){}var e={},n=e.lib={},o=n.Base={extend:function(e){var t=r(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),(t.init.prototype=t).$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=n.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,r=e.words,i=this.sigBytes,n=e.sigBytes;if(this.clamp(),i%4)for(var o=0;o<n;o++){var a=r[o>>>2]>>>24-o%4*8&255;t[i+o>>>2]|=a<<24-(i+o)%4*8}else for(var s=0;s<n;s+=4)t[i+s>>>2]=r[s>>>2];return this.sigBytes+=n,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=c.ceil(t/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(function(){if(i){if("function"==typeof i.getRandomValues)try{return i.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof i.randomBytes)try{return i.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")}());return new u.init(t,e)}}),a=e.enc={},s=a.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,i=[],n=0;n<r;n++){var o=t[n>>>2]>>>24-n%4*8&255;i.push((o>>>4).toString(16)),i.push((15&o).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,r=[],i=0;i<t;i+=2)r[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new u.init(r,t/2)}},l=a.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,i=[],n=0;n<r;n++){var o=t[n>>>2]>>>24-n%4*8&255;i.push(String.fromCharCode(o))}return i.join("")},parse:function(e){for(var t=e.length,r=[],i=0;i<t;i++)r[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new u.init(r,t)}},p=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},d=n.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t,r=this._data,i=r.words,n=r.sigBytes,o=this.blockSize,a=n/(4*o),s=(a=e?c.ceil(a):c.max((0|a)-this._minBufferSize,0))*o,e=c.min(4*s,n);if(s){for(var l=0;l<s;l+=o)this._doProcessBlock(i,l);t=i.splice(0,s),r.sigBytes-=e}return new u.init(t,e)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),h=(n.Hasher=d.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(r){return function(e,t){return new r.init(t).finalize(e)}},_createHmacHelper:function(r){return function(e,t){return new h.HMAC.init(r,t).finalize(e)}}}),e.algo={});return e},"object"==typeof i?r.exports=i=t():"function"==typeof define&&define.amd?define([],t):e.CryptoJS=t()}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{crypto:1}],3:[function(e,t,r){var i,n;i=this,n=function(e){var f;return f=e.lib.WordArray,e.enc.Base64={stringify:function(e){for(var t=e.words,r=e.sigBytes,i=this._map,n=(e.clamp(),[]),o=0;o<r;o+=3)for(var a=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,s=0;s<4&&o+.75*s<r;s++)n.push(i.charAt(a>>>6*(3-s)&63));var l=i.charAt(64);if(l)for(;n.length%4;)n.push(l);return n.join("")},parse:function(e){var t=e.length,r=this._map;if(!(i=this._reverseMap))for(var i=this._reverseMap=[],n=0;n<r.length;n++)i[r.charCodeAt(n)]=n;for(var o,a,s=r.charAt(64),l=(s&&-1!==(s=e.indexOf(s))&&(t=s),e),c=t,u=i,p=[],d=0,h=0;h<c;h++)h%4&&(o=u[l.charCodeAt(h-1)]<<h%4*2,a=u[l.charCodeAt(h)]>>>6-h%4*2,p[d>>>2]|=(o|a)<<24-d%4*8,d++);return f.create(p,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},e.enc.Base64},"object"==typeof r?t.exports=r=n(e("./core")):"function"==typeof define&&define.amd?define(["./core"],n):n(i.CryptoJS)},{"./core":2}],4:[function(e,t,r){var i,n;i=this,n=function(e){return e.enc.Utf8},"object"==typeof r?t.exports=r=n(e("./core")):"function"==typeof define&&define.amd?define(["./core"],n):n(i.CryptoJS)},{"./core":2}],5:[function(e,t,r){var i,n;i=this,n=function(e){return e.HmacSHA1},"object"==typeof r?t.exports=r=n(e("./core"),e("./sha1"),e("./hmac")):"function"==typeof define&&define.amd?define(["./core","./sha1","./hmac"],n):n(i.CryptoJS)},{"./core":2,"./hmac":6,"./sha1":7}],6:[function(e,t,r){var i,n;i=this,n=function(e){var t,s;t=e.lib.Base,s=e.enc.Utf8,e.algo.HMAC=t.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=s.parse(t));for(var r=e.blockSize,i=4*r,e=((t=t.sigBytes>i?e.finalize(t):t).clamp(),this._oKey=t.clone()),t=this._iKey=t.clone(),n=e.words,o=t.words,a=0;a<r;a++)n[a]^=1549556828,o[a]^=909522486;e.sigBytes=t.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,e=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(e))}})},"object"==typeof r?t.exports=r=n(e("./core")):"function"==typeof define&&define.amd?define(["./core"],n):n(i.CryptoJS)},{"./core":2}],7:[function(e,t,r){var i,n;i=this,n=function(e){var t,r,i,n,u;return r=(t=e).lib,i=r.WordArray,n=r.Hasher,r=t.algo,u=[],r=r.SHA1=n.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=this._hash.words,i=r[0],n=r[1],o=r[2],a=r[3],s=r[4],l=0;l<80;l++){u[l]=l<16?0|e[t+l]:(c=u[l-3]^u[l-8]^u[l-14]^u[l-16])<<1|c>>>31;var c=(i<<5|i>>>27)+s+u[l];c+=l<20?1518500249+(n&o|~n&a):l<40?1859775393+(n^o^a):l<60?(n&o|n&a|o&a)-1894007588:(n^o^a)-899497514,s=a,a=o,o=n<<30|n>>>2,n=i,i=c}r[0]=r[0]+i|0,r[1]=r[1]+n|0,r[2]=r[2]+o|0,r[3]=r[3]+a|0,r[4]=r[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[14+(64+i>>>9<<4)]=Math.floor(r/4294967296),t[15+(64+i>>>9<<4)]=r,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}}),t.SHA1=n._createHelper(r),t.HmacSHA1=n._createHmacHelper(r),e.SHA1},"object"==typeof r?t.exports=r=n(e("./core")):"function"==typeof define&&define.amd?define(["./core"],n):n(i.CryptoJS)},{"./core":2}],8:[function(j,r,i){!function(B,V){!function(){var e,t;e=this,t=function(){"use strict";function l(e){return"function"==typeof e}var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=0,t=void 0,n=void 0,a=function(e,t){p[i]=e,p[i+1]=t,2===(i+=2)&&(n?n(d):M())};var e="undefined"!=typeof window?window:void 0,o=e||{},o=o.MutationObserver||o.WebKitMutationObserver,s="undefined"==typeof self&&void 0!==B&&"[object process]"==={}.toString.call(B),c="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function u(){var e=setTimeout;return function(){return e(d,1)}}var p=new Array(1e3);function d(){for(var e=0;e<i;e+=2)(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0;i=0}function h(){try{var e=Function("return this")().require("vertx");return void 0!==(t=e.runOnLoop||e.runOnContext)?function(){t(d)}:u()}catch(e){return u()}}var f,y,_,M=void 0;function g(e,t){var r,i=this,n=new this.constructor(S),o=(void 0===n[m]&&R(n),i._state);return o?(r=arguments[o-1],a(function(){return A(o,n,r,i._result)})):k(i,n,e,t),n}function v(e){var t;return e&&"object"==typeof e&&e.constructor===this?e:(x(t=new this(S),e),t)}var M=s?function(){return B.nextTick(d)}:o?(y=0,s=new o(d),_=document.createTextNode(""),s.observe(_,{characterData:!0}),function(){_.data=y=++y%2}):c?((f=new MessageChannel).port1.onmessage=d,function(){return f.port2.postMessage(0)}):(void 0===e&&"function"==typeof j?h:u)(),m=Math.random().toString(36).substring(2);function S(){}var b=void 0,T=1,E=2;function U(e,i,n){a(function(t){var r=!1,e=function(e,t,r,i){try{e.call(t,r,i)}catch(e){return e}}(n,i,function(e){r||(r=!0,(i!==e?x:P)(t,e))},function(e){r||(r=!0,C(t,e))},t._label);!r&&e&&(r=!0,C(t,e))},e)}function w(e,t,r){var i,n;t.constructor===e.constructor&&r===g&&t.constructor.resolve===v?(i=e,(n=t)._state===T?P(i,n._result):n._state===E?C(i,n._result):k(n,void 0,function(e){return x(i,e)},function(e){return C(i,e)})):void 0!==r&&l(r)?U(e,t,r):P(e,t)}function x(t,e){if(t===e)C(t,new TypeError("You cannot resolve a promise with itself"));else if(r=typeof e,null===e||"object"!=r&&"function"!=r)P(t,e);else{r=void 0;try{r=e.then}catch(e){return void C(t,e)}w(t,e,r)}var r}function H(e){e._onerror&&e._onerror(e._result),I(e)}function P(e,t){e._state===b&&(e._result=t,e._state=T,0!==e._subscribers.length)&&a(I,e)}function C(e,t){e._state===b&&(e._state=E,e._result=t,a(H,e))}function k(e,t,r,i){var n=e._subscribers,o=n.length;e._onerror=null,n[o]=t,n[o+T]=r,n[o+E]=i,0===o&&e._state&&a(I,e)}function I(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var i,n=void 0,o=e._result,a=0;a<t.length;a+=3)i=t[a],n=t[a+r],i?A(r,i,n,o):n(o);e._subscribers.length=0}}function A(e,t,r,i){var n=l(r),o=void 0,a=void 0,s=!0;if(n){try{o=r(i)}catch(e){s=!1,a=e}if(t===o)return void C(t,new TypeError("A promises callback cannot return that same promise."))}else o=i;t._state===b&&(n&&s?x(t,o):!1===s?C(t,a):e===T?P(t,o):e===E&&C(t,o))}var L=0;function R(e){e[m]=L++,e._state=void 0,e._result=void 0,e._subscribers=[]}D.prototype._enumerate=function(e){for(var t=0;this._state===b&&t<e.length;t++)this._eachEntry(e[t],t)},D.prototype._eachEntry=function(t,e){var r=this._instanceConstructor,i=r.resolve;if(i===v){var n,o=void 0,a=void 0,s=!1;try{o=t.then}catch(e){s=!0,a=e}o===g&&t._state!==b?this._settledAt(t._state,e,t._result):"function"!=typeof o?(this._remaining--,this._result[e]=t):r===O?(n=new r(S),s?C(n,a):w(n,t,o),this._willSettleAt(n,e)):this._willSettleAt(new r(function(e){return e(t)}),e)}else this._willSettleAt(i(t),e)},D.prototype._settledAt=function(e,t,r){var i=this.promise;i._state===b&&(this._remaining--,e===E?C(i,r):this._result[t]=r),0===this._remaining&&P(i,this._result)},D.prototype._willSettleAt=function(e,t){var r=this;k(e,void 0,function(e){return r._settledAt(T,t,e)},function(e){return r._settledAt(E,t,e)})};var F=D;function D(e,t){this._instanceConstructor=e,this.promise=new e(S),this.promise[m]||R(this.promise),r(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0!==this.length&&(this.length=this.length||0,this._enumerate(t),0!==this._remaining)||P(this.promise,this._result)):C(this.promise,new Error("Array Methods must be provided an Array"))}N.prototype.catch=function(e){return this.then(null,e)},N.prototype.finally=function(t){var r=this.constructor;return l(t)?this.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})}):this.then(t,t)};var O=N;function N(e){if(this[m]=L++,this._result=this._state=void 0,this._subscribers=[],S!==e){if("function"!=typeof e)throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof N))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");var t=this;try{e(function(e){x(t,e)},function(e){C(t,e)})}catch(e){C(t,e)}}}return O.prototype.then=g,O.all=function(e){return new F(this,e).promise},O.race=function(n){var o=this;return r(n)?new o(function(e,t){for(var r=n.length,i=0;i<r;i++)o.resolve(n[i]).then(e,t)}):new o(function(e,t){return t(new TypeError("You must pass an array to race."))})},O.resolve=v,O.reject=function(e){var t=new this(S);return C(t,e),t},O._setScheduler=function(e){n=e},O._setAsap=function(e){a=e},O._asap=a,O.polyfill=function(){var e=void 0;if(void 0!==V)e=V;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=O},O.Promise=O},"object"==typeof i&&void 0!==r?r.exports=t():"function"==typeof define&&define.amd?define(t):e.ES6Promise=t()}.call(this)}.call(this,j("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:9}],9:[function(e,t,r){var i,n,t=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}try{i="function"==typeof setTimeout?setTimeout:o}catch(e){i=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}function s(t){if(i===setTimeout)return setTimeout(t,0);if((i===o||!i)&&setTimeout)return(i=setTimeout)(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}var l,c=[],u=!1,p=-1;function d(){u&&l&&(u=!1,l.length?c=l.concat(c):p=-1,c.length)&&h()}function h(){if(!u){for(var e=s(d),t=(u=!0,c.length);t;){for(l=c,c=[];++p<t;)l&&l[p].run();p=-1,t=c.length}l=null,u=!1,!function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return(n=clearTimeout)(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function y(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new f(e,t)),1!==c.length||u||s(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=y,t.addListener=y,t.once=y,t.off=y,t.removeListener=y,t.removeAllListeners=y,t.emit=y,t.prependListener=y,t.prependOnceListener=y,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],10:[function(e,t,r){t.exports={name:"aliyun-aliplayer",version:"2.18.1",description:"aliyun h5 player",main:"./dist/aliplayer-min",files:["dist"],repository:{type:"git",url:""},keywords:["clam","prismplayer"],scripts:{start:"npx grunt live",build:"npx grunt build",release:"commit-and-tag-version","publish-beta":'npm run build && git add . && git commit -m "misc: build assets for daily" && def p -d'},devDependencies:{"@babel/core":"^7.15.0","@babel/preset-env":"^7.15.0","babel-loader":"^8.2.2","babel-plugin-es6-promise":"^1.1.1",babelify:"^10.0.0","commit-and-tag-version":"^11.2.1",grunt:"^1.0.4","grunt-autoprefixer":"^3.0.4","grunt-babel":"^8.0.0","grunt-browserify":"^5.3.0","grunt-contrib-clean":"^2.0.0","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-cssmin":"^3.0.0","grunt-contrib-less":"^2.0.0","grunt-contrib-uglify":"^4.0.1","grunt-contrib-watch":"^1.1.0","grunt-run":"^0.8.1","grunt-text-replace":"^0.4.0"},dependencies:{"crypto-js":"^4.1.1"}}},{}],11:[function(e,t,r){var i=e("../ui/component"),n=(e("../lib/util"),e("../lib/dom")),o=e("../lib/event"),a=(e("../lib/ua"),e("../lang/index")),s=e("../player/base/event/eventtype"),e=i.extend({init:function(e,t){i.call(this,e,t),this.className=t.className||"prism-auto-stream-selector",this.addClass(this.className)},createEl:function(){var e=i.prototype.createEl.call(this,"div");return e.innerHTML="<div><p class='tip-text'></p></div><div class='operators'><a class='prism-button prism-button-ok' type='button'>"+a.get("OK_Text")+"</a><a class='prism-button prism-button-cancel'  target='_blank'>"+a.get("Cancel_Text")+"</a></div>",e},bindEvent:function(){var i=this,e=(i._player.on(s.Private.AutoStreamShow,function(e){var t,r=document.querySelector("#"+i.getId()+" .tip-text");i._player._getLowerQualityLevel&&(t=i._player._getLowerQualityLevel())&&(i._switchUrl=t,r.innerText=a.get("Auto_Stream_Tip_Text").replace("$$",t.item.desc),n.css(i.el(),"display","block"))}),i._player.on(s.Private.AutoStreamHide,function(e){document.querySelector("#"+i.getId()+" .tip-text");n.css(i.el(),"display","none")}),document.querySelector("#"+i.getId()+" .prism-button-ok")),e=(o.on(e,"click",function(){i._player._changeStream&&i._switchUrl&&(i._player._changeStream(i._switchUrl.index,a.get("Quality_Change_Text")),i._player.trigger(s.Private.SettingListHide)),n.css(i.el(),"display","none")}),document.querySelector("#"+i.getId()+" .prism-button-cancel"));o.on(e,"click",function(){n.css(i.el(),"display","none"),i._player.trigger(s.Private.SettingListHide)})}});t.exports=e},{"../lang/index":23,"../lib/dom":32,"../lib/event":33,"../lib/ua":49,"../lib/util":51,"../player/base/event/eventtype":70,"../ui/component":130}],12:[function(e,t,r){var i=e("../ui/component"),a=e("../lib/dom"),n=e("../lib/event"),o=e("../lib/ua"),s=e("../lib/function"),l=(e("../lang/index"),e("../lib/util")),c=e("../config"),u=e("../lib/playerutil"),p=e("../player/base/event/eventtype"),e=i.extend({init:function(e,t){i.call(this,e,t),this.className=t.className||"prism-liveshift-progress",this.addClass(this.className),this._liveshiftService=e._liveshiftService},createEl:function(){var e=i.prototype.createEl.call(this);return e.innerHTML='<div class="prism-enable-liveshift"><div class="prism-progress-loaded"></div><div class="prism-progress-played"></div><div class="prism-progress-cursor"><img></img></div><p class="prism-progress-time"></p><div class="prism-liveshift-seperator"></div></div><div class="prism-disable-liveshift"></div>',e},bindEvent:function(){function t(e){r._progressDown=e}var r=this,e=(this.loadedNode=document.querySelector("#"+this.id()+" .prism-progress-loaded"),this.playedNode=document.querySelector("#"+this.id()+" .prism-progress-played"),this.cursorNode=document.querySelector("#"+this.id()+" .prism-progress-cursor"),this.timeNode=document.querySelector("#"+this.id()+" .prism-progress-time"),this.controlNode=document.querySelector("#"+this._player._options.id+" .prism-controlbar"),this.seperatorNode=document.querySelector("#"+this.id()+" .prism-liveshift-seperator"),this.progressNode=document.querySelector("#"+this.id()+" .prism-enable-liveshift"),document.querySelector("#"+this.id()+" .prism-progress-cursor img")),i="//"+c.domain+c.path+c.h5Version+"/skins/default/img/dragcursor.png";this._player._options.skinsDomain?i=this._player._options.skinsDomain+"/skins/default/img/dragcursor.png":c.domain?-1<c.domain.indexOf("localhost")&&(i="//"+c.domain+"/build/skins/default/img/dragcursor.png"):i=this._player&&this._player._options&&this._player._options.sdkDomain?this._player._options.sdkDomain+c.path+c.h5Version+"/skins/default/img/dragcursor.png":(c.path||"").substring(1)+c.h5Version+"/skins/default/img/dragcursor.png",e.src=i,n.on(this.cursorNode,"mousedown",function(e){r._onMouseDown(e)}),n.on(this.cursorNode,"touchstart",function(e){r._onMouseDown(e)}),n.on(this.progressNode,"mousemove",function(e){r._progressMove(e)}),n.on(this.progressNode,"touchmove",function(e){r._progressMove(e)});n.on(this.progressNode,"mousedown",function(e){t(!0)}),n.on(this.progressNode,"touchstart",function(e){t(!0)}),n.on(this.progressNode,"mouseup",function(e){t(!1)}),n.on(this.progressNode,"touchend",function(e){t(!1)}),n.on(this._el,"click",function(e){r._onMouseClick(e)}),this._player.on(p.Private.HideProgress,function(e){r._hideProgress(e)}),this._player.on(p.Private.CancelHideProgress,function(e){r._cancelHideProgress(e)}),this._player.on(p.Private.ShowBar,function(){r._updateLayout()}),n.on(this.progressNode,p.Private.MouseOver,function(e){r._onMouseOver(e)}),n.on(this.progressNode,p.Private.MouseOut,function(e){r._onMouseOut(e)}),this.bindTimeupdate=s.bind(this,this._onTimeupdate),this._player.on(p.Player.TimeUpdate,this.bindTimeupdate),u.isLiveShift(this._player._options)&&r._liveshiftService.start(6e4,function(e){e={mediaId:r._player._options.vid||"",error_code:e.Code,error_msg:e.Message};r._player.logError(e),r._player.trigger(p.Player.Error,e)}),this._player.on(p.Private.LiveShiftQueryCompleted,function(){r._updateSeperator(),r._updateLayout()}),this._player.on(p.Private.LiveShiftSwitchToLive,function(){r._updateCursorPosition()}),this._player.on(p.Player.Pause,function(){r._liveshiftService.stop()}),o.IS_IPAD?this.interval=setInterval(function(){r._onProgress()},500):this._player.on(p.Video.Progress,function(){r._onProgress()})},_updateSeperator:function(){this._liveshiftService.currentTimeDisplay&&(this.seperatorNode.innerText=this._liveshiftService.currentTimeDisplay)},_updateLayout:function(){var e=this.seperatorNode.offsetWidth,t=this.el().offsetWidth,r=t-e;0!=e&&0!=r&&(a.css(this.progressNode,"width",100*(r-10)/t+"%"),a.css(this.seperatorNode,"right",-1*(e+10)+"px"))},_progressMove:function(e){var t=this._getSeconds(e),r=this._liveshiftService.availableLiveShiftTime,t=(this.timeNode.innerText="-"+l.formatTime(r-t),r?t/r:0),r=1-this.timeNode.clientWidth/this.el().clientWidth,i=(r<t&&(t=r),this.timeNode&&(a.css(this.timeNode,"display","block"),a.css(this.timeNode,"left",100*t+"%")),this);!o.IS_PC&&i._progressDown&&(i.progressSeekTimer&&clearTimeout(i.progressSeekTimer),i.progressSeekTimer=setTimeout(function(){i._progressDown||i._onMouseClick(e)},200))},_hideProgress:function(e){n.off(this.cursorNode,"mousedown"),n.off(this.cursorNode,"touchstart")},_cancelHideProgress:function(e){var t=this;n.on(this.cursorNode,"mousedown",function(e){t._onMouseDown(e)}),n.on(this.cursorNode,"touchstart",function(e){t._onMouseDown(e)})},_canSeekable:function(e){var t=!0;return t="function"==typeof this._player.canSeekable?this._player.canSeekable(e):t},_onMouseOver:function(e){this._updateCursorPosition(this._getCurrentTime()),a.css(this.timeNode,"display","block")},_onMouseOut:function(e){a.css(this.timeNode,"display","none")},_getSeconds:function(e){for(var t=this.el().offsetLeft,r=this.el();r=r.offsetParent;){var i=a.getTranslateX(r);t+=r.offsetLeft+i}var e=(e.touches&&e.touches.length?e.touches[0]:e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e).pageX,n=this.progressNode.offsetWidth,o=this._liveshiftService.availableLiveShiftTime;return sec=(sec=(sec=o?(e-t)/n*o:0)<0?0:sec)>o?o:sec},_onMouseClick:function(e){var t=this,e=this._getSeconds(e),r=this._liveshiftService.availableLiveShiftTime,i=r-e,n=this._player._options,r=(i<=n.liveShiftMinOffset&&(e=r-(i=n.liveShiftMinOffset)),this._player.trigger(p.Private.SeekStart,{fromTime:this._getCurrentTime()}),this._liveshiftService.getSourceUrl(i)),n=u.isHls(t._player._options.source);t._player._loadByUrlInner(r,e,!0),t._player.trigger(p.Private.Play_Btn_Hide),t._liveshiftService.seekTime=e,t._player.trigger(p.Private.EndStart,{toTime:e}),t._updateProgressBar(this.playedNode,e),t._updateCursorPosition(e),setTimeout(function(){t._progressDown||t._onMouseOut()},500),n&&setTimeout(function(){t._player.play()})},_onMouseDown:function(e){var t=this;e.preventDefault(),this._player.trigger(p.Private.SeekStart,{fromTime:this._getCurrentTime()}),n.on(this.controlNode,"mousemove",function(e){t._onMouseMove(e)}),n.on(this.controlNode,"touchmove",function(e){t._onMouseMove(e)}),n.on(this.controlNode,"mouseup",function(e){t._onMouseUp(e)}),n.on(this.controlNode,"touchend",function(e){t._onMouseUp(e)})},_onMouseUp:function(e){e.preventDefault(),n.off(this.controlNode,"mousemove"),n.off(this.controlNode,"touchmove"),n.off(this._player.tag,"mouseup"),n.off(this._player.tag,"touchend"),n.off(this.controlNode,"mouseup"),n.off(this.controlNode,"touchend"),this._onMouseClick(e)},_onMouseMove:function(e){e.preventDefault()},_onTimeupdate:function(e){this._player._seeking||(o.IS_ANDROID&&o.IS_UC&&(this._hasResetFlagUC&&this._player.getCurrentTime()&&(this._hasResetFlagUC=!1,this._basePtsUC=this._player.getCurrentTime()),this._player.getCurrentTime()||(this._hasResetFlagUC=!0,this._basePtsUC=0)),this._updateProgressBar(this.playedNode,this._getCurrentTime()),this._updateCursorPosition(this._getCurrentTime()),this._player.trigger(p.Private.UpdateProgressBar,{time:this._getCurrentTime()}))},_getCurrentTime:function(){var e=this._liveshiftService.seekTime,e=(-1==e&&(e=0),this._player.getCurrentTime()+e);return o.IS_ANDROID&&o.IS_UC&&(e-=this._basePtsUC||0),e},_onProgress:function(e){this._player.getDuration()&&1<=this._player.getBuffered().length&&this._updateProgressBar(this.loadedNode,this._player.getBuffered().end(this._player.getBuffered().length-1))},_updateProgressBar:function(e,t){var r,i;1!=this._player._switchSourcing&&(i=0,-1==this._liveshiftService.seekTime?i=1:1<(i=(r=this._liveshiftService.availableLiveShiftTime)?t/r:0)&&(this._liveshiftService.seekTime=-(i=1)),this.liveShiftStartDisplay,e)&&a.css(e,"width",100*i+"%")},_updateCursorPosition:function(e){var t,r,i,n;this._player.el()&&1!=this._player._switchSourcing&&(i=0,n=1,t=this._player.el().clientWidth,-1==this._liveshiftService.seekTime?i=1:1<(i=(r=this._liveshiftService.availableLiveShiftTime)?e/r:0)&&(this._liveshiftService.seekTime=-1),0!=t&&(n=1-(e=10/t),i-=e),i=i<0?0:i,this.cursorNode)&&(n<i?(a.css(this.cursorNode,"right","0px"),a.css(this.cursorNode,"left","auto")):(a.css(this.cursorNode,"right","auto"),a.css(this.cursorNode,"left",100*i+"%")))}});t.exports=e},{"../config":14,"../lang/index":23,"../lib/dom":32,"../lib/event":33,"../lib/function":35,"../lib/playerutil":46,"../lib/ua":49,"../lib/util":51,"../player/base/event/eventtype":70,"../ui/component":130}],13:[function(e,t,r){var i=e("../ui/component"),n=e("../lib/util"),o=e("../player/base/event/eventtype"),e=i.extend({init:function(e,t){i.call(this,e,t),this.className=t.className||"prism-live-time-display",this.addClass(this.className),this._liveshiftService=e._liveshiftService},createEl:function(){var e=i.prototype.createEl.call(this,"div");return e.innerHTML='<span class="current-time">00:00</span> <span class="time-bound">/</span> <span class="end-time">00:00</span><span class="live-text">Live: </span><span class="live-time"></span>',e},bindEvent:function(){var i=this;this._player.on(o.Video.TimeUpdate,function(){var e,t=i._liveshiftService,r=document.querySelector("#"+i.id()+" .current-time");t.liveShiftStartDisplay&&t.availableLiveShiftTime>t.seekTime&&-1!=t.seekTime?(e=i._liveshiftService.getBaseTime(),e=n.formatTime(e+i._player.getCurrentTime()),r.innerText=e):t.currentTimeDisplay&&(r.innerText=t.currentTimeDisplay)}),this._player.on(o.Private.LiveShiftQueryCompleted,function(){i.updateTime()})},updateTime:function(){document.querySelector("#"+this.id()+" .end-time").innerText=this._liveshiftService.liveTimeRange.endDisplay,document.querySelector("#"+this.id()+" .live-time").innerText=this._liveshiftService.currentTimeDisplay}});t.exports=e},{"../lib/util":51,"../player/base/event/eventtype":70,"../ui/component":130}],14:[function(e,t,r){e=e("../package.json");t.exports={domain:"g.alicdn.com",path:"/apsara-media-box/imp-web-player/",flashVersion:"2.8.2",h5Version:e.version.split("-")[0],rtsVersion:"2.4.3",cityBrain:!0,logDuration:3,logCount:100,logReportTo:"https://videocloud.cn-hangzhou.log.aliyuncs.com/logstores/newplayer/track"}},{"../package.json":10}],15:[function(e,t,r){var i,n,o,a;e("./lib/patch-ssr").isSSR||(e("./lang/index").load(),i=e("./player/adaptivePlayer"),n=e("./lib/reloadInstanceUtil"),o=e("./lib/componentutil"),a=e("./config"),(e=function(e,t){e.useH5Prism=!0;e=i.create(e,t);return n.storeUserEvents(e),e}).getVersion=function(){return a.h5Version},o.register(e),(o=window.Aliplayer=e).players={},e.reloadInstance=n.reloadInstance,"undefined"==typeof Uint8Array)||Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,"slice",{value:Array.prototype.slice}),t.exports=o},{"./config":14,"./lang/index":23,"./lib/componentutil":27,"./lib/patch-ssr":44,"./lib/reloadInstanceUtil":47,"./player/adaptivePlayer":66}],16:[function(e,t,r){var i=e("../player/base/event/eventtype"),n=e("../lib/constants"),o=e("../lang/index");t.exports=function(){function e(e){var t=this;void 0===e&&(e={}),this.interval=3e3,this.player=null,this.timer=null,this.playerInitDone=!1,this.player=e.player,this.player.on(i.Player.Init,function(){t.playerInitDone=!0})}var t=e.prototype;return t.start=function(){var e=this;this.stop(),this.player&&this.player._options&&!this.player._options.preventRecord||(this.timer=setInterval(function(){e.playerInitDone&&e.check()},this.interval))},t.stop=function(){this.clearTimer()},t.check=function(){var e=!1,t=this.detectPrototype()||this.detectNativeFn();return(t||this.detectDeperateVideo())&&(console.log("isMediaSourceModified",t),this.clearTimer(),this.displayError(),this.setupErrorStyle(),this.destroyVideo(),localStorage.setItem("_intercept_mediastream_",""),e=!0),e},t.dispose=function(){this.stop(),this.player=null,this.playerInitDone=!1},t.clearTimer=function(){this.timer&&(clearInterval(this.timer),this.timer=null)},t.displayError=function(){var e=this.player,t={mediaId:e._options&&e._options.vid?e._options.vid:"",error_code:n.ErrorCode.RecordNotAllowed,error_msg:o.get("Record_Not_Allowed")};e.logError(t),e.trigger(i.Player.Error,t)},t.setupErrorStyle=function(){this.hideRetry();var e=document.querySelector(".prism-ErrorMessage");e&&(e.style.opacity="1",e.style.visibility="visible")},t.hideRetry=function(){var e=document.querySelector("#"+this.player.id()+" .prism-button-retry");e&&(e.style.display="none")},t.destroyVideo=function(){this.player._drm&&this.player.destroy();var e=this.player.tag;e&&e.parentNode&&e.parentNode.removeChild(e)},t.detectPrototype=function(){var e=window,t=e.MediaSource;return t&&e.EventTarget&&t.__proto__.__proto__===e.EventTarget},t.detectNativeFn=function(){var e=window.MediaSource;return e&&!this.isNativeFn(e.prototype.addSourceBuffer)},t.isNativeFn=function(e){var t=RegExp("^".concat(Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?"),"$")),r=typeof e;return null!==e&&("object"==r||"function"==r)&&t.test(e)},t.detectDeperateVideo=function(){var e=this.player.tag;if(e)return-1!==(e.getAttribute("id")||"").indexOf("360")},e}()},{"../lang/index":23,"../lib/constants":28,"../player/base/event/eventtype":70}],17:[function(e,t,r){var i=e("../lib/oo"),n=e("../lang/index"),e=i.extend({init:function(e,t){this._player=e,this._options=e.options()}}),o=(e.prototype.handle=function(e){var t,r;this._options.autoPlayDelay&&(t=(t=this._options.autoPlayDelayDisplayText)||n.get("AutoPlayDelayDisplayText").replace("$$",this._options.autoPlayDelay),this._player.trigger("info_show",t),this._player.trigger("h5_loading_hide"),this._player.trigger("play_btn_hide"),(r=this)._timeHandler=setTimeout(function(){r._player.trigger("info_hide"),r._options.autoPlayDelay=0,e&&e()},1e3*this._options.autoPlayDelay),this._player.on("play",function(){o(r)}),this._player.on("pause",function(){o(r)}))},e.prototype.dispose=function(){o(this),this._player=null},function(e){e._timeHandler&&(clearTimeout(e._timeHandler),e._timeHandler=null)});t.exports=e},{"../lang/index":23,"../lib/oo":43}],18:[function(e,t,r){var i=e("../lib/event"),n=e("../lib/data"),o=e("../player/base/event/eventtype"),a=n.guid(),e={};function s(e){var t,r,i=this._options.keyFastForwardStep,n=this._options.isLive;switch(e&&e.keyCode){case 39:n||(e.preventDefault(),t=this.getDuration(),r=this.getCurrentTime()+i,this.seek(r=t<r?t:r),l.call(this,r),c.call(this,r));break;case 37:n||(e.preventDefault(),r=this.getCurrentTime()-i,this.seek(r=r<0?0:r),l.call(this,r),c.call(this,r));break;case 38:e.preventDefault(),this.getVolume()<1&&0<=this.getVolume()&&this.setVolume(Number((this.getVolume()+.1).toFixed(1)));break;case 40:e.preventDefault(),0<this.getVolume()&&this.getVolume()<=1&&this.setVolume(Number((this.getVolume()-.1).toFixed(1)));break;case 32:if(n)return;e.preventDefault(),this.tag.paused?this.play(!0):this.pause(!0)}}function l(e){this.trigger(o.Private.UpdateProgress,{targetTime:e})}function c(e){this.trigger(o.Private.UpdateCursorPosition,{targetTime:e})}e.init=function(){var e;this._options.keyShortCuts&&((e=s.bind(this)).guid=a,i.on(window.document,"keydown",e))},e.dispose=function(){var e;this._options.keyShortCuts&&((e=s.bind(this)).guid=a,i.off(window.document,"keydown",e))},t.exports=e},{"../lib/data":30,"../lib/event":33,"../player/base/event/eventtype":70}],19:[function(e,t,r){var o="undefined"==typeof Promise?e("es6-promise").Promise:Promise,a=e("../lib/constants").LicenseResultCode,s=e("../lib/io"),i=((e={})[a.ResourceIncorrect]="license resource init error",e[a.LicenseKeyInvalid]="invalid license key",e[a.DomainInvalid]="invalid domain",e[a.CertInvalid]="invalid cert content",e[a.NotFound]="license not found",e[a.Expired]="license expired",e),e=function(){function e(){}return e.getLicense=function(r,i){var n=this;return this.isWasmSupported()?i?r?this.instance?o.resolve(this.instance):new o(function(e,t){n.resolvers.push(e),n.rejecters.push(t),1===n.resolvers.length&&s.loadJS("https://g.alicdn.com/apsara-media-components/amcom-web-license/0.2.0/index.js",function(){window.loadLicenseSource().then(function(e){return e.init(2,r,i).then(function(t){n.instance=t,n.resolvers.forEach(function(e){e(t)})}).catch(function(e){console.error(e),n.rejecters.forEach(function(e){e(a.CertInvalid)})})}).catch(function(){n.rejecters.forEach(function(e){e(a.ResourceIncorrect)})}).finally(function(){n.resolvers=[],n.rejecters=[]})},function(){n.rejecters.forEach(function(e){e(a.ResourceIncorrect)})})}):o.reject(a.DomainInvalid):o.reject(a.LicenseKeyInvalid):o.reject(a.WasmNotSupported)},e.isWasmSupported=function(){return"object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate},e.logError=function(e){i[e]&&console.error(i[e])},e}();e.instance=void 0,e.resolvers=[],e.rejecters=[],t.exports=e},{"../lib/constants":28,"../lib/io":40,"es6-promise":8}],20:[function(e,t,r){t.exports=t.exports={OD:"OD",FD:"360p",LD:"540p",SD:"720p",HD:"1080p","2K":"2K","4K":"4K",FHD:"FHD",XLD:"XLD",SQ:"SQ",HQ:"HQ",Speed:"Speed",Speed_05X_Text:"0.5X",Speed_1X_Text:"Normal",Speed_125X_Text:"1.25X",Speed_15X_Text:"1.5X",Speed_2X_Text:"2X",Refresh_Text:"Refresh",Cancel:"Cancel",Mute:"Mute",Snapshot:"Snapshot",Detection_Text:"Diagnose",Play_DateTime:"Time",Quality_Change_Fail_Switch_Text:"Cannot play, switch to ",Quality_Change_Text:"Switch to ",Quality_The_Url:"The url",AutoPlayDelayDisplayText:"Play in $$ seconds",Error_Load_Abort_Text:"Data abort erro",Error_Network_Text:"Loading failed due to network error",Error_Decode_Text:"Decode error",Error_Server_Network_NotSupport_Text:"Network error or \xa0the format of video is unsupported",Error_Offline_Text:"The network is unreachable, please click Refresh",Error_Play_Text:"Error occured while playing",Error_Retry_Text:" Please close or refresh",Error_AuthKey_Text:"Authentication expired or the domain is not in white list",Error_H5_Not_Support_Text:"The format of video is not supported by\xa0h5 player\uff0cplease use flash player",Error_Not_Support_M3U8_Text:"The format of m3u8 is not supported by this explorer",Error_Not_Support_MP4_Text:"The format of mp4\xa0is not supported by this explorer",Error_Not_Support_encrypt_Text:"To play the encrypted video,please set encryptType to 1",Error_Vod_URL_Is_Empty_Text:"The url is empty",Error_Vod_Fetch_Urls_Text:"Error occured when fetch urls\uff0cplease close or refresh",Fetch_Playauth_Error:"Error occured when fetch playauth close or refresh",Error_Playauth_Decode_Text:"PlayAuth parse failed",Error_Vid_Not_Same_Text:"Cannot renew url due to vid changed",Error_Playauth_Expired_Text:"Playauth expired, please close or refresh",Error_MTS_Fetch_Urls_Text:"Error occurred while requesting mst server",Error_Load_M3U8_Failed_Text:"The m3u8 file loaded failed,please make sure domain configuration https certificate or enable cors",Error_Load_M3U8_Timeout_Text:"Timeout error occored\xa0when the\xa0m3u8 file loaded",Error_Liveshift_M3U8_Not_Found_Text:"No more liveshift video avaliable",Error_M3U8_Decode_Text:"The m3u8 file decoded failed",Error_TX_Decode_Text:"Video decoded failed",Error_Waiting_Timeout_Text:"Buffering timeout,\xa0please close or refresh",Error_Invalidate_Source:"Video shoud be mp4\u3001mp3\u3001m3u8\u3001mpd or flv",Error_Empty_Source:"Video URL shouldn't be empty",Error_Vid_Empty_Source:"vid's video URL hasn't been fetched",Error_Mediaauth_Empty_Source:"mediaAuth's video URL hasn't been fetched",Error_Fetch_NotStream:"The vid has no stream to play",Error_Fetch_Media_Not_Found:"Data is not found",Error_Not_Found:"Url is not found",Error_Drm_License_Request_Failed:"DRM license request failed",Error_Drm_Not_Supported:"DRM in not supported",Error_Drm_Load:"DRM load error",Error_Region_Block_Text:"This video is not available in your region",Tip_Err_Common:"please contact us for support, the error detail is:<br />",Tip_Err_Common_Short:"the error detail is:<br />",Tip_Drm_Request_Err:"The request failed with an error, please check the browser console to check whether it is caused by DNS, HTTPS certificates, or network problems. <br/> If the above tests are fine,",Tip_Drm_Secure_Context:"DRM can only be accessed under https, localhost, 127.0.0.1 web pages, and m3u8 and media segments must also use https.",Tip_Drm_Key_System_Unavailable:"1. This browser does not support Widevine or the current Widevine configuration<br/>2. The request that pops up in the browser was rejected by the user<br/>3. Please open the browser settings, look for the [Protected Content] setting and allow",Tip_Drm_File_Not_Allowed:"Do not use the file:// to open the file directly, you need to use a https:// to access the file",Tip_Drm_Playlist_Hierarchy:"HLS playlist level error, the main list needs to be master playlist",Tip_Err_Decode:"The decoding error refers to the current audio/video frame is not compatible with the browser, you can try the following methods: <br />1.chrome/edge browser open the chrome://flags, search for Hardware-accelerated video decode, select disabled<br />2.If the decoding error persists, please transcode the video to fix the problem frame",Tip_Err_Rts_Http_Failed:"The error indicates that the RTS streaming request encountered an HTTP error, which is usually related to HTTPS certificate, DNS resolution, or network connectivity issues. Due to browser restrictions on JavaScript, the player cannot obtain detailed error information. If you need further information, you can follow these steps:<br>Right-click on a blank area of the browser and select 'Inspect'.<br>2.In the newly opened interface, select 'Console'.<br>3.Check for any red error messages:<br>If you see 'SSL', it means that you have not correctly configured the HTTPS certificate for the streaming domain.<br>If you see 'NOT RESOLVED', it means that the DNS resolution for your domain has failed.<br>You can also use the <a style='color:white;text-decoration:underline;' href='https://live.console.aliyun.com/#/tool/url' target='_blank'>ApsaraVideo Live Diagnostic Tool</a> for self-diagnosis.",Live_End:"Live has finished",Play_Before_Fullscreen:"Please play before fullscreen",Can_Not_Seekable:"Can not seek to this position",Cancel_Text:"Cancel",OK_Text:"OK",Auto_Stream_Tip_Text:"Internet is slow, does switch to $$",Request_Block_Text:"This request is blocked, the video Url should be over https",Open_Html_By_File:"Html page should be on the server",Maybe_Cors_Error:"please make sure domain configuration https certificate or enable cors",Speed_Switch_To:"Speed switch to ",Curent_Volume:"Current volume:",Volume_Mute:"set to mute",Volume_UnMute:"set to unmute",ShiftLiveTime_Error:"Live start time should not be greater than over time",Error_Not_Support_Format_On_Mobile:"flv\u3001rmtp can't be supported on mobile\uff0cplease use m3u8",SessionId_Ticket_Invalid:"please assign value for sessionId and ticket properties",Http_Error:" An HTTP network request failed with an error, but not from the server.",Http_Timeout:"A network request timed out",DRM_License_Expired:"DRM license is expired, please refresh",Not_Support_DRM:"Browser doesn't support DRM",CC_Switch_To:"Subtitle switch to ",AudioTrack_Switch_To:"Audio tracks switch to ",Subtitle:"Subtitle/CC",AudioTrack:"Audio Track",Quality:"Quality",Auto:"Auto",Quality_Switch_To:"Quality switch to ",Fullscreen:"Full Screen",Setting:"Settings",Volume:"Volume",Play:"Play",Pause:"Pause",CloseSubtitle:"Close CC",OpenSubtitle:"Open CC",ExistFullScreen:"Exit Full Screen",Muted:"Muted",Retry:"Retry",SwitchToLive:"Return to live",iOSNotSupportVodEncription:"iOS desn't support Vod's private encription video, please use HLS standard encription or DRM",UseChromeForVodEncription:"This browser desn't suport Vod's encription video, please use latest Chrome",Record_Not_Allowed:"Recording or playing in seperated window is not allowed, please disable related plugins or switch browser.",License_No_Authorization:"Aliplayer without Authorization",License_Click_To_Apply:"Click to apply",Rts_Err_Http_Signal_Error:"(RTS)http signal error",Rts_Err_Play_Failed:"(RTS)play faild error",Rts_Err_No_Data_For:"ms received no data",Rts_Err_Browser_Not_Support:"(RTS)browser not support",Rts_Err_Not_Support_Webrtc:"(RTS)not support webrtc",Rts_Err_Browser_Version_Too_Low:"(RTS)browser version too low",Rts_Err_Not_Support_H264:"(RTS)not support h264",Rts_Err_Create_Offer_Error:"(RTS)create offer error",Rts_Err_Play_Url_Error:"(RTS)play url error",Rts_Err_Subscribe_Nonthing:"(RTS)subscribe nonthing",Rts_Err_Http_Request_Failed:"(RTS)HTTP request failed",Rts_Err_Http_Answer_Failed:"(RTS)answer failed",Rts_Err_PeerConnection_Unknown:"(RTS)Unknown PeerConnection",Splayer_Err_Env_Check:"(SP)This browser can't play this media",Splayer_Err_Coroutine:"(SP)Coroutine error",Splayer_Err_Decoder:"(SP)Decode error",Splayer_Err_Buffering:"(SP)Buffering error",Splayer_Err_Parser_Not_Found:"(SP)Media container is not supported"}},{}],21:[function(e,t,r){t.exports=t.exports={OD:"OD",LD:"360p",FD:"540p",SD:"720p",HD:"1080p","2K":"2K","4K":"4K",FHD:"FHD",XLD:"XLD",SQ:"SQ",HQ:"HQ",Forbidden_Text:"Internal information is strictly forbidden to outsider",Refresh:"Refresh",Diagnosis:"Diagnosis",Live_Finished:"Live has finished, thanks for watching",Play:"Play",Pause:"Pause",Snapshot:"Snapshot",Replay:"Replay",Live:"Live",Encrypt:"Encrypt",Sound:"Sound",Fullscreen:"Full Screen",Exist_Fullscreen:"Exit Full-screen",Resolution:"Resolution",Next:"Next Video",Brightness:"Brightness",Default:"Default",Contrast:"Contrast",Titles_Credits:"Titles\xa0and\xa0Credits",Skip_Titles:"Skip Titles",Skip_Credits:"Skip Credits",Not_Support_Out_Site:"The video is not supported for outside website, please watch it by TaoTV",Watch_Now:"Watch now",Network_Error:"Network is unreachable, please try to refresh",Video_Error:"Playing a video error,\xa0please try to refresh",Decode_Error:"Data decoding\xa0error",Live_Not_Start:"Live has not started, to be expected",Live_Loading:"Live information is loading,\xa0please try to refresh",Fetch_Playauth_Error:"Error occured when fetch playauth close or refresh",Live_End:"Live has finished",Live_Abrot:"Signal aborted,\xa0please try to refresh",Corss_Domain_Error:"Please ensure your domain has obtained IPC license and combined CNAME, \r\n or to set\xa0\xa0cross-domain accessing available",Url_Timeout_Error:"The video url is timeout,\xa0please try to refresh",Connetction_Error:"Sorry\uff0cthe video cannot play because of connection error, please try to watch other videos",Fetch_MTS_Error:"Fetching video list failed, please ensure",Token_Expired_Error:"Requesting open api failed, please ensure token expired or not",Video_Lists_Empty_Error:"The video list is empty, please check the format of video",Encrypted_Failed_Error:"Fetching encrypted file failed, please check the permission of player",Fetch_Failed_Permission_Error:"Fetching video list failed, please check the permission of player",Invalidate_Param_Error:"No video url, please check the parameters",AutoPlayDelayDisplayText:"Play in $$ seconds",Fetch_MTS_NOT_NotStream_Error:"The vid has no stream to play",Cancel_Text:"Cancel",OK_Text:"OK",Auto_Stream_Tip_Text:"Internet is slow, does switch to $$",Open_Html_By_File:"Html page should be on the server",Cant_Use_Flash_On_Mobile:"Mobile doesn't support flash player\uff0cplease use h5 player",Flash_Not_Ready:"Flash Player plugin hasn't been installed <a href='https://www.flash.cn/' target='_blank'>install plugin</a>, or check if disable Flash plugin"}},{}],22:[function(e,t,r){t.exports=t.exports={OD:"\u539f\u753b",FD:"\u6d41\u7545",LD:"\u6807\u6e05",SD:"\u9ad8\u6e05",HD:"\u8d85\u6e05","2K":"2K","4K":"4K",FHD:"\u5168\u9ad8\u6e05",XLD:"\u6781\u901f",SQ:"\u666e\u901a\u97f3\u8d28",HQ:"\u9ad8\u97f3\u8d28",Forbidden_Text:"\u5185\u90e8\u4fe1\u606f\uff0c\u4e25\u7981\u5916\u4f20",Refresh:"\u5237\u65b0",Diagnosis:"\u8bca\u65ad",Live_Finished:"\u76f4\u64ad\u5df2\u7ed3\u675f,\u8c22\u8c22\u89c2\u770b",Play:"\u64ad\u653e",Pause:"\u6682\u505c",Snapshot:"\u622a\u56fe",Replay:"\u91cd\u64ad",Live:"\u76f4\u64ad",Encrypt:"\u52a0\u5bc6",Sound:"\u58f0\u97f3",Fullscreen:"\u5168\u5c4f",Exist_Fullscreen:"\u9000\u51fa\u5168\u5c4f",Resolution:"\u6e05\u6670\u5ea6",Next:"\u4e0b\u4e00\u96c6",Brightness:"\u4eae\u5ea6",Default:"\u9ed8\u8ba4",Contrast:"\u5bf9\u6bd4\u5ea6",Titles_Credits:"\u7247\u5934\u7247\u5c3e",Skip_Titles:"\u8df3\u8fc7\u7247\u5934",Skip_Credits:"\u8df3\u8fc7\u7247\u5c3e",Not_Support_Out_Site:"\u8be5\u89c6\u9891\u6682\u4e0d\u652f\u6301\u7ad9\u5916\u64ad\u653e\uff0c\u8bf7\u5230\u6dd8TV\u89c2\u770b",Watch_Now:"\u7acb\u5373\u89c2\u770b",Network_Error:"\u7f51\u7edc\u65e0\u6cd5\u8fde\u63a5\uff0c\u8bf7\u5c1d\u8bd5\u68c0\u67e5\u7f51\u7edc\u540e\u5237\u65b0\u8bd5\u8bd5",Video_Error:"\u89c6\u9891\u64ad\u653e\u5f02\u5e38\uff0c\u8bf7\u5237\u65b0\u8bd5\u8bd5",Decode_Error:"\u64ad\u653e\u6570\u636e\u89e3\u7801\u9519\u8bef",Live_Not_Start:"\u4eb2\uff0c\u76f4\u64ad\u8fd8\u672a\u5f00\u59cb\u54e6\uff0c\u656c\u8bf7\u671f\u5f85",Live_Loading:"\u76f4\u64ad\u4fe1\u606f\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u5237\u65b0\u8bd5\u8bd5",Live_End:"\u4eb2\uff0c\u76f4\u64ad\u5df2\u7ed3\u675f",Live_Abrot:"\u5f53\u524d\u76f4\u64ad\u4fe1\u53f7\u4e2d\u65ad\uff0c\u8bf7\u5237\u65b0\u540e\u91cd\u8bd5",Corss_Domain_Error:"\u8bf7\u786e\u8ba4\u60a8\u7684\u57df\u540d\u5df2\u5b8c\u6210\u5907\u6848\u548cCNAME\u7ed1\u5b9a\uff0c\r\n\u5e76\u5904\u4e8e\u542f\u7528\u72b6\u6001\uff0c\u6216\u8d44\u6e90\u5141\u8bb8\u8de8\u8d8a\u8bbf\u95ee",Url_Timeout_Error:"\u60a8\u6240\u89c2\u770b\u7684\u89c6\u9891\u5730\u5740\u8fde\u63a5\u8d85\u65f6\uff0c\u8bf7\u5237\u65b0\u540e\u91cd\u8bd5",Connetction_Error:"\u62b1\u6b49,\u8be5\u89c6\u9891\u7531\u4e8e\u8fde\u63a5\u9519\u8bef\u6682\u65f6\u4e0d\u80fd\u64ad\u653e,\u8bf7\u89c2\u770b\u5176\u5b83\u89c6\u9891",Fetch_MTS_Error:"\u83b7\u53d6\u89c6\u9891\u5217\u8868\u5931\u8d25\uff0c\u8bf7\u786e\u8ba4",Token_Expired_Error:"\u8bf7\u6c42\u63a5\u53e3\u5931\u8d25\uff0c\u8bf7\u786e\u8ba4Token\u662f\u5426\u8fc7\u671f",Video_Lists_Empty_Error:"\u83b7\u53d6\u89c6\u9891\u5217\u8868\u4e3a\u7a7a\uff0c\u8bf7\u786e\u8ba4\u64ad\u653e\u6570\u636e\u4e0e\u683c\u5f0f",Encrypted_Failed_Error:"\u83b7\u53d6\u89c6\u9891\u52a0\u5bc6\u79d8\u94a5\u9519\u8bef\uff0c\u8bf7\u786e\u8ba4\u64ad\u653e\u6743\u9650",Fetch_Failed_Permission_Error:"\u83b7\u53d6\u89c6\u9891\u5217\u8868\u5931\u8d25\uff0c\u8bf7\u786e\u8ba4\u64ad\u653e\u6743\u9650",Invalidate_Param_Error:"\u65e0\u8f93\u5165\u89c6\u9891\uff0c\u8bf7\u786e\u8ba4\u8f93\u5165\u53c2\u6570",AutoPlayDelayDisplayText:"$$\u79d2\u4ee5\u540e\u5f00\u59cb\u64ad\u653e",Fetch_MTS_NOT_NotStream_Error:"\u6b64vid\u6ca1\u6709\u53ef\u64ad\u653e\u89c6\u9891",Cancel_Text:"\u53d6\u6d88",OK_Text:"\u786e\u8ba4",Auto_Stream_Tip_Text:"\u7f51\u7edc\u4e0d\u7ed9\u529b\uff0c\u662f\u5426\u5207\u6362\u5230$$",Fetch_Playauth_Error:"\u83b7\u53d6\u64ad\u653e\u51ed\u8bc1\u51fa\u9519\u5566\uff0c\u8bf7\u5c1d\u8bd5\u9000\u51fa\u91cd\u8bd5\u6216\u5237\u65b0",Open_Html_By_File:"\u4e0d\u80fd\u76f4\u63a5\u5728\u6d4f\u89c8\u5668\u6253\u5f00html\u6587\u4ef6\uff0c\u8bf7\u90e8\u7f72\u5230\u670d\u52a1\u7aef",Cant_Use_Flash_On_Mobile:"\u79fb\u52a8\u7aef\u4e0d\u652f\u6301Flash\u64ad\u653e\u5668\uff0c\u8bf7\u4f7f\u7528h5\u64ad\u653e\u5668",Flash_Not_Ready:"Flash Player\u63d2\u4ef6\u672a\u5b89\u88c5<a href='https://www.flash.cn/' target='_blank'>\u5b89\u88c5\u63d2\u4ef6</a>\uff0c\u5982\u679c\u5df2\u7ecf\u5b89\u88c5\u8bf7\u68c0\u67e5\u662f\u5426\u88ab\u7981\u7528"}},{}],23:[function(o,e,t){function n(){var e;return void 0!==window[l]&&window[l]||(e=(e=(navigator.language||navigator.browserLanguage).toLowerCase())&&-1<e.indexOf("zh")?"zh-cn":"en-us",window[l]=e),window[l]}function a(e,t){var r=p(e),i="",n=u(),i="flash"==e?"en-us"==n?o("./flash/en-us"):"zh-cn"==n?o("./flash/zh-cn"):t[n]:"en-us"==n?o("./en-us"):"zh-cn"==n?o("./zh-cn"):t[n];s.set(r,JSON.stringify(i)),c(e,i)}var r=o("../config"),s=o("../lib/storage"),i=(o("../lib/io"),"aliplayer_lang_data"),l="aliplayer_lang",c=function(e,t){e=p(e);window[e]=t},u=function(){return n()},p=function(e){var t=u();return i+"_"+(e=e||"h5")+"_"+r.h5Version.replace(/\./g,"_")+"_"+t};e.exports.setCurrentLanguage=function(e,t,r){var i=window[l];if(!("en-us"==(e=void 0!==e&&e?e:n())||"zh-cn"==e||r&&r[e]))throw new Error("There is not language resource for "+e+", please specify the language resource by languageTexts property");window[l]=e,a(t,r),e!=i&&o("../lib/constants").updateByLanguage()},e.exports.getCurrentLanguage=n,e.exports.getLanguageData=function(e,t){e=p(e);return window[e]},e.exports.load=a,e.exports.get=function(e,t){t=p(t=t||"h5"),t=window[t];if(t)return t[e]}},{"../config":14,"../lib/constants":28,"../lib/io":40,"../lib/storage":48,"./en-us":20,"./flash/en-us":21,"./flash/zh-cn":22,"./zh-cn":24}],24:[function(e,t,r){t.exports=t.exports={OD:"\u539f\u753b",FD:"\u6d41\u7545",LD:"\u6807\u6e05",SD:"\u9ad8\u6e05",HD:"\u8d85\u6e05","2K":"2K","4K":"4K",FHD:"\u5168\u9ad8\u6e05",XLD:"\u6781\u901f",SQ:"\u666e\u901a\u97f3\u8d28",HQ:"\u9ad8\u97f3\u8d28",Speed:"\u500d\u901f",Speed_05X_Text:"0.5X",Speed_1X_Text:"\u6b63\u5e38",Speed_125X_Text:"1.25X",Speed_15X_Text:"1.5X",Speed_2X_Text:"2X",Quality_Change_Fail_Switch_Text:"\u4e0d\u80fd\u64ad\u653e\uff0c\u5207\u6362\u4e3a",Quality_Change_Text:"\u6b63\u5728\u4e3a\u60a8\u5207\u6362\u5230 ",Quality_The_Url:"\u6b64\u5730\u5740",Refresh_Text:"\u5237\u65b0",Detection_Text:"\u67e5\u770b\u5efa\u8bae",Cancel:"\u53d6\u6d88",Mute:"\u9759\u97f3",Snapshot:"\u622a\u56fe",Play_DateTime:"\u64ad\u653e\u65f6\u95f4",AutoPlayDelayDisplayText:"$$\u79d2\u4ee5\u540e\u5f00\u59cb\u64ad\u653e",Error_Load_Abort_Text:"\u83b7\u53d6\u6570\u636e\u8fc7\u7a0b\u88ab\u4e2d\u6b62",Error_Network_Text:"\u7f51\u7edc\u9519\u8bef\u52a0\u8f7d\u6570\u636e\u5931\u8d25",Error_Decode_Text:"\u89e3\u7801\u9519\u8bef",Error_Server_Network_NotSupport_Text:"\u670d\u52a1\u5668\u3001\u7f51\u7edc\u9519\u8bef\u6216\u683c\u5f0f\u4e0d\u652f\u6301",Error_Offline_Text:"\u7f51\u7edc\u4e0d\u53ef\u7528\uff0c\u8bf7\u786e\u5b9a",Error_Play_Text:"\u64ad\u653e\u51fa\u9519\u5566",Error_Retry_Text:"\u8bf7\u5c1d\u8bd5\u9000\u51fa\u91cd\u8bd5\u6216\u5237\u65b0",Error_AuthKey_Text:"\u53ef\u80fd\u9274\u6743\u8fc7\u671f\u3001\u57df\u540d\u4e0d\u5728\u767d\u540d\u5355\u6216\u8bf7\u6c42\u88ab\u62e6\u622a",Error_H5_Not_Support_Text:"h5\u4e0d\u652f\u6301\u6b64\u683c\u5f0f\uff0c\u8bf7\u4f7f\u7528flash\u64ad\u653e\u5668",Error_Not_Support_M3U8_Text:"\u6d4f\u89c8\u5668\u4e0d\u652f\u6301m3u8\u89c6\u9891\u64ad\u653e",Error_Not_Support_MP4_Text:"\u6d4f\u89c8\u5668\u4e0d\u652f\u6301mp4\u89c6\u9891\u64ad\u653e",Error_Not_Support_encrypt_Text:"\u64ad\u653e\u79c1\u6709\u52a0\u5bc6\u89c6\u9891\uff0c\u8bf7\u8bbe\u7f6e\u5c5e\u6027encryptType\u4e3a1",Error_Vod_URL_Is_Empty_Text:"\u83b7\u53d6\u64ad\u653e\u5730\u5740\u4e3a\u7a7a",Error_Vod_Fetch_Urls_Text:"\u83b7\u53d6\u5730\u5740\u51fa\u9519\u5566\uff0c\u8bf7\u5c1d\u8bd5\u9000\u51fa\u91cd\u8bd5\u6216\u5237\u65b0",Fetch_Playauth_Error:"\u83b7\u53d6\u64ad\u653e\u51ed\u8bc1\u51fa\u9519\u5566\uff0c\u8bf7\u5c1d\u8bd5\u9000\u51fa\u91cd\u8bd5\u6216\u5237\u65b0",Error_Playauth_Decode_Text:"playauth\u89e3\u6790\u9519\u8bef",Error_Vid_Not_Same_Text:"\u4e0d\u80fd\u66f4\u65b0\u5730\u5740\uff0cvid\u548c\u64ad\u653e\u4e2d\u7684\u4e0d\u4e00\u81f4",Error_Playauth_Expired_Text:"\u51ed\u8bc1\u5df2\u8fc7\u671f\uff0c\u8bf7\u5c1d\u8bd5\u9000\u51fa\u91cd\u8bd5\u6216\u5237\u65b0",Error_MTS_Fetch_Urls_Text:"MTS\u83b7\u53d6\u53d6\u6570\u5931\u8d25",Error_Load_M3U8_Failed_Text:"\u83b7\u53d6m3u8\u6587\u4ef6\u5931\u8d25,\u8bf7\u786e\u8ba4\u57df\u540d\u662f\u5426\u914d\u7f6e\u4e86https\u8bc1\u4e66\u6216\u8005\u662f\u5426\u5f00\u542f\u4e86\u5141\u8bb8\u8de8\u57df\u8bbf\u95ee",Error_Load_M3U8_Timeout_Text:"\u83b7\u53d6m3u8\u6587\u4ef6\u8d85\u65f6",Error_Liveshift_M3U8_Not_Found_Text:"\u6ca1\u6709\u66f4\u591a\u65f6\u79fb\u89c6\u9891\u4e86",Error_M3U8_Decode_Text:"\u83b7\u53d6m3u8\u6587\u4ef6\u89e3\u6790\u5931\u8d25",Error_TX_Decode_Text:"\u89e3\u6790\u6570\u636e\u51fa\u9519",Error_Waiting_Timeout_Text:"\u7f13\u51b2\u6570\u636e\u8d85\u65f6\uff0c\u8bf7\u5c1d\u8bd5\u9000\u51fa\u91cd\u8bd5\u6216\u5237\u65b0",Error_Invalidate_Source:"\u64ad\u653e\u5730\u5740\u683c\u5f0f\u9700\u8981\u4e3amp4\u3001mp3\u3001m3u8\u3001mpd\u6216flv",Error_Empty_Source:"\u64ad\u653e\u5730\u5740\u4e0d\u80fd\u4e3a\u7a7a",Error_Vid_Empty_Source:"vid\u5bf9\u5e94\u7684\u89c6\u9891\u5730\u5740\u8fd8\u672a\u83b7\u53d6\u5230",Error_Mediaauth_Empty_Source:"mediaAuth\u5bf9\u5e94\u7684\u89c6\u9891\u5730\u5740\u8fd8\u672a\u83b7\u53d6\u5230",Error_Fetch_NotStream:"\u6b64vid\u6ca1\u6709\u53ef\u64ad\u653e\u89c6\u9891",Error_Fetch_Media_Not_Found:"\u6570\u636e\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664",Error_Not_Found:"\u64ad\u653e\u5730\u5740\u4e0d\u5b58\u5728",Error_Drm_License_Request_Failed:"DRM License \u8bf7\u6c42\u5931\u8d25",Error_Drm_Not_Supported:"\u5f53\u524d\u6d4f\u89c8\u5668\u4e0d\u652f\u6301 DRM \u64ad\u653e",Error_Drm_Load:"DRM \u64ad\u653e\u9519\u8bef",Error_Region_Block_Text:"\u60a8\u6240\u5728\u7684\u5730\u533a\u65e0\u6cd5\u89c2\u770b\u8be5\u89c6\u9891",Tip_Err_Common:"\u60a8\u53ef\u8054\u7cfb\u552e\u540e\u652f\u6301\uff0c\u9519\u8bef\u8be6\u60c5:<br />",Tip_Err_Common_Short:"\u9519\u8bef\u8be6\u60c5:<br />",Tip_Drm_Request_Err:"\u8bf7\u6c42\u51fa\u9519\uff0c\u8bf7\u5148\u67e5\u770b\u6d4f\u89c8\u5668\u63a7\u5236\u53f0\uff0c\u68c0\u67e5\u662f\u5426\u7531\u57df\u540d\u89e3\u6790\u3001https\u8bc1\u4e66\u3001\u6216\u7f51\u7edc\u95ee\u9898\u5f15\u8d77\u3002<br />\u82e5\u4ee5\u4e0a\u68c0\u67e5\u6ca1\u95ee\u9898\uff0c",Tip_Drm_Secure_Context:"DRM\u4ec5\u53ef\u4ee5\u5728https\u3001localhost\u3001127.0.0.1\u7f51\u9875\u4e0b\u8bbf\u95ee\uff0c\u540c\u65f6m3u8\u548c\u5207\u7247\u4e5f\u5fc5\u987b\u4f7f\u7528https\u3002",Tip_Drm_Key_System_Unavailable:"1.\u6b64\u6d4f\u89c8\u5668\u4e0d\u652f\u6301Widevine\u6216\u8005\u5f53\u524d\u7684Widevine\u914d\u7f6e<br />2.\u6d4f\u89c8\u5668\u5f39\u51fa\u7684\u8bf7\u6c42\u88ab\u7528\u6237\u62d2\u7edd\u4e86<br />3.\u8bf7\u6253\u5f00\u6d4f\u89c8\u5668\u8bbe\u7f6e\uff0c\u67e5\u627e\u5173\u4e8e\u3010\u53d7\u4fdd\u62a4\u7684\u5185\u5bb9\u3011\u8bbe\u7f6e\u5e76\u5141\u8bb8",Tip_Drm_File_Not_Allowed:"\u8bf7\u4e0d\u8981\u4f7f\u7528file://\u76f4\u63a5\u6253\u5f00\u6587\u4ef6\uff0c\u9700\u8981\u4f7f\u7528https://\u8bbf\u95ee\u6587\u4ef6",Tip_Drm_Playlist_Hierarchy:"HLS\u64ad\u653e\u5217\u8868\u5c42\u7ea7\u9519\u8bef\uff0c\u4e3b\u5217\u8868\u9700\u8981\u662f master playlist",Tip_Err_Decode:"\u89e3\u7801\u9519\u8bef\u6307\u7684\u662f\u5f53\u524d\u97f3/\u89c6\u9891\u5e27\u4e0e\u6d4f\u89c8\u5668\u4e0d\u517c\u5bb9\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u4ee5\u4e0b\u65b9\u5f0f\uff1a<br />1.chrome/edge \u6d4f\u89c8\u5668\u6253\u5f00chrome://flags\uff0c\u641c\u7d22 Hardware-accelerated video decode\uff0c\u9009\u62e9 disabled<br />2.\u5982\u679c\u89e3\u7801\u9519\u8bef\u4ecd\u7136\u5b58\u5728\uff0c\u8bf7\u5bf9\u89c6\u9891\u8fdb\u884c\u8f6c\u7801\u5904\u7406\uff0c\u4ee5\u4fee\u590d\u95ee\u9898\u5e27",Tip_Err_Rts_Http_Failed:"\u8be5\u9519\u8bef\u6307\u7684\u662fRTS\u62c9\u6d41\u8bf7\u6c42\u9047\u5230\u4e86\u4e00\u4e2ahttp\u9519\u8bef\uff0c\u4e00\u822c\u6765\u8bf4\u662fhttps\u8bc1\u4e66\u3001DNS\u89e3\u6790\u6216\u8005\u7f51\u7edc\u8fde\u901a\u6027\u95ee\u9898\uff0c\u7531\u4e8e\u6d4f\u89c8\u5668\u5bf9JS\u7684\u9650\u5236\uff0c\u64ad\u653e\u5668\u65e0\u6cd5\u53d6\u5f97\u8be6\u7ec6\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u9700\u8981\u8fdb\u4e00\u6b65\u6392\u67e5\uff0c\u60a8\u53ef\u6309\u7167\u4ee5\u4e0b\u64cd\u4f5c\uff1a<br>1.\u53f3\u952e\u6d4f\u89c8\u5668\u7a7a\u767d\u5904\uff0c\u9009\u62e9\u3010\u68c0\u67e5\u30112.\u5728\u65b0\u6253\u5f00\u7684\u754c\u9762\u4e2d\u9009\u62e9\u3010\u63a7\u5236\u53f0\u30113.\u67e5\u770b\u7ea2\u8272\u62a5\u9519\uff1a<br>\u5982\u679c\u6709SSL\u5b57\u6837\uff0c\u5219\u4ee3\u8868\u60a8\u6ca1\u6709\u4e3a\u62c9\u6d41\u57df\u540d\u6b63\u786e\u5730\u914d\u7f6ehttps\u8bc1\u4e66<br>\u5982\u679c\u6709NOT RESOLVED\u5b57\u6837\uff0c\u5219\u4ee3\u8868\u60a8\u7684\u57df\u540dDNS\u89e3\u6790\u5931\u8d25<br>\u60a8\u4e5f\u4f7f\u7528<a style='color:white;text-decoration:underline;' href='https://live.console.aliyun.com/#/tool/url' target='_blank'>\u963f\u91cc\u4e91\u76f4\u64ad\u8bca\u65ad\u5de5\u5177</a>\u8fdb\u884c\u81ea\u52a9\u6392\u67e5",Live_End:"\u4eb2\uff0c\u76f4\u64ad\u5df2\u7ed3\u675f",Play_Before_Fullscreen:"\u64ad\u653e\u540e\u518d\u5168\u5c4f",Can_Not_Seekable:"\u4e0d\u80fdseek\u5230\u8fd9\u91cc",Cancel_Text:"\u53d6\u6d88",OK_Text:"\u786e\u8ba4",Auto_Stream_Tip_Text:"\u7f51\u7edc\u4e0d\u7ed9\u529b\uff0c\u662f\u5426\u5207\u6362\u5230$$",Request_Block_Text:"\u6d4f\u89c8\u5668\u5b89\u5168\u7b56\u7565\u89c6\u9891\u5730\u5740\u4e0d\u80fd\u4e3ahttp\u534f\u8bae\uff0c\u4e0e\u7f51\u7ad9https\u534f\u8bae\u4e0d\u4e00\u81f4",Open_Html_By_File:"\u4e0d\u80fd\u76f4\u63a5\u5728\u6d4f\u89c8\u5668\u6253\u5f00html\u6587\u4ef6\uff0c\u8bf7\u90e8\u7f72\u5230\u670d\u52a1\u7aef",Maybe_Cors_Error:"\u8bf7\u786e\u8ba4\u57df\u540d\u662f\u5426\u914d\u7f6e\u4e86https\u8bc1\u4e66\u6216\u8005\u662f\u5426\u5f00\u542f\u4e86\u5141\u8bb8\u8de8\u57df\u8bbf\u95ee",Speed_Switch_To:"\u500d\u901f\u5207\u6362\u5230 ",Curent_Volume:"\u5f53\u524d\u97f3\u91cf\uff1a",Volume_Mute:"\u8bbe\u7f6e\u4e3a\u9759\u97f3",Volume_UnMute:"\u8bbe\u7f6e\u4e3a\u975e\u9759\u97f3",ShiftLiveTime_Error:"\u76f4\u64ad\u5f00\u59cb\u65f6\u95f4\u4e0d\u80fd\u5927\u4e8e\u76f4\u64ad\u7ed3\u675f\u65f6\u95f4",Error_Not_Support_Format_On_Mobile:"\u79fb\u52a8\u7aef\u4e0d\u652f\u6301flv\u3001rmtp\u89c6\u9891\uff0c\u8bf7\u4f7f\u7528m3u8",SessionId_Ticket_Invalid:"DRM\u89c6\u9891\u64ad\u653e\uff0csessionId\u548cticket\u5c5e\u6027\u4e0d\u80fd\u4e3a\u7a7a",Http_Error:"Http\u7f51\u7edc\u8bf7\u6c42\u5931\u8d25",Http_Timeout:"http\u8bf7\u6c42\u8d85\u65f6",DRM_License_Expired:"DRM license\u8d85\u65f6\uff0c\u8bf7\u5237\u65b0",Not_Support_DRM:"\u6d4f\u89c8\u5668\u4e0d\u652f\u6301DRM\u89c6\u9891\u7684\u64ad\u653e\u6216\u672a\u53d7\u5230\u7528\u6237\u8bb8\u53ef",CC_Switch_To:"\u5b57\u5e55\u5207\u6362\u5230 ",AudioTrack_Switch_To:"\u97f3\u8f68\u5207\u6362\u5230 ",Subtitle:"\u5b57\u5e55",AudioTrack:"\u97f3\u8f68",Quality:"\u6e05\u6670\u5ea6",Auto:"\u81ea\u52a8",Quality_Switch_To:"\u6e05\u6670\u5ea6\u5207\u6362\u5230 ",Fullscreen:"\u5168\u5c4f",Setting:"\u8bbe\u7f6e",Volume:"\u97f3\u91cf",Play:"\u64ad\u653e",Pause:"\u6682\u505c",CloseSubtitle:"\u5173\u95ed\u5b57\u5e55",OpenSubtitle:"\u6253\u5f00\u5b57\u5e55",ExistFullScreen:"\u9000\u51fa\u5168\u5c4f",Muted:"\u9759\u97f3",Retry:"\u91cd\u8bd5",SwitchToLive:"\u8fd4\u56de\u76f4\u64ad",iOSNotSupportVodEncription:"iOS\u4e0d\u652f\u6301\u963f\u91cc\u4e91\u89c6\u9891\u52a0\u5bc6\uff08\u52a0\u5bc6\uff09\u64ad\u653e\uff0c\u8bf7\u4f7f\u7528\u6807\u51c6\u52a0\u5bc6\u6216DRM",UseChromeForVodEncription:"\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u70b9\u64ad\u52a0\u5bc6\u64ad\u653e\uff0c\u8bf7\u4f7f\u7528\u6700\u65b0Chrome\u6d4f\u89c8\u5668",Record_Not_Allowed:"\u7981\u6b62\u5f55\u5c4f\u6216\u5c0f\u7a97\u53e3\u64ad\u653e\uff0c\u8bf7\u5173\u95ed\u63d2\u4ef6\u6216\u66f4\u6362\u6d4f\u89c8\u5668",License_No_Authorization:"\u64ad\u653e\u5668SDK\u672a\u6fc0\u6d3b",License_Click_To_Apply:"\u70b9\u51fb\u7533\u8bf7License",Rts_Err_Http_Signal_Error:"(RTS)\u4fe1\u4ee4\u8bf7\u6c42\u5931\u8d25",Rts_Err_Play_Failed:"(RTS)\u64ad\u653e\u5931\u8d25",Rts_Err_No_Data_For:"\u6beb\u79d2\u6ca1\u6709\u6570\u636e",Rts_Err_Browser_Not_Support:"(RTS)\u4e0d\u652f\u6301\u6b64\u6d4f\u89c8\u5668",Rts_Err_Not_Support_Webrtc:"(RTS)\u4e0d\u652f\u6301webrtc",Rts_Err_Browser_Version_Too_Low:"(RTS)\u6d4f\u89c8\u5668\u7248\u672c\u8fc7\u4f4e",Rts_Err_Not_Support_H264:"(RTS)\u4e0d\u652f\u6301H264",Rts_Err_Create_Offer_Error:"(RTS)create offer\u5931\u8d25",Rts_Err_Play_Url_Error:"(RTS)\u64ad\u653eurl\u534f\u8bae\u9519\u8bef",Rts_Err_Subscribe_Nonthing:"(RTS)\u53c2\u6570\u8bbe\u7f6e\u9519\u8bef",Rts_Err_Http_Request_Failed:"(RTS)HTTP\u8bf7\u6c42\u5931\u8d25",Rts_Err_Http_Answer_Failed:"(RTS)answer\u5931\u8d25",Rts_Err_PeerConnection_Unknown:"(RTS)PeerConnection\u5f02\u5e38",Splayer_Err_Env_Check:"(SP)\u5f53\u524d\u73af\u5883\u4e0d\u652f\u6301\u64ad\u653e\u8be5\u89c6\u9891",Splayer_Err_Coroutine:"(SP)Coroutine \u9519\u8bef",Splayer_Err_Decode:"(SP)\u89e3\u7801\u9519\u8bef",Splayer_Err_Buffering:"(SP)\u7f13\u51b2\u533a\u9519\u8bef",Splayer_Err_Parser_Not_Found:"(SP)\u4e0d\u652f\u6301\u7684\u5a92\u4f53\u5bb9\u5668"}},{}],25:[function(e,t,r){var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";if(window.Uint8Array)for(var u=new Uint8Array(256),i=0;i<o.length;i++)u[o.charCodeAt(i)]=i;var s=function(e){for(var t="",r=0;r<e.length;r+=16e3){var i=e.subarray(r,r+16e3);t+=String.fromCharCode.apply(null,i)}return t};t.exports={decode:function(e){for(var t,r,i,n,o=.75*e.length,a=e.length,s=0,o=("="===e[e.length-1]&&(o--,"="===e[e.length-2])&&o--,new ArrayBuffer(o)),l=new Uint8Array(o),c=0;c<a;c+=4)t=u[e.charCodeAt(c)],r=u[e.charCodeAt(c+1)],i=u[e.charCodeAt(c+2)],n=u[e.charCodeAt(c+3)],l[s++]=t<<2|r>>4,l[s++]=(15&r)<<4|i>>2,l[s++]=(3&i)<<6|63&n;return o},encode:function(e){for(var t=new Uint8Array(e),r=t.length,i="",n=0;n<r;n+=3)i=(i=(i=(i+=o[t[n]>>2])+o[(3&t[n])<<4|t[n+1]>>4])+o[(15&t[n+1])<<2|t[n+2]>>6])+o[63&t[n+2]];return r%3==2?i=i.substring(0,i.length-1)+"=":r%3==1&&(i=i.substring(0,i.length-2)+"=="),i},unpackPlayReady:function(e){e=function(e,t,r){if(!e)return"";r||e.byteLength%2==0||console.log("Data has an incorrect length, must be even."),r=e instanceof ArrayBuffer?e:((r=new Uint8Array(e.byteLength)).set(new Uint8Array(e)),r.buffer);for(var i=Math.floor(e.byteLength/2),n=new Uint16Array(i),o=new DataView(r),a=0;a<i;a++)n[a]=o.getUint16(2*a,t);return s(n)}(e,!0,!0);if(-1!=e.indexOf("PlayReadyKeyMessage")){for(var e=(new DOMParser).parseFromString(e,"application/xml"),t=e.getElementsByTagName("HttpHeader"),r={},i=0;i<t.length;++i){var n=t[i].querySelector("name"),o=t[i].querySelector("value");r[n.textContent]=o.textContent}return{header:r,changange:e.querySelector("Challenge").textContent}}console.log("PlayReady request is already unwrapped.")}}},{}],26:[function(e,t,r){var n=e("./videox-muxer.min");function o(){}t.exports=function(e,t,r){void 0===t&&(t=o),void 0===r&&(r=o);var i=new n.Demuxer({progressive:!0});i.on("loadedmetadata",function(e){void 0===e&&(e={}),i.suspend(),i.destroy(),i=null,t(e)}),i.on("error",function(e){r(e)}),i.load(e)}},{"./videox-muxer.min":52}],27:[function(e,t,r){var i=e("./oo"),n=e("../player/base/event/eventtype");t.exports.stopPropagation=function(e){window.event?window.event.cancelBubble=!0:e.stopPropagation()},t.exports.register=function(e){e.util={stopPropagation:t.exports.stopPropagation},e.Component=i.extend,e.EventType=n.Player}},{"../player/base/event/eventtype":70,"./oo":43}],28:[function(e,t,r){function i(){t.exports.VideoErrorCodeText={1:n.get("Error_Load_Abort_Text"),2:n.get("Error_Network_Text"),3:n.get("Error_Decode_Text"),4:n.get("Error_Server_Network_NotSupport_Text")},t.exports.VideoLevels={0:n.get("OD"),640:n.get("FD"),960:n.get("LD"),1280:n.get("SD"),1920:n.get("HD"),2580:n.get("2K"),3840:n.get("4K")},t.exports.QualityLevels={OD:n.get("OD"),LD:n.get("LD"),FD:n.get("FD"),SD:n.get("SD"),HD:n.get("HD"),"2K":n.get("2K"),"4K":n.get("4K"),XLD:n.get("XLD"),FHD:n.get("FHD"),SQ:n.get("SQ"),HQ:n.get("HQ")},t.exports.SpeedLevels=[{key:.5,text:n.get("Speed_05X_Text")},{key:1,text:n.get("Speed_1X_Text")},{key:1.25,text:n.get("Speed_125X_Text")},{key:1.5,text:n.get("Speed_15X_Text")},{key:2,text:n.get("Speed_2X_Text")}]}var n=e("../lang/index");t.exports.LOAD_START="loadstart",t.exports.LOADED_METADATA="loadedmetadata",t.exports.LOADED_DATA="loadeddata",t.exports.PROGRESS="progress",t.exports.CAN_PLAY="canplay",t.exports.CAN_PLYA_THROUGH="canplaythrough",t.exports.PLAY="play",t.exports.PAUSE="pause",t.exports.ENDED="ended",t.exports.PLAYING="playing",t.exports.WAITING="waiting",t.exports.ERROR="error",t.exports.SUSPEND="suspend",t.exports.STALLED="stalled",t.exports.AuthKeyExpiredEvent="authkeyexpired",t.exports.USER_EVENT_NAME="__user_events__",t.exports.PLAYER_SDK_CODE=9201,t.exports.FEATURE_ID_H265=30001,t.exports.FEATURE_ID_H266=30002,t.exports.LicenseResultCode={Success:0,NotFound:1,Expired:2,CertInvalid:3,WasmNotSupported:4,ResourceIncorrect:5,LicenseKeyInvalid:6,DomainInvalid:7},t.exports.DRMKeySystem={4:"com.microsoft.playready",5:"com.widevine.alpha"},t.exports.EncryptionType={Private:1,Standard:2,ChinaDRM:3,PlayReady:4,Widevine:5},t.exports.VodEncryptionType={AliyunVoDEncryption:1,HLSEncryption:2,Widevine:5,"Widevine-FairPlay":5},t.exports.DRMType={Widevine:"Widevine",PlayReady:"PlayReady"},t.exports.ErrorCode={InvalidParameter:4001,AuthKeyExpired:4002,InvalidSourceURL:4003,NotFoundSourceURL:4004,StartLoadData:4005,LoadedMetadata:4006,PlayingError:4007,LoadingTimeout:4008,RequestDataError:4009,EncrptyVideoNotSupport:4010,FormatNotSupport:4011,PlayauthDecode:4012,PlayDataDecode:4013,NetworkUnavaiable:4014,UserAbort:4015,NetworkError:4016,URLsIsEmpty:4017,DrmLicenseRequestFailed:4018,RecordNotAllowed:4019,MediaNotFound:4020,DrmNotSupported:4021,DrmLoadError:4022,RegionBlock:4023,CrossDomain:4027,OtherError:4400,ServerAPIError:4500,FlashNotInstalled:4600,RtsSignalError:4100,RtsPlayFailedError:4200,RtsNotSupportWebRtc:4110,RtsBrowserNotSupport:4111,RtsBrowserVersionTooLow:4112,RtsNotSupportH264:4113,RtsCreateOfferError:4114,RtsAutoPLayFaild:4115,RtsPlayUrlError:4116,RtsSubscribeNonthing:4117,RtsHtmlElementError:4118,RtsHtmlElementNotMatch:4119,RtsBrowserNotSupportRtc:4120,RtsHttpRequestFaild:4121,RtsHttpAnswerFaild:4122,RtsPeerConnectionUnknown:4123,SplayerEnvCheckError:4300,SplayerCoroutineError:4301,SplayerDecodeError:4302,SplayerBufferingError:4303,SplayerParserNotFound:4304},t.exports.AuthKeyExpired=7200,t.exports.AuthKeyRefreshExpired=7e3,t.exports.AuthInfoExpired=100,t.exports.VideoErrorCode={1:4015,2:4016,3:4013,4:4400},t.exports.RegionBlockMessages=["black location","denied by region block"],t.exports.IconType={FontClass:"fontclass",Symbol:"symbol",Sprite:"Sprite"},t.exports.SelectedStreamLevel="selectedStreamLevel",t.exports.SelectedCC="selectedCC",t.exports.HWDetectHvc1="HWDetectHvc1",t.exports.HWDetectHvc1Hls="HWDetectHvc1Hls",t.exports.HWDetectHev1="HWDetectHev1",t.exports.HWDetectHev1Hls="HWDetectHev1Hls",t.exports.WidthMapToLevel={0:"OD",640:"FD",960:"LD",1280:"SD",1920:"HD",2580:"2K",3840:"4K"};i(),t.exports.updateByLanguage=i},{"../lang/index":23}],29:[function(e,t,r){t.exports.get=function(e){for(var t=e+"",r=document.cookie.split(";"),i=0;i<r.length;i++){var n=r[i].trim();if(0==n.indexOf(t))return unescape(n.substring(t.length+1,n.length))}return""},t.exports.set=function(e,t,r){var i=new Date,r=(i.setTime(i.getTime()+24*r*60*60*1e3),"expires="+i.toGMTString());document.cookie=e+"="+escape(t)+"; "+r}},{}],30:[function(e,r,t){var i=e("./object");r.exports.cache={},r.exports.guid=function(e,t){var r,i,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),o=[];if(t=t||n.length,e)for(r=0;r<e;r++)o[r]=n[0|Math.random()*t];else for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",r=0;r<36;r++)o[r]||(i=0|16*Math.random(),o[r]=n[19==r?3&i|8:i]);return o.join("")},r.exports.expando="vdata"+(new Date).getTime(),r.exports.getData=function(e){var t=e[r.exports.expando];return t||(t=e[r.exports.expando]=r.exports.guid(),r.exports.cache[t]={}),r.exports.cache[t]},r.exports.hasData=function(e){var t="";return!(!(t=e?e[r.exports.expando]:t)||i.isEmpty(r.exports.cache[t]))},r.exports.removeData=function(t){var e="";if(e=t?t[r.exports.expando]:e){delete r.exports.cache[e];try{delete t[r.exports.expando]}catch(e){t.removeAttribute?t.removeAttribute(r.exports.expando):t[r.exports.expando]=null}}}},{"./object":42}],31:[function(e,t,r){var i,d="undefined"==typeof Promise?e("es6-promise").Promise:Promise;e="undefined"!=typeof self?self:this,i=function(){return r=[function(e,t,r){"use strict";!function(e){t.b=function(e){for(var t=(e=void 0===e?{}:e).includes,e=e.excludes,e=void 0===e?[]:e,r=!1,i=!1,n=0,o=void 0===t?[]:t;n<o.length;n++)if(!0===o[n]){r=!0;break}for(var a=0,s=e;a<s.length;a++)if(!0===s[a]){i=!0;break}return r&&!i},t.c=function(e,t,r){e=n.a[e];return void 0!==e&&Object(i.compare)(e,t,r)},t.a=function(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:this};var i=r(11),n=(r.n(i),r(4))}.call(t,r(10))},function(e,t,r){"use strict";r.d(t,"c",function(){return n}),r.d(t,"d",function(){return o}),r.d(t,"b",function(){return a}),r.d(t,"f",function(){return s}),r.d(t,"a",function(){return l}),r.d(t,"e",function(){return c});var i,t=r(3),r=r(0),r=Object(r.a)(),n="InstallTrigger"in((null==r?void 0:r.window)||{})||/firefox/i.test(t.b),o=/trident/i.test(t.b)||/msie/i.test(t.b),a=/edge/i.test(t.b),s=/webkit/i.test(t.b)&&!a,l=void 0!==(null==(i=null==r?void 0:r.window)?void 0:i.chrome)||/chrome/i.test(t.b),c="[object SafariRemoteNotification]"===((null==(r=null==(i=null==r?void 0:r.window)?void 0:i.safari)?void 0:r.pushNotification)||!1).toString()||/safari/i.test(t.b)&&!l},function(e,t,r){"use strict";r.d(t,"b",function(){return o}),r.d(t,"c",function(){return a}),r.d(t,"a",function(){return s});var i=r(1);function n(r){if(console){if(!i.d&&!i.b)return console[r];if("log"===r||"clear"===r)return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console[r].apply(console,e)}}return function(){for(var e=0;e<arguments.length;e++)e,0}}var o=n("log"),a=n("table"),s=n("clear")},function(e,t,r){"use strict";t.a=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return null!=i&&i.document?(e=i.document).createElement.apply(e,t):{}},r.d(t,"b",function(){return n});var t=r(0),i=Object(t.a)(),n=(null==(r=null==i?void 0:i.navigator)?void 0:r.userAgent)||"xxxxx"},function(e,t,r){"use strict";r.d(t,"a",function(){return i});for(var i={},n=0,o=(r(3).b||"").match(/\w+\/(\d|\.)+(\s|$)/gi)||[];n<o.length;n++){var a=o[n].split("/"),s=a[0],a=a[1];i[s]=a}},function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"d",function(){return n}),r.d(t,"c",function(){return o}),r.d(t,"a",function(){return a}),r.d(t,"e",function(){return s});var t=r(3),i=/ipad/i.test(t.b),n=/macintosh/i.test(t.b),o=/iphone/i.test(t.b),a=/android/i.test(t.b),s=/windows/i.test(t.b)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addListener=function(e){p.addListener(e)},t.removeListener=function(e){p.removeListener(e)},t.isLaunch=function(){return p.isLaunch()},t.launch=function(){p.launch()},t.stop=function(){p.stop()},t.setDetectDelay=function(e){p.setDetectDelay(e)};var i=r(7),n=r(8),o=(r.d(t,"DevtoolsDetector",function(){return i.a}),r.d(t,"checkers",function(){return n}),r(0)),a=(r.d(t,"match",function(){return o.b}),r.d(t,"specificVersionMatch",function(){return o.c}),r(1)),s=(r.d(t,"isFirefox",function(){return a.c}),r.d(t,"isIE",function(){return a.d}),r.d(t,"isEdge",function(){return a.b}),r.d(t,"isWebkit",function(){return a.f}),r.d(t,"isChrome",function(){return a.a}),r.d(t,"isSafari",function(){return a.e}),r(2)),l=(r.d(t,"log",function(){return s.b}),r.d(t,"table",function(){return s.c}),r.d(t,"clear",function(){return s.a}),r(17)),c=(r.d(t,"isMobile",function(){return l.a}),r(4)),u=(r.d(t,"versionMap",function(){return c.a}),r(5)),p=(r.d(t,"isIpad",function(){return u.b}),r.d(t,"isMac",function(){return u.d}),r.d(t,"isIphone",function(){return u.c}),r.d(t,"isAndroid",function(){return u.a}),r.d(t,"isWindows",function(){return u.e}),new i.a({checkers:[n.elementIdChecker,n.regToStringChecker,n.functionToStringChecker,n.depRegToStringChecker,n.dateToStringChecker,n.debuggerChecker]}));t.default=p},function(e,t,r){"use strict";r.d(t,"a",function(){return n});var i=this&&this.__awaiter||function(e,a,s,l){return new(s=s||d)(function(r,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,n)}o((l=l.apply(e,a||[])).next())})},s=this&&this.__generator||function(i,n){var o,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(r){return function(e){var t=[r,e];if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))l.label=t[1];else if(6===t[0]&&l.label<s[1])l.label=s[1],s=t;else{if(!(s&&l.label<s[2])){s[2]&&l.ops.pop(),l.trys.pop();continue}l.label=s[2],l.ops.push(t)}}t=n.call(i,l)}catch(e){t=[6,e],a=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},n=(o.prototype.launch=function(){this._detectLoopDelay<=0&&this.setDetectDelay(500),this._detectLoopStopped&&(this._detectLoopStopped=!1,this._detectLoop())},o.prototype.stop=function(){this._detectLoopStopped||(this._detectLoopStopped=!0,clearTimeout(this._timer))},o.prototype.isLaunch=function(){return!this._detectLoopStopped},o.prototype.setDetectDelay=function(e){this._detectLoopDelay=e},o.prototype.addListener=function(e){this._listeners.push(e)},o.prototype.removeListener=function(t){this._listeners=this._listeners.filter(function(e){return e!==t})},o.prototype._broadcast=function(e){for(var t=0,r=this._listeners;t<r.length;t++){var i=r[t];try{i(e.isOpen,e)}catch(e){}}},o.prototype._detectLoop=function(){return i(this,void 0,void 0,function(){var t,r,i,n,o,a=this;return s(this,function(e){switch(e.label){case 0:t=!1,r="",i=0,n=this._checkers,e.label=1;case 1:return i<n.length?[4,(o=n[i]).isEnable()]:[3,6];case 2:return e.sent()?(r=o.name,[4,o.isOpen()]):[3,4];case 3:t=e.sent(),e.label=4;case 4:if(t)return[3,6];e.label=5;case 5:return i++,[3,1];case 6:return t!=this._isOpen&&(this._isOpen=t,this._broadcast({isOpen:t,checkerName:r})),0<this._detectLoopDelay?this._timer=setTimeout(function(){return a._detectLoop()},this._detectLoopDelay):this.stop(),[2]}})})},o);function o(e){e=e.checkers;this._listeners=[],this._isOpen=!1,this._detectLoopStopped=!0,this._detectLoopDelay=500,this._checkers=e.slice()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(9),n=(r.d(t,"depRegToStringChecker",function(){return i.a}),r(12)),o=(r.d(t,"elementIdChecker",function(){return n.a}),r(13)),a=(r.d(t,"functionToStringChecker",function(){return o.a}),r(14)),s=(r.d(t,"regToStringChecker",function(){return a.a}),r(15)),l=(r.d(t,"debuggerChecker",function(){return s.a}),r(16));r.d(t,"dateToStringChecker",function(){return l.a})},function(e,t,r){"use strict";r.d(t,"a",function(){return u});var i=r(1),n=r(2),o=r(0),a=this&&this.__awaiter||function(e,a,s,l){return new(s=s||d)(function(r,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,n)}o((l=l.apply(e,a||[])).next())})},s=this&&this.__generator||function(i,n){var o,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(r){return function(e){var t=[r,e];if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))l.label=t[1];else if(6===t[0]&&l.label<s[1])l.label=s[1],s=t;else{if(!(s&&l.label<s[2])){s[2]&&l.ops.pop(),l.trys.pop();continue}l.label=s[2],l.ops.push(t)}}t=n.call(i,l)}catch(e){t=[6,e],a=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},l=/ /,c=!1,u=(l.toString=function(){return c=!0,u.name},{name:"dep-reg-to-string",isOpen:function(){return a(this,void 0,void 0,function(){return s(this,function(e){return c=!1,Object(n.c)({dep:l}),Object(n.a)(),[2,c]})})},isEnable:function(){return a(this,void 0,void 0,function(){return s(this,function(e){return[2,Object(o.b)({includes:[!0],excludes:[i.c,i.d]})]})})}})},function(e,t){var r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){var i;void 0!==(t="function"==typeof(i=function(){var t=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i;function p(e){var t=e.replace(/^v/,"").replace(/\+.*$/,""),r=function(e,t){return-1===e.indexOf(t)?e.length:e.indexOf(t)}(t,"-"),i=t.substring(0,r).split(".");return i.push(t.substring(r+1)),i}function d(e){return isNaN(Number(e))?e:Number(e)}function h(e){if("string"!=typeof e)throw new TypeError("Invalid argument expected string");if(!t.test(e))throw new Error("Invalid argument not valid semver ('"+e+"' received)")}function n(e,t){[e,t].forEach(h);for(var r=p(e),i=p(t),n=0;n<Math.max(r.length-1,i.length-1);n++){var o=parseInt(r[n]||0,10),a=parseInt(i[n]||0,10);if(o>a)return 1;if(a>o)return-1}var s=r[r.length-1],l=i[i.length-1];if(s&&l){var c=s.split(".").map(d),u=l.split(".").map(d);for(n=0;n<Math.max(c.length,u.length);n++){if(void 0===c[n]||"string"==typeof u[n]&&"number"==typeof c[n])return-1;if(void 0===u[n]||"string"==typeof c[n]&&"number"==typeof u[n])return 1;if(c[n]>u[n])return 1;if(u[n]>c[n])return-1}}else if(s||l)return s?-1:1;return 0}var o=[">",">=","=","<","<="],a={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]};return n.validate=function(e){return"string"==typeof e&&t.test(e)},n.compare=function(e,t,r){!function(e){if("string"!=typeof e)throw new TypeError("Invalid operator type, expected string but got "+typeof e);if(-1===o.indexOf(e))throw new TypeError("Invalid operator, expected one of "+o.join("|"))}(r);var i=n(e,t);return a[r].indexOf(i)>-1},n})?i.apply(t,[]):i)&&(e.exports=t)},function(e,t,r){"use strict";r.d(t,"a",function(){return u});var i=r(1),n=r(2),o=r(0),t=r(3),a=this&&this.__awaiter||function(e,a,s,l){return new(s=s||d)(function(r,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,n)}o((l=l.apply(e,a||[])).next())})},s=this&&this.__generator||function(i,n){var o,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(r){return function(e){var t=[r,e];if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))l.label=t[1];else if(6===t[0]&&l.label<s[1])l.label=s[1],s=t;else{if(!(s&&l.label<s[2])){s[2]&&l.ops.pop(),l.trys.pop();continue}l.label=s[2],l.ops.push(t)}}t=n.call(i,l)}catch(e){t=[6,e],a=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},l=Object(t.a)("div"),c=!1,u=(Object.defineProperty(l,"id",{get:function(){return c=!0,u.name},configurable:!0}),{name:"element-id",isOpen:function(){return a(this,void 0,void 0,function(){return s(this,function(e){return c=!1,Object(n.b)(l),Object(n.a)(),[2,c]})})},isEnable:function(){return a(this,void 0,void 0,function(){return s(this,function(e){return[2,Object(o.b)({includes:[!0],excludes:[i.d,i.b,i.c]})]})})}})},function(e,t,r){"use strict";r.d(t,"a",function(){return p});var i=r(1),n=r(2),o=r(5),a=r(0),s=this&&this.__awaiter||function(e,a,s,l){return new(s=s||d)(function(r,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,n)}o((l=l.apply(e,a||[])).next())})},l=this&&this.__generator||function(i,n){var o,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(r){return function(e){var t=[r,e];if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))l.label=t[1];else if(6===t[0]&&l.label<s[1])l.label=s[1],s=t;else{if(!(s&&l.label<s[2])){s[2]&&l.ops.pop(),l.trys.pop();continue}l.label=s[2],l.ops.push(t)}}t=n.call(i,l)}catch(e){t=[6,e],a=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}};function c(){}var u=0,p=(c.toString=function(){return u++,""},{name:"function-to-string",isOpen:function(){return s(this,void 0,void 0,function(){return l(this,function(e){return u=0,Object(n.b)(c),Object(n.a)(),[2,2===u]})})},isEnable:function(){return s(this,void 0,void 0,function(){return l(this,function(e){return[2,Object(a.b)({includes:[!0],excludes:[i.c,(o.b||o.c)&&i.a]})]})})}})},function(e,t,r){"use strict";r.d(t,"a",function(){return u});var i=r(2),n=r(1),o=r(0),a=this&&this.__awaiter||function(e,a,s,l){return new(s=s||d)(function(r,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,n)}o((l=l.apply(e,a||[])).next())})},s=this&&this.__generator||function(i,n){var o,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(r){return function(e){var t=[r,e];if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))l.label=t[1];else if(6===t[0]&&l.label<s[1])l.label=s[1],s=t;else{if(!(s&&l.label<s[2])){s[2]&&l.ops.pop(),l.trys.pop();continue}l.label=s[2],l.ops.push(t)}}t=n.call(i,l)}catch(e){t=[6,e],a=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},l=/ /,c=!1,u=(l.toString=function(){return c=!0,u.name},{name:"reg-to-string",isOpen:function(){return a(this,void 0,void 0,function(){return s(this,function(e){return c=!1,Object(i.b)(l),Object(i.a)(),[2,c]})})},isEnable:function(){return a(this,void 0,void 0,function(){return s(this,function(e){return[2,Object(o.b)({includes:[!0],excludes:[n.f]})]})})}})},function(e,t,r){"use strict";r.d(t,"a",function(){return a});var i=this&&this.__awaiter||function(e,a,s,l){return new(s=s||d)(function(r,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,n)}o((l=l.apply(e,a||[])).next())})},n=this&&this.__generator||function(i,n){var o,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(r){return function(e){var t=[r,e];if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))l.label=t[1];else if(6===t[0]&&l.label<s[1])l.label=s[1],s=t;else{if(!(s&&l.label<s[2])){s[2]&&l.ops.pop(),l.trys.pop();continue}l.label=s[2],l.ops.push(t)}}t=n.call(i,l)}catch(e){t=[6,e],a=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}};function o(){return(performance||Date).now()}var a={name:"debugger-checker",isOpen:function(){return i(this,void 0,void 0,function(){var t;return n(this,function(e){return t=o(),function(){}.constructor("debugger")(),[2,100<o()-t]})})},isEnable:function(){return i(this,void 0,void 0,function(){return n(this,function(e){return[2,!0]})})}}},function(e,t,r){"use strict";r.d(t,"a",function(){return u});var i=r(1),n=r(2),o=r(0),a=this&&this.__awaiter||function(e,a,s,l){return new(s=s||d)(function(r,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,n)}o((l=l.apply(e,a||[])).next())})},s=this&&this.__generator||function(i,n){var o,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(r){return function(e){var t=[r,e];if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))l.label=t[1];else if(6===t[0]&&l.label<s[1])l.label=s[1],s=t;else{if(!(s&&l.label<s[2])){s[2]&&l.ops.pop(),l.trys.pop();continue}l.label=s[2],l.ops.push(t)}}t=n.call(i,l)}catch(e){t=[6,e],a=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},l=new Date,c=0,u=(l.toString=function(){return c++,""},{name:"date-to-string",isOpen:function(){return a(this,void 0,void 0,function(){return s(this,function(e){return c=0,Object(n.b)(l),Object(n.a)(),[2,2===c]})})},isEnable:function(){return a(this,void 0,void 0,function(){return s(this,function(e){return[2,Object(o.b)({includes:[i.a],excludes:[]})]})})}})},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var t=r(3),i=/mobile/i.test(t.b)}],n={},i.m=r,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=6);function i(e){var t;return(n[e]||(t=n[e]={i:e,l:!1,exports:{}},r[e].call(t.exports,t,t.exports,i),t.l=!0,t)).exports}var r,n},"object"==typeof r&&"object"==typeof t?t.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof r?r.devtoolsDetector=i():e.devtoolsDetector=i()},{"es6-promise":8}],32:[function(e,l,t){var i=e("./object");l.exports.el=function(e){return document.getElementById(e)},l.exports.createEl=function(e,t){var r;return e=e||"div",t=t||{},r=document.createElement(e),i.each(t,function(e,t){-1!==e.indexOf("aria-")||"role"==e?r.setAttribute(e,t):r[e]=t}),r},l.exports.addClass=function(e,t){-1==(" "+e.className+" ").indexOf(" "+t+" ")&&(e.className=""===e.className?t:e.className+" "+t)},l.exports.removeClass=function(e,t){var r,i;if(-1!=e.className.indexOf(t)){for(i=(r=e.className.split(" ")).length-1;0<=i;i--)r[i]===t&&r.splice(i,1);e.className=r.join(" ")}},l.exports.hasClass=function(e,t){return-1!=e.className.indexOf(t)},l.exports.getClasses=function(e){return e.className?e.className.split(" "):[]},l.exports.getElementAttributes=function(e){var t,r,i={};if(e&&e.attributes&&0<e.attributes.length)for(var n,o=(n=e.attributes).length-1;0<=o;o--)t=n[o].name,r=n[o].value,"boolean"!=typeof e[t]&&-1===",autoplay,controls,loop,muted,default,".indexOf(","+t+",")||(r=null!==r),i[t]=r;return i},l.exports.insertFirst=function(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)},l.exports.blockTextSelection=function(){document.body.focus(),document.onselectstart=function(){return!1}},l.exports.unblockTextSelection=function(){document.onselectstart=function(){return!0}},l.exports.css=function(r,e,t){return!(!r||!r.style)&&(e&&t?(r.style[e]=t,!0):t||"string"!=typeof e?!t&&"object"==typeof e&&(i.each(e,function(e,t){r.style[e]=t}),!0):r.style[e])},l.exports.getTransformName=function(e){for(var t=["transform","WebkitTransform","MozTransform","msTransform","OTransform"],r=t[0],i=0,n=t.length;i<n;i++)if(void 0!==e.style[t[i]]){r=t[i];break}return r},l.exports.getTransformEventName=function(e,t){for(var r=["","Webkit","Moz","ms","O"],i=t.toLowerCase(),n=["transform","WebkitTransform","MozTransform","msTransform","OTransform"],o=0,a=n.length;o<a;o++)if(void 0!==e.style[n[o]]){0!=o&&(i=r[o]+t);break}return i},l.exports.addCssByStyle=function(e){var t=document,r=t.createElement("style"),e=(r.setAttribute("type","text/css"),r.styleSheet?r.styleSheet.cssText=e:(e=t.createTextNode(e),r.appendChild(e)),t.getElementsByTagName("head"));(e.length?e[0]:t.documentElement).appendChild(r)},l.exports.getTranslateX=function(e){var t=0;if(e)try{var r=window.getComputedStyle(e),i=l.exports.getTransformName(e),t=new(window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix)(r[i]).m41}catch(e){console.log(e)}return t},l.exports.getPointerPosition=function(e,t){var r={},i=l.exports.findPosition(e),n=e.offsetWidth,e=e.offsetHeight,o=i.top,i=i.left,a=t.pageY,s=t.pageX;return t.changedTouches&&(s=t.changedTouches[0].pageX,a=t.changedTouches[0].pageY),r.y=Math.max(0,Math.min(1,(o-a+e)/e)),r.x=Math.max(0,Math.min(1,(s-i)/n)),r},l.exports.findPosition=function(e){var t,r,i,n;return(t=e.getBoundingClientRect&&e.parentNode?e.getBoundingClientRect():t)?(e=document.documentElement,n=document.body,i=e.clientLeft||n.clientLeft||0,r=window.pageXOffset||n.scrollLeft,r=t.left+r-i,i=e.clientTop||n.clientTop||0,e=window.pageYOffset||n.scrollTop,n=t.top+e-i,{left:Math.round(r),top:Math.round(n)}):{left:0,top:0}}},{"./object":42}],33:[function(e,l,t){var c=e("./object"),u=e("./data"),r=e("./ua"),i=e("./fastclick");function p(t,r,e,i){c.each(e,function(e){t(r,e,i)})}l.exports.on=function(o,e,t){if(o){if(c.isArray(e))return p(l.exports.on,o,e,t);r.IS_MOBILE&&"click"==e&&i.attach(o);var a=u.getData(o);a.handlers||(a.handlers={}),a.handlers[e]||(a.handlers[e]=[]),t.guid||(t.guid=u.guid()),a.handlers[e].push(t),a.dispatcher||(a.disabled=!1,a.dispatcher=function(e){if(!a.disabled){e=l.exports.fixEvent(e);var t=a.handlers[e.type];if(t)for(var r=t.slice(0),i=0,n=r.length;i<n&&!e.isImmediatePropagationStopped();i++)r[i].call(o,e)}}),1==a.handlers[e].length&&(o.addEventListener?o.addEventListener(e,a.dispatcher,!1):o.attachEvent&&o.attachEvent("on"+e,a.dispatcher))}},l.exports.off=function(t,e,r){if(t&&u.hasData(t)){var i=u.getData(t);if(i.handlers){if(c.isArray(e))return p(l.exports.off,t,e,r);function n(e){i.handlers[e]=[],l.exports.cleanUpEvents(t,e)}if(e){var o=i.handlers[e];if(o)if(r){if(r.guid)for(var a=0;a<o.length;a++)o[a].guid===r.guid&&o.splice(a--,1);l.exports.cleanUpEvents(t,e)}else n(e)}else for(var s in i.handlers)n(s)}}},l.exports.cleanUpEvents=function(e,t){var r=u.getData(e);0===r.handlers[t].length&&(delete r.handlers[t],e.removeEventListener?e.removeEventListener(t,r.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+t,r.dispatcher)),c.isEmpty(r.handlers)&&(delete r.handlers,delete r.dispatcher,delete r.disabled),c.isEmpty(r)&&u.removeData(e)},l.exports.fixEvent=function(e){function t(){return!0}function r(){return!1}if(!e||!e.isPropagationStopped){var i,n,o,a=e||window.event;for(i in e={},a)"layerX"===i||"layerY"===i||"keyboardEvent.keyLocation"===i||"returnValue"==i&&a.preventDefault||(e[i]=a[i]);e.target||(e.target=e.srcElement||document),e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement,e.preventDefault=function(){a.preventDefault&&a.preventDefault(),e.returnValue=!1,e.isDefaultPrevented=t,e.defaultPrevented=!0},e.isDefaultPrevented=r,e.defaultPrevented=!1,e.stopPropagation=function(){a.stopPropagation&&a.stopPropagation(),e.cancelBubble=!0,e.isPropagationStopped=t},e.isPropagationStopped=r,e.stopImmediatePropagation=function(){a.stopImmediatePropagation&&a.stopImmediatePropagation(),e.isImmediatePropagationStopped=t,e.stopPropagation()},e.isImmediatePropagationStopped=r,null!=e.clientX&&(n=document.documentElement,o=document.body,e.pageX=e.clientX+(n&&n.scrollLeft||o&&o.scrollLeft||0)-(n&&n.clientLeft||o&&o.clientLeft||0),e.pageY=e.clientY+(n&&n.scrollTop||o&&o.scrollTop||0)-(n&&n.clientTop||o&&o.clientTop||0)),e.which=e.charCode||e.keyCode,null!=e.button&&(e.button=1&e.button?0:4&e.button?1:2&e.button?2:0)}return e},l.exports.trigger=function(e,t){var r,i,n;if(e)return r=u.hasData(e)?u.getData(e):{},i=e.parentNode||e.ownerDocument,"string"==typeof t&&(n=null,!e.paramData&&0!=e.paramData||(n=e.paramData,e.paramData=null,e.removeAttribute(n)),t={type:t,target:e,paramData:n}),t=l.exports.fixEvent(t),r.dispatcher&&r.dispatcher.call(e,t),i&&!t.isPropagationStopped()&&!1!==t.bubbles?l.exports.trigger(i,t):i||t.defaultPrevented||(n=u.getData(t.target),t.target[t.type]&&(n.disabled=!0,"function"==typeof t.target[t.type]&&t.target[t.type](),n.disabled=!1)),!t.defaultPrevented},l.exports.one=function(e,t,r){if(e){if(c.isArray(t))return p(l.exports.one,e,t,r);function i(){l.exports.off(e,t,i),r.apply(this,arguments)}i.guid=r.guid=r.guid||u.guid(),l.exports.on(e,t,i)}}},{"./data":30,"./fastclick":34,"./object":42,"./ua":49}],34:[function(e,t,r){function a(n,e){var t;if(e=e||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=e.touchBoundary||10,this.layer=n,this.tapDelay=e.tapDelay||200,this.tapTimeout=e.tapTimeout||700,!a.notNeeded(n)){for(var r=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],i=0,o=r.length;i<o;i++)this[r[i]]=function(e,t){return function(){return e.apply(t,arguments)}}(this[r[i]],this);s&&(n.addEventListener("mouseover",this.onMouse,!0),n.addEventListener("mousedown",this.onMouse,!0),n.addEventListener("mouseup",this.onMouse,!0)),n.addEventListener("click",this.onClick,!0),n.addEventListener("touchstart",this.onTouchStart,!1),n.addEventListener("touchmove",this.onTouchMove,!1),n.addEventListener("touchend",this.onTouchEnd,!1),n.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(n.removeEventListener=function(e,t,r){var i=Node.prototype.removeEventListener;"click"===e?i.call(n,e,t.hijacked||t,r):i.call(n,e,t,r)},n.addEventListener=function(e,t,r){var i=Node.prototype.addEventListener;"click"===e?i.call(n,e,t.hijacked||(t.hijacked=function(e){e.propagationStopped||t(e)}),r):i.call(n,e,t,r)}),"function"==typeof n.onclick&&(t=n.onclick,n.addEventListener("click",function(e){t(e)},!1),n.onclick=null)}}var i=0<=navigator.userAgent.indexOf("Windows Phone"),s=0<navigator.userAgent.indexOf("Android")&&!i,o=/iP(ad|hone|od)/.test(navigator.userAgent)&&!i,l=o&&/OS 4_\d(_\d)?/.test(navigator.userAgent),c=o&&/OS [6-7]_\d/.test(navigator.userAgent),n=0<navigator.userAgent.indexOf("BB10");a.prototype.needsClick=function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(o&&"file"===e.type||e.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(e.className)},a.prototype.needsFocus=function(e){switch(e.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!s;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}},a.prototype.sendClick=function(e,t){var r;document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),t=t.changedTouches[0],(r=document.createEvent("MouseEvents")).initMouseEvent(this.determineEventType(e),!0,!0,window,1,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,0,null),r.forwardedTouchEvent=!0,e.dispatchEvent(r)},a.prototype.determineEventType=function(e){return s&&"select"===e.tagName.toLowerCase()?"mousedown":"click"},a.prototype.focus=function(e){var t;o&&e.setSelectionRange&&0!==e.type.indexOf("date")&&"time"!==e.type&&"month"!==e.type&&"email"!==e.type?(t=e.value.length,e.setSelectionRange(t,t)):e.focus()},a.prototype.updateScrollParent=function(e){var t,r=e.fastClickScrollParent;if(!r||!r.contains(e)){t=e;do{if(t.scrollHeight>t.offsetHeight){r=t,e.fastClickScrollParent=t;break}}while(t=t.parentElement)}r&&(r.fastClickLastScrollTop=r.scrollTop)},a.prototype.getTargetElementFromEventTarget=function(e){return e.nodeType===Node.TEXT_NODE?e.parentNode:e},a.prototype.onTouchStart=function(e){var t,r,i;if(!(1<e.targetTouches.length)){if(t=this.getTargetElementFromEventTarget(e.target),r=e.targetTouches[0],o){if((i=window.getSelection()).rangeCount&&!i.isCollapsed)return!0;if(!l){if(r.identifier&&r.identifier===this.lastTouchIdentifier)return e.preventDefault(),!1;this.lastTouchIdentifier=r.identifier,this.updateScrollParent(t)}}this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=t,this.touchStartX=r.pageX,this.touchStartY=r.pageY,e.timeStamp-this.lastClickTime<this.tapDelay&&e.preventDefault()}return!0},a.prototype.touchHasMoved=function(e){var e=e.changedTouches[0],t=this.touchBoundary;return Math.abs(e.pageX-this.touchStartX)>t||Math.abs(e.pageY-this.touchStartY)>t},a.prototype.onTouchMove=function(e){return this.trackingClick&&(this.targetElement!==this.getTargetElementFromEventTarget(e.target)||this.touchHasMoved(e))&&(this.trackingClick=!1,this.targetElement=null),!0},a.prototype.findControl=function(e){return void 0!==e.control?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},a.prototype.onTouchEnd=function(e){var t,r,i,n=this.targetElement;if(!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0;if(e.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=e.timeStamp,t=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,c&&(i=e.changedTouches[0],(n=document.elementFromPoint(i.pageX-window.pageXOffset,i.pageY-window.pageYOffset)||n).fastClickScrollParent=this.targetElement.fastClickScrollParent),"label"===(i=n.tagName.toLowerCase())){if(r=this.findControl(n)){if(this.focus(n),s)return!1;n=r}}else if(this.needsFocus(n))return 100<e.timeStamp-t||o&&window.top!==window&&"input"===i?this.targetElement=null:(this.focus(n),this.sendClick(n,e),o&&"select"===i||(this.targetElement=null,e.preventDefault())),!1;return!(!o||l||!(r=n.fastClickScrollParent)||r.fastClickLastScrollTop===r.scrollTop)||(this.needsClick(n)||(e.preventDefault(),this.sendClick(n,e)),!1)},a.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},a.prototype.onMouse=function(e){return!this.targetElement||!(!e.forwardedTouchEvent&&e.cancelable&&(!this.needsClick(this.targetElement)||this.cancelNextClick)&&(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),1))},a.prototype.onClick=function(e){return this.trackingClick?(this.targetElement=null,!(this.trackingClick=!1)):"submit"===e.target.type&&0===e.detail||((e=this.onMouse(e))||(this.targetElement=null),e)},a.prototype.destroy=function(){var e=this.layer;s&&(e.removeEventListener("mouseover",this.onMouse,!0),e.removeEventListener("mousedown",this.onMouse,!0),e.removeEventListener("mouseup",this.onMouse,!0)),e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchmove",this.onTouchMove,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},a.notNeeded=function(e){var t,r;if(void 0===window.ontouchstart)return!0;if(r=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!s)return!0;if(t=document.querySelector("meta[name=viewport]")){if(-1!==t.content.indexOf("user-scalable=no"))return!0;if(31<r&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(n&&10<=(r=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/))[1]&&3<=r[2]&&(t=document.querySelector("meta[name=viewport]"))){if(-1!==t.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===e.style.msTouchAction||"manipulation"===e.style.touchAction||!!(27<=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]&&(t=document.querySelector("meta[name=viewport]"))&&(-1!==t.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))||"none"===e.style.touchAction||"manipulation"===e.style.touchAction},a.attach=function(e,t){return new a(e,t)},t.exports=a},{}],35:[function(e,t,r){var n=e("./data");t.exports.bind=function(e,t,r){t.guid||(t.guid=n.guid());function i(){return t.apply(e,arguments)}return i.guid=r?r+"_"+t.guid:t.guid,i}},{"./data":30}],36:[function(e,t,r){function w(){"use strict";w=function(){return a};var a={},e=Object.prototype,l=e.hasOwnProperty,c=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},i=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",n=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function s(e,t,r,i){var n,o,a,s,t=t&&t.prototype instanceof d?t:d,t=Object.create(t.prototype),i=new b(i||[]);return c(t,"_invoke",{value:(n=e,o=r,a=i,s="suspendedStart",function(e,t){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===e)throw t;return E()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){r=function e(t,r){var i=t.iterator[r.method];if(void 0===i){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method))return p;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}i=u(i,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,p;i=i.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}(r,a);if(r){if(r===p)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";r=u(n,o,a);if("normal"===r.type){if(s=a.done?"completed":"suspendedYield",r.arg===p)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}})}),t}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var p={};function d(){}function h(){}function f(){}var t={},y=(o(t,i,function(){return this}),Object.getPrototypeOf),y=y&&y(y(T([]))),_=(y&&y!==e&&l.call(y,i)&&(t=y),f.prototype=d.prototype=Object.create(t));function g(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(a,s){var t;c(this,"_invoke",{value:function(r,i){function e(){return new s(function(e,t){!function t(e,r,i,n){var o,e=u(a[e],a,r);if("throw"!==e.type)return(r=(o=e.arg).value)&&"object"==typeof r&&l.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,i,n)},function(e){t("throw",e,i,n)}):s.resolve(r).then(function(e){o.value=e,i(o)},function(e){return t("throw",e,i,n)});n(e.arg)}(r,i,e,t)})}return t=t?t.then(e,e):e()}})}function m(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function b(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(m,this),this.reset(!0)}function T(t){if(t){var r,e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(l.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e}).next=e}return{next:E}}function E(){return{value:void 0,done:!0}}return c(_,"constructor",{value:h.prototype=f,configurable:!0}),c(f,"constructor",{value:h,configurable:!0}),h.displayName=o(f,n,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,o(e,n,"GeneratorFunction")),e.prototype=Object.create(_),e},a.awrap=function(e){return{__await:e}},g(v.prototype),o(v.prototype,r,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,r,i,n){void 0===n&&(n=Promise);var o=new v(s(e,t,r,i),n);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},g(_),o(_,n,"Generator"),o(_,i,function(){return this}),o(_,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,r=Object(e),i=[];for(t in r)i.push(t);return i.reverse(),function e(){for(;i.length;){var t=i.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=T,b.prototype={constructor:b,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&l.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var i=this;function e(e,t){return o.type="throw",o.arg=r,i.next=e,t&&(i.method="next",i.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t],o=n.completion;if("root"===n.tryLoc)return e("end");if(n.tryLoc<=this.prev){var a=l.call(n,"catchLoc"),s=l.call(n,"finallyLoc");if(a&&s){if(this.prev<n.catchLoc)return e(n.catchLoc,!0);if(this.prev<n.finallyLoc)return e(n.finallyLoc)}else if(a){if(this.prev<n.catchLoc)return e(n.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return e(n.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&l.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var n=i;break}}var o=(n=n&&("break"===e||"continue"===e)&&n.tryLoc<=t&&t<=n.finallyLoc?null:n)?n.completion:{};return o.type=e,o.arg=t,n?(this.method="next",this.next=n.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,i,n=this.tryEntries[t];if(n.tryLoc===e)return"throw"===(r=n.completion).type&&(i=r.arg,S(n)),i}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},a}function l(e,t,r,i,n,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(i,n)}function a(s){return function(){var e=this,a=arguments;return new Promise(function(t,r){var i=s.apply(e,a);function n(e){l(i,t,r,n,o,"next",e)}function o(e){l(i,t,r,n,o,"throw",e)}n(void 0)})}}var i,s="undefined"==typeof Promise?e("es6-promise").Promise:Promise;e=self,i=function(){"use strict";function _(e,t){var r="hls"===(t=void 0===t?"mp4":t),i="";switch(e=void 0===e?"":e){case"hvc1":i=r?"https://player.alicdn.com/lib/detect-assets/01s_20x20_hvc1.m3u8":"https://ice-pub-media.myalicdn.com/vod-demo/hevc/01s_20x20_hvc1.mp4";break;case"hev1":i=r?"https://player.alicdn.com/lib/detect-assets/01s_20x20_hev1.m3u8":"https://ice-pub-media.myalicdn.com/vod-demo/hevc/01s_20x20_hev1.mp4";break;default:i=""}return i}function g(i,l,c,e){void 0===l&&(l=!1),void 0===c&&(c="");var u=performance.now(),p=e;return new s(function(o){e=i,void 0===(t=l?100:0)&&(t=100),(r=document.createElement("video")).setAttribute("width",""+t),r.setAttribute("height",""+t),r.setAttribute("muted","muted"),r.setAttribute("crossorigin","anonymous"),r.setAttribute("preload","preload"),r.setAttribute("autoplay","autoplay"),r.setAttribute("webkit-playsinline","webkit-playsinline"),r.setAttribute("playsinline","playsinline"),r.setAttribute("x-webkit-airplay","x-webkit-airplay"),r.setAttribute("playsinline","playsinline"),r.src=e;var e,t,r,a=r,s=setInterval(function(){var e,t,r,i,n;(performance.now()-u>p||0!==a.videoWidth)&&(clearInterval(s),e=0!==a.videoWidth,l?(a.setAttribute("controls","controls"),t=a,void 0===(r=c)&&(r=""),i=document.createElement("dv"),(n=document.createElement("h3")).innerText=r,i.appendChild(t),i.appendChild(n),document.body.appendChild(i)):(a.pause(),a=null),o(e))})})}var i={d:function(e,t){for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},e={},t=(i.d(e,{default:function(){return o}}),navigator.userAgent),r=/qqbrowser/i.test(t.toLowerCase()),n=/Edge/i.test(t),n=/Chrome/i.test(t)&&!n&&!r,v=/Safari/i.test(t)&&!n,r=t.match(/Version\/([\d.]+)([^S](Safari)|[^M]*(Mobile)[^S]*(Safari))/),n=r&&r[1],m=n&&Number(n.split(".")[0]),S=function(){var t=a(w().mark(function e(t){var r;return w().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return r=e.sent,e.next=5,r.blob();case 5:return r=e.sent,e.abrupt("return",URL.createObjectURL(r));case 7:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),b={includeSystemHijack:!0,showVideo:!1,format:"mp4",codecTags:["hev1","hvc1"],timeout:2e3},o=function(y){return void 0===y&&(y={}),new s(function(){var t=a(w().mark(function e(t){var r,i,n,o,a,s,l,c,u,p,d,h,f;return w().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=Object.assign({},b,y),r=o.includeSystemHijack,i=o.showVideo,l=o.codecTags,n=o.format,o=o.timeout,a=performance.now(),s=-1<l.indexOf("hvc1"),l=-1<l.indexOf("hev1"),u=c=!1,!(v&&m&&11<=m)){e.next=14;break}if(p=_("hvc1",n),e.t0=r,e.t0){e.next=9;break}return e.next=8,S(p);case 8:p=e.sent;case 9:return e.next=11,g(p,i,"hvc1",o);case 11:c=e.sent,e.next=34;break;case 14:if(!s){e.next=24;break}if(d=_("hvc1",n),e.t1=r,e.t1){e.next=21;break}return e.next=20,S(d);case 20:d=e.sent;case 21:return e.next=23,g(d,i,"hvc1",o);case 23:c=e.sent;case 24:if(!l){e.next=34;break}if(h=_("hev1",n),e.t2=r,e.t2){e.next=31;break}return e.next=30,S(h);case 30:h=e.sent;case 31:return e.next=33,g(h,i,"hev1",o);case 33:u=e.sent;case 34:f=performance.now(),t({isHvc1Supported:c,isHev1Supported:u,time:Math.ceil(f-a)});case 36:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}())};return e.default},"object"==typeof r&&"object"==typeof t?t.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof r?r.hevcDetector=i():e.hevcDetector=i()},{"es6-promise":8}],37:[function(e,t,r){var i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,o=/^([^\/;?#]*)(.*)$/,n=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,s={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var i=s.parseURL(e);if(i)return i.path=s.normalizePath(i.path),s.buildURLFromParts(i);throw new Error("Error trying to parse base URL.")}i=s.parseURL(t);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return r.alwaysNormalize?(i.path=s.normalizePath(i.path),s.buildURLFromParts(i)):t;t=s.parseURL(e);if(!t)throw new Error("Error trying to parse base URL.");!t.netLoc&&t.path&&"/"!==t.path[0]&&(e=o.exec(t.path),t.netLoc=e[1],t.path=e[2]),t.netLoc&&!t.path&&(t.path="/");var n,e={scheme:t.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};return i.netLoc||(e.netLoc=t.netLoc,"/"!==i.path[0]&&(i.path?(n=(n=t.path).substring(0,n.lastIndexOf("/")+1)+i.path,e.path=s.normalizePath(n)):(e.path=t.path,i.params||(e.params=t.params,i.query)||(e.query=t.query)))),null===e.path&&(e.path=r.alwaysNormalize?s.normalizePath(i.path):i.path),s.buildURLFromParts(e)},parseURL:function(e){e=i.exec(e);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(n,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};t.exports=s},{}],38:[function(e,t,r){function i(e){for(var t in e="string"==typeof e?this.parseAttrList(e):e)e.hasOwnProperty(t)&&(this[t]=e[t])}var n=/^(\d+)x(\d+)$/,o=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g;i.prototype={decimalInteger:function(e){e=parseInt(this[e],10);return e>Number.MAX_SAFE_INTEGER?1/0:e},hexadecimalInteger:function(e){if(this[e]){for(var t=(1&(t=(this[e]||"0x").slice(2)).length?"0":"")+t,r=new Uint8Array(t.length/2),i=0;i<t.length/2;i++)r[i]=parseInt(t.slice(2*i,2*i+2),16);return r}return null},hexadecimalIntegerAsNumber:function(e){e=parseInt(this[e],16);return e>Number.MAX_SAFE_INTEGER?1/0:e},decimalFloatingPoint:function(e){return parseFloat(this[e])},enumeratedString:function(e){return this[e]},decimalResolution:function(e){e=n.exec(this[e]);if(null!==e)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}},parseAttrList:function(e){var t,r={};for(o.lastIndex=0;null!==(t=o.exec(e));){var i=t[2];0===i.indexOf('"')&&i.lastIndexOf('"')===i.length-1&&(i=i.slice(1,-1)),r[t[1]]=i}return r}},t.exports=i},{}],39:[function(e,t,r){function S(){this.method=null,this.key=null,this.iv=null,this._uri=null}function b(){this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[]}function i(){this.loaders={}}var n=e("../constants"),l=e("../playerutil"),T=e("./attrlist"),c=e("../io"),o=e("./URLToolkit"),u=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,p=/#EXT-X-MEDIA:(.*)/g,E=new RegExp([/#EXTINF:(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),w=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(PART-INF):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,d="RegionBlock";b.prototype.getUrl=function(){return!this._url&&this.relurl&&(this._url=o.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},b.prototype.Seturl=function(e){this._url=e},b.prototype.getProgramDateTime=function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime},b.prototype.GetbyteRange=function(){var e,t,r;return this._byteRange||(e=this._byteRange=[],this.rawByteRange&&(1===(t=this.rawByteRange.split("@",2)).length?(r=this.lastByteRangeEndOffset,e[0]=r||0):e[0]=parseInt(t[1]),e[1]=parseInt(t[0])+e[0])),this._byteRange},b.prototype.getByteRangeStartOffset=function(){return this.byteRange[0]},b.prototype.getByteRangeEndOffset=function(){return this.byteRange[1]},b.prototype.getDecryptdata=function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata};i.prototype=((e={parseMasterPlaylist:function(e,t){var r=[];for(u.lastIndex=0;null!=(o=u.exec(e));){var i={},n=i.attrs=new T(o[1]),o=(i.url=this.resolve(o[2],t),n.decimalResolution("RESOLUTION"));if(o&&(i.width=o.width,i.height=o.height),i.bitrate=n.decimalInteger("AVERAGE-BANDWIDTH")||n.decimalInteger("BANDWIDTH"),i.name=n.NAME,a=n.CODECS)for(var a=a.split(/[ ,]+/),s=0;s<a.length;s++){var l=a[s];-1!==l.indexOf("avc1")?i.videoCodec=this.avc1toavcoti(l):-1!==l.indexOf("hvc1")?i.videoCodec=l:i.audioCodec=l}r.push(i)}return r},parseMasterPlaylistMedia:function(e,t,r,i){var n=[],o=0;for(p.lastIndex=0;null!=(s=p.exec(e));){var a={},s=new T(s[1]);s.TYPE===r&&(a.groupId=s["GROUP-ID"],a.name=s.NAME,a.type=r,a.default="YES"===s.DEFAULT,a.autoselect="YES"===s.AUTOSELECT,a.forced="YES"===s.FORCED,s.URI&&(a.url=this.resolve(s.URI,t)),a.lang=s.LANGUAGE,a.name||(a.name=a.lang),i&&(a.audioCodec=i),a.id=o++,n.push(a))}return n},avc1toavcoti:function(e){var t=e.split("."),r=2<t.length?(r=t.shift()+".",(r+=parseInt(t.shift()).toString(16))+("000"+parseInt(t.shift()).toString(16)).substr(-4)):e;return r},load:function(o,a,i){var s=this;c.get(o,function(e){var t,r,i,n=s.parseMasterPlaylist(e,o);n.length&&(t=s.parseMasterPlaylistMedia(e,o,"AUDIO",n[0].audioCodec),r=s.parseMasterPlaylistMedia(e,o,"SUBTITLES"),t.length)&&(i=!1,t.forEach(function(e){e.url||(i=!0)}),!1===i)&&n[0].audioCodec&&!n[0].attrs.AUDIO&&(console.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),t.unshift({type:"main",name:"main"})),a({levels:n,audioTracks:t,subtitles:r,url:o,string:e})},function(e,t,r){i&&((r=l.parseHttpHeaders(r)["x-tengine-error"])&&-1<n.RegionBlockMessages.indexOf(r)&&(e=d),i(e,t))})},loadMediaPlaylist:function(e,t,r){var i=this,n=(e=e||{}).string,o=e.url;n?(e=i.parseLevelPlaylist(n,o),t(e)):c.get(o,function(e){e=i.parseLevelPlaylist(e,o);t(e)},function(e){r&&r(e)})},resolve:function(e,t){return o.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}}).parseMasterPlaylist=function(e,t){var r=[];for(u.lastIndex=0;null!=(o=u.exec(e));){var i={},n=i.attrs=new T(o[1]),o=(i.url=this.resolve(o[2],t),n.decimalResolution("RESOLUTION"));if(o&&(i.width=o.width,i.height=o.height),i.bitrate=n.decimalInteger("AVERAGE-BANDWIDTH")||n.decimalInteger("BANDWIDTH"),i.name=n.NAME,a=n.CODECS)for(var a=a.split(/[ ,]+/),s=0;s<a.length;s++){var l=a[s];-1!==l.indexOf("avc1")?i.videoCodec=this.avc1toavcoti(l):-1!==l.indexOf("hvc1")?i.videoCodec=l:i.audioCodec=l}r.push(i)}return r},e.parseMasterPlaylistMedia=function(e,t,r,i){var n=[],o=0;for(p.lastIndex=0;null!=(s=p.exec(e));){var a={},s=new T(s[1]);s.TYPE===r&&(a.groupId=s["GROUP-ID"],a.name=s.NAME,a.type=r,a.default="YES"===s.DEFAULT,a.autoselect="YES"===s.AUTOSELECT,a.forced="YES"===s.FORCED,s.URI&&(a.url=this.resolve(s.URI,t)),a.lang=s.LANGUAGE,a.name||(a.name=a.lang),i&&(a.audioCodec=i),a.id=o++,n.push(a))}return n},e.avc1toavcoti=function(e){var t=e.split("."),r=2<t.length?(r=t.shift()+".",(r+=parseInt(t.shift()).toString(16))+("000"+parseInt(t.shift()).toString(16)).substr(-4)):e;return r},e.parseLevelPlaylist=function(e,t,r,i){var n,o,a=0,s=0,l={type:null,version:null,url:t,fragments:[],live:!0,startSN:0},c=new S,u=0,p=null,d=new b;for(E.lastIndex=0;null!==(n=E.exec(e));){var h=n[1];if(h){d.duration=parseFloat(h);var f=(" "+n[2]).slice(1);d.title=f||null,d.tagList.push(f?["INF",h,f]:["INF",h])}else if(n[3])isNaN(d.duration)||(f=a++,d.type=i,d.start=s,d.levelkey=c,d.sn=f,d.level=r,d.cc=u,d.baseurl=t,d.relurl=(" "+n[3]).slice(1),l.fragments.push(d),s+=(p=d).duration,d=new b);else if(n[4])d.rawByteRange=(" "+n[4]).slice(1),p&&(h=p.byteRangeEndOffset)&&(d.lastByteRangeEndOffset=h);else if(n[5])d.rawProgramDateTime=(" "+n[5]).slice(1),d.tagList.push(["PROGRAM-DATE-TIME",d.rawProgramDateTime]),void 0===l.programDateTime&&(l.programDateTime=new Date(new Date(Date.parse(n[5]))-1e3*s));else{for(n=n[0].match(w),o=1;o<n.length&&void 0===n[o];o++);var y=(" "+n[o+1]).slice(1),_=(" "+n[o+2]).slice(1);switch(n[o]){case"#":d.tagList.push(_?[y,_]:[y]);break;case"PLAYLIST-TYPE":l.type=y.toUpperCase();break;case"MEDIA-SEQUENCE":a=l.startSN=parseInt(y);break;case"TARGETDURATION":l.targetduration=parseFloat(y);break;case"VERSION":l.version=parseInt(y);break;case"EXTM3U":break;case"ENDLIST":l.live=!1;break;case"DIS":u++,d.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":u=parseInt(y);break;case"KEY":var g=new T(y),v=g.enumeratedString("METHOD"),m=g.URI,g=g.hexadecimalInteger("IV");v&&(c=new S,m)&&0<=["AES-128","SAMPLE-AES"].indexOf(v)&&(c.method=v,c.baseuri=t,c.reluri=m,c.key=null,c.iv=g);break;case"START":v=new T(y).decimalFloatingPoint("TIME-OFFSET");isNaN(v)||(l.startTimeOffset=v);break;case"MAP":m=new T(y);d.relurl=m.URI,d.rawByteRange=m.BYTERANGE,d.baseurl=t,d.level=r,d.type=i,d.sn="initSegment",l.initSegment=d,d=new b;break;case"PART-INF":g=new T(y);l.partTarget=g.decimalFloatingPoint("PART-TARGET");break;default:console.log("line parsed but not handled: "+n)}}}return(d=p)&&!d.relurl&&(l.fragments.pop(),s-=d.duration),l.totalduration=s,l.averagetargetduration=s/l.fragments.length,l.endSN=a-1,l},e),i.ERROR_REGION_BLOCK=d,t.exports=i},{"../constants":28,"../io":40,"../playerutil":46,"./URLToolkit":37,"./attrlist":38}],40:[function(e,v,t){function m(e){try{var t=/vod(?:-product)?\.(\S+)\.aliyuncs\.com/.exec(e);return{value:!!t,region:t?t[1]:""}}catch(e){return{value:!1,region:""}}}function S(e){return(e||"").split("?")[0]}var b=e("../player/base/event/eventtype"),T=e("./url"),E="main",w="backup";v.exports.get=function(e,t,r,i,n){v.exports.ajax.call(this,"GET",e,{},t,r,i,n)},v.exports.post=function(e,t,r,i,n,o){var a={"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Accept:"application/json"};v.exports.ajax("POST",e,t,r,i,n,o,a)},v.exports.postWithHeader=function(e,t,r,i,n){v.exports.ajax("POST",e,t,i,n,!0,!1,r)},v.exports.ajax=function(r,i,n,o,a,s,l,c,u){var p,d,e,h,f=this,t=(u=u||{type:E,time:0},a=a||function(){},m(i)),y=t.value,t=t.region,_=i.replace("vod."+t+".aliyuncs.com","vod-product."+t+".aliyuncs.com");y&&f&&f._useBackupVodDomain&&(i=_),"undefined"==typeof XMLHttpRequest&&(window.XMLHttpRequest=function(){try{return new window.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new window.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new window.ActiveXObject("Msxml2.XMLHTTP")}catch(e){}throw new Error("This browser does not support XMLHttpRequest.")}),d=new XMLHttpRequest,t=T.parseUrl(i),e=window.location,!(t.protocol+t.host!==e.protocol+e.host)||!window.XDomainRequest||"withCredentials"in d?(p="file:"==t.protocol||"file:"==e.protocol,d.onreadystatechange=function(){if(4===d.readyState){t=(e=d).status,e=e.responseText;t=0===t||500<=t&&t<=599&&-1===(e||"").indexOf("RequestId");if(h&&(clearTimeout(h),h=void 0),t||0!==u.time&&f&&"function"==typeof f.trigger&&(f._useBackupVodDomain=!0,f.trigger(b.Private.VodRequestExceptionResume,{url:S(i),status:d.status,response:200!==d.status?d.responseText:"",retryType:u.type,retryTime:u.time})),200===d.status||p&&0===d.status)o(d.responseText);else{if(t&&y&&u){if(f&&"function"==typeof f.trigger&&f.trigger(b.Private.VodRequestException,{url:S(i),status:d.status,response:d.responseText,retryType:u.type,retryTime:u.time}),u.type===E)return u.time<1?(u.time++,void setTimeout(function(){v.exports.ajax.call(f,r,i,n,o,a,s,l,c,u)},200)):(u.type=w,u.time=1,void setTimeout(function(){v.exports.ajax.call(f,r,_,n,o,a,s,l,c,u)},200));if(u.type===w){if(u.time<2)return u.time++,void setTimeout(function(){v.exports.ajax.call(f,r,_,n,o,a,s,l,c,u)},200);f&&(f._useBackupVodDomain=!1)}}a(d.responseText,d.status,d)}}var e,t}):((d=new window.XDomainRequest).onload=function(){o(d.responseText)},d.onerror=a,d.onprogress=function(){},d.ontimeout=a);try{if(void 0===s&&(s=!0),d.open(r,i,s),l&&(d.withCredentials=!0),c)for(var g in c)c.hasOwnProperty(g)&&d.setRequestHeader(g,c[g])}catch(e){return void a(e)}try{m(i).value&&(h=setTimeout(function(){u.type===E?u.time=1:u.type===w&&(u.time=2),d.abort()},5e3)),d.send(n)}catch(e){a(e)}},v.exports.jsonp=function(e,t,r){var i="jsonp_callback_"+Math.round(1e5*Math.random()),n=document.createElement("script");e&&(n.src=e+(0<=e.indexOf("?")?"&":"?")+"callback="+i+"&cb="+i,n.onerror=function(){delete window[i],document.body.removeChild(n),r()},n.onload=function(){setTimeout(function(){window[i]&&(delete window[i],document.body.removeChild(n))},0)},window[i]=function(e){delete window[i],document.body.removeChild(n),t(e)},document.body.appendChild(n))},v.exports.loadJS=function(e,t,r){var i=document.getElementsByTagName("HEAD").item(0),n=document.createElement("script");e&&e.toLowerCase().indexOf("https://")<0&&e.toLowerCase().indexOf("http://")<0&&(e=document.URL.replace(/(\/[^\/]*?)$/i,"")+e),n.type="text/javascript",n.src=e,n.onload=function(){t&&t()},n.onerror=function(){r&&r()},i.appendChild(n)}},{"../player/base/event/eventtype":70,"./url":50}],41:[function(e,t,r){var a=e("./dom");t.exports.render=function(e,t){var r=t.align||(t.className?"":"tl"),i=t.x||0,t=t.y||0,n=i.indexOf&&0<i.indexOf("%")?"":"px",o=t.indexOf&&0<t.indexOf("%")?"":"px";"tl"===r?a.css(e,{float:"left","margin-left":i+n,"margin-top":t+o}):"tr"===r?a.css(e,{float:"right","margin-right":i+n,"margin-top":t+o}):"tlabs"===r?a.css(e,{position:"absolute",left:i+n,top:t+o}):"trabs"===r?a.css(e,{position:"absolute",right:i+n,top:t+o}):"blabs"===r?a.css(e,{position:"absolute",left:i+n,bottom:t+o}):"brabs"===r?a.css(e,{position:"absolute",right:i+n,bottom:t+o}):"cc"===r&&a.addClass(e,"loading-center")}},{"./dom":32}],42:[function(e,a,t){var s=Object.prototype.hasOwnProperty;a.exports.create=Object.create||function(e){function t(){}return t.prototype=e,new t},a.exports.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(arg)},a.exports.isEmpty=function(e){for(var t in e)if(null!==e[t])return!1;return!0},a.exports.each=function(e,t,r){if(a.exports.isArray(e))for(var i=0,n=e.length;i<n&&!1!==t.call(r||this,e[i],i);++i);else for(var o in e)if(s.call(e,o)&&!1===t.call(r||this,o,e[o]))break;return e},a.exports.merge=function(e,t){if(t)for(var r in t)s.call(t,r)&&(e[r]=t[r]);return e},a.exports.deepMerge=function(e,t){var r,i,n;for(r in e=a.exports.copy(e),t)s.call(t,r)&&(i=e[r],n=t[r],a.exports.isPlain(i)&&a.exports.isPlain(n)?e[r]=a.exports.deepMerge(i,n):e[r]=t[r]);return e},a.exports.copy=function(e){return a.exports.merge({},e)},a.exports.isPlain=function(e){return!!e&&"object"==typeof e&&"[object Object]"===e.toString()&&e.constructor===Object},a.exports.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},a.exports.unescape=function(e){return e.replace(/&([^;]+);/g,function(e,t){return{amp:"&",lt:"<",gt:">",quot:'"',"#x27":"'","#x60":"`"}[t.toLowerCase()]||e})}},{}],43:[function(e,t,r){var n,o=e("./object");(n=function(){}).extend=function(e){var t,r,i=(e=e||{}).init||e.init||this.prototype.init||this.prototype.init||function(){};for(r in(((t=function(){i.apply(this,arguments)}).prototype=o.create(this.prototype)).constructor=t).extend=n.extend,t.create=n.create,e)e.hasOwnProperty(r)&&(t.prototype[r]=e[r]);return t},n.create=function(){var e=o.create(this.prototype);return this.apply(e,arguments),e},t.exports=n},{"./object":42}],44:[function(e,t,r){var i=!new Function("try {return this===window;}catch(e){ return false;}")();t.exports.isSSR=i},{}],45:[function(e,f,t){var y=e("./object"),r=e("../config"),i=e("./dom"),n=e("./cookie"),o=e("./constants"),a=e("../lang/index"),l=e("./ua"),s=e("./io"),_=e("../player/base/plugin/defaultemptycomponent"),c=e("./hardware-decoding-detector"),g={preload:!0,autoplay:!0,useNativeControls:!1,width:"100%",height:"300px",cover:"",from:"",trackLog:!0,logBatched:!0,heartHeatInterval:30,isLive:!1,playsinline:!0,showBarTime:5e3,rePlay:!1,liveRetry:5,liveRetryInterval:1,liveRetryStep:0,keyShortCuts:!1,keyFastForwardStep:10,isVBR:!1,vodRetry:3,format:"",definition:"",defaultDefinition:"",loadDataTimeout:20,waitingTimeout:60,waitingBufferedTime:3,delayLoadingShow:1,controlBarForOver:!1,controlBarVisibility:"hover",enableSystemMenu:!1,qualitySort:"asc",x5_video_position:"normal",x5_type:"",x5_fullscreen:!1,x5_orientation:"landscape|portrait",x5LandscapeAsFullScreen:!0,license:{},autoPlayDelay:0,autoPlayDelayDisplayText:"",useHlsPluginForSafari:!1,enableMSEForAndroid:!0,encryptType:0,language:"zh-cn",languageTexts:{},mediaType:"video",outputType:"",playConfig:{},reAuthInfo:{},components:[],liveTimeShiftUrl:"",liveShiftSource:"",liveShiftTime:"",liveShiftMinOffset:30,videoHeight:"100%",videoWidth:"100%",enableWorker:!0,authTimeout:"",enableMockFullscreen:!1,region:"cn-shanghai",debug:!1,progressMarkers:[],snapshotWatermark:{left:"500",top:"100",text:"",font:"16px \u5b8b\u4f53",fillColor:"#FFFFFF",strokeColor:"#FFFFFF"},liveStartTime:"",liveOverTime:"",enableStashBufferForFlv:!0,flvOption:{accurateSeek:!0},hlsOption:{stopLoadAsPaused:!1},hlsLoadingTimeOut:2e4,useHlsPlugOnMobile:!0,lowLatencyMode:!1,useHls2:void 0,skipRtsSupportCheck:!1,rtsLoadDataTimeout:6e3,rtsFallbackSource:void 0,rtsVersion:"",rtsSdkUrl:"",nudgeMaxRetry:5,tracks:[],recreatePlayer:function(){},diagnosisButtonVisible:!0,enableH265:!1,forceH265:!1,enableH266:!1,forceH266:!1,h265Threads:!0,h265Simd:!0,preventRecord:!1,traceId:"",mediaAuth:void 0,textTracks:void 0,_native:!0,hlsUriToken:"",thumbnailUrl:"",refreshAccessInfo:function(){},drmSessionTimeout:5e3,skinRes:"//"+r.domain+"/de/prismplayer-flash/"+r.flashVersion+"/atlas/defaultSkin",splayerUrl:null,splayerWasmDomain:null},u=(f.exports.defaultH5Layout=[{name:"bigPlayButton",align:"blabs",x:30,y:80},{name:"H5Loading",align:"cc"},{name:"errorDisplay",align:"tlabs",x:0,y:0},{name:"infoDisplay"},{name:"tooltip",align:"blabs",x:0,y:50},{name:"thumbnail"},{name:"controlBar",align:"blabs",x:0,y:0,children:[{name:"progress",align:"blabs",x:0,y:44},{name:"playButton",align:"tl",x:15,y:12},{name:"timeDisplay",align:"tl",x:10,y:5},{name:"fullScreenButton",align:"tr",x:10,y:12},{name:"subtitle",align:"tr",x:15,y:12},{name:"setting",align:"tr",x:15,y:12},{name:"volume",align:"tr",x:5,y:10}]}],f.exports.defaultAudioLayout=[{name:"controlBar",align:"blabs",x:0,y:0,children:[{name:"progress",align:"blabs",x:0,y:44},{name:"playButton",align:"tl",x:15,y:12},{name:"timeDisplay",align:"tl",x:10,y:5},{name:"volume",align:"tr",x:5,y:10}]}],f.exports.defaultFlashLayout=[{name:"bigPlayButton",align:"blabs",x:30,y:80},{name:"controlBar",align:"blabs",x:0,y:0,children:[{name:"progress",align:"tlabs",x:0,y:0},{name:"playButton",align:"tl",x:15,y:26},{name:"nextButton",align:"tl",x:10,y:26},{name:"timeDisplay",align:"tl",x:10,y:24},{name:"fullScreenButton",align:"tr",x:10,y:25},{name:"streamButton",align:"tr",x:10,y:23},{name:"volume",align:"tr",x:10,y:25}]},{name:"fullControlBar",align:"tlabs",x:0,y:0,children:[{name:"fullTitle",align:"tl",x:25,y:6},{name:"fullNormalScreenButton",align:"tr",x:24,y:13},{name:"fullTimeDisplay",align:"tr",x:10,y:12},{name:"fullZoom",align:"cc"}]}],f.exports.canPlayType=function(e){var t=document.createElement("video");return t.canPlayType?t.canPlayType(e):""},f.exports.canPlayHls=function(){return""!=f.exports.canPlayType("application/x-mpegURL")},f.exports.isUsedHlsPluginOnMobile=function(e){return!!(l.IS_MOBILE&&(l.IS_CHROME||l.IS_FIREFOX||l.IS_X5||l.IS_EDGE_NEW)&&f.exports.isSupportHls())},f.exports.isSafariUsedHlsPlugin=function(e){return!!(l.os.pc&&l.browser.safari&&e)},f.exports.hasUIComponent=function(e,t){if(void 0!==e&&e&&0!=e.length)for(var r=0,i=e.length;r<i;r++){var n=e[r].name;if(n==t)return!0;if("controlBar"==n)return f.exports.hasUIComponent(e[r].children,t)}return!1},f.exports.validateSource=function(e){return!0},f.exports.supportH5Video=function(){return void 0!==document.createElement("video").canPlayType},f.exports.createWrapper=function(e){var t=e.id,t="string"==typeof t?(0===t.indexOf("#")&&(t=t.slice(1)),i.el(t)):t;if(t&&t.nodeName)return f.exports.adjustContainerLayout(t,e),t;throw new TypeError("\u6ca1\u6709\u4e3a\u64ad\u653e\u5668\u6307\u5b9a\u5bb9\u5668")},f.exports.adjustContainerLayout=function(e,t){t.width&&!e.style.width&&(e.style.width=t.width),t.height&&!e.style.height&&(e.style.height=t.height)},f.exports.isSupportHls=function(){var e=window.MediaSource=window.MediaSource||window.WebKitMediaSource,t=window.SourceBuffer=window.SourceBuffer||window.WebKitSourceBuffer,e=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),t=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return e&&t},f.exports.isSupportFlv=function(){return f.exports.isSupportHls()},f.exports.isSupportMSE=function(){return!!window.Promise&&!!window.Uint8Array&&!!Array.prototype.forEach&&f.exports.isSupportedMediaSource()},f.exports.isSupportedMediaSource=function(){return!!window.MediaSource&&!!MediaSource.isTypeSupported},f.exports.isSupportedDrm=function(){return!!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration)&&f.exports.isSupportMSE()},f.exports.isAudio=function(e){return e&&0<e.toLowerCase().indexOf(".mp3")},f.exports.isLiveShift=function(e){return e.isLive&&e.liveStartTime&&e.liveOverTime},f.exports.isHls=function(e){return e&&0<e.toLowerCase().indexOf(".m3u8")},f.exports.isDash=function(e){return e&&0<e.toLowerCase().indexOf(".mpd")},f.exports.isFlv=function(e){return e&&0<e.toLowerCase().indexOf(".flv")},f.exports.isRTMP=function(e){return e&&-1<e.toLowerCase().indexOf("rtmp:")},f.exports.isRts=function(e){return e&&-1<e.toLowerCase().indexOf("artc:")},f.exports.isMp4=function(e){return e&&-1<e.toLowerCase().indexOf(".mp4")},f.exports.checkSecuritSupport=function(){return f.exports.isSupportHls()?"":l.IS_IOS?a.get("iOSNotSupportVodEncription"):a.get("UseChromeForVodEncription")},f.exports.nativeSupportH265=function(){return l.IS_IOS||l.IS_MAC_SAFARI},f.exports.findSelectedStreamLevel=function(e,t){var r=t;if(r||(r=n.get(o.SelectedStreamLevel))){for(var i=0;i<e.length;i++)if(e[i].definition==r)return i}else n.set(o.SelectedStreamLevel,e[0].definition,365);return 0},f.exports.getHistoryDetectResult=function(e,t){if(e)return t="hls"===t,"hvc1"===e?t?n.get(o.HWDetectHvc1Hls):n.get(o.HWDetectHvc1):"hev1"===e?t?n.get(o.HWDetectHev1Hls):n.get(o.HWDetectHev1):void 0},f.exports.setHistoryDetectResult=function(e,t,r){var i="unknownCodec",t="hls"===t;"hvc1"===e?i=t?o.HWDetectHvc1Hls:o.HWDetectHvc1:"hev1"===e&&(i=t?o.HWDetectHev1Hls:o.HWDetectHev1),n.set(i,r)},f.exports.handleOption=function(e,t){f.exports.isRts(e.source)&&(e.isLive=!0);var r,i=y.merge(y.copy(g),e),n=[{name:"fullScreenButton",align:"tr",x:20,y:12},{name:"subtitle",align:"tr",x:15,y:12},{name:"setting",align:"tr",x:15,y:12},{name:"volume",align:"tr",x:5,y:10}],o=!1;if(e.useFlashPrism||f.exports.isRTMP(e.source)?(o=!0,n=[{name:"liveIco",align:"tlabs",x:15,y:25},{name:"fullScreenButton",align:"tr",x:10,y:25},{name:"volume",align:"tr",x:10,y:25}]):(r=f.exports.isLiveShift(i))?(n.push({name:"liveShiftProgress",align:"tlabs",x:0,y:0}),n.push({name:"playButton",align:"tl",x:15,y:12}),n.push({name:"liveDisplay",align:"tl",x:15,y:6})):n.push({name:"liveDisplay",align:"tlabs",x:15,y:6}),e.isLive)if(void 0===e.skinLayout)i.skinLayout=[{name:"errorDisplay",align:"tlabs",x:0,y:0},{name:"infoDisplay"},{name:"bigPlayButton",align:"blabs",x:30,y:80},{name:"tooltip",align:"blabs",x:0,y:56},{name:"H5Loading",align:"cc"},{name:"controlBar",align:"blabs",x:0,y:0,children:f.exports.isRts(e.source)?[{name:"fullScreenButton",align:"tr",x:20,y:12},{name:"volume",align:"tr",x:5,y:10},{name:"liveDisplay",align:"tlabs",x:15,y:6}]:n}];else if(0!=e.skinLayout){for(var a=e.skinLayout.length,s=[],l=-1,c=0;c<a;c++)if("controlBar"==i.skinLayout[c].name){for(var l=c,u=i.skinLayout[c].children.length,p=0;p<u;p++){var d,h=i.skinLayout[c].children[p].name;"liveDisplay"!=h&&"liveIco"!=h&&"fullScreenButton"!=h&&"volume"!=h&&"snapshot"!=h&&"setting"!=h&&"subtitle"!=h&&(!r||"progress"!=h&&"playButton"!=h&&"timeDisplay"!=h)||(d=i.skinLayout[c].children[p],"progress"==h?d.name="liveShiftProgress":"timeDisplay"==h?d.name="liveShiftTimeDisplay":o&&"liveDisplay"==h&&(d.name="liveIco"),s.push(d))}break}-1!=l&&(i.skinLayout[l].children=s)}return(void 0===e.components||!e.components||y.isArray(e.components)&&0==e.components.length)&&"false"!=e.components&&(i.components=[_]),i},f.exports.getLiveHostByRegion=function(e){var t="live.aliyuncs.com";return e&&-1<["ap-southeast-1","eu-central-1"].indexOf(e)?"live."+e+".aliyuncs.com":t},f.exports.isVideoTag=function(e){return e&&"string"==typeof e.nodeName&&"video"===e.nodeName.toLowerCase()},f.exports.unqiueTextTracks=function(e){var t=[],t=(e=void 0===e?[]:e).reduce(function(e,t){var r;return e.some(function(e){return e.srclang===t.srclang})?e:((r=t).label=t.label||t.srclang,[].concat(e,[r]))},[]),r={};return t.forEach(function(e,t){r[e.label]?r[e.label].push(t):r[e.label]=[t]}),Object.keys(r).forEach(function(e){e=r[e]||[];1<e.length&&e.forEach(function(e){t[e].label=t[e].label+"("+t[e].srclang+")"})}),t},f.exports.isHvc1Codec=function(e){return-1<(e=void 0===e?"":e).indexOf("hvc1")},f.exports.isHev1Codec=function(e){return-1<(e=void 0===e?"":e).indexOf("hev1")},f.exports.isVvccCodec=function(e){return-1<(e=void 0===e?"":e).indexOf("vvcC")},f.exports.isVvc1Codec=function(e){return-1<(e=void 0===e?"":e).indexOf("vvc1")},f.exports.isH265Codec=function(e){return f.exports.isHvc1Codec(e=void 0===e?"":e)||f.exports.isHev1Codec(e)},f.exports.isH266Codec=function(e){return f.exports.isVvccCodec(e=void 0===e?"":e)||f.exports.isVvc1Codec(e)},f.exports.isH264Codec=function(e){return-1<(e=void 0===e?"":e).indexOf("avc1")},f.exports.getVideoTrack=function(e){var t;return(e=void 0===e?[]:e).forEach(function(e){1===Number(e.type)&&(t=e)}),t},l.IS_ANDROID&&(l.dingTalk()||l.IS_UC||l.is_X5||l.IS_HUAWEI||l.IS_XIAOMI||l.IS_OPPO||l.IS_VIVO||l.IS_MEIZU||l.IS_SAMSUNG||l.IS_WEBVIEW)||l.os&&"windows"===l.os.name&&l.IS_UC);f.exports.shouldUseBasePlayer=function(e,t){var r,i,n,o=e.codecTag,e=e.url,a="supported",s="unsupported";return!o||(n=f.exports.isHvc1Codec(o),r=f.exports.isMp4(e),e=f.exports.isHls(e),r&&f.exports.nativeSupportH265()&&n)||r&&function(){if(!(!u&&(l.IS_CHROME||l.IS_EDGE_NEW)))return!1;var t=0;try{t=l.USER_AGENT.match(/Chrome\/(\d+)/i)[1]}catch(e){t=0}return!(parseInt(t)<104||!window.MediaSource||!window.MediaSource.isTypeSupported('video/mp4;codecs="hvc1.1.6.L120.90"'))}()?t(!0):u?(n=f.exports.getHistoryDetectResult(o,i=e?"hls":"mp4"))===a?t(!0):n===s?t(!1):void c({codecTags:[o],format:i,timeout:2e3}).then(function(e){e=e.isHev1Supported||e.isHvc1Supported;if(f.exports.setHistoryDetectResult(o,i,e?a:s),e)return t(!0);t(!1)}).catch(function(e){console.log("hevcDetector ERROR",e),t(!1)}):t(!1)},f.exports.parseHttpHeaders=function(e){if(e)try{var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};return t.forEach(function(e){var e=e.split(": "),t=e.shift(),e=e.join(": ");r[t]=e}),r}catch(e){}},f.exports.detectRegionBlock=function(e,i){s.get(e,function(){i(!1)},function(e,t,r){r=f.exports.parseHttpHeaders(r)["x-tengine-error"];403===t&&r&&-1<o.RegionBlockMessages.indexOf(r)?i(!0):i(!1)})}},{"../config":14,"../lang/index":23,"../player/base/plugin/defaultemptycomponent":92,"./constants":28,"./cookie":29,"./dom":32,"./hardware-decoding-detector":36,"./io":40,"./object":42,"./ua":49}],46:[function(e,f,t){var y=e("./object"),r=e("../config"),i=e("./dom"),n=e("./cookie"),o=e("./constants"),a=e("../lang/index"),l=e("./ua"),s=e("./io"),_=e("../player/base/plugin/defaultemptycomponent"),c=e("./hardware-decoding-detector"),g={preload:!0,autoplay:!0,useNativeControls:!1,width:"100%",height:"300px",cover:"",from:"",trackLog:!0,logBatched:!0,heartHeatInterval:30,isLive:!1,playsinline:!0,showBarTime:5e3,rePlay:!1,liveRetry:5,liveRetryInterval:1,liveRetryStep:0,keyShortCuts:!1,keyFastForwardStep:10,isVBR:!1,vodRetry:3,format:"",definition:"",defaultDefinition:"",loadDataTimeout:20,waitingTimeout:60,waitingBufferedTime:3,delayLoadingShow:1,controlBarForOver:!1,controlBarVisibility:"hover",enableSystemMenu:!1,qualitySort:"asc",x5_video_position:"normal",x5_type:"",x5_fullscreen:!1,x5_orientation:"landscape|portrait",x5LandscapeAsFullScreen:!0,license:{},autoPlayDelay:0,autoPlayDelayDisplayText:"",useHlsPluginForSafari:!1,enableMSEForAndroid:!0,encryptType:0,language:"zh-cn",languageTexts:{},mediaType:"video",outputType:"",playConfig:{},reAuthInfo:{},components:[],liveTimeShiftUrl:"",liveShiftSource:"",liveShiftTime:"",liveShiftMinOffset:30,videoHeight:"100%",videoWidth:"100%",enableWorker:!0,authTimeout:"",enableMockFullscreen:!1,region:"cn-shanghai",debug:!1,progressMarkers:[],snapshotWatermark:{left:"500",top:"100",text:"",font:"16px \u5b8b\u4f53",fillColor:"#FFFFFF",strokeColor:"#FFFFFF"},liveStartTime:"",liveOverTime:"",enableStashBufferForFlv:!0,flvOption:{accurateSeek:!0},hlsOption:{stopLoadAsPaused:!1},hlsLoadingTimeOut:2e4,useHlsPlugOnMobile:!0,lowLatencyMode:!1,useHls2:void 0,skipRtsSupportCheck:!1,rtsLoadDataTimeout:6e3,rtsFallbackSource:void 0,rtsVersion:"",rtsSdkUrl:"",nudgeMaxRetry:5,tracks:[],recreatePlayer:function(){},diagnosisButtonVisible:!0,enableH265:!1,forceH265:!1,enableH266:!1,forceH266:!1,h265Threads:!0,h265Simd:!0,preventRecord:!1,traceId:"",mediaAuth:void 0,textTracks:void 0,_native:!0,hlsUriToken:"",thumbnailUrl:"",refreshAccessInfo:function(){},drmSessionTimeout:5e3,skinRes:"//"+r.domain+"/de/prismplayer-flash/"+r.flashVersion+"/atlas/defaultSkin",splayerUrl:null,splayerWasmDomain:null},u=(f.exports.defaultH5Layout=[{name:"bigPlayButton",align:"blabs",x:30,y:80},{name:"H5Loading",align:"cc"},{name:"errorDisplay",align:"tlabs",x:0,y:0},{name:"infoDisplay"},{name:"tooltip",align:"blabs",x:0,y:50},{name:"thumbnail"},{name:"controlBar",align:"blabs",x:0,y:0,children:[{name:"progress",align:"blabs",x:0,y:44},{name:"playButton",align:"tl",x:15,y:12},{name:"timeDisplay",align:"tl",x:10,y:5},{name:"fullScreenButton",align:"tr",x:10,y:12},{name:"subtitle",align:"tr",x:15,y:12},{name:"setting",align:"tr",x:15,y:12},{name:"volume",align:"tr",x:5,y:10}]}],f.exports.defaultAudioLayout=[{name:"controlBar",align:"blabs",x:0,y:0,children:[{name:"progress",align:"blabs",x:0,y:44},{name:"playButton",align:"tl",x:15,y:12},{name:"timeDisplay",align:"tl",x:10,y:5},{name:"volume",align:"tr",x:5,y:10}]}],f.exports.defaultFlashLayout=[{name:"bigPlayButton",align:"blabs",x:30,y:80},{name:"controlBar",align:"blabs",x:0,y:0,children:[{name:"progress",align:"tlabs",x:0,y:0},{name:"playButton",align:"tl",x:15,y:26},{name:"nextButton",align:"tl",x:10,y:26},{name:"timeDisplay",align:"tl",x:10,y:24},{name:"fullScreenButton",align:"tr",x:10,y:25},{name:"streamButton",align:"tr",x:10,y:23},{name:"volume",align:"tr",x:10,y:25}]},{name:"fullControlBar",align:"tlabs",x:0,y:0,children:[{name:"fullTitle",align:"tl",x:25,y:6},{name:"fullNormalScreenButton",align:"tr",x:24,y:13},{name:"fullTimeDisplay",align:"tr",x:10,y:12},{name:"fullZoom",align:"cc"}]}],f.exports.canPlayType=function(e){var t=document.createElement("video");return t.canPlayType?t.canPlayType(e):""},f.exports.canPlayHls=function(){return""!=f.exports.canPlayType("application/x-mpegURL")},f.exports.isUsedHlsPluginOnMobile=function(e){return!!(l.IS_MOBILE&&(l.IS_CHROME||l.IS_FIREFOX||l.IS_X5||l.IS_EDGE_NEW)&&f.exports.isSupportHls())},f.exports.isSafariUsedHlsPlugin=function(e){return!!(l.os.pc&&l.browser.safari&&e)},f.exports.hasUIComponent=function(e,t){if(void 0!==e&&e&&0!=e.length)for(var r=0,i=e.length;r<i;r++){var n=e[r].name;if(n==t)return!0;if("controlBar"==n)return f.exports.hasUIComponent(e[r].children,t)}return!1},f.exports.validateSource=function(e){return!0},f.exports.supportH5Video=function(){return void 0!==document.createElement("video").canPlayType},f.exports.createWrapper=function(e){var t=e.id,t="string"==typeof t?(0===t.indexOf("#")&&(t=t.slice(1)),i.el(t)):t;if(t&&t.nodeName)return f.exports.adjustContainerLayout(t,e),t;throw new TypeError("\u6ca1\u6709\u4e3a\u64ad\u653e\u5668\u6307\u5b9a\u5bb9\u5668")},f.exports.adjustContainerLayout=function(e,t){t.width&&!e.style.width&&(e.style.width=t.width),t.height&&!e.style.height&&(e.style.height=t.height)},f.exports.isSupportHls=function(){var e=window.MediaSource=window.MediaSource||window.WebKitMediaSource,t=window.SourceBuffer=window.SourceBuffer||window.WebKitSourceBuffer,e=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),t=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return e&&t},f.exports.isSupportFlv=function(){return f.exports.isSupportHls()},f.exports.isSupportMSE=function(){return!!window.Promise&&!!window.Uint8Array&&!!Array.prototype.forEach&&f.exports.isSupportedMediaSource()},f.exports.isSupportedMediaSource=function(){return!!window.MediaSource&&!!MediaSource.isTypeSupported},f.exports.isSupportedDrm=function(){return!!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration)&&f.exports.isSupportMSE()},f.exports.isAudio=function(e){return e&&0<e.toLowerCase().indexOf(".mp3")},f.exports.isLiveShift=function(e){return e.isLive&&e.liveStartTime&&e.liveOverTime},f.exports.isHls=function(e){return e&&0<e.toLowerCase().indexOf(".m3u8")},f.exports.isDash=function(e){return e&&0<e.toLowerCase().indexOf(".mpd")},f.exports.isFlv=function(e){return e&&0<e.toLowerCase().indexOf(".flv")},f.exports.isRTMP=function(e){return e&&-1<e.toLowerCase().indexOf("rtmp:")},f.exports.isRts=function(e){return e&&-1<e.toLowerCase().indexOf("artc:")},f.exports.isMp4=function(e){return e&&-1<e.toLowerCase().indexOf(".mp4")},f.exports.checkSecuritSupport=function(){return f.exports.isSupportHls()?"":l.IS_IOS?a.get("iOSNotSupportVodEncription"):a.get("UseChromeForVodEncription")},f.exports.nativeSupportH265=function(){return l.IS_IOS||l.IS_MAC_SAFARI},f.exports.findSelectedStreamLevel=function(e,t){var r=t;if(r||(r=n.get(o.SelectedStreamLevel))){for(var i=0;i<e.length;i++)if(e[i].definition==r)return i}else n.set(o.SelectedStreamLevel,e[0].definition,365);return 0},f.exports.getHistoryDetectResult=function(e,t){if(e)return t="hls"===t,"hvc1"===e?t?n.get(o.HWDetectHvc1Hls):n.get(o.HWDetectHvc1):"hev1"===e?t?n.get(o.HWDetectHev1Hls):n.get(o.HWDetectHev1):void 0},f.exports.setHistoryDetectResult=function(e,t,r){var i="unknownCodec",t="hls"===t;"hvc1"===e?i=t?o.HWDetectHvc1Hls:o.HWDetectHvc1:"hev1"===e&&(i=t?o.HWDetectHev1Hls:o.HWDetectHev1),n.set(i,r)},f.exports.handleOption=function(e,t){f.exports.isRts(e.source)&&(e.isLive=!0);var r,i=y.merge(y.copy(g),e),n=[{name:"fullScreenButton",align:"tr",x:20,y:12},{name:"subtitle",align:"tr",x:15,y:12},{name:"setting",align:"tr",x:15,y:12},{name:"volume",align:"tr",x:5,y:10}],o=!1;if(e.useFlashPrism||f.exports.isRTMP(e.source)?(o=!0,n=[{name:"liveIco",align:"tlabs",x:15,y:25},{name:"fullScreenButton",align:"tr",x:10,y:25},{name:"volume",align:"tr",x:10,y:25}]):(r=f.exports.isLiveShift(i))?(n.push({name:"liveShiftProgress",align:"tlabs",x:0,y:0}),n.push({name:"playButton",align:"tl",x:15,y:12}),n.push({name:"liveDisplay",align:"tl",x:15,y:6})):n.push({name:"liveDisplay",align:"tlabs",x:15,y:6}),e.isLive)if(void 0===e.skinLayout)i.skinLayout=[{name:"errorDisplay",align:"tlabs",x:0,y:0},{name:"infoDisplay"},{name:"bigPlayButton",align:"blabs",x:30,y:80},{name:"tooltip",align:"blabs",x:0,y:56},{name:"H5Loading",align:"cc"},{name:"controlBar",align:"blabs",x:0,y:0,children:f.exports.isRts(e.source)?[{name:"fullScreenButton",align:"tr",x:20,y:12},{name:"volume",align:"tr",x:5,y:10},{name:"liveDisplay",align:"tlabs",x:15,y:6}]:n}];else if(0!=e.skinLayout){for(var a=e.skinLayout.length,s=[],l=-1,c=0;c<a;c++)if("controlBar"==i.skinLayout[c].name){for(var l=c,u=i.skinLayout[c].children.length,p=0;p<u;p++){var d,h=i.skinLayout[c].children[p].name;"liveDisplay"!=h&&"liveIco"!=h&&"fullScreenButton"!=h&&"volume"!=h&&"snapshot"!=h&&"setting"!=h&&"subtitle"!=h&&(!r||"progress"!=h&&"playButton"!=h&&"timeDisplay"!=h)||(d=i.skinLayout[c].children[p],"progress"==h?d.name="liveShiftProgress":"timeDisplay"==h?d.name="liveShiftTimeDisplay":o&&"liveDisplay"==h&&(d.name="liveIco"),s.push(d))}break}-1!=l&&(i.skinLayout[l].children=s)}return(void 0===e.components||!e.components||y.isArray(e.components)&&0==e.components.length)&&"false"!=e.components&&(i.components=[_]),i},f.exports.getLiveHostByRegion=function(e){var t="live.aliyuncs.com";return e&&-1<["ap-southeast-1","eu-central-1"].indexOf(e)?"live."+e+".aliyuncs.com":t},f.exports.isVideoTag=function(e){return e&&"string"==typeof e.nodeName&&"video"===e.nodeName.toLowerCase()},f.exports.unqiueTextTracks=function(e){var t=[],t=(e=void 0===e?[]:e).reduce(function(e,t){var r;return e.some(function(e){return e.srclang===t.srclang})?e:((r=t).label=t.label||t.srclang,[].concat(e,[r]))},[]),r={};return t.forEach(function(e,t){r[e.label]?r[e.label].push(t):r[e.label]=[t]}),Object.keys(r).forEach(function(e){e=r[e]||[];1<e.length&&e.forEach(function(e){t[e].label=t[e].label+"("+t[e].srclang+")"})}),t},f.exports.isHvc1Codec=function(e){return-1<(e=void 0===e?"":e).indexOf("hvc1")},f.exports.isHev1Codec=function(e){return-1<(e=void 0===e?"":e).indexOf("hev1")},f.exports.isVvccCodec=function(e){return-1<(e=void 0===e?"":e).indexOf("vvcC")},f.exports.isVvc1Codec=function(e){return-1<(e=void 0===e?"":e).indexOf("vvc1")},f.exports.isH265Codec=function(e){return f.exports.isHvc1Codec(e=void 0===e?"":e)||f.exports.isHev1Codec(e)},f.exports.isH266Codec=function(e){return f.exports.isVvccCodec(e=void 0===e?"":e)||f.exports.isVvc1Codec(e)},f.exports.isH264Codec=function(e){return-1<(e=void 0===e?"":e).indexOf("avc1")},f.exports.getVideoTrack=function(e){var t;return(e=void 0===e?[]:e).forEach(function(e){1===Number(e.type)&&(t=e)}),t},l.IS_ANDROID&&(l.dingTalk()||l.IS_UC||l.is_X5||l.IS_HUAWEI||l.IS_XIAOMI||l.IS_OPPO||l.IS_VIVO||l.IS_MEIZU||l.IS_SAMSUNG||l.IS_WEBVIEW)||l.os&&"windows"===l.os.name&&l.IS_UC);f.exports.shouldUseBasePlayer=function(e,t){var r,i,n,o=e.codecTag,e=e.url,a="supported",s="unsupported";return!o||(n=f.exports.isHvc1Codec(o),r=f.exports.isMp4(e),e=f.exports.isHls(e),r&&f.exports.nativeSupportH265()&&n)||r&&function(){if(!(!u&&(l.IS_CHROME||l.IS_EDGE_NEW)))return!1;var t=0;try{t=l.USER_AGENT.match(/Chrome\/(\d+)/i)[1]}catch(e){t=0}return!(parseInt(t)<104||!window.MediaSource||!window.MediaSource.isTypeSupported('video/mp4;codecs="hvc1.1.6.L120.90"'))}()?t(!0):u?(n=f.exports.getHistoryDetectResult(o,i=e?"hls":"mp4"))===a?t(!0):n===s?t(!1):void c({codecTags:[o],format:i,timeout:2e3}).then(function(e){e=e.isHev1Supported||e.isHvc1Supported;if(f.exports.setHistoryDetectResult(o,i,e?a:s),e)return t(!0);t(!1)}).catch(function(e){console.log("hevcDetector ERROR",e),t(!1)}):t(!1)},f.exports.parseHttpHeaders=function(e){if(e)try{var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};return t.forEach(function(e){var e=e.split(": "),t=e.shift(),e=e.join(": ");r[t]=e}),r}catch(e){}},f.exports.detectRegionBlock=function(e,i){s.get(e,function(){i(!1)},function(e,t,r){r=f.exports.parseHttpHeaders(r)["x-tengine-error"];403===t&&r&&-1<o.RegionBlockMessages.indexOf(r)?i(!0):i(!1)})}},{"../config":14,"../lang/index":23,"../player/base/plugin/defaultemptycomponent":92,"./constants":28,"./cookie":29,"./dom":32,"./hardware-decoding-detector":36,"./io":40,"./object":42,"./ua":49}],47:[function(e,a,t){var n=e("./object"),s=e("../player/adaptiveplayer"),l=e("./constants").USER_EVENT_NAME;a.exports.reloadInstance=function(e,t,r){var i=r,n=(i.dispose(),e.readyCallback),o=e._readyCallbackCalled,e=s.create(e,function(e){t(e),o||n(e)});a.exports.restoreUserEvents(r,e),a.exports.removeAllProps(i),(i.__proto__=e)[l]=i[l]},a.exports.storeUserEvents=function(e){var r=e,i=r.__proto__.on,n={};r.on=function(e,t){"function"==typeof t&&(n[e]?n[e].push(t):n[e]=[t],this._el)&&(t.binded=!0,i.call(r,e,t))},r[l]=n},a.exports.restoreUserEvents=function(e,r){var i=e[l];i&&n.each(i,function(t){i[t].forEach(function(e){r.on(t,e)})})},a.exports.removeAllProps=function(e,t){for(var r in t=[].concat(t=t||[],[l]),e)e.hasOwnProperty(r)&&-1===t.indexOf(r)&&delete e[r]}},{"../player/adaptiveplayer":67,"./constants":28,"./object":42}],48:[function(e,t,r){t.exports.set=function(t,r){try{window.localStorage&&localStorage.setItem(t,r)}catch(e){window[t+"_localStorage"]=r}},t.exports.get=function(t){try{if(window.localStorage)return localStorage.getItem(t)}catch(e){return window[t+"_localStorage"]}return""}},{}],49:[function(e,x,t){var r,i,n,o;if(x.exports.USER_AGENT=navigator.userAgent,x.exports.IS_IPHONE=/iPhone/i.test(x.exports.USER_AGENT),x.exports.IS_IPAD=/iPad/i.test(x.exports.USER_AGENT),x.exports.IS_IPOD=/iPod/i.test(x.exports.USER_AGENT),x.exports.IS_MAC=/mac/i.test(x.exports.USER_AGENT),x.exports.IS_EDGE=/Edge/i.test(x.exports.USER_AGENT),x.exports.IS_EDGE_NEW=/Edg/i.test(x.exports.USER_AGENT)&&!x.exports.IS_EDGE,x.exports.IS_IE11=/Trident\/7.0/i.test(x.exports.USER_AGENT),x.exports.IS_X5=/qqbrowser/i.test(x.exports.USER_AGENT.toLowerCase()),x.exports.IS_CHROME=/Chrome/i.test(x.exports.USER_AGENT)&&!x.exports.IS_EDGE&&!x.exports.IS_EDGE_NEW&&!x.exports.IS_X5,x.exports.IS_SAFARI=/Safari/i.test(x.exports.USER_AGENT)&&!x.exports.IS_CHROME&&!x.exports.IS_EDGE_NEW,x.exports.IS_FIREFOX=/Firefox/i.test(x.exports.USER_AGENT),x.exports.IS_UC=/ucweb|UCBrowser|UBrowser/i.test(x.exports.USER_AGENT),x.exports.IS_HUAWEI=/HuaweiBrowser/i.test(x.exports.USER_AGENT),x.exports.IS_XIAOMI=/MiuiBrowser/i.test(x.exports.USER_AGENT),x.exports.IS_OPPO=/HeyTapBrowser/i.test(x.exports.USER_AGENT),x.exports.IS_VIVO=/VivoBrowser/i.test(x.exports.USER_AGENT),x.exports.IS_MEIZU=/MZBrowser/i.test(x.exports.USER_AGENT),x.exports.IS_SAMSUNG=/samsungbrowser/i.test(x.exports.USER_AGENT),document.all)try{var a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");x.exports.HAS_FLASH=!!a}catch(e){x.exports.HAS_FLASH=!1}else navigator.plugins&&0<navigator.plugins.length?(a=navigator.plugins["Shockwave Flash"],x.exports.HAS_FLASH=!!a):x.exports.HAS_FLASH=!1;x.exports.IS_MAC_SAFARI=x.exports.IS_MAC&&x.exports.IS_SAFARI&&!x.exports.IS_CHROME&&!x.exports.HAS_FLASH,x.exports.IS_IOS=x.exports.IS_IPHONE||x.exports.IS_IPAD||x.exports.IS_IPOD,x.exports.IOS_VERSION=function(){var e=x.exports.USER_AGENT.match(/OS (\d+)_/i);if(e&&e[1])return e[1]}(),x.exports.IS_ANDROID=/Android/i.test(x.exports.USER_AGENT),x.exports.ANDROID_VERSION=(a=x.exports.USER_AGENT.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i))?(i=a[1]&&parseFloat(a[1]),r=a[2]&&parseFloat(a[2]),i&&r?parseFloat(a[1]+"."+a[2]):i||null):null,x.exports.IS_OLD_ANDROID=x.exports.IS_ANDROID&&/webkit/i.test(x.exports.USER_AGENT)&&x.exports.ANDROID_VERSION<2.3,x.exports.TOUCH_ENABLED=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),x.exports.IS_MOBILE=x.exports.IS_IOS||x.exports.IS_ANDROID,x.exports.IS_H5=x.exports.IS_MOBILE||!x.exports.HAS_FLASH,x.exports.IS_PC=!x.exports.IS_MOBILE,x.exports.is_X5=/micromessenger/i.test(x.exports.USER_AGENT)||/qqbrowser/i.test(x.exports.USER_AGENT),x.exports.IS_ANDROID_FIREFOX=x.exports.IS_ANDROID&&x.exports.IS_FIREFOX,x.exports.CHROME_VERSION=x.exports.IS_CHROME&&x.exports.USER_AGENT.match(/Chrome\/(\d+)/i)[1],x.exports.getHost=function(e){var t,r,i="";return void 0===e||null==e||""==e?"":(t=e.indexOf("//"),r=e,i=r=-1<t?e.substring(t+2):r,(e=(i=(e=r.split("/"))&&0<e.length?e[0]:i).split(":"))&&0<e.length?e[0]:i)},x.exports.dingTalk=function(){var e=x.exports.USER_AGENT.toLowerCase();return/dingtalk/i.test(e)},x.exports.IS_DINGTALK=x.exports.dingTalk(),x.exports.wechat=function(){var e=x.exports.USER_AGENT.toLowerCase();return/micromessenger/i.test(e)},x.exports.inIFrame=function(){return self!=top},x.exports.getReferer=function(){var t=document.referrer;if(x.exports.inIFrame())try{t=top.document.referrer}catch(e){t=document.referrer}return t},x.exports.getHref=function(){location.href;if(x.exports.inIFrame())try{top.location.href}catch(e){location.href}return location.href},x.exports.check360=function(){return-1!=navigator.userAgent.indexOf("Safari")?function(){var e=navigator.userAgent.split(" ");if(-1!=e[e.length-1].indexOf("Safari"))for(var t in navigator.plugins)if("np-mswmp.dll"==navigator.plugins[t].filename)return!0;return!1}():(null==navigator.msPointerEnabled||navigator.msPointerEnabled)&&(1==navigator.msDoNotTrack||1==window.doNotTrack)&&(!!Number(window.screenX)&&window.screenLeft-window.screenX!=8||(-1!=navigator.userAgent.indexOf("MSIE 7.0")||-1!=navigator.userAgent.indexOf("MSIE 8.0"))&&null==console.count)},r=x.exports,function(e,t){var r=this.os={},i=this.browser={},n=e.match(/Web[kK]it[\/]{0,1}([\d.]+)/),o=e.match(/(Android);?[\s\/]+([\d.]+)?/),a=!!e.match(/\(Macintosh\; Intel /),s=e.match(/(iPad).*OS\s([\d_]+)/),l=e.match(/(iPod)(.*OS\s([\d_]+))?/),c=!s&&e.match(/(iPhone\sOS)\s([\d_]+)/),u=e.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),t=/Win\d{2}|Windows/.test(t),p=e.match(/Windows Phone ([\d.]+)/),d=u&&e.match(/TouchPad/),h=e.match(/Kindle\/([\d.]+)/),f=e.match(/Silk\/([\d._]+)/),y=e.match(/(BlackBerry).*Version\/([\d.]+)/),_=e.match(/(BB10).*Version\/([\d.]+)/),g=e.match(/(RIM\sTablet\sOS)\s([\d.]+)/),v=e.match(/PlayBook/),m=e.match(/Chrome\/([\d.]+)/)||e.match(/CriOS\/([\d.]+)/),S=e.match(/Firefox\/([\d.]+)/),b=e.match(/\((?:Mobile|Tablet); rv:([\d.]+)\).*Firefox\/[\d.]+/),T=e.match(/MSIE\s([\d.]+)/)||e.match(/Trident\/[\d](?=[^\?]+).*rv:([0-9.].)/),E=!m&&e.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/),w=E||e.match(/Version\/([\d.]+)([^S](Safari)|[^M]*(Mobile)[^S]*(Safari))/);(i.webkit=!!n)&&(i.version=n[1]),o&&(r.android=!0,r.version=o[2]),c&&!l&&(r.ios=r.iphone=!0,r.version=c[2].replace(/_/g,".")),s&&(r.ios=r.ipad=!0,r.version=s[2].replace(/_/g,".")),l&&(r.ios=r.ipod=!0,r.version=l[3]?l[3].replace(/_/g,"."):null),p&&(r.wp=!0,r.version=p[1]),u&&(r.webos=!0,r.version=u[2]),d&&(r.touchpad=!0),y&&(r.blackberry=!0,r.version=y[2]),_&&(r.bb10=!0,r.version=_[2]),g&&(r.rimtabletos=!0,r.version=g[2]),v&&(i.playbook=!0),h&&(r.kindle=!0,r.version=h[1]),f&&(i.silk=!0,i.version=f[1]),!f&&r.android&&e.match(/Kindle Fire/)&&(i.silk=!0),m&&(i.chrome=!0,i.version=m[1]),S&&(i.firefox=!0,i.version=S[1]),b&&(r.firefoxos=!0,r.version=b[1]),T&&(i.ie=!0,i.version=T[1]),w&&(a||r.ios||t||o)&&(i.safari=!0,r.ios||r.android||(i.version=w[1])),r.ios&&(i.version=r.version),E&&(i.webview=!0),a&&((n=e.match(/[\d]*_[\d]*_[\d]*/))&&0<n.length&&n[0]&&(r.version=n[0].replace(/_/g,".")),/MQBHD/.test(e))&&(i.version=((e.match(/.*OS\s([\d_]+)/)||[])[1]||"").replace(/_/g,".")),r.tablet=!!(s||v||o&&!e.match(/Mobile/)||S&&e.match(/Tablet/)||T&&!e.match(/Phone/)&&e.match(/Touch/)),r.phone=!(r.tablet||r.ipod||!(o||c||u||y||_||m&&e.match(/Android/)||m&&e.match(/CriOS\/([\d.]+)/)||S&&e.match(/Mobile/)||T&&e.match(/Touch/))),r.pc=!r.tablet&&!r.phone,a?r.name="macOS":t?(r.name="windows",r.version=function(){var e=navigator.userAgent,t="";(-1<e.indexOf("Windows NT 5.0")||-1<e.indexOf("Windows 2000"))&&(t="2000");(-1<e.indexOf("Windows NT 5.1")||-1<e.indexOf("Windows XP"))&&(t="XP");(-1<e.indexOf("Windows NT 5.2")||-1<e.indexOf("Windows 2003"))&&(t="2003");(-1<e.indexOf("Windows NT 6.0")||-1<e.indexOf("Windows Vista"))&&(t="Vista");(-1<e.indexOf("Windows NT 6.1")||-1<e.indexOf("Windows 7"))&&(t="7");(-1<e.indexOf("Windows NT 6.2")||-1<e.indexOf("Windows 8"))&&(t="8");(-1<e.indexOf("Windows NT 6.3")||-1<e.indexOf("Windows 8.1"))&&(t="8.1");(-1<e.indexOf("Windows NT 10")||-1<e.indexOf("Windows 10"))&&(t="10");return t}()):r.name=function(){var e=navigator.userAgent,t="other",r=x.exports.os;if(r.ios)return"iOS";if(r.android)return"android";if(-1<e.indexOf("Baiduspider"))return"Baiduspider";if(-1<e.indexOf("PlayStation"))return"PS4";r="Win32"==navigator.platform||"Windows"==navigator.platform||-1<e.indexOf("Windows"),e="Mac68K"==navigator.platform||"MacPPC"==navigator.platform||"Macintosh"==navigator.platform||"MacIntel"==navigator.platform;e&&(t="macOS");"X11"!=navigator.platform||r||e||(t="Unix");-1<String(navigator.platform).indexOf("Linux")&&(t="Linux");if(r)return"windows";return t}(),i.name=(l=navigator.userAgent.toLowerCase(),(p=x.exports.browser).firefox?"Firefox":p.ie?/edge/.test(l)?"Edge":"IE":x.exports.IS_EDGE_NEW?"EdgeChromium":/micromessenger/.test(l)?"\u5fae\u4fe1\u5185\u7f6e\u6d4f\u89c8\u5668":/qqbrowser/.test(l)?"QQ\u6d4f\u89c8\u5668":x.exports.IS_UC?"UC":x.exports.IS_DINGTALK?"Dingtalk":x.exports.IS_HUAWEI?"HuaweiBrowser":x.exports.IS_XIAOMI?"MiBrowser":x.exports.IS_OPPO?"OppoBrowser":x.exports.IS_VIVO?"VivoBrowser":x.exports.IS_MEIZU?"MeizuBrowser":x.exports.IS_SAMSUNG?"SamsungBrowser":x.exports.IS_WEBVIEW||/MQBHD/.test(l)?"webview":p.chrome?"Chrome":p.safari?"Safari":/baiduspider/.test(l)?"Baiduspider":/opera/.test(l)?"Opera":/360se/.test(l)?"360\u6d4f\u89c8\u5668":/bidubrowser/.test(l)?"\u767e\u5ea6\u6d4f\u89c8\u5668":/metasr/.test(l)?"\u641c\u72d7\u6d4f\u89c8\u5668":/lbbrowser/.test(l)?"\u730e\u8c79\u6d4f\u89c8\u5668":/playstation/.test(l)?"PS4\u6d4f\u89c8\u5668":void 0)}.call(r,navigator.userAgent,navigator.platform),x.exports.IS_WEBVIEW=(i=x.exports.USER_AGENT,n=new RegExp("("+["WebView","(iPhone|iPod|iPad)(?!.*Safari)","Android.*(Version).*(wv|.0.0.0)","Linux; U; Android"].join("|")+")","ig"),o=new RegExp("("+["VivoBrowser","MZBrowser","MiuiBrowser"].join("|")+")","ig"),!!i.match(n)&&!i.match(o))},{}],50:[function(e,t,r){var s=e("./dom");t.exports.getAbsoluteURL=function(e){return e=e.match(/^https?:\/\//)?e:s.createEl("div",{innerHTML:'<a href="'+e+'">x</a>'}).firstChild.href},t.exports.parseUrl=function(e){var t,r=["protocol","hostname","port","pathname","search","hash","host"],i=s.createEl("a",{href:e}),n=""===i.host&&"file:"!==i.protocol;n&&((t=s.createEl("div")).innerHTML='<a href="'+e+'"></a>',i=t.firstChild,t.setAttribute("style","display:none; position:absolute;"),document.body.appendChild(t));for(var o={},a=0;a<r.length;a++)o[r[a]]=i[r[a]];return o.segments=i.pathname.replace(/^\//,"").split("/"),n&&document.body.removeChild(t),o}},{"./dom":32}],51:[function(e,r,t){var i=e("./dom"),n=e("./ua"),o=e("./playerutil");r.exports.formatTime=function(e){var t,e=Math.floor(e),r=Math.floor(e/3600);return e%=3600,t=Math.floor(e/60),e=e%60,!(r===1/0||isNaN(r)||t===1/0||isNaN(t)||e==1/0||isNaN(e))&&("00"===(r=10<=r?r:"0"+r)?"":r+":")+(10<=t?t:"0"+t)+":"+(10<=e?e:"0"+e)},r.exports.extractTime=function(e){var t;return e?("00"===(t=10<=(t=parseInt(e.getHours()))?t:"0"+t)?"":t+":")+(t=10<=(t=parseInt(e.getMinutes()))?t:"0"+t)+":"+(t=10<=(t=parseInt(e.getSeconds()))?t:"0"+t):""},r.exports.convertToTimestamp=function(e,t){var r="";return e&&(t?r=e.gettime():(r=Date.parse(e),r/=1e3)),r},r.exports.convertToDate=function(e,t){var r="";return e&&(r=new Date).setTime(1e3*e),r},r.exports.parseTime=function(e){var t,r,i;return e?(i=r=t=0,3===(e=e.split(":")).length?(t=e[0],r=e[1],i=e[2]):2===e.length?(r=e[0],i=e[1]):1===e.length&&(i=e[0]),3600*(t=parseInt(t,10))+60*(r=parseInt(r,10))+(i=Math.ceil(parseFloat(i)))):"00:00:00"},r.exports.formatDate=function(e,t){var r,i={"M+":e.getMonth()+1,"d+":e.getDate(),"H+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(r in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),i)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[r]:("00"+i[r]).substr((""+i[r]).length)));return t},r.exports.sleep=function(e){for(var t=Date.now();Date.now()-t<=e;);},r.exports.htmlEncodeAll=function(e){return null==e?"":e.replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace(/\&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},r.exports.toBinary=function(e){if(!window.atob)return"";for(var t=atob(e),r=t.length,i=new Uint8Array(r),n=0;n<r;n++)i[n]=t.charCodeAt(n);return i},r.exports.readyBinary=function(e){for(var t=new Uint8Array(e),r=t.length,i="",n=0;n<r;n++)i+=t[n];return i},r.exports.delayHide=function(e,t){e&&(void 0===t&&(t=1e3),e.delayHanlder&&clearTimeout(e.delayHanlder),e.delayHanlder=setTimeout(function(){i.css(e,"display","none")},t))},r.exports.openInFile=function(){return-1!=window.location.protocol.toLowerCase().indexOf("file")},r.exports.contentProtocolMixed=function(e,t){return!!((n.os.pc&&(o.isHls(e)&&!n.browser.safari||o.isFlv(e))||t)&&"https:"==window.location.protocol.toLowerCase()&&e&&-1<e.toLowerCase().indexOf("http://"))},r.exports.queryString=function(e){var t,r,i;return 2===(e=(e=decodeURIComponent(e)).split("?")).length&&(e=e[1],t=e.split("&"))?(r={},i=0,$(t).each(function(){var e=t[i].split("=");2===e.length&&(r[e[0]]=e[1].replace(/\+/g," ")),i++}),r):{}},r.exports.log=function(e){var t=window.location.href,t=r.exports.queryString(t);t&&1==t.debug&&console.log(e)}},{"./dom":32,"./playerutil":46,"./ua":49}],52:[function(e,t,r){var i,Vo="undefined"==typeof Promise?e("es6-promise").Promise:Promise;e=this,i=function(){return r={307:function(e,t,r){e=r.nmd(e);var i="__lodash_hash_undefined__",C=1,H=2,x=9007199254740991,k="[object Arguments]",I="[object Array]",P="[object AsyncFunction]",F="[object Boolean]",B="[object Date]",V="[object Error]",j="[object Function]",q="[object GeneratorFunction]",A="[object Map]",W="[object Number]",L="[object Object]",G="[object Promise]",X="[object Proxy]",K="[object RegExp]",R="[object Set]",z="[object String]",n="[object WeakMap]",$="[object ArrayBuffer]",D="[object DataView]",Y=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,o={},r=(o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o[k]=o[I]=o[$]=o[F]=o[D]=o[B]=o[V]=o[j]=o[A]=o[W]=o[L]=o[K]=o[R]=o[z]=o[n]=!1,"object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g),a="object"==typeof self&&self&&self.Object===Object&&self,a=r||a||Function("return this")(),t=t&&!t.nodeType&&t,s=t&&e&&!e.nodeType&&e,s=s&&s.exports===t,l=s&&r.process,t=function(){try{return l&&l.binding&&l.binding("util")}catch(e){}}(),r=t&&t.isTypedArray;function J(e){var r=-1,i=Array(e.size);return e.forEach(function(e,t){i[++r]=[t,e]}),i}function Z(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var ee,te,t=Array.prototype,c=Function.prototype,u=Object.prototype,p=a["__core-js_shared__"],re=c.toString,O=u.hasOwnProperty,ie=(c=/[^.]+$/.exec(p&&p.keys&&p.keys.IE_PROTO||""))?"Symbol(src)_1."+c:"",ne=u.toString,oe=RegExp("^"+re.call(O).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),p=s?a.Buffer:void 0,c=a.Symbol,ae=a.Uint8Array,se=u.propertyIsEnumerable,le=t.splice,d=c?c.toStringTag:void 0,ce=Object.getOwnPropertySymbols,s=p?p.isBuffer:void 0,t=(ee=Object.keys,te=Object,T(a,"DataView")),h=T(a,"Map"),p=T(a,"Promise"),ue=T(a,"Set"),a=T(a,"WeakMap"),f=T(Object,"create"),pe=E(t),de=E(h),he=E(p),fe=E(ue),ye=E(a),c=c?c.prototype:void 0,_e=c?c.valueOf:void 0;function y(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function _(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function g(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function v(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new g;++t<r;)this.add(e[t])}function N(e){e=this.__data__=new _(e);this.size=e.size}function ge(e,t){var r,i,n,o=U(e),a=!o&&xe(e),s=!o&&!a&&Pe(e),l=!o&&!a&&!s&&Le(e),c=o||a||s||l,u=c?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],p=u.length;for(r in e)!t&&!O.call(e,r)||c&&("length"==r||s&&("offset"==r||"parent"==r)||l&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||(i=r,(n=null==(n=p)?x:n)&&("number"==typeof i||Q.test(i))&&-1<i&&i%1==0&&i<n))||u.push(r);return u}function m(e,t){for(var r=e.length;r--;)if(we(e[r][0],t))return r;return-1}function S(e){{if(null==e)return void 0===e?"[object Undefined]":"[object Null]";if(d&&d in Object(e)){var t=e,r=O.call(t,d),i=t[d];try{var n=!(t[d]=void 0)}catch(t){}var o=ne.call(t);return n&&(r?t[d]=i:delete t[d]),o}return ne.call(e)}}function ve(e){return w(e)&&S(e)==k}function me(e,t,r,i,n){return e===t||(null==e||null==t||!w(e)&&!w(t)?e!=e&&t!=t:function(e,t,r,i,n,o){var a=U(e),s=U(t),l=a?I:M(e),s=s?I:M(t),c=(l=l==k?L:l)==L,u=(s=s==k?L:s)==L,s=l==s;if(s&&Pe(e)){if(!Pe(t))return!1;c=!(a=!0)}if(s&&!c)return o=o||new N,(a||Le(e)?be:function(e,t,r,i,n,o){switch(l){case D:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case $:return!(e.byteLength!=t.byteLength||!n(new ae(e),new ae(t)));case F:case B:case W:return we(+e,+t);case V:return e.name==t.name&&e.message==t.message;case K:case z:return e==t+"";case A:var a=J;case R:a=a||Z;if(e.size!=t.size&&!(r&C))return!1;var s=o.get(e);if(s)return s==t;r|=H,o.set(e,t);s=be(a(e),a(t),r,i,n,o);return o.delete(e),s;case"[object Symbol]":if(_e)return _e.call(e)==_e.call(t)}return!1})(e,t,r,i,n,o);if(!(r&C)){a=c&&O.call(e,"__wrapped__"),c=u&&O.call(t,"__wrapped__");if(a||c)return n(a?e.value():e,c?t.value():t,r,i,o=o||new N)}if(s){o=o||new N;var p=e,d=t,h=r,f=i,y=n,_=o,g=h&C,v=Te(p),m=v.length;if(m!=Te(d).length&&!g)return!1;for(var S=m;S--;){var b=v[S];if(!(g?b in d:O.call(d,b)))return!1}u=_.get(p);if(u&&_.get(d))return u==d;for(var T=!0,E=(_.set(p,d),_.set(d,p),g);++S<m;){var w,x=p[b=v[S]],P=d[b];if(!(void 0===(w=f?g?f(P,x,b,d,p,_):f(x,P,b,p,d,_):w)?x===P||y(x,P,h,f,_):w)){T=!1;break}E=E||"constructor"==b}return T&&!E&&(u=p.constructor)!=(a=d.constructor)&&"constructor"in p&&"constructor"in d&&!("function"==typeof u&&u instanceof u&&"function"==typeof a&&a instanceof a)&&(T=!1),_.delete(p),_.delete(d),T}return!1}(e,t,r,i,me,n))}function Se(e){if(t=e&&e.constructor,e!==("function"==typeof t&&t.prototype||u))return ee(te(e));var t,r,i=[];for(r in Object(e))O.call(e,r)&&"constructor"!=r&&i.push(r);return i}function be(e,t,r,i,n,o){var a=r&C,s=e.length,l=t.length;if(s!=l&&!(a&&s<l))return!1;l=o.get(e);if(l&&o.get(t))return l==t;var c=-1,u=!0,p=r&H?new v:void 0;for(o.set(e,t),o.set(t,e);++c<s;){var d,h=e[c],f=t[c];if(void 0!==(d=i?a?i(f,h,c,t,e,o):i(h,f,c,e,t,o):d)){if(d)continue;u=!1;break}if(p){if(!function(e,t){for(var r=-1,i=null==e?0:e.length;++r<i;)if(t(e[r],r,e))return 1}(t,function(e,t){return!p.has(t)&&(h===e||n(h,e,r,i,o))&&p.push(t)})){u=!1;break}}else if(h!==f&&!n(h,f,r,i,o)){u=!1;break}}return o.delete(e),o.delete(t),u}function Te(e){var t=Ee,r=Re(e);if(U(e))return r;for(var i=r,n=t(e),o=-1,a=n.length,s=i.length;++o<a;)i[s+o]=n[o];return i}function b(e,t){var r,e=e.__data__;return("string"==(r=typeof t)||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t)?e["string"==typeof t?"string":"hash"]:e.map}function T(e,t){e=null==e?void 0:e[t];return!Ie(t=e)||ie&&ie in t||!(Ce(t)?oe:Y).test(E(t))?void 0:e}y.prototype.clear=function(){this.__data__=f?f(null):{},this.size=0},y.prototype.delete=function(e){e=this.has(e)&&delete this.__data__[e];return this.size-=e?1:0,e},y.prototype.get=function(e){var t,r=this.__data__;return f?(t=r[e])===i?void 0:t:O.call(r,e)?r[e]:void 0},y.prototype.has=function(e){var t=this.__data__;return f?void 0!==t[e]:O.call(t,e)},y.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=f&&void 0===t?i:t,this},_.prototype.clear=function(){this.__data__=[],this.size=0},_.prototype.delete=function(e){var t=this.__data__,e=m(t,e);return!(e<0||(e==t.length-1?t.pop():le.call(t,e,1),--this.size,0))},_.prototype.get=function(e){var t=this.__data__,e=m(t,e);return e<0?void 0:t[e][1]},_.prototype.has=function(e){return-1<m(this.__data__,e)},_.prototype.set=function(e,t){var r=this.__data__,i=m(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this},g.prototype.clear=function(){this.size=0,this.__data__={hash:new y,map:new(h||_),string:new y}},g.prototype.delete=function(e){e=b(this,e).delete(e);return this.size-=e?1:0,e},g.prototype.get=function(e){return b(this,e).get(e)},g.prototype.has=function(e){return b(this,e).has(e)},g.prototype.set=function(e,t){var r=b(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this},v.prototype.add=v.prototype.push=function(e){return this.__data__.set(e,i),this},v.prototype.has=function(e){return this.__data__.has(e)},N.prototype.clear=function(){this.__data__=new _,this.size=0},N.prototype.delete=function(e){var t=this.__data__,e=t.delete(e);return this.size=t.size,e},N.prototype.get=function(e){return this.__data__.get(e)},N.prototype.has=function(e){return this.__data__.has(e)},N.prototype.set=function(e,t){var r=this.__data__;if(r instanceof _){var i=r.__data__;if(!h||i.length<199)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new g(i)}return r.set(e,t),this.size=r.size,this};var Ee=ce?function(e){if(null==e)return[];e=Object(e);for(var t=ce(e),r=-1,i=null==t?0:t.length,n=0,o=[];++r<i;){var a=t[r];se.call(e,a)&&(o[n++]=a)}return o}:function(){return[]},M=S;function E(e){if(null!=e){try{return re.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function we(e,t){return e===t||e!=e&&t!=t}(t&&M(new t(new ArrayBuffer(1)))!=D||h&&M(new h)!=A||p&&M(p.resolve())!=G||ue&&M(new ue)!=R||a&&M(new a)!=n)&&(M=function(e){var t=S(e),e=t==L?e.constructor:void 0,e=e?E(e):"";if(e)switch(e){case pe:return D;case de:return A;case he:return G;case fe:return R;case ye:return n}return t});var xe=ve(function(){return arguments}())?ve:function(e){return w(e)&&O.call(e,"callee")&&!se.call(e,"callee")},U=Array.isArray,Pe=s||function(){return!1};function Ce(e){if(Ie(e))return(e=S(e))==j||e==q||e==P||e==X}function ke(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=x}function Ie(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function w(e){return null!=e&&"object"==typeof e}var Ae,Le=r?(Ae=r,function(e){return Ae(e)}):function(e){return w(e)&&ke(e.length)&&!!o[S(e)]};function Re(e){return(null!=e&&ke(e.length)&&!Ce(e)?ge:Se)(e)}e.exports=function(e,t){return me(e,t)}},801:function(e){e.exports=function(e){return void 0===e}},378:function(e,t,r){e=r.nmd(e);var M,U,H="__lodash_hash_undefined__",F=9007199254740991,B="[object Arguments]",V="[object AsyncFunction]",j="[object Function]",q="[object GeneratorFunction]",W="[object Null]",G="[object Object]",X="[object Proxy]",K="[object Undefined]",z=/^\[object .+?Constructor\]$/,$=/^(?:0|[1-9]\d*)$/,i={},r=(i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i[B]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i[j]=i["[object Map]"]=i["[object Number]"]=i[G]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,"object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g),n="object"==typeof self&&self&&self.Object===Object&&self,n=r||n||Function("return this")(),t=t&&!t.nodeType&&t,o=t&&e&&!e.nodeType&&e,t=o&&o.exports===t,a=t&&r.process,r=function(){try{return o&&o.require&&o.require("util").types||a&&a.binding&&a.binding("util")}catch(e){}}(),r=r&&r.isTypedArray,Y=Array.prototype,s=Function.prototype,l=Object.prototype,c=n["__core-js_shared__"],S=s.toString,b=l.hasOwnProperty,Q=(s=/[^.]+$/.exec(c&&c.keys&&c.keys.IE_PROTO||""))?"Symbol(src)_1."+s:"",J=l.toString,Z=S.call(Object),ee=RegExp("^"+S.call(b).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),c=t?n.Buffer:void 0,s=n.Symbol,te=n.Uint8Array,re=(c&&c.allocUnsafe,M=Object.getPrototypeOf,U=Object,function(e){return M(U(e))}),ie=Object.create,ne=l.propertyIsEnumerable,oe=Y.splice,u=s?s.toStringTag:void 0,p=function(){try{var e=m(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),t=c?c.isBuffer:void 0,ae=Math.max,se=Date.now,le=m(n,"Map"),d=m(Object,"create"),ce=function(e){if(!D(e))return{};if(ie)return ie(e);h.prototype=e;e=new h;return h.prototype=void 0,e};function h(){}function f(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function y(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function _(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function T(e){e=this.__data__=new y(e);this.size=e.size}function ue(e,t,r){(void 0===r||k(e[t],r))&&(void 0!==r||t in e)||E(e,t,r)}function g(e,t){for(var r=e.length;r--;)if(k(e[r][0],t))return r;return-1}function E(e,t,r){"__proto__"==t&&p?p(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}f.prototype.clear=function(){this.__data__=d?d(null):{},this.size=0},f.prototype.delete=function(e){e=this.has(e)&&delete this.__data__[e];return this.size-=e?1:0,e},f.prototype.get=function(e){var t,r=this.__data__;return d?(t=r[e])===H?void 0:t:b.call(r,e)?r[e]:void 0},f.prototype.has=function(e){var t=this.__data__;return d?void 0!==t[e]:b.call(t,e)},f.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=d&&void 0===t?H:t,this},y.prototype.clear=function(){this.__data__=[],this.size=0},y.prototype.delete=function(e){var t=this.__data__,e=g(t,e);return!(e<0||(e==t.length-1?t.pop():oe.call(t,e,1),--this.size,0))},y.prototype.get=function(e){var t=this.__data__,e=g(t,e);return e<0?void 0:t[e][1]},y.prototype.has=function(e){return-1<g(this.__data__,e)},y.prototype.set=function(e,t){var r=this.__data__,i=g(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this},_.prototype.clear=function(){this.size=0,this.__data__={hash:new f,map:new(le||y),string:new f}},_.prototype.delete=function(e){e=v(this,e).delete(e);return this.size-=e?1:0,e},_.prototype.get=function(e){return v(this,e).get(e)},_.prototype.has=function(e){return v(this,e).has(e)},_.prototype.set=function(e,t){var r=v(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this},T.prototype.clear=function(){this.__data__=new y,this.size=0},T.prototype.delete=function(e){var t=this.__data__,e=t.delete(e);return this.size=t.size,e},T.prototype.get=function(e){return this.__data__.get(e)},T.prototype.has=function(e){return this.__data__.has(e)},T.prototype.set=function(e,t){var r=this.__data__;if(r instanceof y){var i=r.__data__;if(!le||i.length<199)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new _(i)}return r.set(e,t),this.size=r.size,this};var pe=function(e,t,r){for(var i=-1,n=Object(e),o=r(e),a=o.length;a--;){var s=o[++i];if(!1===t(n[s],s,n))break}return e};function w(e){{if(null==e)return void 0===e?K:W;if(u&&u in Object(e)){var t=e,r=b.call(t,u),i=t[u];try{var n=!(t[u]=void 0)}catch(t){}var o=J.call(t);return n&&(r?t[u]=i:delete t[u]),o}return J.call(e)}}function de(e){return O(e)&&w(e)==B}function he(y,_,g,v,m){y!==_&&pe(_,function(e,t){var r,i,n,o,a,s,l,c,u,p,d,h,f;m=m||new T,D(e)?(i=_,o=g,a=he,s=v,l=m,d=x(r=y,n=t),h=x(i,n),(f=l.get(h))||((i=void 0===(f=s?s(d,h,n+"",r,i,l):void 0))&&(c=!(p=A(h))&&ge(h),u=!p&&!c&&Se(h),f=h,p||c||u?f=A(d)?d:O(p=d)&&L(p)?function(e,t){var r=-1,i=e.length;for(t=t||Array(i);++r<i;)t[r]=e[r];return t}(d):c?(i=!1,h.slice()):u?(i=!1,u=new(c=(p=h).buffer).constructor(c.byteLength),new te(u).set(new te(c)),new p.constructor(u,p.byteOffset,p.length)):[]:function(e){if(O(e)&&w(e)==G)return null===(e=re(e))||"function"==typeof(e=b.call(e,"constructor")&&e.constructor)&&e instanceof e&&S.call(e)==Z}(h)||I(h)?I(f=d)?f=function(){for(var e,t,r=d,i=be(d),n=void 0,o=!n,a=(n=n||{},-1),s=i.length;++a<s;){var l=i[a],c=void 0;void 0===c&&(c=r[l]),o?E(n,l,c):(c=c,t=void 0,t=(e=n)[l=l],b.call(e,l)&&k(t,c)&&(void 0!==c||l in e)||E(e,l,c))}return n}():D(d)&&!R(d)||(f="function"!=typeof h.constructor||ye(h)?{}:ce(re(h))):i=!1),i&&(l.set(h,f),a(f,h,o,s,l),l.delete(h))),ue(r,n,f)):(c=v?v(x(y,t),e,t+"",y,_,m):void 0,ue(y,t,c=void 0===c?e:c))},be)}function v(e,t){var r,e=e.__data__;return("string"==(r=typeof t)||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t)?e["string"==typeof t?"string":"hash"]:e.map}function m(e,t){e=null==e?void 0:e[t];return!D(t=e)||Q&&Q in t||!(R(t)?ee:z).test(function(e){if(null!=e){try{return S.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(t))?void 0:e}function fe(e,t){var r=typeof e;return(t=null==t?F:t)&&("number"==r||"symbol"!=r&&$.test(e))&&-1<e&&e%1==0&&e<t}function ye(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||l)}function x(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}_e=p?function(e,t){return p(e,"toString",{configurable:!0,enumerable:!1,value:(r=t,function(){return r}),writable:!0});var r}:Pe,C=P=0;var _e,P,C,Y=function(){var e=se(),t=16-(e-C);if(C=e,0<t){if(800<=++P)return arguments[0]}else P=0;return _e.apply(void 0,arguments)};function k(e,t){return e===t||e!=e&&t!=t}var I=de(function(){return arguments}())?de:function(e){return O(e)&&b.call(e,"callee")&&!ne.call(e,"callee")},A=Array.isArray;function L(e){return null!=e&&ve(e.length)&&!R(e)}var ge=t||function(){return!1};function R(e){if(D(e))return(e=w(e))==j||e==q||e==V||e==X}function ve(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=F}function D(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function O(e){return null!=e&&"object"==typeof e}var me,Se=r?(me=r,function(e){return me(e)}):function(e){return O(e)&&ve(e.length)&&!!i[w(e)]};function be(e){if(L(e)){var t,r=e,i=!0,n=A(r),o=!n&&I(r),a=!n&&!o&&ge(r),s=!n&&!o&&!a&&Se(r),l=n||o||a||s,c=l?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(r.length,String):[],u=c.length;for(t in r)!i&&!b.call(r,t)||l&&("length"==t||a&&("offset"==t||"parent"==t)||s&&("buffer"==t||"byteLength"==t||"byteOffset"==t)||fe(t,u))||c.push(t);return c}var p=e;if(D(p)){var d,h=ye(p),f=[];for(d in p)("constructor"!=d||!h&&b.call(p,d))&&f.push(d);return f}var y=[];if(null!=p)for(var _ in Object(p))y.push(_);return y}Te=function(e,t,r){he(e,t,r)};var Te,Ee,we,N,xe,c=Y((we=s=function(e,t){var r=-1,i=t.length,n=1<i?t[i-1]:void 0,o=2<i?t[2]:void 0,n=3<Te.length&&"function"==typeof n?(i--,n):void 0;for(o&&function(e,t,r){var i;if(D(r))return("number"==(i=typeof t)?L(r)&&fe(t,r.length):"string"==i&&t in r)&&k(r[t],e)}(t[0],t[1],o)&&(n=i<3?void 0:n,i=1),e=Object(e);++r<i;){var a=t[r];a&&Te(e,a,r)}return e},xe=Pe,N=ae(void 0===Ee?we.length-1:Ee,0),function(){for(var e=arguments,t=-1,r=ae(e.length-N,0),i=Array(r);++t<r;)i[t]=e[N+t];for(var t=-1,n=Array(N+1);++t<N;)n[t]=e[t];n[N]=xe(i);var o=we,a=this,s=n;switch(s.length){case 0:return o.call(a);case 1:return o.call(a,s[0]);case 2:return o.call(a,s[0],s[1]);case 3:return o.call(a,s[0],s[1],s[2])}return o.apply(a,s)}),s+"");function Pe(e){return e}e.exports=c},775:function(e){var n=Object.prototype.hasOwnProperty;function o(e){return"[Throws: "+(e?e.message:"?")+"]"}function i(e){var t=[];return function r(i){if(null===i||"object"!=typeof i)return i;if(-1!==t.indexOf(i))return"[Circular]";if(t.push(i),"function"==typeof i.toJSON)try{var e=r(i.toJSON());return t.pop(),e}catch(r){return o(r)}return e=Array.isArray(i)?i.map(r):Object.keys(i).reduce(function(e,t){return e[t]=r(function(e,t){if(n.call(e,t))try{}catch(e){return o(e)}return e[t]}(i,t)),e},{}),t.pop(),e}(e)}e.exports=function(e,t,r){return JSON.stringify(i(e),t,r)},e.exports.ensureProperties=i}},i={},Fo.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return Fo.d(t,{a:t}),t},Fo.d=function(e,t){for(var r in t)Fo.o(t,r)&&!Fo.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},Fo.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),Fo.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},Fo.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},Fo.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},Bo={},function(){"use strict";Fo.r(Bo),Fo.d(Bo,{AACParser:function(){return M},AudioBody:function(){return vt},AvcSPS:function(){return Te},BasicLoader:function(){return Qe},BitBuffer:function(){return x},Box:function(){return v},ByteBuffer:function(){return w},CTrackTypeMap:function(){return Ie},Demuxer:function(){return Co},DiscardType:function(){return ce},EAudioCodecID:function(){return pt},EAudioPacketType:function(){return yt},EFormatType:function(){return g},EFrameType:function(){return Et},EH264NALType:function(){return $},EH265NALType:function(){return P},EH266NALType:function(){return C},EHandlerType:function(){return pe},ELoaderStatus:function(){return d},EPID:function(){return Zn},ESampleFlag:function(){return E},ESoundType:function(){return ft},EStreamType:function(){return rn},ETSPacketType:function(){return io},ETagType:function(){return $e},ETrackType:function(){return I},EVideoCodecID:function(){return wt},EVideoPacketType:function(){return xt},ErrorCode:function(){return ue},FLVParser:function(){return It},FullBox:function(){return a},H264NAL:function(){return Q},H265NAL:function(){return k},H266NAL:function(){return re},HLSParser:function(){return _o},HevcSPS:function(){return xe},Loader:function(){return et},LoaderError:function(){return Ye},MP4Parser:function(){return Hn},MP4RemuxStream:function(){return Uo},MPEGTSParser:function(){return ho},PAT:function(){return eo},PES:function(){return to},PMT:function(){return ro},Remuxer:function(){return Lo},SOUND_RATE:function(){return _t},SOUND_SIZE:function(){return gt},ScriptBody:function(){return Pt},TSHeader:function(){return oo},TagHeader:function(){return dt},VideoBody:function(){return kt},esTypeMap:function(){return Jn}});var M={},U=(Fo.r(M),Fo.d(M,{AAC_DURATION:function(){return F},AAC_SAMPLING_FREQUENCIES:function(){return H},addADTSHeader:function(){return B},getADTSHeaderLength:function(){return j},getADTSLength:function(){return q},isADTS:function(){return V},readAACSamples:function(){return W}}),{}),w=(Fo.r(U),Fo.d(U,{Box:function(){return v},avc1:function(){return At},avcC:function(){return Re},btrt:function(){return Rt},co64:function(){return sn},ctts:function(){return on},dinf:function(){return h},dref:function(){return Dt},edts:function(){return h},elst:function(){return $t},esds:function(){return lr},ftyp:function(){return cr},hdlr:function(){return dr},hev1:function(){return Lt},hvc1:function(){return Lt},hvcC:function(){return Be},mdat:function(){return hr},mdhd:function(){return fr},mdia:function(){return h},mfhd:function(){return Pr},mfra:function(){return h},minf:function(){return h},moof:function(){return wr},moov:function(){return h},mp4a:function(){return yr},mvex:function(){return Cr},mvhd:function(){return _r},pasp:function(){return Sr},sdtp:function(){return kr},sidx:function(){return Ir},stbl:function(){return h},stco:function(){return an},stsc:function(){return ln},stsd:function(){return cn},stss:function(){return un},stsz:function(){return pn},stts:function(){return hn},tfdt:function(){return bi},tfhd:function(){return zi},tkhd:function(){return br},traf:function(){return xr},trak:function(){return h},trex:function(){return Zi},trun:function(){return nn},url:function(){return Tr},vmhd:function(){return Er},vvc1:function(){return ur},vvcC:function(){return pr}}),r.fromUint8=function(e){return new r(e.buffer,e.byteOffset,e.byteLength)},r.concatUint8s=function(e){return this.concatUint8.apply(this,e)},r.concatUint8=function(){for(var t,r,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return e.length<=1?e[0]||new Uint8Array(0):(t=new Uint8Array(e.reduce(function(e,t){return e+t.byteLength},0)),r=0,e.forEach(function(e){t.set(e,r),r+=e.byteLength}),t)},r.concat=function(e,t){return r.concatUint8(new Uint8Array(e),new Uint8Array(t)).buffer},Object.defineProperty(r.prototype,"buffer",{get:function(){return this.dv.buffer},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"unreadLength",{get:function(){return Math.max(this.end-this.offset,0)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"length",{get:function(){return this.end-this.start},enumerable:!1,configurable:!0}),r.prototype.readFloat=function(e){var t=0;switch(e){case 4:t=this.dv.getFloat32(this.offset);break;case 8:t=this.dv.getFloat64(this.offset);break;default:throw new Error("not supported for read float byte with "+e)}return this.offset+=e,t},r.prototype.back=function(e){this.offset-=e},r.prototype.skip=function(e){this.offset+=e},r.prototype.readInt=function(e){var t=this.offset;switch(this.offset+=e,e){case 1:return this.dv.getInt8(t);case 2:return this.dv.getInt16(t);case 4:return this.dv.getInt32(t);default:throw new Error("not supported for read byte with "+e)}},r.prototype.read=function(e){var t=this.offset;switch(this.offset+=e,e){case 1:return this.dv.getUint8(t);case 2:return this.dv.getUint16(t);case 3:return(this.dv.getUint16(t)<<8)+this.dv.getUint8(t+2);case 4:return this.dv.getUint32(t);default:return this.back(e-4),this.read(e-4)+this.dv.getUint32(t)*Math.pow(256,e-4)}},r.prototype.writeInt=function(e,t){var r=this.offset;switch(this.offset+=e,e){case 1:return this.dv.setInt8(r,t);case 2:return this.dv.setInt16(r,t);case 3:return this.dv.setInt8(r,t>>16),this.dv.setInt16(r+1,65535&t);case 4:return this.dv.setInt32(r,t);default:throw new Error("\u4e0d\u652f\u6301Byte write "+e)}},r.prototype.write=function(e,t){var r=this.offset;switch(this.offset+=e,e){case 1:return this.dv.setUint8(r,t);case 2:return this.dv.setUint16(r,t);case 3:return this.dv.setUint8(r,t>>>16),this.dv.setUint16(r+1,65535&t);case 4:return this.dv.setUint32(r,t);default:throw new Error("\u4e0d\u652f\u6301Byte write "+e)}},r.prototype.readToUint8=function(e){e=new Uint8Array(this.dv.buffer,this.offset,e||this.unreadLength);return this.offset+=e.byteLength,e},r.prototype.readToBuffer=function(e){e=this.offset||e?this.dv.buffer.slice(this.offset,e?this.offset+e:void 0):this.dv.buffer;return this.offset+=e.byteLength,e},r),H=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],F=1024,B=function(e,t){var r=t.audioObjectType,i=t.sampleRate,n=t.samplingFrequencyIndex,o=t.channelCount,t=t.numberOfRawDataBlocksInFrame,t=void 0===t?0:t,a=n,n=(0===n&&0<i&&(a=H.indexOf(i)),e.byteLength+7),i=new Uint8Array(7);return i[0]=255,i[1]=241,i[2]=r-1<<6,i[2]|=a<<2,i[2]|=(4&o)>>2,i[3]=(3&o)<<6,i[3]|=(6144&n)>>11,i[4]=(2047&n)>>3,i[5]=(7&n)<<5,i[5]|=31,i[6]=252,i[6]|=3&t,w.concatUint8(i,e)},V=function(e,t){return t<e.byteLength-1&&255===e[t]&&240==(246&e[t+1])},j=function(e,t){return 1&e[t+1]?7:9},q=function(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5},W=function(e){for(var t,r,i=[],n=0,o=e.byteLength;n+6<o;)V(e,n)?(t=j(e,n),r=q(e,n),i.push({audioObjectType:1+(e[2]>>>6),sampleRate:H[e[2]>>>2&15],samplingFrequencyIndex:e[2]>>>2&15,channelCount:(1&e[2])<<2|e[3]>>>6,numberOfRawDataBlocksInFrame:0,data:e.subarray(n+t,n+r)}),n+=r):n++;return i},x=(G.fromByte=function(e,t){return new G(e.read(t),t<<3)},G.prototype.skip=function(e){this.offset+=e},G.prototype.read=function(e){var t=this.len-this.offset-e;if(0<=t){for(var r=0,i=0;i<e;i++)r+=1<<i;return this.offset+=e,this.num>>>t&r}return console.warn("bit \u8bfb\u53d6\u4f4d\u6570\u8d85\u8fc7\u9650\u5236"),0},G);function G(e,t){this.num=e,this.len=t,this.offset=0}function r(e,t,r){this.dv=new DataView(e),this.offset=t||this.dv.byteOffset,this.start=this.offset,this.end=r?this.start+r:this.dv.byteLength}K.createAnnexbStartCode=function(){return new Uint8Array([0,0,0,1])},K.createVVCAnnexbStartCode=function(){return new Uint8Array([0,0,1])},K.createAVCCStartCode=function(e){return new Uint8Array([e>>24&255,e>>16&255,e>>8&255,255&e])},K.extractAVCCNAL=function(e,t){for(var r,i=[],n=new w(e.buffer,e.byteOffset,e.byteLength);n.unreadLength>t;){if((r=n.read(t+1))<=0||r>n.unreadLength){console.warn("extract avc nalu size wrong! lengthSizeMinusOne:",t,"size:",r);break}var o=n.offset-n.start;i.push(e.subarray(o,o+r)),n.skip(r)}return i},K.extractAnnexbNAL=function(r){for(var e=r.byteLength,i=[],t=0;t<e-3;)0===r[t]?0===r[t+1]?0===r[t+2]?0===r[t+3]?t++:(1===r[t+3]&&t+4<e&&i.push({prefixStart:t,start:t+4}),t+=4):(1===r[t+2]&&i.push({prefixStart:t,start:t+3}),t+=3):t+=2:t++;return i.length?i.map(function(e,t){t=i[t+1];return t?r.subarray(e.start,t.prefixStart):r.subarray(e.start)}):[]};var X=K;function K(){}var z,$;z=function(e,t){return(z=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(e=$=$||{})[e.UNUSED=0]="UNUSED",e[e.NON_IDR_SLICE=1]="NON_IDR_SLICE",e[e.DP_A=2]="DP_A",e[e.DP_B=3]="DP_B",e[e.DP_C=4]="DP_C",e[e.IDR=5]="IDR",e[e.SEI=6]="SEI",e[e.SPS=7]="SPS",e[e.PPS=8]="PPS",e[e.DIVIDER=9]="DIVIDER",e[e.SEQUENCE_END=10]="SEQUENCE_END",e[e.STREAM_END=11]="STREAM_END",e[e.FILL=12]="FILL";var P,Y,Q=function(r){function e(e){var t=r.call(this)||this,e=new x(e.read(1),8);return t.forbiddenZeroBit=e.read(1),t.nalRefIdc=e.read(2),t.nalType=e.read(5),t}var t=e,i=r;if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}return z(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n),e.extractNALType=function(e){return 31&e[0]},e.isSlice=function(e){e=this.extractNALType(e);return e>=$.NON_IDR_SLICE&&e<=$.IDR},e}(X),e=(Y=function(e,t){return(Y=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Y(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});(t=P=P||{})[t.TRAIL_N=0]="TRAIL_N",t[t.TRAIL_R=1]="TRAIL_R",t[t.TSA_N=2]="TSA_N",t[t.TSA_R=3]="TSA_R",t[t.STSA_N=4]="STSA_N",t[t.STSA_R=5]="STSA_R",t[t.RADL_N=6]="RADL_N",t[t.RADL_R=7]="RADL_R",t[t.RASL_N=8]="RASL_N",t[t.RASL_R=9]="RASL_R",t[t.VCL_N10=10]="VCL_N10",t[t.VCL_R11=11]="VCL_R11",t[t.VCL_N12=12]="VCL_N12",t[t.VCL_R13=13]="VCL_R13",t[t.VCL_N14=14]="VCL_N14",t[t.VCL_R15=15]="VCL_R15",t[t.BLA_W_LP=16]="BLA_W_LP",t[t.BLA_W_RADL=17]="BLA_W_RADL",t[t.BLA_N_LP=18]="BLA_N_LP",t[t.IDR_W_RADL=19]="IDR_W_RADL",t[t.IDR_N_LP=20]="IDR_N_LP",t[t.CRA=21]="CRA",t[t.VPS=32]="VPS",t[t.SPS=33]="SPS",t[t.PPS=34]="PPS",t[t.ACCESS_UNIT_DELIMITER=35]="ACCESS_UNIT_DELIMITER",t[t.EOS=36]="EOS",t[t.EOB=37]="EOB",t[t.FILLER_DATA=38]="FILLER_DATA",t[t.SEI=39]="SEI",t[t.SEI_SUFFIX=40]="SEI_SUFFIX",t[t.INVALID=64]="INVALID";e(ee,Z=X),ee.extractNALType=function(e,t){return(126&e[t=void 0===t?0:t])>>1},ee.isNonRefNALType=function(e){switch(e){case P.TRAIL_N:case P.STSA_N:case P.RADL_N:case P.RASL_N:case P.VCL_N10:case P.VCL_N12:case P.VCL_N14:return!0;default:return!1}},ee.isNonRef=function(e){return this.isNonRefNALType(this.extractNALType(e))},ee.isSlice=function(e){e=this.extractNALType(e);return e>=P.TRAIL_N&&e<=P.CRA},ee.littleEndian=function(){var e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]},ee.parseHVCVideoData=function(e,t){for(var r=e.byteLength,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n=[],o=0,a=0+t,s=this.littleEndian,l=!1;o<r;){if(r<=o+4){console.warn("parseHVCVideoData Malformed Nalu near timestamp "+a+", offset = "+o+", dataSize = "+r);break}var c=i.getUint32(o,!s);if(r-4<c)return void console.warn("parseHVCVideoData Malformed Nalus near timestamp "+a+", NaluSize > DataSize!");var u=i.getUint8(o+4)>>1&63,p=(16<=u&&u<=23&&(l=!0),0+o+4),u={type:u,data:e.subarray(p,p+c)};n.push(u),o+=4+c}return{keyframe:l,units:n}};var C,J,Z,k=ee,t=(J=function(e,t){return(J=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}J(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function ee(e){var t=Z.call(this)||this,e=new x(e.read(2),16);return t.forbiddenZeroBit=e.read(1),t.nalType=e.read(6),t.nhLayerId=e.read(6),t.nhTimeId=e.read(3),t}(e=C=C||{})[e.VVC_TRAIL_NUT=0]="VVC_TRAIL_NUT",e[e.VVC_STSA_NUT=1]="VVC_STSA_NUT",e[e.VVC_RADL_NUT=2]="VVC_RADL_NUT",e[e.VVC_RASL_NUT=3]="VVC_RASL_NUT",e[e.VVC_RSV_VCL_4=4]="VVC_RSV_VCL_4",e[e.VVC_RSV_VCL_5=5]="VVC_RSV_VCL_5",e[e.VVC_RSV_VCL_6=6]="VVC_RSV_VCL_6",e[e.VVC_IDR_W_RADL=7]="VVC_IDR_W_RADL",e[e.VVC_IDR_N_LP=8]="VVC_IDR_N_LP",e[e.VVC_CRA_NUT=9]="VVC_CRA_NUT",e[e.VVC_GDR_NUT=10]="VVC_GDR_NUT",e[e.VVC_RSV_IRAP_11=11]="VVC_RSV_IRAP_11",e[e.VVC_OPI_NUT=12]="VVC_OPI_NUT",e[e.VVC_DCI_NUT=13]="VVC_DCI_NUT",e[e.VVC_VPS_NUT=14]="VVC_VPS_NUT",e[e.VVC_SPS_NUT=15]="VVC_SPS_NUT",e[e.VVC_PPS_NUT=16]="VVC_PPS_NUT",e[e.VVC_PREFIX_APS_NUT=17]="VVC_PREFIX_APS_NUT",e[e.VVC_SUFFIX_APS_NUT=18]="VVC_SUFFIX_APS_NUT",e[e.VVC_PH_NUT=19]="VVC_PH_NUT",e[e.VVC_AUD_NUT=20]="VVC_AUD_NUT",e[e.VVC_EOS_NUT=21]="VVC_EOS_NUT",e[e.VVC_EOB_NUT=22]="VVC_EOB_NUT",e[e.VVC_PREFIX_SEI_NUT=23]="VVC_PREFIX_SEI_NUT",e[e.VVC_SUFFIX_SEI_NUT=24]="VVC_SUFFIX_SEI_NUT",e[e.VVC_FD_NUT=25]="VVC_FD_NUT",e[e.VVC_RSV_NVCL_26=26]="VVC_RSV_NVCL_26",e[e.VVC_RSV_NVCL_27=27]="VVC_RSV_NVCL_27",e[e.VVC_UNSPEC_28=28]="VVC_UNSPEC_28",e[e.VVC_UNSPEC_29=29]="VVC_UNSPEC_29",e[e.VVC_UNSPEC_30=30]="VVC_UNSPEC_30",e[e.VVC_UNSPEC_31=31]="VVC_UNSPEC_31";t(i,te=X),i.parseNaluHeader=function(e){return{nuh_layer_id:63&e[0],nal_unit_type:e[1]>>3&31,nuh_temporal_id_plus1:7&e[1]}},i.extractNALType=function(e){return this.parseNaluHeader(e).nal_unit_type},i.isNonRefNALType=function(e){switch(e){case C.VVC_IDR_W_RADL:case C.VVC_IDR_N_LP:return!0;default:return!1}},i.isNonRef=function(e){return this.isNonRefNALType(this.extractNALType(e))},i.isSlice=function(e){e=this.extractNALType(e);return e<=C.VVC_RASL_NUT||e>=C.VVC_IDR_W_RADL&&e<=C.VVC_GDR_NUT},i.littleEndian=function(){var e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]},i.parseHVCVideoData=function(e,t){for(var r=e.byteLength,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n=[],o=0,a=0+t,s=this.littleEndian,l=!1;o<r;){if(r<=o+4){console.warn("parseHVCVideoData Malformed Nalu near timestamp "+a+", offset = "+o+", dataSize = "+r);break}var c=i.getUint32(o,!s);if(r-4<c)return void console.warn("parseHVCVideoData Malformed Nalus near timestamp "+a+", NaluSize > DataSize!");var u=i.getUint8(o+4)>>1&63,p=(16<=u&&u<=23&&(l=!0),0+o+4),u={type:u,data:e.subarray(p,p+c)};n.push(u),o+=4+c}return{keyframe:l,units:n}};var te,re=i,e=Fo(307),ie=Fo.n(e);function i(e){var t=te.call(this)||this,e=new x(e.read(2),16);return t.forbiddenZeroBit=e.read(1),t.nalType=e.read(6),t.nhLayerId=e.read(6),t.nhTimeId=e.read(3),t}function ne(t,r){var i=!1;return Object.keys(r).forEach(function(e){ie()(t[e],r[e])||(t[e]=r[e],i=!0)}),i}function oe(e){return e<10?"0"+e:e}var t=Fo(775),ae=Fo.n(t),se="undefined"!=typeof performance&&"function"==typeof performance.now;function le(){return(se?performance:Date).now()}var u;(e=u=u||{})[e.TRACE=-1]="TRACE",e[e.DEBUG=0]="DEBUG",e[e.LOG=1]="LOG",e[e.INFO=2]="INFO",e[e.WARN=10]="WARN",e[e.ERROR=11]="ERROR",e[e.NONE=1e3]="NONE";var ce,ue,pe,g,I,de=u.INFO,he=u.ERROR,fe=2e3,ye=le(),_e=[],ge=0,ve=(o.prototype._print=function(e,t){var r,i,n,o,a,s,l,c;de<=e&&(r=le()-ye,n="[".concat(u[e],"][").concat(this.name,"][").concat((i=r,void 0===(n=!0)&&(n=!0),c=Math.floor(i/1e3),n=void 0!==n&&n,((o=c)===1/0?o:(s=Math.floor(o/60),s-=60*(a=Math.floor(s/60)),o=Math.floor(o-60*(60*a+s)),l=[],(n||0<a)&&l.push(oe(a)),l.push(oe(s)),l.push(oe(o)),l.join(":")))+"."+Math.floor(1e3*(i-1e3*c))),"]"),_e.push({id:ge++,level:e,name:this.name,timestamp:r,args:t,prefix:n,message:""}),_e.length>fe&&_e.shift(),he<=e)&&(a=(u[e]||"").toLowerCase(),s=console[a])&&s.apply(void 0,function(e,t,r){if(r||2===arguments.length)for(var i,n=0,o=t.length;n<o;n++)!i&&n in t||((i=i||Array.prototype.slice.call(t,0,n))[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}([n],t,!1))},o.prototype.getLogs=function(){return _e.map(function(e){return e.message=e.prefix+" "+e.args.map(function(e){return"string"==typeof e?e:ae()(e)}).join(" "),e})},o.prototype.clear=function(){_e=[]},o.prototype.setSize=function(e){fe=e},o.prototype.setLevel=function(e){de=e},o.prototype.getLevel=function(){return de},o.prototype.setPrintLevel=function(e){he=e},o.prototype.reset=function(){de=u.INFO,he=u.ERROR,fe=2e3,ye=le(),_e=[],ge=0},o.LogLevel=u,o),A=(new ve("common"),new ve("demuxer")),me=(n.prototype.loadWord=function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,i=new Uint8Array(4),t=Math.min(4,t);if(0===t)throw new Error("no bytes available");i.set(e.subarray(r,r+t)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*t,this.bytesAvailable-=t},n.prototype.skipBits=function(e){var t;this.bitsAvailable>e||(e=(e-=this.bitsAvailable)-((t=e>>3)<<3),this.bytesAvailable-=t,this.loadWord()),this.word<<=e,this.bitsAvailable-=e},n.prototype.readBits=function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;return 32<e&&A.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,0<this.bitsAvailable?this.word<<=t:0<this.bytesAvailable&&this.loadWord(),0<(t=e-t)&&this.bitsAvailable?r<<t|this.readBits(t):r},n.prototype.skipLZ=function(){for(var e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},n.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},n.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())},n.prototype.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},n.prototype.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},n.prototype.readUByte=function(){return this.readBits(8)},n.prototype.readUShort=function(){return this.readBits(16)},n.prototype.readUInt=function(){return this.readBits(32)},n.prototype.skipScalingList=function(e){for(var t=8,r=8,i=0;i<e;i++)t=0===(r=0!==r?(t+this.readEG()+256)%256:r)?t:r},n),Se=[100,110,122,244,44,83,86,118,128,138,144],be=[[0,1],[1,1],[12,11],[10,11],[16,11],[40,33],[24,11],[20,11],[32,11],[80,33],[18,11],[15,11],[64,33],[160,99],[4,3],[3,2],[2,1]],Te=(Ce.generateCodec=function(e){return"avc1."+[e.generalProfileIdc,e.generalProfileCompatibility,e.generalLevelIdc].map(function(e){return(e=e.toString(16)).length<2?"0"+e:e}).join("")},Ce),Ee=[1,2,2,1],we=[1,2,1,1],xe=(Pe.generateCodec=function(e){var t=["hvc1"],r=e.generalProfileSpace;t.push((0<r&&r<4?String.fromCharCode(64+r):"")+e.generalProfileIdc.toString()),t.push(e.generalProfileCompatibilityFlags.reverse().reduce(function(e,t){return e<<1|t},0).toString(16)),t.push((e.generalTierFlag?"H":"L")+e.generalLevelIdc);for(var i=!1,n=[],o=5;0<=o;o--){var a=e.generalConstraintIndicatorFlags[o];(a||i)&&(n.unshift(a.toString(16)),i=!0)}return t.concat(n).join(".")},Pe);function Pe(e){var t=this;this.generalProfileSpace=0,this.generalTierFlag=0,this.generalProfileIdc=0,this.generalProfileCompatibilityFlags=[],this.generalConstraintIndicatorFlags=[],this.subLayerProfilePresentFlags=[],this.subLayerLevelPresentFlags=[],this.separateColourPlaneFlag=0,this.pixelRatio=[],this.codec="",this.checkProfileIdc=function(e){return t.generalProfileIdc===e||t.generalProfileCompatibilityFlags[e]};var r,i,n,o,a=new me(e);for(this.vpsId=a.readBits(4),this.maxSubLayersMinus1=a.readBits(3),this.temporalIdNestingFlag=a.readBits(1),this.generalProfileSpace=a.readBits(2),this.generalTierFlag=a.readBits(1),this.generalProfileIdc=a.readBits(5),r=0;r<32;r++)this.generalProfileCompatibilityFlags[r]=a.readBits(1),0===this.generalProfileIdc&&0<r&&this.generalProfileCompatibilityFlags[r]&&(this.generalProfileIdc=r);for(r=0;r<6;r++)this.generalConstraintIndicatorFlags.push(a.readUByte());for(this.generalLevelIdc=a.readUByte(),r=0;r<this.maxSubLayersMinus1;r++)this.subLayerProfilePresentFlags[r]=a.readBits(1),this.subLayerLevelPresentFlags[r]=a.readBits(1);for(0<this.maxSubLayersMinus1&&a.skipBits(2*(8-this.maxSubLayersMinus1)),r=0;r<this.maxSubLayersMinus1;r++)this.subLayerProfilePresentFlags[r]&&a.skipBits(48),this.subLayerLevelPresentFlags[r]&&a.readUByte();this.spsId=a.readUEG(),this.codec=Pe.generateCodec(this),this.chromaFormatIdc=a.readUEG(),3===this.chromaFormatIdc&&(this.separateColourPlaneFlag=a.readBits(1)),this.separateColourPlaneFlag&&(this.chromaFormatIdc=0),this.width=a.readUEG(),this.height=a.readUEG(),a.readBits(1)&&(e=Ee[this.chromaFormatIdc],o=we[this.chromaFormatIdc],i=a.readUEG()*e,e=a.readUEG()*e,n=a.readUEG()*o,o=a.readUEG()*o,this.width-=i+e,this.height-=n+o)}function Ce(e){this.generalProfileSpace=0,this.generalTierFlag=0,this.generalProfileIdc=0,this.generalProfileCompatibility=0,this.crop=0,this.cropLeft=0,this.cropRight=0,this.cropTop=0,this.cropBottom=0,this.pixelRatio=[],this.codec="";var t,r,i=new me(e);if(this.generalProfileIdc=i.readUByte(),this.generalProfileCompatibility=i.readUByte(),this.generalLevelIdc=i.readUByte(),this.spsId=i.readUEG(),this.codec=Ce.generateCodec(this),-1<Se.indexOf(this.generalProfileIdc)){if(this.chromaFormatIdc=i.readUEG(),3===this.chromaFormatIdc&&i.skipBits(1),i.skipUEG(),i.skipUEG(),i.skipBits(1),i.readBits(1))for(t=0,r=3!==this.chromaFormatIdc?8:12;t<r;t++)i.readBits(1)&&(t<6?i.skipScalingList(16):i.skipScalingList(64))}else this.chromaFormatIdc=1;i.skipUEG();e=i.readUEG();if(0===e)i.skipUEG();else if(1===e)for(i.skipBits(1),i.skipEG(),i.skipEG(),t=0,r=i.readUEG();t<r;t++)i.skipEG();i.skipUEG(),i.skipBits(1);var n,e=i.readUEG()+1,o=i.readUEG()+1,a=i.readBits(1);a||i.skipBits(1),this.height=o*(2-a),i.skipBits(1),this.crop=i.readBits(1),this.crop&&(n=1<<(1===this.chromaFormatIdc||2===this.chromaFormatIdc?1:0),a=2-a<<(1===this.chromaFormatIdc?1:0),this.cropLeft=i.readUEG()*n,this.cropRight=i.readUEG()*n,this.cropTop=i.readUEG()*a,this.cropBottom=i.readUEG()*a),this.width=16*e-(this.cropRight+this.cropLeft),this.height=16*o-(this.cropTop+this.cropBottom),i.readBits(1)&&i.readBits(1)&&(255===(n=i.readUByte())?(this.pixelRatio[0]=i.readUByte()<<8|i.readUByte(),this.pixelRatio[1]=i.readUByte()<<8|i.readUByte()):n<be.length&&(this.pixelRatio=be[n]))}function n(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}function o(e){var r=this;this.trace=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r._print(u.TRACE,e)},this.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r._print(u.DEBUG,e)},this.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r._print(u.LOG,e)},this.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r._print(u.INFO,e)},this.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r._print(u.WARN,e)},this.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r._print(u.ERROR,e)},this.name=e}(t=ce=ce||{})[t.NONE=-16]="NONE",t[t.DEFAULT=0]="DEFAULT",t[t.NONREF=8]="NONREF",t[t.BIDIR=16]="BIDIR",t[t.NONINTRA=24]="NONINTRA",t[t.NONKEY=32]="NONKEY",t[t.ALL=48]="ALL",(e=ue=ue||{})[e.ABORTED=1]="ABORTED",e[e.NETWORK=2]="NETWORK",e[e.DECODE=3]="DECODE",e[e.SRC_NOT_SUPPORTED=4]="SRC_NOT_SUPPORTED",e[e.PARSER=1001]="PARSER",e[e.WEBGL_NOT_SUPPORTED=10005]="WEBGL_NOT_SUPPORTED",e[e.COROUTINE=20001]="COROUTINE",e[e.BUFFERING=20003]="BUFFERING",e[e.RENDERER=20005]="RENDERER",(t=pe=pe||{}).VIDE="vide",t.SOUN="soun",(e=g=g||{})[e.FLV=0]="FLV",e[e.MP4=1]="MP4",e[e.HLS=2]="HLS",e[e.MPEGTS=3]="MPEGTS",e[e.UNKNOWN=4]="UNKNOWN",(t=I=I||{})[t.UNKNOWN=0]="UNKNOWN",t[t.VIDEO=1]="VIDEO",t[t.AUDIO=2]="AUDIO";function ke(e,t){var r=e.offset;this.start=t,this.size=e.read(4),this.type=String.fromCharCode(e.read(1),e.read(1),e.read(1),e.read(1)).trim(),1===this.size&&(this.size=e.read(8)),this.length=e.offset-r}(e={})[pe.VIDE]=I.VIDEO,e[pe.SOUN]=I.AUDIO;var E,Ie=e,e=((t=E=E||{})[t.DEGRADATION_PRIORITY_MASK=65535]="DEGRADATION_PRIORITY_MASK",t[t.IS_NON_SYNC=65536]="IS_NON_SYNC",t[t.PADDING_MASK=917504]="PADDING_MASK",t[t.REDUNDANCY_MASK=3145728]="REDUNDANCY_MASK",t[t.DEPENDED_MASK=12582912]="DEPENDED_MASK",t[t.DEPENDS_MASK=50331648]="DEPENDS_MASK",t[t.DEPENDS_NO=33554432]="DEPENDS_NO",t[t.DEPENDS_YES=16777216]="DEPENDS_YES",Fe=function(e,t){return(Fe=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Fe(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Ae=function(){return(Ae=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},Le=new Date("1904-01-01T00:00:00Z").getTime(),v=(We.prototype.append=function(e){this.children.push(e)},We.mapBoxToJSON=function(e){return Ae({box:e},e.children.reduce(function(e,t){var r=t.header.type,i=e[r],t=We.mapBoxToJSON(t);return i?Array.isArray(i)?i.push(t):e[r]=[i,t]:e[r]=t,e},{}))},We),a=(e(qe,He=v),qe);Ue=function(e,t){return(Ue=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Ue(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(je,Me=v);var Re=je;Ne=function(e,t){return(Ne=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};function De(e){for(var t=e.byteLength,r=[],i=1;i<t-2;)0===e[i]&&0===e[i+1]&&3===e[i+2]?r.push(i+=2):i++;if(0===r.length)return e;for(var n=t-r.length,o=new Uint8Array(n),a=0,i=0;i<n;a++,i++)a===r[0]&&(a++,r.shift()),o[i]=e[a];return o}(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Ne(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Ve,Oe=v);var Oe,Ne,Me,Ue,He,Fe,Be=Ve;function Ve(e,t){var r,i=Oe.call(this,e,t)||this;i.nalus=[],i.vps=[],i.sps=[],i.pps=[],i.sei=[],i.configVersion=t.read(1),r=new x(t.read(1),8),i.generalProfileSpace=r.read(2),i.generalTierFlag=r.read(1),i.generalProfileIdc=r.read(5),r=new x(t.read(4),32),i.generalProfileCompatibilityFlags=Array.from(new Array(32)).map(function(){return r.read(1)}),i.generalConstraintIndicatorFlags=Array.from(new Array(6)).map(function(){return t.read(1)}),i.generalLevelIdc=t.read(1),i.minSpatialSegmentationIdc=4095&t.read(2),i.parallelismType=3&t.read(1),i.chromaFormatIdc=3&t.read(1),i.bitDepthLumaMinus8=7&t.read(1),i.bitDepthChromaMinus8=7&t.read(1),i.avgFrameRate=t.read(2),r=new x(t.read(1),8),i.constantFrameRate=r.read(2),i.numTemporalLayers=r.read(3),i.temporalIdNested=r.read(1),i.lengthSizeMinusOne=r.read(2),i.nalus=[];for(var n=t.read(1),o=0;o<n;o++){var a=[],s=(r=new x(t.read(1),8)).read(1);r.read(1);for(var l=r.read(6),c=t.read(2),u=0;u<c;u++)a.push(new Uint8Array(t.read(2)).map(function(){return t.read(1)}));i.nalus.push({completeness:s,type:l,data:a}),l===P.VPS?a.forEach(function(e){return i.vps.push(e)}):l===P.SPS?a.forEach(function(e){return i.sps.push(e)}):l===P.PPS?a.forEach(function(e){return i.pps.push(e)}):l===P.SEI&&a.forEach(function(e){return i.sei.push(e)})}return i.codec=xe.generateCodec(i),i}function je(e,t){var r=Me.call(this,e,t)||this;r.sps=[],r.pps=[],r.configVersion=t.read(1),r.generalProfileIdc=t.read(1),r.generalProfileCompatibility=t.read(1),r.generalLevelIdc=t.read(1),r.lengthSizeMinusOne=3&t.read(1),r.numOfSequenceParameterSets=31&t.read(1);for(var i,n=0,o=[],n=0;n<r.numOfSequenceParameterSets;n++){for(i=t.read(2),o=[];i--;)o.push(t.read(1));r.sps.push(new Uint8Array(o))}for(r.numOfPictureParameterSets=31&t.read(1),n=0;n<r.numOfPictureParameterSets;n++){for(i=t.read(2),o=[];i--;)o.push(t.read(1));r.pps.push(new Uint8Array(o))}return r.codec=Te.generateCodec(r),r}function qe(e,t){e=He.call(this,e,t)||this;return e.version=t.read(1),e.flag=t.read(3),e}function We(e,t){this.children=[],this.isContainer=!1,this.toStandardTime=function(e){return e&&Le+1e3*e},this.header=e}function Ge(){var o=this;this._eventMap={},this.listeners=function(e){return o._eventMap[e]||[]},this.emit=function(e,t){e=o._eventMap[e];return!!Array.isArray(e)&&(e.forEach(function(e){return e(t)}),!0)},this.off=function(e,t){var r=o._eventMap[e];return Array.isArray(r)&&(o._eventMap[e]=r.filter(function(e){return e!==t})),o},this.removeAllListeners=function(e){return void 0===e?o._eventMap={}:o._eventMap[e]&&(o._eventMap[e]=[]),o},this.on=function(e,t){return o._eventMap[e]?o._eventMap[e].push(t):o._eventMap[e]=[t],o},this.once=function(i,n){return o.on(i,function e(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];o.off(i,e),n.apply(o,t)}),o},this.proxy=function(i,e){e.forEach(function(r){o.on(r,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.unshift(r),i.emit.apply(i,e)})})},this.proxyOnce=function(i,e){e.forEach(function(r){o.once(r,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.unshift(r),i.emit.apply(i,e)})})}}Xe=function(e,t){return(Xe=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};var d,Xe,Ke,ze,$e,t=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Xe(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},Ye=((e=d=d||{})[e.IDLE=0]="IDLE",e[e.LOADING=1]="LOADING",e[e.SUSPENGING=2]="SUSPENGING",e[e.ERROR=3]="ERROR",ze=Error,t(Ze,ze),Ze),Qe=(t(s,Ke=Ge),Object.defineProperty(s.prototype,"eof",{get:function(){return this.offset===this.total},enumerable:!1,configurable:!0}),s.prototype._changeStatus=function(e){this.status!==e&&(A.log("loader status changed: ".concat(d[this.status]," -> ").concat(d[e])),this.status=e)},s.prototype.jump=function(e){this.offset=e},s.prototype.load=function(e,t,r){return this.reset(),this.url=e,this.loadRange(t,r)},s.prototype.resume=function(){return this.loadRange(this.offset)},s.prototype.suspend=function(){var e=this.status;this._abort(),e===d.LOADING&&(this._changeStatus(d.SUSPENGING),this.emit("suspend",void 0))},s.prototype.abort=function(){var e=this.status;this._abort(),e!==d.SUSPENGING&&e!==d.LOADING||this.emit("abort",void 0)},s.prototype.reset=function(){this.abort(),this.offset=0,this.total=1/0,this.url=""},s.prototype.destroy=function(){this.removeAllListeners(),this.reset()},s),Je={isIos:!1,isDingtalk:!1,isQQBrowser:!1},e=(window.navigator.userAgent||"").toLowerCase();function s(e){void 0===e&&(e={});var t=Ke.call(this)||this;return t.timeout=15e3,t.total=1/0,t.offset=0,t.status=d.IDLE,t.url="",t._handleError=function(e){"AbortError"!==e.name&&(t._changeStatus(d.ERROR),t.emit("error",{code:ue.NETWORK,message:e.message,origin:e}))},t.timeout=e.timeout||t.timeout,t}function Ze(e){return ze.call(this,e)||this}/(iPhone\sOS)\s([\d_]+)/i.test(e)&&(Je.isIos=!0),-1<e.indexOf("dingtalk")?Je.isDingtalk=!0:-1<e.indexOf("qqbrowser")&&(Je.isQQBrowser=!0),at=function(e,t){return(at=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}at(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(ut,ot=Qe),ut.isSupported=function(){return Je.isIos&&(Je.isDingtalk||Je.isQQBrowser)?(console.log("ios","isDingtalk",Je.isDingtalk,"isQQBrowser",Je.isQQBrowser),!1):"undefined"!=typeof AbortController&&"undefined"!=typeof ReadableStream},ut.prototype.loadRange=function(i,e){var n=this;if(void 0===i&&(i=0),void 0===e&&(e=1/0),!this.url||i>=this.total)return Vo.resolve(!1);if(this.status===d.LOADING||this.status===d.ERROR)return Vo.resolve(!1);A.info("\u6267\u884cload, from=".concat(i," to=").concat(e," url=").concat(this.url)),this.abort();var t=new Headers,o=0<i||e<1/0;return o&&(e=Math.min(this.total-1,e),t.set("Range","bytes=".concat(i,"-").concat(e===1/0?"":e))),this._changeStatus(d.LOADING),this.controller=new AbortController,this.emit("loadstart",void 0),this.timer=setTimeout(this.triggerTimeout,this.timeout),fetch(this.url,{method:"GET",headers:t,signal:this.controller.signal}).then(function(e){if(clearTimeout(n.timer),200<=e.status&&e.status<300){var r;if(n.offset=i,o?(t=e.headers.get("Content-Range")||"",n.total=Number(t.split("/")[1])):n.total=Number(e.headers.get("Content-Length")||""),e.body)return r=e.body.getReader(),function t(){return r.read().then(function(e){return e.done?(n.total=n.total||n.offset,n.controller=null,n._changeStatus(d.IDLE),n.emit("loadend",void 0),!0):(n.offset+=e.value.byteLength,n.emit("progress",{offset:n.offset-e.value.byteLength,data:e.value}),t())})}();if(e.arrayBuffer)return e.arrayBuffer().then(function(e){return n.offset+=e.byteLength,n.emit("progress",{offset:n.offset-e.byteLength,data:new Uint8Array(e)}),n.controller=null,n._changeStatus(d.IDLE),n.emit("loadend",void 0),!0})}var t=new Ye("\u5a92\u4f53\u6d41\u6570\u636e\u4e0d\u5b58\u5728: ".concat(n.url));throw t.response=e,t}).catch(function(e){return clearTimeout(n.timer),n._handleError(e),!1})};t=ut;nt=function(e,t){return(nt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}nt(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(ct,it=Qe),ct.prototype._abort=function(){var e=this.xhr;e&&(e.onerror=null,e.onprogress=null,e.onloadend=null,e.onreadystatechange=null,e.abort(),this.xhr=null,this._resolve(!1)),this._changeStatus(d.IDLE)},ct.prototype.loadRange=function(i,n){var u=this;return void 0===i&&(i=0),void 0===n&&(n=1/0),!this.url||i>=this.total||this.status===d.LOADING||this.status===d.ERROR?Vo.resolve(!1):(this.abort(),new Vo(function(e,t){u.xhr=new XMLHttpRequest,u._resolve=e;function r(e){var r,t=s.responseText,i=t.length,n=c,o=u.offset,a=i-n;0<a&&(u.offset+=a),!l&&e&&u.total===1/0&&(u.total=u.offset),0<a&&(c=i,u.emit("progress",{offset:o,data:(r=t.substring(n,i),new Uint8Array(r.length).map(function(e,t){return r.charCodeAt(t)}))}))}var s=u.xhr,l=0<i||n<1/0,c=(s.open("GET",u.url),l&&s.setRequestHeader("Range","bytes=".concat(i,"-").concat(n===1/0?"":n)),s.onreadystatechange=function(){var e;s.readyState===s.HEADERS_RECEIVED&&200<=s.status&&s.status<300&&(l?(e=s.getResponseHeader("Content-Range")||"",u.total=Number(e.split("/")[1])||u.total):u.total=Number(s.getResponseHeader("Content-Length"))||u.total),s.readyState>=s.HEADERS_RECEIVED&&clearTimeout(u._timer)},u.offset=i,0);s.timeout=u.timeout,s.onprogress=function(){r(!1)},s.onloadend=function(){r(!0),u.xhr=null,u._changeStatus(d.IDLE),u.emit("loadend",void 0),e(!0)},s.onerror=function(e){u.xhr=null;e=new Error(e.constructor.name);u._handleError(e),t(e)},s.overrideMimeType("text/plain; charset=x-user-defined"),u._changeStatus(d.LOADING),u.emit("loadstart",void 0),u._timer=setTimeout(u.triggerTimeout,u.timeout),s.send()}))};var e=ct,et=t.isSupported()?t:e;rt=function(e,t){return(rt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}rt(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(l,tt=Ge),Object.defineProperty(l.prototype,"loader",{get:function(){return this.customLoader||this.originLoader},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"url",{get:function(){return this.loader.url},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"status",{get:function(){return this.loader.status},enumerable:!1,configurable:!0}),l.probe=function(e){throw new Error("parser should implements static probe")},l.prototype.onProgress=function(e){},l.prototype.onLoadEnd=function(){},l.prototype.load=function(e){return this.reset(),this.loader.load(e)},l.prototype.suspend=function(){return this.loader.suspend()},l.prototype.resume=function(){return this.loader.resume()},l.prototype.reset=function(){this.loader.reset(),this.metadata=null},l.prototype.destroy=function(){this.reset(),this.loader.off("progress",this.onProgress),this.loader.off("loadend",this.onLoadEnd),this.originLoader.destroy(),this.removeAllListeners()};var tt,rt,it,nt,ot,at,t=l,st=(lt.BUFFER_LENGTH=9,lt);function lt(e){this.signature=String.fromCharCode(e.read(1),e.read(1),e.read(1)),this.version=e.read(1);var t=e.read(1),e=(this.size=e.read(4),new x(t,8));e.read(5),this.hasAudio=!!e.read(1),e.read(1),this.hasVideo=!!e.read(1)}function l(e){var t=tt.call(this)||this;return t.skipFrame=ce.DEFAULT,t.metadata=null,t.options=e,t.onProgress=t.onProgress.bind(t),t.onLoadEnd=t.onLoadEnd.bind(t),t.originLoader=new et(t.options),t.customLoader=e.loader,t.loader.on("progress",t.onProgress),t.loader.on("loadend",t.onLoadEnd),t.skipFrame=e.skipFrame||ce.DEFAULT,t}function ct(){var e=null!==it&&it.apply(this,arguments)||this;return e.xhr=null,e._timer=-1,e._resolve=function(e){},e.triggerTimeout=function(){e._abort(),e._handleError(new Error("\u52a0\u8f7d\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5"))},e}function ut(){var e=null!==ot&&ot.apply(this,arguments)||this;return e.controller=null,e.timer=-1,e._abort=function(){clearTimeout(e.timer),e.controller&&!e.controller.signal.aborted&&(e.controller.abort(),e.controller=null),e._changeStatus(d.IDLE)},e.triggerTimeout=function(){e._abort(),e._handleError(new Ye("\u52a0\u8f7d\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5"))},e}(e=$e=$e||{})[e.AUDIO=8]="AUDIO",e[e.VIDEO=9]="VIDEO",e[e.SCRIPT=18]="SCRIPT";ht.BUFFER_LENGTH=11;var pt,dt=ht;function ht(e){this.type=e.read(1),this.size=e.read(3),this.dts=e.read(3),this.dts|=e.read(1)<<24,e.skip(3)}(e=pt=pt||{})[e.PCM=0]="PCM",e[e.ADPCM=1]="ADPCM",e[e.MP3=2]="MP3",e[e.PCM_LE=3]="PCM_LE",e[e.NELLYMOSER_16KHZ_MONO=4]="NELLYMOSER_16KHZ_MONO",e[e.NELLYMOSER_8KHZ_MONO=5]="NELLYMOSER_8KHZ_MONO",e[e.NELLYMOSER=6]="NELLYMOSER",e[e.PCM_ALAW=7]="PCM_ALAW",e[e.PCM_MULAW=8]="PCM_MULAW",e[e.AAC=10]="AAC",e[e.SPEEX=11]="SPEEX";var ft,yt,_t=[5512,11025,22050,44100],gt=[8,16];(e=ft=ft||{})[e.MONO=0]="MONO",e[e.STEREO=1]="STEREO",(e=yt=yt||{})[e.ADTS_HEADER=0]="ADTS_HEADER",e[e.RAW=1]="RAW";mt.readAudioSpecificConfig=function(e){var e=new x(e.read(2),16),t=e.read(5),r=e.read(4),e=e.read(4);return{audioObjectType:t,sampleRate:H[r],samplingFrequencyIndex:r,channelCount:e}};var c,vt=mt;function mt(e){var t=new x(e.read(1),8);this.codecId=t.read(4),this.sampleRate=_t[t.read(2)],this.sampleSize=gt[t.read(1)],this.soundType=t.read(1),this.packetType=e.read(1),this.data=e.readToUint8()}function St(t){var e=t.read(2);return Array.from(Array(e)).map(function(){var e=t.read(1);return 0<e?String.fromCharCode(e):""}).join("")}function bt(e){var t=St(e),e=Tt(e);return{key:t,value:e.value,objectEnd:e.objectEnd}}function Tt(e){var t={value:null,objectEnd:!1},r=e.read(1);switch(r){case c.NUMBER:t.value=e.readFloat(8);break;case c.BOOLEAN:t.value=!!e.read(1);break;case c.LONG_STRING:case c.STRING:t.value=St(e);break;case c.OBJECT_START:t.value=function(e){for(var t={};0<e.unreadLength;){var r=bt(e);if(r.objectEnd)break;t[r.key]=r.value}return t}(e);break;case c.ECMA_ARRAY:t.value=function(e){for(var t=e.read(4),r={};0<t--;){var i=bt(e);r[i.key]=i.value}return r}(e);break;case c.OBJECT_END:t.objectEnd=!0;break;case c.STRICT_ARRAY:t.value=function(e){for(var t=e.read(4),r=[];0<t--;){var i=Tt(e);r.push(i.value)}return r}(e);break;case c.DATE:t.value=new Date(e.readFloat(8)+60*e.readInt(2)+1e3);break;default:console.warn("unknown AMF value type",r)}return t}(e=c=c||{})[e.NUMBER=0]="NUMBER",e[e.BOOLEAN=1]="BOOLEAN",e[e.STRING=2]="STRING",e[e.OBJECT_START=3]="OBJECT_START",e[e.NULL=5]="NULL",e[e.UNDEFINED=6]="UNDEFINED",e[e.REFERENCE=7]="REFERENCE",e[e.ECMA_ARRAY=8]="ECMA_ARRAY",e[e.OBJECT_END=9]="OBJECT_END",e[e.STRICT_ARRAY=10]="STRICT_ARRAY",e[e.DATE=11]="DATE",e[e.LONG_STRING=12]="LONG_STRING";var Et,wt,xt,Pt=function(e){this.name=Tt(e).value,this.value=Tt(e).value};(e=Et=Et||{})[e.KEY=1]="KEY",e[e.INTER=2]="INTER",e[e.DISP_INTER=3]="DISP_INTER",e[e.GENERATED_KEY=4]="GENERATED_KEY",e[e.VIDEO_INFO_CMD=5]="VIDEO_INFO_CMD",(e=wt=wt||{})[e.JPEG=1]="JPEG",e[e.H263=2]="H263",e[e.SCREEN=3]="SCREEN",e[e.VP6=4]="VP6",e[e.VP6A=5]="VP6A",e[e.SCREEN2=6]="SCREEN2",e[e.H264=7]="H264",e[e.REALH263=8]="REALH263",e[e.MPEG4=9]="MPEG4",e[e.H265=12]="H265",(e=xt=xt||{})[e.AVC_SEQUENCE_HEADER=0]="AVC_SEQUENCE_HEADER",e[e.AVC_NALU=1]="AVC_NALU",e[e.AVC_END=2]="AVC_END";var Ct,kt=function(e){var t=new x(e.read(1),8);this.type=t.read(4),this.codecId=t.read(4),this.packetType=e.read(1),this.cts=e.read(3)+4286578688^4286578688,this.data=e.readToUint8()},L={isFirefox:!1,isOpera:!1,isTrident:!1,isEdge:!1,isChrome:!1,isSafari:!1,isMQQBrowser:!1,isMobile:!1,isIos:!1,isDingtalk:!1},e=void 0!==window.navigator,p=e?window.navigator.userAgent:"";-1<p.indexOf("MQQBrowser")?L.isMQQBrowser=!0:-1<p.indexOf("Firefox")?L.isFirefox=!0:-1<p.indexOf("Opera")||-1<p.indexOf("OPR")?L.isOpera=!0:-1<p.indexOf("Trident")?L.isTrident=!0:-1<p.indexOf("Edge")?L.isEdge=!0:-1<p.indexOf("Chrome")?(L.isChrome=!0,(p.toLowerCase().match(/chrome\/([\d.]+)/)||[])[1]):-1<p.indexOf("Safari")||-1<p.indexOf("iPhone")||-1<p.indexOf("iPad")||-1<p.indexOf("iPod")?L.isSafari=!0:-1<p.toLowerCase().indexOf("dingtalk")&&(L.isDingtalk=!0),/(iPhone\sOS)\s([\d_]+)/i.test(p)&&(L.isIos=!0),e&&("maxTouchPoints"in(p=window.navigator)?L.isMobile=0<p.maxTouchPoints:"msMaxTouchPoints"in p?L.isMobile=0<p.msMaxTouchPoints:(e=null==(e=window.matchMedia)?void 0:e.call(window,"(pointer:coarse)"))&&"(pointer:coarse)"===e.media?L.isMobile=!!e.matches:"orientation"in window?L.isMobile=!0:(e=p.userAgent,L.isMobile=/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(e)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(e))),zt=function(e,t){return(zt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}zt(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(f,Kt=t),f.probe=function(e){return!(e.byteLength<9)&&"FLV"===new st(new w(e.buffer,e.byteOffset,e.byteLength)).signature},f.prototype.parse=function(e,t){var r=[];if(e.byteLength){this.unhandleBuffer&&(e=w.concat(this.unhandleBuffer,e),t-=this.unhandleBuffer.byteLength,this.unhandleBuffer=null);var i=new w(e);for(!this.header&&i.unreadLength>=st.BUFFER_LENGTH&&(this.header=new st(i),!1===this.header.hasVideo&&(this.header.hasVideo=!0),i.skip(this.header.size-st.BUFFER_LENGTH));i.unreadLength>4+dt.BUFFER_LENGTH;){i.skip(4);var n=new dt(i);if(!(i.unreadLength>=n.size)){i.back(4+dt.BUFFER_LENGTH);break}var o=new w(i.buffer,i.offset,n.size);switch(i.skip(n.size),n.type){case $e.VIDEO:r=r.concat(this.parseVideoBody(n,o,i.offset+t));break;case $e.AUDIO:r=r.concat(this.parseAudioBody(n,o,i.offset+t));break;case $e.SCRIPT:this.parseScriptBody(n,o);break;default:return A.warn("unknown tag type",n.type),r}}this.unhandleBuffer=i.unreadLength?i.readToBuffer():null}return r},f.prototype.checkMetadata=function(){var e=this.flvMetadata,t=this.header;if(console.log("checkMetadata flvMetadata:",e,"header:",t,", this.metadata:",this.metadata),t&&!this.metadata){var r=[];if(t.hasVideo){if(!this.videoTrackMeta||!this.videoLoaded)return void console.log("checkMetadata hasVideo no this.videoTrackMeta",this.videoTrackMeta,", this.videoLoaded",this.videoLoaded);this.videoTrackMeta.baseDTS=this.baseVideoDTS,this.videoTrackMeta.basePTS=this.baseVideoPTS,this.videoTrackMeta.fps=null==e?void 0:e.framerate,r.push(this.videoTrackMeta)}if(t.hasAudio){if(!this.audioTrackMeta||!this.audioLoaded)return void console.log("checkMetadata hasAudio no this.audioTrackMeta",this.audioTrackMeta,", this.audioLoaded",this.audioLoaded);this.audioTrackMeta.baseDTS=this.baseAudioDTS,this.audioTrackMeta.basePTS=this.baseAudioPTS,r.push(this.audioTrackMeta)}var t=this.options,i=t.live,t=t.progressive;this.metadata={formatType:g.FLV,live:!!i,progressive:!i&&!!t,url:this.loader.url,basePTS:Math.min.apply(Math,r.map(function(e){return e.basePTS||0})),baseDTS:Math.min.apply(Math,r.map(function(e){return e.baseDTS||0})),timescale:1e3,duration:1e3*((null==e?void 0:e.duration)||1/0),tracks:r},console.log("checkMetadata loadedmetadata",this.metadata),this.emit("loadedmetadata",this.metadata)}},f.prototype.parseVideoBody=function(e,t,r){var i=this,t=new kt(t),n=(this.emit("loadedtag",{header:e,body:t}),[]),o=t.type===Et.KEY,a=!1;if(t.data.length)if(t.packetType===xt.AVC_SEQUENCE_HEADER){var s,l,c=this.flvMetadata||{},u={type:I.VIDEO,id:2,baseDTS:0,basePTS:0,timescale:1e3,vps:[],sps:[],pps:[],sei:[],width:c.width||0,height:c.height||0,codec:"",pixelRatio:[],live:(null==(c=this.metadata)?void 0:c.live)||!1};t.codecId===wt.H264?(s=new ke(new w(new ArrayBuffer(8)),0),l=new w(t.data.buffer,t.data.byteOffset,t.data.byteLength),c=new Re(s,l),u.pps=c.pps,u.sps=c.sps,u.codec=c.codec,(c=c.sps[0])&&(p=new Te(c.subarray(1)),u.width=p.width,u.height=p.height)):t.codecId===wt.H265&&(X.extractAnnexbNAL(t.data).forEach(function(e){var t=new w(e.buffer,e.byteOffset,e.length),r=new k(t);r.nalType<P.ACCESS_UNIT_DELIMITER&&(r.nalType===P.SPS?(t=new xe(De(t.readToUint8())),u.sps.push(e),u.codec=t.codec,console.log("thisvideoTrackMeta sps.codec=",t.codec),u.width=t.width,u.height=t.height):r.nalType===P.VPS?u.vps.push(e):r.nalType===P.PPS&&u.pps.push(e))}),""===u.codec)&&(s=new ke(new w(new ArrayBuffer(8)),0),l=new w(t.data.buffer,t.data.byteOffset,t.data.byteLength),c=new Be(s,l),u.vps=c.vps,u.pps=c.pps,u.sps=c.sps,u.sei=c.sei,u.codec=c.codec,c.sps&&0<c.sps.length&&(p=new xe(De(c.sps[0])),u.width=p.width,u.height=p.height),this.isHVCC=!0),this.videoTrackMeta=u,console.log("parse AVC_SEQUENCE_HEADER thisvideoTrackMeta isHVCC:%o, %o",this.isHVCC,this.videoTrackMeta),this.checkMetadata()}else{var p,d=[];if(t.codecId!==wt.H265||this.isHVCC){var h=X.extractAVCCNAL(t.data,3),f={type:I.VIDEO,id:2,baseDTS:0,basePTS:0,timescale:1e3,vps:[],sps:[],pps:[],sei:[],width:(null==(s=this.flvMetadata)?void 0:s.width)||0,height:(null==(l=this.flvMetadata)?void 0:l.height)||0,codec:"",pixelRatio:[],live:(null==(c=this.metadata)?void 0:c.live)||!1},y=[],_=[],g=[],v=[];h.forEach(function(e){var t=new w(e.buffer,e.byteOffset,e.length),r=new k(t);16<=r.nalType&&r.nalType<=23&&(o=!0),r.nalType<P.ACCESS_UNIT_DELIMITER&&(r.nalType===P.SPS?(t=new xe(De(t.readToUint8())),y.push(e),f.codec=t.codec,f.width=t.width,f.height=t.height):r.nalType===P.VPS?_.push(e):r.nalType===P.PPS?g.push(e):r.nalType===P.SEI?v.push(e):!L.isSafari||r.nalType===P.TRAIL_R||r.nalType===P.TRAIL_N||r.nalType===P.IDR_W_RADL||r.nalType===P.IDR_N_LP||r.nalType===P.CRA?d.push(e):console.warn("skip this nalu nalType:",r.nalType),a=k.isNonRefNALType(r.nalType))}),_.length&&(f.vps=_),y.length&&(f.sps=y),g.length&&(f.pps=g),v.length&&(f.sei=v),0<y.length&&(this.videoTrackMeta?(this.videoTrackMeta.vps=[],this.videoTrackMeta.sps=[],this.videoTrackMeta.pps=[],this.videoTrackMeta.sei=[],_.forEach(function(e){var t;return null==(t=i.videoTrackMeta)?void 0:t.vps.push(e)}),y.forEach(function(e){var t;return null==(t=i.videoTrackMeta)?void 0:t.sps.push(e)}),g.forEach(function(e){var t;return null==(t=i.videoTrackMeta)?void 0:t.pps.push(e)}),v.forEach(function(e){var t;return null==(t=i.videoTrackMeta)?void 0:t.sei.push(e)})):this.videoTrackMeta=f)}else{if(this.skipFrame===ce.NONREF&&k.isNonRefNALType(k.extractNALType(t.data,4)))return console.warn("skipFrame isNonRefNALType"),[];var h,m={type:I.VIDEO,id:2,baseDTS:0,basePTS:0,timescale:1e3,vps:[],sps:[],pps:[],sei:[],width:(null==(p=this.flvMetadata)?void 0:p.width)||0,height:(null==(s=this.flvMetadata)?void 0:s.height)||0,codec:"",pixelRatio:[],live:(null==(l=this.metadata)?void 0:l.live)||!1},S=[],b=[],T=[],E=[];(h=X.extractAnnexbNAL(t.data)).forEach(function(e){var t=new w(e.buffer,e.byteOffset,e.length),r=new k(t);16<=r.nalType&&r.nalType<=23&&(o=!0),r.nalType<P.ACCESS_UNIT_DELIMITER&&(r.nalType===P.SPS?(t=new xe(De(t.readToUint8())),S.push(e),m.codec=t.codec,m.width=t.width,m.height=t.height):r.nalType===P.VPS?b.push(e):r.nalType===P.PPS?T.push(e):r.nalType===P.SEI&&E.push(e)),a=k.isNonRefNALType(r.nalType),d.push(e)}),b.length&&(m.vps=b),S.length&&(m.sps=S),T.length&&(m.pps=T),E.length&&(m.sei=E),S.length&&(this.videoTrackMeta?(this.videoTrackMeta.vps=[],this.videoTrackMeta.sps=[],this.videoTrackMeta.pps=[],b.forEach(function(e){var t;return null==(t=i.videoTrackMeta)?void 0:t.vps.push(e)}),S.forEach(function(e){var t;return null==(t=i.videoTrackMeta)?void 0:t.sps.push(e)}),T.forEach(function(e){var t;return null==(t=i.videoTrackMeta)?void 0:t.pps.push(e)}),E.forEach(function(e){var t;return null==(t=i.videoTrackMeta)?void 0:t.sei.push(e)})):this.videoTrackMeta=m)}if(!this.videoLoaded&&this.videoTrackMeta){if(!o)return[];this.videoLoaded=!0,this.baseVideoDTS=e.dts,this.baseVideoPTS=t.cts+e.dts,this.checkMetadata()}this.videoTrackMeta&&o&&(this.videoTrackMeta.pps.forEach(function(e){return d.unshift(e)}),this.videoTrackMeta.sps.forEach(function(e){return d.unshift(e)}),this.videoTrackMeta.vps.forEach(function(e){return d.unshift(e)}),this.videoTrackMeta.sei.forEach(function(e){return d.unshift(e)})),d.length&&(p={trackId:2,codec:(null==(c=this.videoTrackMeta)?void 0:c.codec)||"",trackType:I.VIDEO,isSync:o||t.type===Et.KEY,isNonRef:a,data:d,dts:e.dts,pts:e.dts+t.cts,offset:r,size:d.reduce(function(e,t){return e+t.byteLength},0)},n.push(p))}else A.warn("[videox] flv parse empty data",e,t);return n},f.prototype.parseAudioBody=function(e,t,r){var i,t=new vt(t),n=(this.emit("loadedtag",{header:e,body:t}),[]);return t.packetType===yt.ADTS_HEADER?(i=new w(t.data.buffer,t.data.byteOffset,t.data.byteLength),i=vt.readAudioSpecificConfig(i),this.audioTrackMeta={id:1,baseDTS:0,basePTS:0,type:I.AUDIO,codec:"mp4a.40."+i.audioObjectType,timescale:1e3,audioObjectType:i.audioObjectType,sampleRate:i.sampleRate,samplingFrequencyIndex:i.samplingFrequencyIndex,sampleSize:t.sampleSize,channelCount:i.channelCount},this.checkMetadata()):(this.audioLoaded||(this.audioLoaded=!0,this.baseAudioDTS=e.dts,this.baseAudioPTS=e.dts,this.checkMetadata()),n.push({codec:(null==(i=this.audioTrackMeta)?void 0:i.codec)||"",trackId:1,trackType:I.AUDIO,isSync:!0,isNonRef:!1,data:[t.data],dts:e.dts,pts:e.dts,offset:r,size:t.data.byteLength})),n},f.prototype.parseScriptBody=function(e,t){t=new Pt(t),this.emit("loadedtag",{header:e,body:t}),e=t.value;e&&"onMetaData"===t.name&&(this.flvMetadata=e,A.info("flv script tag loaded, flv metadata:",this.flvMetadata))},f.prototype.onProgress=function(e){var t=e.data,e=e.offset;t.byteLength&&(t=this.parse(t.buffer,e)).length&&(e=void 0,this.cachePackets.length?(e=this.cachePackets.concat(t),this.cachePackets=[]):e=t,this.metadata&&this.loader.status!==d.SUSPENGING?this.emit("loadeddata",{packets:e}):this.cachePackets=e)},f.prototype.onLoadEnd=function(){this.loader.eof&&this.emit("end",void 0)},f.prototype.seek=function(){},f.prototype.reset=function(){Kt.prototype.reset.call(this),this.cachePackets=[],this.videoLoaded=!1,this.audioLoaded=!1,this.baseVideoDTS=0,this.baseVideoPTS=0,this.baseAudioDTS=0,this.baseAudioPTS=0,this.header=null,this.unhandleBuffer=null,this.flvMetadata=null,this.videoTrackMeta=null,this.audioTrackMeta=null};var It=f;Xt=function(e,t){return(Xt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Xt(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(tr,Gt=v);var h=tr;Wt=function(e,t){return(Wt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Wt(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(er,qt=h);var At=er;jt=function(e,t){return(jt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}jt(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Zt,Vt=At);var Lt=Zt;Bt=function(e,t){return(Bt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Bt(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Jt,Ft=v);var Rt=Jt;Ht=function(e,t){return(Ht=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Ht(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Qt,Ut=h);var Dt=Qt;Mt=function(e,t){return(Mt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Mt(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Yt,Nt=v);var Ot,Nt,Mt,Ut,Ht,Ft,Bt,Vt,jt,qt,Wt,Gt,Xt,Kt,zt,$t=Yt,p=(Ot=function(e,t){return(Ot=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Ot(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function Yt(e,t){var r=Nt.call(this,e,t)||this;r.entries=[],r.version=t.read(1),r.flag=t.read(3),r.entryCount=t.read(4);for(var i=0;i<r.entryCount;i++){var n=1===r.version;r.entries.push({segmentDuration:t.read(n?8:4),mediaTime:t.read(n?8:4),mediaRateInteger:t.read(2),mediaRateFraction:t.read(2)})}return r}function Qt(e,t){e=Ut.call(this,e,t)||this;return e.version=t.read(1),e.flag=t.read(3),e.entryCount=t.read(4),e}function Jt(e,t){e=Ft.call(this,e,t)||this;return e.bufferSizeDB=t.read(4),e.maxBitrate=t.read(4),e.avgBitrate=t.read(4),e}function Zt(){return null!==Vt&&Vt.apply(this,arguments)||this}function er(e,t){var e=qt.call(this,e,t)||this,r=(t.skip(4),t.skip(2),e.bitReferenceId=t.read(2),e.codeStreamVersion=t.read(4),t.skip(4),t.skip(8),e.width=t.read(2),e.heigth=t.read(2),e.horizontalResolution=t.read(4),e.verticalResolution=t.read(4),t.skip(4),e.frameCount=t.read(2),Math.min(t.read(1),32));return e.compressorName=Array.from(new Array(r)).map(function(){return String.fromCharCode(t.read(1))}).join(""),t.skip(32-(r+1)),e.depth=t.read(2),t.skip(2),e}function tr(){var e=null!==Gt&&Gt.apply(this,arguments)||this;return e.isContainer=!0,e}function f(){var e=null!==Kt&&Kt.apply(this,arguments)||this;return e.header=null,e.flvMetadata=null,e.videoTrackMeta=null,e.audioTrackMeta=null,e.unhandleBuffer=null,e.cachePackets=[],e.videoLoaded=!1,e.baseVideoPTS=0,e.baseVideoDTS=0,e.audioLoaded=!1,e.baseAudioPTS=0,e.baseAudioDTS=0,e.isHVCC=!1,e.formatType=g.FLV,e}(e=Ct=Ct||{})[e.OD=1]="OD",e[e.IOD=2]="IOD",e[e.ESD=3]="ESD",e[e.DCD=4]="DCD",e[e.DSD=5]="DSD",e[e.SLCD=6]="SLCD";{Ki.readSize=function(e){for(var t,r=0,i=4;i--&&(r=r<<7|127&(t=e.read(1)),128&t););return r},Ki.extractDescriptors=function(e){for(var t,r,i,n=[];e.unreadLength;){if(t=new Ki(e),i=new w(e.buffer,e.offset,t.size),e.skip(t.size),t.size<=0)return n;switch(t.tag){case Ct.ESD:r=new nr(t,i);break;case Ct.DCD:r=new or(t,i);break;case Ct.DSD:r=new ar(t,i);break;case Ct.SLCD:r=new sr(t,i);break;default:r=null}r&&i.unreadLength&&(r.children=Ki.extractDescriptors(i)),n.push(r)}return n};var R,rr=Ki,ir=(Xi.findDescriptor=function(e,t){var r;return e.some(function(e){return!!(r=e.probe.tag===t?e:Xi.findDescriptor(e.children,t))}),r},Xi),nr=(p(Gi,Si=ir),Gi),or=(p(Wi,mi=ir),Wi),ar=(p(qi,vi=ir),qi),sr=(p(ji,gi=ir),ji);_i=function(e,t){return(_i=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};var e,lr=((e=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}_i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Vi,yi=a),Vi);fi=function(e,t){return(fi=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};var p,cr=((p=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}fi(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Bi,hi=v),Bi);di=function(e,t){return(di=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};var e,ur=((e=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}di(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Fi,pi=At),Fi);ui=function(e,t){return(ui=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};var p,pr=((p=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ui(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Hi,ci=v),Hi);li=function(e,t){return(li=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};var e,dr=((e=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}li(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Ui,si=v),Ui);ai=function(e,t){return(ai=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};var p,hr=((p=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ai(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Mi,oi=v),Mi);ni=function(e,t){return(ni=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};var e,fr=((e=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ni(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Ni,ii=v),Ni);ri=function(e,t){return(ri=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};var p,yr=((p=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ri(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Oi,ti=h),Oi);ei=function(e,t){return(ei=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};var e,_r=((e=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ei(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Di,Zr=v),Di),gr=(Jr=function(e,t){return(Jr=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},Ri),vr=Qr=v;if("function"!=typeof vr&&null!==vr)throw new TypeError("Class extends value "+String(vr)+" is not a constructor or null");function mr(){this.constructor=gr}Jr(gr,vr),gr.prototype=null===vr?Object.create(vr):(mr.prototype=vr.prototype,new mr);var Sr=Ri}Yr=function(e,t){return(Yr=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Yr(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Li,$r=v);var br=Li;zr=function(e,t){return(zr=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}zr(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Ai,Kr=v);var Tr=Ai;Xr=function(e,t){return(Xr=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Xr(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Ii,Gr=v);var Er=Ii;Wr=function(e,t){return(Wr=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Wr(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(ki,qr=h);var wr=ki;jr=function(e,t){return(jr=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}jr(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Ci,Vr=h);var xr=Ci;Br=function(e,t){return(Br=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Br(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Pi,Fr=a);var Pr=Pi;Hr=function(e,t){return(Hr=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Hr(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(xi,Ur=h);var Cr=xi;Mr=function(e,t){return(Mr=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Mr(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(wi,Nr=a);var kr=wi;Or=function(e,t){return(Or=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Or(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Ei,Dr=a);var Ir=Ei;Rr=function(e,t){return(Rr=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Rr(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Ti,Lr=a);var Ar,Lr,Rr,Dr,Or,Nr,Mr,Ur,Hr,Fr,Br,Vr,jr,qr,Wr,Gr,Xr,Kr,zr,$r,Yr,Qr,Jr,Zr,ei,ti,ri,ii,ni,oi,ai,si,li,ci,ui,pi,di,hi,fi,yi,_i,gi,vi,mi,Si,bi=Ti,p=(Ar=function(e,t){return(Ar=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Ar(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function Ti(e,t){e=Lr.call(this,e,t)||this;return 1===e.version?e.baseMediaDecodeTime=t.read(8):e.baseMediaDecodeTime=t.read(4),e}function Ei(e,t){var r=Dr.call(this,e,t)||this;r.references=[],r.trackId=t.read(4),r.timescale=t.read(4),0===r.version?(r.pts=t.read(4),r.offset=t.read(4)):(r.pts=t.read(8),r.offset=t.read(8)),t.skip(2),r.references=[];for(var i=t.read(2),n=0;n<i;n++){var o=new x(t.read(4),32),a=t.read(4),s=new x(t.read(4),32);r.references.push({type:o.read(1),size:o.read(31),duration:a,startWithSap:s.read(1),sapType:s.read(3),sapDeltaTime:s.read(28)})}return r}function wi(e,t){var r=Nr.call(this,e,t)||this;r.isLeadings=[],r.sampleDependsOns=[],r.sampleIsDependedOns=[],r.sampleHasRedundancys=[];for(var i=0,n=void 0;i<t.unreadLength;i++)n=new x(t.read(1),8),r.isLeadings[i]=n.read(2),r.sampleDependsOns[i]=n.read(2),r.sampleIsDependedOns[i]=n.read(2),r.sampleHasRedundancys[i]=n.read(2);return r}function xi(){return null!==Ur&&Ur.apply(this,arguments)||this}function Pi(){return null!==Fr&&Fr.apply(this,arguments)||this}function Ci(){return null!==Vr&&Vr.apply(this,arguments)||this}function ki(){return null!==qr&&qr.apply(this,arguments)||this}function Ii(e,t){e=Gr.call(this,e,t)||this;return e.version=t.read(1),e.flag=t.read(3),e.graphicsMode=t.read(2),e.opcolor=[t.read(2),t.read(2),t.read(2)],e}function Ai(e,t){e=Kr.call(this,e,t)||this;return e.version=t.read(1),e.flag=t.read(3),e}function Li(e,t){var r=$r.call(this,e,t)||this;r.matrix=[],r.version=t.read(1),r.flag=t.read(3),r.createTime=r.toStandardTime(t.read(4)),r.modifyTime=r.toStandardTime(t.read(4)),r.trackId=t.read(4),t.skip(4),r.duration=t.read(4),t.skip(8),r.layer=t.read(2),r.alternateGroup=t.read(2),r.volume=Number(t.read(1)+"."+t.read(1)),t.skip(2);for(var i=0;i<9;i++)r.matrix.push(Number(t.read(2)+"."+t.read(2)));return r.width=Number(t.read(2)+"."+t.read(2)),r.height=Number(t.read(2)+"."+t.read(2)),r}function Ri(e,t){var r=Qr.call(this,e,t)||this;for(r.data=[];0<t.unreadLength;)r.data.push(t.read(1));return r}function Di(e,t){var r=Zr.call(this,e,t)||this;r.matrix=[],r.version=t.read(1),r.flag=t.read(3),r.createTime=r.toStandardTime(t.read(4)),r.modifyTime=r.toStandardTime(t.read(4)),r.timeScale=t.read(4),r.duration=t.read(4),r.rate=Number(t.read(2)+"."+t.read(2)),r.volume=Number(t.read(1)+"."+t.read(1)),t.skip(10);for(var i=0;i<9;i++)r.matrix.push(Number(t.read(2)+"."+t.read(2)));return t.skip(24),r.nextTrackId=t.read(4),r}function Oi(e,t){e=ti.call(this,e,t)||this;return t.skip(6),e.dataReferenceIndex=t.read(2),t.skip(8),e.channelCount=t.read(2),e.sampleSize=t.read(2),t.skip(4),e.sampleRate=t.read(4)>>>16,e}function Ni(e,t){function r(e){return 96+(31&e)}var e=ii.call(this,e,t)||this,i=(e.version=t.read(1),e.flag=t.read(3),1===e.version),i=(e.createTime=e.toStandardTime(t.read(i?8:4)),e.modifyTime=e.toStandardTime(t.read(i?8:4)),e.timeScale=t.read(4),e.duration=t.read(i?8:4),t.read(2));return e.language=String.fromCharCode(r(i>>10),r(i>>5),r(i)),e.quality=Number(t.read(1)+"."+t.read(1)),e}function Mi(e,t){var r=oi.call(this,e,t)||this;return r.data=t.readToUint8(e.size-e.length),r}function Ui(e,t){var r=si.call(this,e,t)||this;for(r.name="",r.version=t.read(1),r.flag=t.read(3),r.preDefined=String.fromCharCode(t.read(1),t.read(1),t.read(1),t.read(1)),r.handleType=String.fromCharCode(t.read(1),t.read(1),t.read(1),t.read(1)),t.skip(12);0<t.unreadLength;)r.name+=String.fromCharCode(t.read(1));return r}function Hi(e,t){var r=ci.call(this,e,t)||this,e=(r.generalTierFlag=0,r.generalProfileIdc=0,r.generalLevelIdc=0,r.bitDepthLumaMinus8=0,r.bitDepthChromaMinus8=0,r.avgFrameRate=0,r.nalus=[],r.vps=[],r.sps=[],r.pps=[],r.sei=[],r.codecTag="vvc1",t.skip(5),(p=new x(t.read(2),16)).read(9)),i=(console.log("ols_idx",e),p.read(3)),e=(console.log("num_sublayers",i),p.read(2)),n=p.read(2),e=(console.log("constant_frame_rate:",e),console.log("chroma_format_idc:",n),r.constantFrameRate=e,r.chromaFormatIdc=n,(p=new x(t.read(1),8)).skip(5),p.read(2));if(r.lengthSizeMinusOne=e,p.read(1)){(p=new x(t.read(2),16)).skip(2);var o=p.read(6),n=p.read(7),e=p.read(1),e=(r.generalTierFlag=e,r.generalProfileIdc=n,t.read(1)),n=(r.generalLevelIdc=e,(p=new x(t.read(1),8)).read(1)),e=p.read(1),a=(console.log("ptl_frame_only_constraint_flag:",n),console.log("ptl_multilayer_enabled_flag:",e),0),s=new Uint8Array(o);if(o){for(a=0;a<o-1;a++){var l=p.read(6),c=(p=new x(t.read(1),8)).read(2);s[a]=l<<2|c}s[o-1]=p.read(6)}else p.read(6);var u=0;if(1<i){for(var p=new x(t.read(1),8),d=0,u=i-2;0<=u;--u)d|=p.read(1)<<u;for(u=i;u<=8&&1<i;++u)p.read(1);for(u=i-2;0<=u;--u)d&1<<u&&(u,t.read(1))}var h=t.read(1),f=[];if(h)for(a=0;a<h;a++)f.push(t.readInt(1));var n=t.read(2),e=t.read(2),y=t.read(2);console.log("max_picture_width:",n),console.log("max_picture_height:",e),r.avgFrameRate=y}for(var _=[],g=t.read(1),v=0,m=0,v=0;v<g;v++){_.push([]);var S=(p=new x(t.read(1),8)).read(1),b=(p.skip(2),p.read(5)),T=[],E=1;for(13!=b&&12!=b&&(E=t.read(2)),m=0;m<E;m++)T.push(new Uint8Array(t.read(2)).map(function(){return t.read(1)}));_.push({completeness:S,nalu_type:b,data:T}),b===C.VVC_VPS_NUT?T.forEach(function(e){return r.vps.push(e)}):b===C.VVC_SPS_NUT?T.forEach(function(e){return r.sps.push(e)}):b===C.VVC_PPS_NUT&&T.forEach(function(e){return r.pps.push(e)})}return r.configVersion=0,r.codec="vvc1.1.L48.CA",r}function Fi(){return null!==pi&&pi.apply(this,arguments)||this}function Bi(e,t){var r=hi.call(this,e,t)||this;for(r.compatibleBrands=[],r.majorBrand=String.fromCharCode(t.read(1),t.read(1),t.read(1),t.read(1)),r.minorVersion=t.read(4);4<=t.unreadLength;)r.compatibleBrands.push(String.fromCharCode(t.read(1),t.read(1),t.read(1),t.read(1)));return r}function Vi(e,t){var e=yi.call(this,e,t)||this,t=(e.descriptors=[],e.audioObjectType=0,e.samplingFrequencyIndex=0,e.descriptors=rr.extractDescriptors(t),ir.findDescriptor(e.descriptors,Ct.DCD)),r=ir.findDescriptor(e.descriptors,Ct.DSD);return r&&(e.audioObjectType=r.audioObjectType,e.samplingFrequencyIndex=r.samplingFrequencyIndex),e.codec=t&&r?"mp4a."+t.mepg4Audio.toString(16)+"."+r.audioObjectType.toString(16):"mp4a",e}function ji(e,t){e=gi.call(this,e)||this;return e.esId=t.read(2),e}function qi(e,t){e=vi.call(this,e)||this,t=new x(t.read(2),16);return e.audioObjectType=t.read(5),e.samplingFrequencyIndex=t.read(4),e.channel=t.read(4),e.frameLengthFlag=t.read(1),e.dependsOnCoreCoder=t.read(1),e.extesionFlag=t.read(1),e}function Wi(e,t){e=mi.call(this,e)||this;return e.mepg4Audio=t.read(1),e.audioStream=t.read(1),e.bufferSize=t.read(3),e.maxBitrate=t.read(4),e.avgBitrate=t.read(4),e}function Gi(e,t){e=Si.call(this,e)||this;return e.streamDependenceFlag=0,e.URLFlag=0,e.OCRStreamFlag=0,e.esId=t.read(2),e.esFlag=t.read(1),128&e.esFlag&&(e.streamDependenceFlag=t.read(2)),64&e.esFlag&&(e.URLFlag=t.read(1),t.skip(e.URLFlag)),32&e.esFlag&&(e.OCRStreamFlag=t.read(2)),e}function Xi(e){this.children=[],this.probe=e}function Ki(e){this.tag=e.read(1),this.size=Ki.readSize(e)}(e=R=R||{})[e.BASE_DATA_OFFSET=1]="BASE_DATA_OFFSET",e[e.SAMPLE_DESC=2]="SAMPLE_DESC",e[e.SAMPLE_DUR=8]="SAMPLE_DUR",e[e.SAMPLE_SIZE=16]="SAMPLE_SIZE",e[e.SAMPLE_FLAG=32]="SAMPLE_FLAG",e[e.DUR_EMPTY=65536]="DUR_EMPTY",e[e.DEFAULT_BASE_IS_MOOF=131072]="DEFAULT_BASE_IS_MOOF";p(tn,Ji=a);var D,zi=tn;Qi=function(e,t){return(Qi=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Qi(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(en,Yi=a);var $i,Yi,Qi,Ji,Zi=en,e=($i=function(e,t){return($i=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}$i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function en(e,t){e=Yi.call(this,e,t)||this;return e.trackId=t.read(4),e.defaultSampleDescriptionIndex=t.read(4),e.defaultSampleDuration=t.read(4),e.defaultSampleSize=t.read(4),e.defaultSampleFlag=t.read(4),e}function tn(e,t){e=Ji.call(this,e,t)||this;return e.baseDataOffset=0,e.defaultSampleDescriptionIndex=0,e.defaultSampleDuration=0,e.defaultSampleSize=0,e.defaultSampleFlag=0,e.trackId=t.read(4),e.flag&R.BASE_DATA_OFFSET&&(e.baseDataOffset=t.read(8)),e.flag&R.SAMPLE_DESC&&(e.defaultSampleDescriptionIndex=t.read(4)),e.flag&R.SAMPLE_DUR&&(e.defaultSampleDuration=t.read(4)),e.flag&R.SAMPLE_SIZE&&(e.defaultSampleSize=t.read(4)),e.flag&R.SAMPLE_FLAG&&(e.defaultSampleFlag=t.read(4)),e}(p=D=D||{})[p.DATA_OFFSET=1]="DATA_OFFSET",p[p.FIRST_FLAG=4]="FIRST_FLAG",p[p.DURATION=256]="DURATION",p[p.SIZE=512]="SIZE",p[p.FLAG=1024]="FLAG",p[p.CTS_OFFSET=2048]="CTS_OFFSET";e(Qn,Un=a);var rn,nn=Qn;Mn=function(e,t){return(Mn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Mn(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Yn,Nn=v);var on=Yn;On=function(e,t){return(On=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}On(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})($n,Dn=v);var an=$n;Rn=function(e,t){return(Rn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Rn(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(zn,Ln=v);var sn=zn;An=function(e,t){return(An=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}An(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Kn,In=v);var ln=Kn;kn=function(e,t){return(kn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}kn(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Xn,Cn=h);var cn=Xn;Pn=function(e,t){return(Pn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Pn(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Gn,xn=h);var un=Gn;wn=function(e,t){return(wn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}wn(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Wn,En=v);var pn=Wn;Tn=function(e,t){return(Tn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};function dn(e){return Array.isArray(e)?e:e?[e]:[]}(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Tn(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(qn,bn=v);var hn=qn,fn=(jn.prototype.addTrack=function(e){this.tracks.push(e)},jn.prototype.getTracks=function(){return this.tracks},jn.prototype.getTrackById=function(t){return this.tracks.find(function(e){return e.options.id===t})},jn),yn=function(){return(yn=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},_n=(Vn.prototype.getSamples=function(){return this.samples},Vn.prototype.getNextSampleOffset=function(){var e=this.samples[this.nextSampleIndex];return e?e.offset:0},Vn.prototype.addSample=function(e){this.samples.push(e),this.duration+=e.duration},Vn.prototype.processNextSample=function(e,t){void 0===t&&(t=0);var r=this.samples[this.nextSampleIndex];if(r)return this.processSample(e,t,r)},Vn.prototype.processSample=function(e,t,r){var i=(t=void 0===t?0:t)+e.byteLength,t=r.offset-t;if(0<=t&&r.offset+r.size<=i)return this.nextSampleIndex++,yn(yn({},r),{data:e.subarray(t,t+r.size)})},Vn.prototype.processSamples=function(e,t){void 0===t&&(t=0);for(var r=this.samples,i=[],n=this.nextSampleIndex,o=r.length;n<o;n++){var a=this.processSample(e,t,r[n]);if(!a)break;i.push(a)}return i},Vn.prototype.seek=function(e){for(var t,r=e*this.options.timeScale,i=-1,n=-1,o=0,a=this.samples.length;o<a;o++)if((t=this.samples[o]).isSync&&(n=o),t.dts+t.cts>=r){i=n;break}if(-1<i)return this.nextSampleIndex=i,this.samples[i]},Vn),gn=(Bn.prototype.createMedia=function(e){return this._parseMoovJSON(e)},Bn.prototype._parseMoovJSON=function(s){var l=this,e=s.mvhd.box,c=new fn({duration:e.duration,timeScale:e.timeScale,rate:e.rate,modifyTime:e.modifyTime,createTime:e.createTime});return s.trak&&[].concat(s.trak).forEach(function(e){var t=e.tkhd,e=e.mdia,r=e.mdhd,i=e.hdlr,e=e.minf.stbl,t=t.box,i=i.box,r=r.box,n=Ie[i.handleType],e=l._buildSamples(e,n),o={id:t.trackId,name:i.name,handleType:i.handleType,type:n,createTime:t.createTime,modifyTime:t.modifyTime,layer:t.layer,volume:t.volume,matrix:t.matrix,duration:t.duration,width:t.width,height:t.height,timeScale:r.timeScale,language:r.language,quality:r.quality,defaultSampleDescriptionIndex:1,defaultSampleDuration:0,defaultSampleSize:0,defaultSampleFlag:0},n=null==(i=s.mvex)?void 0:i.trex,a=(n&&[].concat(n).forEach(function(e){e=e.box;o.defaultSampleDescriptionIndex=e.defaultSampleDescriptionIndex,o.defaultSampleDuration=e.defaultSampleDuration,o.defaultSampleSize=e.defaultSampleSize,o.defaultSampleFlag=e.defaultSampleFlag}),new _n(o));e.forEach(function(e){return a.addSample(e)}),c.addTrack(a)}),c},Bn.prototype._buildSamples=function(e,n){var o,a,s,l,c,u,p,d,h,f,y,_,g,v,m,S,b,t=e.stts,r=e.stss,i=e.ctts,T=e.stsc,E=e.stsz||e.stz2;return E?(u=e.stco||e.co64,p=T.box,d=null==r?void 0:r.box,h=t.box,f=null==i?void 0:i.box,v=g=_=y=-1,m=0,S=[],(b=E.box.sampleSizes).forEach(function(e,t){var r={},i=p.entries;r.size=e,r.trackType=n,0===t?(a=1,o=0,r.chunkIndex=a,c=i[r.chunkRunIndex=o].samplePerChunk,l=0,s=o+1<i.length?i[o+1].firstChunk-1:1/0):t<c?(r.chunkIndex=a,r.chunkRunIndex=o):(a++,l=0,s<(r.chunkIndex=a)&&(s=++o+1<i.length?i[o+1].firstChunk-1:1/0),c+=i[r.chunkRunIndex=o].samplePerChunk),r.descriptionIndex=i[o].sampleDescriptionIndex-1,r.offset=u.box.chunkOffsets[r.chunkIndex-1]+l,l+=r.size,y<t&&(_++,y=Math.max(y,0),y+=h.sampleCounts[_]),0<t?((e=S[t-1]).duration=h.sampleDurations[_],r.dts=S[t-1].dts+e.duration):r.dts=0,f?(g<=t&&(v++,g=Math.max(g,0),g+=f.sampleCounts[v]),r.cts=f.sampleOffsets[v]):r.cts=0,d?t===d.sampleNumbers[m]-1?(r.isSync=!0,m++):r.isSync=!1:r.isSync=!0,r.isLast=t===b.length-1,S.push(r)}),S):[]},Bn),vn=(Fn.prototype.init=function(e){this.options=e},Fn.prototype.parse=function(t){var r=this;dn(t.traf).forEach(function(e){return r._buildSamples(e,t.box)})},Fn.prototype._buildSamples=function(e,t){var r=e.tfhd.box,i=this._getTrakById(r.trackId);if(i)for(var n=i.options,o=e.tfdt.box,a=r.flag,s=(a&R.SAMPLE_DESC?r:n).defaultSampleDescriptionIndex,l=(a&R.SAMPLE_DUR?r:n).defaultSampleDuration,c=(a&R.SAMPLE_SIZE?r:n).defaultSampleSize,u=(a&R.SAMPLE_FLAG?r:n).defaultSampleFlag,p=dn(e.trun),d=n.id,h=n.type,f=a&R.BASE_DATA_OFFSET?r.baseDataOffset:a&R.DEFAULT_BASE_IS_MOOF?t.header.start:0,y=0,_=0;_<p.length;_++)for(var g=p[_].box,v=g.flag,m=g.dataOffset+f,S=0;S<g.sampleCount;S++){var b={},T=(b.trackId=d,b.trackType=h,b.descriptionIndex=s,v&D.SIZE?b.size=g.sampleSizes[S]:b.size=c,v&D.DURATION?b.duration=g.sampleDurations[S]:b.duration=l,b.dts=0<y?y:o?o.baseMediaDecodeTime:0,y=b.dts+b.duration,v&D.CTS_OFFSET?b.cts=g.sampleCTSs[S]:b.cts=0,u);v&D.FLAG?T=g.sampleFlags[S]:0===S&&v&D.FIRST_FLAG&&(T=g.firstSampleFlag),b.offset=m,b.flag=T,b.isSync=!(T&(E.IS_NON_SYNC|E.DEPENDS_YES)),b.isLeading=T>>26&3,b.dependsOn=T>>24&3,b.isDependedOn=T>>22&3,b.hasRedundancy=T>>20&3,b.degradationPriority=65535&T,m+=b.size,b.isLast=_===p.length-1&&S===g.sampleCount-1,i.addSample(b)}},Fn.prototype.destroy=function(){this.options=null},Fn);Sn=function(e,t){return(Sn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Sn(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(y,mn=t),y.probe=function(e){return!(e.byteLength<8)&&"ftyp"===[e[4],e[5],e[6],e[7]].map(function(e){return String.fromCharCode(e)}).join("")},y.prototype.processPackets=function(t,r){var e,i=this,n=[];return this.media&&t.byteLength&&(this.media.getTracks().forEach(function(e){e.processSamples(t,r).forEach(function(e){e=i.convertSampleToPacket(e);e&&n.push(e)})}),e=this.getMinNextSampleOffset()-r,this.unhandleBuffer=e>=t.byteLength?null:t.slice(e).buffer),n},y.prototype.seek=function(t){var e,r=this.options.progressive;this.unhandleBuffer=null,r&&this.loader.suspend(),null!=(e=this.media)&&e.getTracks().map(function(e){return e.seek(t)}),r&&this.loader.loadRange(this.getMinNextSampleOffset())},y.prototype.onProgress=function(e){var t=e.data,e=e.offset;t.length&&(this.unhandleBuffer&&(t=w.concatUint8(new Uint8Array(this.unhandleBuffer),t),e-=this.unhandleBuffer.byteLength,this.unhandleBuffer=null),this.metadata||this.parse(new w(t.buffer,0),e),this.metadata)&&((t=this.processPackets(t,e)).length&&this.emit("loadeddata",{packets:t}))},y.prototype.onLoadEnd=function(){this.loader.eof&&this.emit("end",void 0)},y.prototype.getMinNextSampleOffset=function(){return this.media?Math.min.apply(Math,this.media.getTracks().map(function(e){return e.getNextSampleOffset()})):0},y.prototype.parse=function(o,a){var s,l=this;void 0===a&&(a=0);for(var c=o.offset,u=0,p=this;8<=o.unreadLength;){var e=function(){var t,r,e,i,n;return u=o.offset-c,0===(t=new ke(o,a+u)).size?(e=new Error("box [".concat(t.type,"] size \u4e3a 0")),A.error(e),p.emit("error",{code:ue.PARSER,message:e.message,origin:e}),"break"):p.options.progressive&&"mdat"===t.type&&!p.metadata?(r=t.start+t.size,p.loader.suspend(),p.unhandleBuffer=null,A.info("\u68c0\u6d4b\u5230mdat box\u5728moov box\u4e4b\u540e\uff0c\u8df3\u8f6cmoov\u8d77\u59cb\u504f\u79fb\u4f4d"),p.loader.loadRange(r).then(function(e){e&&(l.unhandleBuffer=null,l.loader.jump(t.start),l.loader.status!==d.SUSPENGING)&&l.loader.loadRange(t.start,r)}),{value:void 0}):(e=t.size-t.length,o.unreadLength>=e?((n=U[t.type])?(i=new w(o.buffer,o.offset,e),(s=new n(t,i)).isContainer&&((n=new y({sub:!0})).proxy(p,["loadedbox"]),n.parse(i,u+a+t.length),n.removeAllListeners(),n.boxes.forEach(function(e){s.append(e)}))):s=new v(t),o.skip(e),p.boxes.push(s),void p.emit("loadedbox",s)):(o.back(t.length),"break"))}();if("object"==typeof e)return e.value;if("break"===e)break}o.unreadLength&&(this.unhandleBuffer=o.readToBuffer())},y.prototype.reset=function(){mn.prototype.reset.call(this),this.boxes=[],this.unhandleBuffer=null,this.avcCBox=void 0,this.hvcCBox=void 0,this.mp4aBox=void 0,this.media=null,this.moofParser.destroy()};var mn,Sn,bn,Tn,En,wn,xn,Pn,Cn,kn,In,An,Ln,Rn,Dn,On,Nn,Mn,Un,Hn=y;function y(e){var _=mn.call(this,e=void 0===e?{}:e)||this;return _.media=null,_.unhandleBuffer=null,_.formatType=g.MP4,_.boxes=[],_._handleBoxLoad=function(e){var t,o,a,s,l,c,u,p,d,h,f,r,i,y,n=e.header.type;"vvcC"===n?_.vvcCBox=e:"vvc1"===n?_.vvcCBox&&(_.vvcCBox.codecTag=n):"hvcC"===n?_.hvcCBox=e:"hvc1"===n||"hev1"===n?_.hvcCBox&&(_.hvcCBox.codecTag=n):"avcC"===n?_.avcCBox=e:"esds"===n?_.esdsBox=e:"mp4a"===n?_.mp4aBox=e:"moov"===n?(i=v.mapBoxToJSON(e),_.media=_.moovParser.createMedia(i),_.moofParser.init({media:_.media}),r=(i=_.mp4aBox||{}).sampleRate,o=void 0===r?0:r,r=i.sampleSize,a=void 0===r?0:r,r=i.channelCount,s=void 0===r?0:r,r=(i=_.esdsBox||{}).audioObjectType,l=void 0===r?0:r,r=i.samplingFrequencyIndex,c=void 0===r?0:r,r=i.codec,u=void 0===r?"":r,p=[],d=[],h=[],_.hvcCBox?(d=_.hvcCBox.vps,h=_.hvcCBox.pps,p=_.hvcCBox.sps):_.vvcCBox?(h=_.vvcCBox.pps,p=_.vvcCBox.sps,p=_.vvcCBox.sps):_.avcCBox&&(h=_.avcCBox.pps,p=_.avcCBox.sps),r=(i=_.options).live,i=i.progressive,y=(null==(t=_.avcCBox)?void 0:t.codec)||"",_.vvcCBox?(y=_.vvcCBox.codec,f=_.vvcCBox?_.vvcCBox.codecTag:void 0):_.hvcCBox&&(y=_.hvcCBox?_.hvcCBox.codec:(null==(t=_.avcCBox)?void 0:t.codec)||"",f=_.hvcCBox?_.hvcCBox.codecTag:void 0),_.metadata={formatType:g.MP4,live:!!r,progressive:!r&&!!i,url:_.loader.url,basePTS:0,baseDTS:0,duration:_.media.options.duration,timescale:_.media.options.timeScale,tracks:_.media.getTracks().map(function(e){var t,r,i,n={};switch(n.id=e.options.id,n.type=e.options.type,n.timescale=e.options.timeScale,n.baseDTS=0,n.basePTS=0,n.type){case I.VIDEO:n.width=e.options.width,n.height=e.options.height,n.vps=d,n.sps=p,n.pps=h,n.rotate=(t=e.options.matrix).length<5||(r=Math.hypot(t[0],t[3]),i=Math.hypot(t[1],t[4]),0===r)||0===i?0:180*Math.atan2(t[1]/i,t[0]/r)/Math.PI,n.pixelRatio=[],n.codec=y,n.codecTag=f,n.fps=_.computeFps(e,null==(i=_.media)?void 0:i.options);break;case I.AUDIO:n.audioObjectType=l,n.sampleRate=o,n.samplingFrequencyIndex=c,n.sampleSize=a,n.channelCount=s,n.codec=u;break;default:n.type=I.UNKNOWN}return n})},A.info("loadedmetadata metadata:",_.metadata),_.emit("loadedmetadata",_.metadata)):"moof"===n&&(A.info("\u68c0\u6d4b\u5230moof box\u88ab\u52a0\u8f7d\uff0c\u5f53\u524d\u7d20\u6750\u4e3afMP4"),_.moofParser.parse(v.mapBoxToJSON(e)))},_.computeFps=function(e,t){return t?e.getSamples().length/(t.duration/t.timeScale):0},_.convertSampleToPacket=function(e){var t,r,i,n,o;return e.trackType===I.VIDEO&&(_.hvcCBox||_.avcCBox||_.vvcCBox)?(o=e.data,t=e.isSync,r=(i=_.hvcCBox||_.avcCBox||_.vvcCBox).lengthSizeMinusOne,i=i.codec,n=X.extractAVCCNAL(o,r),o=!1,_.hvcCBox&&(o=n.every(function(e){return k.isNonRef(e)})),_.vvcCBox&&(o=n.every(function(e){re.isNonRef(e)})),t&&(_.hvcCBox?(_.hvcCBox.pps.forEach(function(e){return n.unshift(e)}),_.hvcCBox.sps.forEach(function(e){return n.unshift(e)}),_.hvcCBox.vps.forEach(function(e){return n.unshift(e)})):_.vvcCBox?(_.vvcCBox.pps.forEach(function(e){return n.unshift(e)}),_.vvcCBox.sps.forEach(function(e){return n.unshift(e)}),_.vvcCBox.vps.forEach(function(e){return n.unshift(e)})):_.avcCBox&&(_.avcCBox.pps.forEach(function(e){return n.unshift(e)}),_.avcCBox.sps.forEach(function(e){return n.unshift(e)}))),{codec:i,trackId:e.trackId,trackType:e.trackType,isLast:e.isLast,dts:e.dts,pts:e.cts+e.dts,isSync:e.isSync,isNonRef:o,data:n,size:n.reduce(function(e,t){return e+t.byteLength},0),offset:e.offset}):e.trackType===I.AUDIO&&_.esdsBox?{codec:_.esdsBox.codec,trackId:e.trackId,trackType:e.trackType,dts:e.dts,pts:e.cts+e.dts,isLast:e.isLast,isSync:!0,isNonRef:!1,data:[e.data],size:e.data.byteLength,offset:e.offset}:void 0},_.options=e,_.moovParser=new gn,_.moofParser=new vn,e.sub||_.on("loadedbox",_._handleBoxLoad),_}function Fn(){var r=this;this.options=null,this._getTrakById=function(t){var e;return null==(e=r.options)?void 0:e.media.getTracks().find(function(e){return e.options.id===t})}}function Bn(){}function Vn(e){this.samples=[],this.nextSampleIndex=0,this.duration=0,this.options=e}function jn(e){this.tracks=[],this.options=e}function qn(e,t){var r=bn.call(this,e,t)||this;r.sampleCounts=[],r.sampleDurations=[],r.version=t.read(1),r.flag=t.read(3);for(var i=t.read(4),n=0;n<i;n++)r.sampleCounts[n]=t.read(4),r.sampleDurations[n]=t.read(4);return r}function Wn(e,t){var r=En.call(this,e,t)||this;r.isContainer=!0,r.sampleSizes=[],r.version=t.read(1),r.flag=t.read(3),r.sampleSize=t.read(4);for(var i=t.read(4),n=0;n<i;n++)0===r.sampleSize?r.sampleSizes.push(t.read(4)):r.sampleSizes.push(r.sampleSize);return r}function Gn(e,t){var r=xn.call(this,e,t)||this;r.sampleNumbers=[],r.version=t.read(1),r.flag=t.read(3);for(var i=t.read(4),n=0;n<i;n++)r.sampleNumbers.push(t.read(4));return r}function Xn(e,t){e=Cn.call(this,e,t)||this;return e.version=t.read(1),e.flag=t.read(3),e.entryCount=t.read(4),e}function Kn(e,t){var r=In.call(this,e,t)||this;r.entries=[],r.version=t.read(1),r.flag=t.read(3);for(var i=t.read(4),n=0;n<i;n++)r.entries.push({firstChunk:t.read(4),samplePerChunk:t.read(4),sampleDescriptionIndex:t.read(4)});return r}function zn(e,t){var r=Ln.call(this,e,t)||this;r.chunkOffsets=[],r.version=t.read(1),r.flag=t.read(3);for(var i=t.read(4),n=0;n<i;n++)r.chunkOffsets.push(t.read(8));return r}function $n(e,t){var r=Dn.call(this,e,t)||this;r.chunkOffsets=[],r.version=t.read(1),r.flag=t.read(3);for(var i=t.read(4),n=0;n<i;n++)r.chunkOffsets.push(t.read(4));return r}function Yn(e,t){var r=Nn.call(this,e,t)||this;r.sampleCounts=[],r.sampleOffsets=[],r.version=t.read(1),r.flag=t.read(3),r.entryCount=t.read(4);for(var i=0;i<r.entryCount;i++)r.sampleCounts.push(t.read(4)),r.sampleOffsets.push(t.readInt(4));return r}function Qn(e,t){var r=Un.call(this,e,t)||this;r.sampleDurations=[],r.sampleSizes=[],r.sampleFlags=[],r.sampleCTSs=[],r.sampleCount=t.read(4),r.flag&D.DATA_OFFSET?r.dataOffset=t.readInt(4):r.dataOffset=0,r.flag&D.FIRST_FLAG?r.firstSampleFlag=t.read(4):r.firstSampleFlag=0;for(var i=0;i<r.sampleCount;i++)r.flag&D.DURATION&&(r.sampleDurations[i]=t.read(4)),r.flag&D.SIZE&&(r.sampleSizes[i]=t.read(4)),r.flag&D.FLAG&&(r.sampleFlags[i]=t.read(4)),r.flag&D.CTS_OFFSET&&(0===r.version?r.sampleCTSs[i]=t.read(4):r.sampleCTSs[i]=t.readInt(4));return r}(p=rn=rn||{})[p.H264=27]="H264",p[p.H265=36]="H265",p[p.AAC=15]="AAC";var Jn={1:I.VIDEO,2:I.VIDEO,3:I.AUDIO,4:I.AUDIO,5:I.UNKNOWN,6:I.UNKNOWN,7:I.UNKNOWN,8:I.UNKNOWN,9:I.UNKNOWN,10:I.UNKNOWN,11:I.UNKNOWN,12:I.UNKNOWN,13:I.UNKNOWN,14:I.UNKNOWN,15:I.AUDIO,16:I.VIDEO,17:I.AUDIO,18:I.UNKNOWN,19:I.UNKNOWN,20:I.UNKNOWN,21:I.UNKNOWN,22:I.UNKNOWN,23:I.UNKNOWN,24:I.UNKNOWN,25:I.UNKNOWN,26:I.UNKNOWN,27:I.VIDEO,28:I.AUDIO,29:I.UNKNOWN,30:I.VIDEO,31:I.UNKNOWN,32:I.UNKNOWN,33:I.VIDEO,36:I.VIDEO,66:I.UNKNOWN,127:I.UNKNOWN,128:I.AUDIO,129:I.AUDIO,130:I.AUDIO,131:I.AUDIO,132:I.AUDIO,133:I.AUDIO,134:I.AUDIO,135:I.AUDIO,144:I.UNKNOWN,145:I.UNKNOWN,192:I.UNKNOWN,193:I.AUDIO,194:I.AUDIO,207:I.UNKNOWN,209:I.VIDEO,210:I.VIDEO,219:I.UNKNOWN,234:I.VIDEO};var Zn,eo=function(e){this.programs=[],this.tableId=e.read(1);var t=new x(e.read(2),16),t=(this.sectionSyntaxIndicator=t.read(1),t.skip(1),t.skip(2),this.sectionLength=t.read(12),this.transportStreamId=e.read(2),new x(e.read(1),8));t.skip(2),this.versionNumber=t.read(5),this.currentNextIndicator=t.read(1),this.sectionNumber=e.read(1),this.lastSectionNumber=e.read(1);for(var r=0;r<this.sectionLength-12;r+=4)this.programs.push({number:e.read(2),pid:8191&e.read(2)});this.crc32=e.read(4)},to=function(e){this.streamId=e.read(1),this.pesPacketLength=e.read(2);var t=new x(e.read(2),16),t=(t.skip(2),this.pesScramblingControl=t.read(2),this.pesPriority=t.read(1),this.dataAlignmentIndicator=t.read(1),this.copyright=t.read(1),this.originalOrCopy=t.read(1),this.ptsDtsFlags=t.read(2),this.esCRFlag=t.read(1),this.esRateFlag=t.read(1),this.dsmTrickModeFlag=t.read(1),this.additionalCopyInfoFlag=t.read(1),this.pesCRCFlag=t.read(1),this.pesExtensionFlag=t.read(1),this.pesHeaderDataLength=e.read(1),e.offset),t=(2&this.ptsDtsFlags?(this.pts=(14&e.read(1))<<27|e.read(2)>>>1<<13|e.read(2)>>>3,this.pts*=4,e.back(1),this.pts+=(6&e.read(1))>>>1,1&this.ptsDtsFlags?(this.dts=(14&e.read(1))<<27|e.read(2)>>>1<<13|e.read(2)>>>3,this.dts*=4,e.back(1),this.dts+=(6&e.read(1))>>>1):this.dts=this.pts):(this.pts=0,this.dts=0),this.pesHeaderDataLength-(e.offset-t));0<t&&e.skip(t),this.data=e.readToUint8()},ro=function(e){this.streams=[],this.tableId=e.read(1);var t=new x(e.read(2),16),t=(this.sectionSyntaxIndicator=t.read(1),t.skip(1),t.skip(2),this.sectionLength=t.read(12),this.programNumber=e.read(2),new x(e.read(1),8));t.skip(2),this.versionNumber=t.read(5),this.currentNextIndicator=t.read(1),this.sectionNumber=e.read(1),this.lastSectionNumber=e.read(1),this.pcrPid=8191&e.read(2),this.programInfoLength=4095&e.read(2);for(var r=12+this.programInfoLength;r<=this.sectionLength-2;r+=5){var i={streamType:e.read(1),pid:8191&e.read(2),esInfoLength:4095&e.read(2)};this.streams.push(i),e.skip(i.esInfoLength),r+=i.esInfoLength}this.crc32=e.read(4)};(e=Zn=Zn||{})[e.PAT=0]="PAT",e[e.CAT=1]="CAT",e[e.TSDT=2]="TSDT";po.SYNC_BYTE=71;var io,no,oo=po,p=Fo(378),ao=Fo.n(p),so=(Object.freeze({formatType:g.UNKNOWN,live:!1,progressive:!1,url:"",basePTS:0,baseDTS:0,timescale:0,duration:0,tracks:[]}),Object.freeze({type:I.VIDEO,id:0,baseDTS:0,basePTS:0,timescale:1e3,codec:"",width:0,height:0,vps:[],pps:[],sps:[],sei:[],pixelRatio:[],fps:0,live:!1})),lo=Object.freeze({type:I.AUDIO,id:1,baseDTS:0,basePTS:0,timescale:1e3,codec:"",audioObjectType:2,samplingFrequencyIndex:0,sampleRate:0,sampleSize:16,channelCount:0}),co=(Object.defineProperty(uo.prototype,"size",{get:function(){return this.list.length},enumerable:!1,configurable:!0}),uo.prototype.write=function(e){this.list.push(e)},uo.prototype.read=function(){return this.list.shift()},uo.prototype.readAll=function(){var e=this.list;return this.list=[],e},uo.prototype.clear=function(){this.list=[]},uo),e=(no=function(e,t){return(no=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}no(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function uo(){this.list=[]}function po(e){var t=new x(e.read(4),32);this.syncByte=t.read(8),this.errorIndicator=t.read(1),this.payloadUnitStartIndicator=t.read(1),this.transportPriority=t.read(1),this.pid=t.read(13),this.transportScramblingControl=t.read(2),this.adaptationFlag=t.read(1),this.payloadFlag=t.read(1),this.continueCounter=t.read(4),this.adaptationFlag&&(t=e.read(1),e.skip(t)),this.payloadUnitStartIndicator&&e.skip(1)}(p=io=io||{})[p.UNKNOWN=0]="UNKNOWN",p[p.PAT=1]="PAT",p[p.PES=2]="PES",p[p.PMT=3]="PMT";e(b,Eo=t),b.probe=function(e){if(e.byteLength<1)return!1;for(var t=0,r=e.byteLength;t<r;t+=188)if(e[t]!==oo.SYNC_BYTE)return!1;return!0},b.prototype.splitToTsPacket=function(e){this.unhandleBuffer&&this.unhandleBuffer.byteLength&&(e=w.concat(this.unhandleBuffer,e),this.unhandleBuffer=void 0);for(var t=new Uint8Array(e),r=t.byteLength,i=0;i+188<=r;){if(t[i]!==oo.SYNC_BYTE){var n=new Uint8Array(t.buffer,i).findIndex(function(e){return e===oo.SYNC_BYTE});if(console.warn("[videox] mpegts sync byte error",t[i],i,n),-1<n){i+=n;continue}break}this.parseTsPacket(t.subarray(i,i+188)),i+=188}i<r&&(this.unhandleBuffer=e.slice(i))},b.prototype.parseTsPacket=function(e){var t,e=w.fromUint8(e),r=new oo(e),i=null;r.pid===Zn.PAT?(i=new eo(e),this.patPrograms=i.programs,this.emitTSPacket(io.PAT,r,i)):this.patPrograms.some(function(e){return e.pid===r.pid})?(i=new ro(e),(t=ie()(this.pmtStreams,i.streams))&&this.emitPackets(),this.metadataChanged=t,this.pmtStreams=i.streams,this.emitTSPacket(io.PMT,r,i)):(t=this.pmtStreams.find(function(e){return e.pid===r.pid}))?(r.payloadUnitStartIndicator&&this.parsePes(),this.prevPesSegments.push(e.readToUint8()),this.prevPesTSHeader=r,this.prevPmtStream=t):this.emitTSPacket(io.UNKNOWN,r,i)},b.prototype.parsePes=function(){var e,t=this.prevPmtStream;this.prevPesSegments.length&&this.prevPesTSHeader&&t&&(e=w.fromUint8(w.concatUint8s(this.prevPesSegments)),this.prevPesSegments=[],1===e.read(2))&&(e=new to(e),this.emitTSPacket(io.PES,this.prevPesTSHeader,e),t.streamType===rn.H265||t.streamType===rn.H264?this.parseVideoPes(e,t):t.streamType===rn.AAC&&this.parseAudioPes(e,t))},b.prototype.parseVideoPes=function(e,t){var r=Math.round(e.dts/90),i=Math.round(e.pts/90),n=t.streamType===rn.H265,o={},a=!0,s=!1,l=[],c=[],u=[],p=[];if(X.extractAnnexbNAL(e.data).forEach(function(e){var t,r,i=w.fromUint8(e);e.length<2||(n?(r=new k(i)).nalType<P.ACCESS_UNIT_DELIMITER&&(r.nalType>=P.VPS&&(r.nalType===P.SPS?(s=!0,t=new xe(De(i.readToUint8())),o.width=t.width,o.height=t.height,o.pixelRatio=t.pixelRatio,o.codec=t.codec,c.push(e)):r.nalType===P.VPS?u.push(e):r.nalType===P.PPS&&p.push(e)),!L.isSafari||r.nalType===P.TRAIL_R||r.nalType===P.TRAIL_N||r.nalType===P.IDR_W_RADL||r.nalType===P.IDR_N_LP||r.nalType===P.CRA||r.nalType===P.SPS||r.nalType===P.VPS||r.nalType===P.PPS||r.nalType===P.SEI?l.push(e):console.warn("skip this nalu nalType:",r.nalType),a=k.isNonRefNALType(r.nalType)&&a):((r=new Q(i)).nalType<$.DIVIDER&&(r.nalType===$.SPS?(s=!0,t=new Te(De(i.readToUint8())),o.width=t.width,o.height=t.height,o.pixelRatio=t.pixelRatio,o.codec=t.codec,c.push(e)):r.nalType===$.PPS&&p.push(e),l.push(e)),a=!1))}),!this.videoLoaded){if(!s)return;this.videoLoaded=!0,o.baseDTS=r,o.basePTS=i}u.length&&(o.vps=u),c.length&&(o.sps=c),p.length&&(o.pps=p),this.videoMetadata?(this.metadataChanged=ne(this.videoMetadata,o),this.metadataChanged&&this.emit("updatedtrackmetadata",this.videoMetadata)):(this.videoMetadata=ao()({},so,o),this.metadataChanged=!0),this.checkMetadataChanged(),this.packetQueue.write({trackId:t.pid,codec:this.videoMetadata.codec,trackType:I.VIDEO,isSync:s,isNonRef:a,data:l,dts:r,pts:i,size:l.reduce(function(e,t){return e+t.byteLength},0)})},b.prototype.parseAudioPes=function(e,r){var t,i,n,o=this,a={},s=Math.round(e.dts/90),l=Math.round(e.pts/90),e=(this.audioLoaded||(this.audioLoaded=!0,a.baseDTS=s,a.basePTS=l),W(e.data));e.length&&(t=e[0],i="mp4a.40."+t.audioObjectType,a.codec=i,a.audioObjectType=t.audioObjectType,a.sampleRate=t.sampleRate,a.channelCount=t.channelCount,this.audioMetadata?(this.metadataChanged=ne(this.audioMetadata,a),this.metadataChanged&&this.emit("updatedtrackmetadata",this.audioMetadata)):(this.audioMetadata=ao()({},lo,a),this.metadataChanged=!0),this.checkMetadataChanged(),n=Math.round(9e4*F/t.sampleRate/90),e.forEach(function(e,t){o.packetQueue.write({trackId:r.pid,codec:i,trackType:I.AUDIO,isSync:!0,isNonRef:!0,data:[e.data],dts:n*t+s,pts:n*t+l,size:e.data.byteLength})}))},b.prototype.checkMetadataChanged=function(){var t,e,r=this;return this.pmtStreams.length&&this.metadataChanged&&(t=[],this.pmtStreams.every(function(e){e=Jn[e.streamType];return e===I.VIDEO?(r.videoMetadata&&t.push(r.videoMetadata),!(!r.videoMetadata||!r.videoMetadata.codec)):e!==I.AUDIO||(r.audioMetadata&&t.push(r.audioMetadata),!(!r.audioMetadata||!r.audioMetadata.codec))}))&&(e={formatType:g.MPEGTS,live:!1,progressive:!!this.options.progressive,url:this.loader.url,basePTS:Math.min.apply(Math,t.map(function(e){return e.basePTS||0})),baseDTS:Math.min.apply(Math,t.map(function(e){return e.baseDTS||0})),timescale:1e3,duration:0,tracks:t},this.metadataChanged=!1,this.metadata?ne(this.metadata,e)&&this.emit("updatedmetadata",this.metadata):(this.metadata=e,this.emit("loadedmetadata",this.metadata))),this.metadataChanged},b.prototype.emitTSPacket=function(e,t,r){A.debug("loadedtspacket","type:",io[e],"header:",t,"payload:",r),this.emit("loadedtspacket",{type:e,header:t,payload:r})},b.prototype.emitPackets=function(){var e;this.metadata&&this.loader.status!==d.SUSPENGING&&!this.metadataChanged&&0<this.packetQueue.size&&(e=this.packetQueue.readAll(),this.emit("loadeddata",{packets:e}))},b.prototype.continuousLoad=function(e){return this.loader.load(e)},b.prototype.parse=function(e){this.splitToTsPacket(e),this.emitPackets()},b.prototype.onProgress=function(e){e.data.byteLength&&this.parse(e.data.buffer)},b.prototype.onLoadEnd=function(){this.parsePes(),this.emitPackets(),this.loader.eof&&this.emit("end",void 0)},b.prototype.resume=function(){return this.options.progressive?Eo.prototype.resume.call(this):Vo.resolve(!1)},b.prototype.flush=function(){this.unhandleBuffer=void 0,this.prevPesTSHeader=void 0,this.prevPmtStream=void 0,this.prevPesSegments=[]},b.prototype.seek=function(){this.reset(),this.loader.jump(0)},b.prototype.reset=function(){Eo.prototype.reset.call(this),this.flush(),this.audioLoaded=!1,this.videoLoaded=!1,this.packetQueue.clear(),this.patPrograms=[],this.pmtStreams=[],this.metadata=null,this.audioMetadata=void 0,this.videoMetadata=void 0,this.metadataChanged=!1};var ho=b;To=function(e,t){return(To=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};var fo=function(){return(fo=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},yo={M3U:/^#EXTM3U/,INF:/^#EXTINF:?([0-9\.]*)?,?(.*)?(?:\n|\r\n)(.*)$/,X_TARGETDURATION:/^#EXT-X-TARGETDURATION:?([0-9.]*)?/,X_VERSION:/^#EXT-X-VERSION:?([0-9.]*)?/,X_MEDIA_SEQUENCE:/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/,X_DISCONTINUITY_SEQUENCE:/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/,X_PLAYLIST_TYPE:/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/,X_BYTERANGE:/^#EXT-X-BYTERANGE:?(.*)?$/,X_ALLOW_CACHE:/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/,X_MAP:/^#EXT-X-MAP:?(.*)$/,X_STREAM_INF:/^#EXT-X-STREAM-INF:?(.*)$/,X_MEDIA:/^#EXT-X-MEDIA:?(.*)$/,X_ENDLIST:/^#EXT-X-ENDLIST/,X_DISCONTINUITY:/^#EXT-X-DISCONTINUITY/,X_PROGRAM_DATE_TIME:/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/,X_KEY:/^#EXT-X-KEY:?(.*)$/,X_START:/^#EXT-X-START:?(.*)$/,X_CUE_OUT_CONT:/^#EXT-X-CUE-OUT-CONT:?(.*)?$/,X_CUE_OUT:/^#EXT-X-CUE-OUT:?(.*)?$/,X_CUE_IN:/^#EXT-X-CUE-IN:?(.*)?$/,X_SKIP:/^#EXT-X-SKIP:(.*)$/,X_PART:/^#EXT-X-PART:(.*)$/,X_SERVER_CONTROL:/^#EXT-X-SERVER-CONTROL:(.*)$/,X_PART_INF:/^#EXT-X-PART-INF:(.*)$/,X_PRELOAD_HINT:/^#EXT-X-PRELOAD-HINT:(.*)$/,X_RENDITION_REPORT:/^#EXT-X-RENDITION-REPORT:(.*)$/},_o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}To(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(S,bo=t),S.probe=function(e){var t;return 7<=e.byteLength&&(t=[],e.forEach(function(e){return t.push(String.fromCharCode(e))}),yo.M3U.test(t.join("")))},Object.defineProperty(S.prototype,"status",{get:function(){return this.loader.eof?this.mpegtsParser.status===d.IDLE?this.shouldContinuousLoad?d.LOADING:d.SUSPENGING:this.mpegtsParser.status:this.loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"duration",{get:function(){return this.isLive?1/0:Math.round(1e3*this.segments.reduce(function(e,t){return e+t.duration},0))},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"currentSegment",{get:function(){return this.segments[this.currSegmentIndex]},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"prevSegmentsTotalDuration",{get:function(){return this.segments.slice(0,this.currSegmentIndex).reduce(function(e,t){return e+t.duration},0)},enumerable:!1,configurable:!0}),S.prototype.insertSegment=function(t){var e=!this.segments.some(function(e){return e.uri===t.uri});return e&&this.segments.push(t),e},S.prototype.onProgress=function(e){this.bufferSegments.push(e)},S.prototype.onLoadEnd=function(){var r,e,i,n,o,a=this;this.loader.eof&&(e=w.concatUint8s(this.bufferSegments.map(function(e){return e.data})),this.bufferSegments=[],e.byteLength&&(e=(new TextDecoder).decode(e).split(/\n#/).map(function(e){return"#"+e.trim()}),i=0,o=n=!1,e.forEach(function(e){var t=e.match(yo.INF);t?(t={sequence:i,duration:parseFloat(t[1]),uri:new URL(t[3],a.url).href,discontinuity:o},a.insertSegment(t),a.emit("loadedsegment",t)):(r=e.match(yo.X_MEDIA_SEQUENCE))?i=Number(r[1]):yo.X_ENDLIST.test(e)?n=!0:yo.X_DISCONTINUITY.test(e)&&(o=!0)}),this.discontinuity=o,this.isLive=!n,this.segments.length||this.emit("error",{code:ue.PARSER,message:"M3U8\u6587\u4ef6\u65e0TS\u6570\u636e"}),this.prevManifestLoadedTime=Date.now(),this.loadSegment()),A.info("hls manifest loaded, all segments length:",this.segments.length))},S.prototype.loadSegment=function(){var e,t,r=this;return this.shouldContinuousLoad?(e=this.segments[this.currSegmentIndex],this.isLive&&!e?(t=1e3*this.m3u8UpdateDuration-(Date.now()-this.prevManifestLoadedTime))<=0?this.loader.load(this.loader.url):new Vo(function(e){clearTimeout(r.fetchTimer),r.fetchTimer=setTimeout(function(){e(r.loader.load(r.loader.url))},t)}):e?(this.cachePackets=[],this.m3u8UpdateDuration=e.duration||2,this.currSegmentStartPTS=void 0,this.mpegtsParser.continuousLoad(e.uri)):(this.ended=!0,Vo.resolve(!1))):Vo.resolve(!1)},S.prototype.suspend=function(){clearTimeout(this.fetchTimer),this.shouldContinuousLoad=!1},S.prototype.resume=function(){var e;return this.cachePackets.length?(e=this.cachePackets,this.cachePackets=[],this.emit("loadeddata",{packets:e}),Vo.resolve(!1)):this.shouldContinuousLoad||this.ended?Vo.resolve(!1):(this.shouldContinuousLoad=!0,this.loader.eof?this.mpegtsParser.loader.status===d.LOADING||this.mpegtsParser.loader.status===d.ERROR?Vo.resolve(!0):this.loadSegment():bo.prototype.resume.call(this))},S.prototype.seek=function(t){this.ended=!1;var r=0,e=this.segments.findIndex(function(e){return r+=e.duration,t<r});this.currSegmentIndex=-1<e?e:this.segments.length-1,this.cachePackets=[],this.bufferSegments=[],this.mpegtsParser.suspend(),this.mpegtsParser.flush(),this.shouldContinuousLoad=!0,this.loadSegment()},S.prototype.reset=function(){clearTimeout(this.fetchTimer),bo.prototype.reset.call(this),this.discontinuity=!1,this.cachePackets=[],this.bufferSegments=[],this.shouldContinuousLoad=!0,this.mpegtsParser.reset(),this.segments=[],this.currSegmentIndex=0,this.isLive=!1,this.ended=!1},S.prototype.destroy=function(){bo.prototype.destroy.call(this),this.mpegtsParser.loader.removeAllListeners(),this.mpegtsParser.destroy()},S),p=Fo(801),go=Fo.n(p);So=function(e,t){return(So=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};function vo(e,t,r){if(r||2===arguments.length)for(var i,n=0,o=t.length;n<o;n++)!i&&n in t||((i=i||Array.prototype.slice.call(t,0,n))[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function _(e){return e.split("").map(function(e){return e.charCodeAt(0)})}var mo,So,bo,To,Eo,wo=function(){return(wo=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},xo=["loadedmetadata","updatedmetadata","updatedtrackmetadata","loadeddata","error","end"],Po=[Hn,_o,It,ho],Co=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}So(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(m,mo=Ge),m.prototype.createLoader=function(){var e=new et(this.options);return e.proxy(this,["progress","error"]),e.proxyOnce(this,["loadstart","loadend"]),e.once("progress",this.handleFirstLoadData),e},m.prototype.createParser=function(e){e=new e(wo(wo({},this.options),{loader:this.loader}));return e.proxy(this,xo),e},Object.defineProperty(m.prototype,"skipFrame",{get:function(){return this.activeParser.skipFrame},set:function(e){A.info("\u8bbe\u7f6eskipFrame:",e),go()(e)||(this.options.skipFrame=e,this.activeParser.skipFrame=e)},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"status",{get:function(){return this.activeParser.status},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"url",{get:function(){return this.loader.url},enumerable:!1,configurable:!0}),m.prototype.parse=function(e){A.info("\u6267\u884cparse"),this.loader.reset(),this.handleFirstLoadData({offset:0,data:e}),this.activeParser.onLoadEnd()},m.prototype.load=function(e){return A.info("\u6267\u884cload",e),this.loader.destroy(),this.loader=this.createLoader(),this.loader.load(e)},m.prototype.seek=function(e){return A.info("\u6267\u884cseek",e),this.activeParser.seek(e)},m.prototype.suspend=function(){return this.activeParser.suspend()},m.prototype.resume=function(){return this.activeParser.resume()},m.prototype.destroy=function(){A.info("\u6267\u884cdestory"),this.loader.destroy(),this.activeParser.destroy(),this.removeAllListeners()},m);function m(e){void 0===e&&(e={});var i=mo.call(this)||this;return i.loader=new et,i.parserClasses=Po,i.logger=A,i.handleFirstLoadData=function(t){var e,r;t&&((r=i.parserClasses.find(function(e){return e.probe(t.data)}))?(e=i.activeParser.formatType,i.activeParser.destroy(),i.activeParser=i.createParser(r),A.info("\u5207\u6362parser, ".concat(g[e]," -> ").concat(g[i.activeParser.formatType])),i.emit("parserchange",void 0),i.activeParser.onProgress(t)):(r="\u672a\u627e\u5230\u5bf9\u5e94\u7684Parser, Byte\u6570\u636e: "+t.data.slice(0,20).join(","),A.error(r),i.emit("error",{code:ue.PARSER,message:r})))},i.options=e,i.loader=i.createLoader(),i.activeParser=i.createParser(i.parserClasses[0]),i.logger.info("demuxer options",e),i}function S(e){var o=bo.call(this,e)||this;return o.mpegtsParser=new ho({progressive:!0,timeout:o.options.timeout}),o.currSegmentIndex=0,o.isLive=!1,o.shouldContinuousLoad=!0,o.ended=!1,o.prevManifestLoadedTime=0,o.fetchTimer=-1,o.discontinuity=!1,o.m3u8UpdateDuration=2,o.bufferSegments=[],o.cachePackets=[],o.formatType=g.HLS,o.segments=[],o.handleTSEnd=function(){o.currSegmentIndex>=o.segments.length-1&&o.emit("end",void 0)},o.handleTSLoadedMetadata=function(e){void 0===o.basePTS&&(o.basePTS=e.basePTS),void 0===o.baseDTS&&(o.baseDTS=e.baseDTS);e=fo(fo({},e),{formatType:g.HLS,live:o.isLive,progressive:!0,basePTS:o.basePTS,baseDTS:o.baseDTS,duration:o.duration,url:o.loader.url,discontinuity:o.discontinuity});o.metadata?ne(o.metadata,e)&&o.emit("updatedmetadata",o.metadata):(o.metadata=e,o.emit("loadedmetadata",o.metadata))},o.handleTSLoadedData=function(e){var t,r,i,n,e=e.packets;e.length&&(null!=(t=o.currentSegment)&&t.discontinuity&&(t=e.slice().sort(function(e,t){return e.pts-t.pts}),void 0===o.currSegmentStartPTS&&(o.currSegmentStartPTS=t[0].pts),r=o.currSegmentStartPTS,i=Math.round(1e3*o.prevSegmentsTotalDuration)+(o.basePTS||0),t.forEach(function(e){var t=e.dts-e.pts;e.pts=i+e.pts-r,e.dts=e.pts+t})),o.cachePackets.length?(n=o.cachePackets.concat(e),o.cachePackets=[]):n=e,o.shouldContinuousLoad?o.emit("loadeddata",{packets:n}):o.cachePackets=n)},o.handleTSLoadEnd=function(){o.currSegmentIndex++,o.loadSegment()},o.mpegtsParser.on("loadedmetadata",o.handleTSLoadedMetadata),o.mpegtsParser.on("updatedmetadata",o.handleTSLoadedMetadata),o.mpegtsParser.on("loadeddata",o.handleTSLoadedData),o.mpegtsParser.on("end",o.handleTSEnd),o.mpegtsParser.loader.on("loadend",o.handleTSLoadEnd),o.mpegtsParser.loader.proxy(o,["error"]),o.mpegtsParser.proxy(o,["updatedtrackmetadata"]),o}function b(){var e=null!==Eo&&Eo.apply(this,arguments)||this;return e.patPrograms=[],e.pmtStreams=[],e.prevPesSegments=[],e.packetQueue=new co,e.audioLoaded=!1,e.videoLoaded=!1,e.metadataChanged=!1,e.metadata=null,e.formatType=g.MPEGTS,e}T.prototype.create=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var i=new Uint8Array(8),n=[i].concat(t.map(function(e){return new Uint8Array(e)})),o=n.reduce(function(e,t){return e+t.byteLength},0),a=new w(i.buffer);return a.write(4,o),_(e).forEach(function(e){return a.write(1,e)}),w.concatUint8s(n)},T.prototype.avc1=function(e){var t=e.pixelRatio,r=e.vps,i=new ArrayBuffer(78),n=new w(i),t=(n.write(4,0),n.write(2,0),n.write(2,1),n.write(4,0),n.write(4,0),n.write(4,0),n.write(4,0),n.write(2,e.width),n.write(2,e.height),n.write(4,4718592),n.write(4,4718592),n.write(4,0),n.write(2,1),n.write(1,12),_("@ali/splayer").forEach(function(e){return n.write(1,e)}),n.skip(19),n.write(2,24),n.write(2,65535),2===t.length?this.pasp(t[0],t[1]):[]);return r.length?this.create("hvc1",i,this.hvcC(e),t):this.create("avc1",i,this.avcC(e),t)},T.prototype.avcC=function(e){var t=e.sps,e=e.pps,r=[],i=[],t=(r.push(t.length),t.forEach(function(e){r.push(e.byteLength>>>8&255),r.push(255&e.byteLength),e.forEach(function(e){return r.push(e)})}),i.push(e.length),e.forEach(function(e){i.push(e.byteLength>>>8&255),i.push(255&e.byteLength),e.forEach(function(e){return i.push(e)})}),new ArrayBuffer(5)),e=new w(t);return e.write(1,1),e.write(1,r[4]||0),e.write(1,r[5]||0),e.write(1,r[6]||0),e.write(1,255),this.create("avcC",t,r,i)},T.prototype.btrt=function(){var e=new ArrayBuffer(12),t=new w(e);return t.write(4,1875072),t.write(4,3e6),t.write(4,3e6),this.create("btrt",e)},T.prototype.pasp=function(e,t){var r=new ArrayBuffer(8),i=new w(r);return i.write(4,e),i.write(4,t),this.create("pasp",r)},T.prototype.dinf=function(){return this.create("dinf",this.dref())},T.prototype.dref=function(){var e=new ArrayBuffer(8),t=new w(e);return t.write(4,0),t.write(4,1),this.create("dref",e,this.url())},T.prototype.esds=function(e){var t=e.audioObjectType,r=e.sampleRate,e=e.channelCount,i=new ArrayBuffer(33),n=new w(i),o=5<=t,a=(n.write(4,0),n.write(1,3),n.write(1,o?27:25),n.write(2,1),n.write(1,0),n.write(1,4),n.write(1,o?19:17),n.write(1,64),n.write(1,21),n.write(3,0),n.write(4,0),n.write(4,0),n.write(1,5),n.write(1,o?4:2),H.findIndex(function(e){return r===e}));return n.write(1,t<<3|(14&a)>>1),o?(n.write(1,(1&(t=a))<<7|e<<3|(14&t)>>1),n.write(1,(1&t)<<7|8),n.write(1,0)):n.write(1,(1&a)<<7|e<<3),n.back(4),n.skip(4),n.write(1,6),n.write(1,1),n.write(1,2),this.create("esds",i)},T.prototype.ftyp=function(){var e=new ArrayBuffer(16),t=new w(e);return _("isom").forEach(function(e){return t.write(1,e)}),t.write(4,1),_("isom").forEach(function(e){return t.write(1,e)}),_("avc1").forEach(function(e){return t.write(1,e)}),this.create("ftyp",e)},T.prototype.hdlr=function(e){var t=new ArrayBuffer(37),r=new w(t);return r.skip(8),e===I.VIDEO?_("vide").forEach(function(e){return r.write(1,e)}):e===I.AUDIO&&_("soun").forEach(function(e){return r.write(1,e)}),r.skip(12),e===I.VIDEO?_("VideoHandler").forEach(function(e){return r.write(1,e)}):e===I.AUDIO&&_("SoundHandler").forEach(function(e){return r.write(1,e)}),r.write(1,0),this.create("hdlr",t)},T.prototype.hvcC=function(e){var t=e.vps,r=e.sps,e=e.pps,i=[],t=[{type:P.VPS,data:t},{type:P.SPS,data:r},{type:P.PPS,data:e}],e=(t.forEach(function(e){var t=e.type,e=e.data;i.push(128|t),i.push(e.length>>>8&255),i.push(255&e.length),e.forEach(function(e){i.push(e.byteLength>>>8&255),i.push(255&e.byteLength),e.forEach(function(e){return i.push(e)})})}),new ArrayBuffer(23)),n=new w(e),o=r.length?r[0]:[];n.write(1,1);for(var a=1;a<12;a++)n.write(1,o[a]||0);return n.write(1,0),n.write(2,0),n.write(1,0),n.write(1,1),n.write(1,0),n.write(1,0),n.write(2,0),n.write(1,15),n.write(1,t.length),this.create("hvcC",e,i)},T.prototype.mdat=function(e){return this.create("mdat",e)},T.prototype.mdhd=function(e){var t=new ArrayBuffer(24),r=new w(t);return r.write(4,0),r.write(4,0),r.write(4,0),r.write(4,e.timescale),r.write(4,0),r.write(2,21956),r.write(2,0),this.create("mdhd",t)},T.prototype.mdia=function(e){return this.create("mdia",this.mdhd(e),this.hdlr(e.type),this.minf(e))},T.prototype.mfhd=function(e){var t=new ArrayBuffer(8),r=new w(t);return r.write(4,0),r.write(4,e),this.create("mfhd",t)},T.prototype.minf=function(e){var t=e.type===I.VIDEO?this.vmhd():this.smhd();return this.create("minf",t,this.dinf(),this.stbl(e))},T.prototype.moof=function(e,t,i){var n=this,t=this.mfhd(t),o=8+t.byteLength+60*e.tracks.length+16*i.length+8,e=e.tracks.map(function(t){var e=i.filter(function(e){return e.trackType===t.type}),r=n.traf(t,e,o);return o+=e.reduce(function(e,t){return e+t.size},0),r});return this.create.apply(this,vo(["moof",t],e,!1))},T.prototype.moov=function(e){var t=this,r=e.tracks.map(function(e){return t.trak(e)});return this.create.apply(this,vo(vo(["moov",this.mvhd(e)],r,!1),[this.mvex(e)],!1))},T.prototype.mp4a=function(e){var t=new ArrayBuffer(28),r=new w(t);return r.write(4,0),r.write(2,0),r.write(2,1),r.write(4,0),r.write(4,0),r.write(2,e.channelCount),r.write(2,e.sampleSize),r.write(4,0),r.write(4,e.sampleRate<<16),this.create("mp4a",t,this.esds(e))},T.prototype.mvex=function(e){var t=this;return this.create.apply(this,vo(["mvex"],e.tracks.map(function(e){return t.trex(e)}),!1))},T.prototype.mvhd=function(e){var t=new ArrayBuffer(100),r=new w(t);return r.write(4,0),r.write(4,0),r.write(4,0),r.write(4,e.timescale),r.write(4,e.duration),r.write(2,1),r.skip(2),r.write(1,1),r.skip(1),r.skip(10),[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0].forEach(function(e){return r.write(1,e)}),r.skip(24),r.write(4,4294967295),this.create("mvhd",t)},T.prototype.sdtp=function(e){var t=e.length,r=new ArrayBuffer(4+t),i=new w(r);i.write(4,0);for(var n=0;n<t;n++){var o=e[n];i.write(1,o.flag)}return this.create("sdtp",r)},T.prototype.smhd=function(){var e=new ArrayBuffer(8),t=new w(e);return t.write(4,0),t.write(4,0),this.create("smhd",e)},T.prototype.stbl=function(e){return this.create("stbl",this.stsd(e),this.stts(),this.stsc(),this.stsz(),this.stco())},T.prototype.stco=function(){var e=new ArrayBuffer(8),t=new w(e);return t.write(4,0),t.write(4,0),this.create("stco",e)},T.prototype.stsc=function(){var e=new ArrayBuffer(8),t=new w(e);return t.write(4,0),t.write(4,0),this.create("stsc",e)},T.prototype.stsd=function(e){var t=new ArrayBuffer(8),r=new w(t);return r.write(4,0),r.write(4,1),e.type===I.VIDEO?this.create("stsd",t,this.avc1(e)):e.type===I.AUDIO?this.create("stsd",t,this.mp4a(e)):this.create("stsd",t)},T.prototype.stsz=function(){var e=new ArrayBuffer(12),t=new w(e);return t.write(4,0),t.write(4,0),t.write(4,0),this.create("stsz",e)},T.prototype.stts=function(){var e=new ArrayBuffer(8),t=new w(e);return t.write(4,0),t.write(4,0),this.create("stts",e)},T.prototype.tkhd=function(e){var t=new ArrayBuffer(84),r=new w(t);return r.write(4,7),r.write(4,0),r.write(4,0),r.write(4,e.id),r.write(4,0),r.write(4,0),r.write(4,0),r.write(4,0),r.write(4,0),r.write(1,0),r.write(1,0),r.write(2,0),[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0].forEach(function(e){return r.write(1,e)}),r.write(2,e.width||0),r.write(2,0),r.write(2,e.height||0),r.write(2,0),this.create("tkhd",t)},T.prototype.tfdt=function(e){var t=new ArrayBuffer(8),r=new w(t);return r.write(4,0),r.write(4,e),this.create("tfdt",t)},T.prototype.tfhd=function(e){var t=new ArrayBuffer(8),r=new w(t);return r.write(4,0),r.write(4,e.id),this.create("tfhd",t)},T.prototype.traf=function(e,t,r){void 0===r&&(r=0);var i=t.length?t[0].dts:0;return this.create("traf",this.tfhd(e),this.tfdt(i),this.trun(t,r))},T.prototype.trak=function(e){return this.create("trak",this.tkhd(e),this.mdia(e))},T.prototype.trex=function(e){var t=new ArrayBuffer(24),r=new w(t);return r.write(4,0),r.write(4,e.id),r.write(4,1),r.write(4,0),r.write(4,0),r.write(4,65537),this.create("trex",t)},T.prototype.trun=function(e,t){var r=e.length,i=new ArrayBuffer(12+16*r),n=new w(i);n.write(4,3841),n.write(4,e.length),n.write(4,t);for(var o=0;o<r;o++){var a=e[o];n.write(4,a.duration),n.write(4,a.size),n.write(4,a.flag),n.write(4,a.cts)}return this.create("trun",i)},T.prototype.vmhd=function(){var e=new ArrayBuffer(12),t=new w(e);return t.write(4,1),t.write(2,0),t.write(2,0),t.write(2,0),t.write(2,0),this.create("vmhd",e)},T.prototype.url=function(){var e=new ArrayBuffer(4);return new w(e).write(4,1),this.create("url ",e)};var ko=T;function T(){}Ao.createSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return new Uint8Array},Ao.FRAME_DURATION=1024;var Io=Ao;function Ao(){}N.prototype.updateConfig=function(e){Object.assign(this.config,e)},N.prototype.createInitSegment=function(){var e=w.concatUint8(this.generator.ftyp(),this.generator.moov(this.config));return this.offset=e.byteLength,e},N.prototype.createSegment=function(i){var n,e,o=this;return i.length?(n=[],this.config.tracks.forEach(function(t){var e,r=i.filter(function(e){return e.trackType===t.type});r.length&&(e=null,t.type===I.VIDEO?e=o.recaculateVideoSamples(r,t):t.type===I.AUDIO&&(e=o.recaculateAudioSamples(r,t)),e)&&(n.push(o.generator.moof(o.config,++o.sequenceNumber,e)),n.push(o.generator.mdat(w.concatUint8s(e.map(function(e){return e.data})))))}),e=w.concatUint8s(n),this.offset+=e.byteLength,e):new Uint8Array},N.prototype.createSlientFrames=function(e,t,r,i){var n=[];if(1.5*i<r){this.logger.warn("remux audio found pts hole at pts:",e,"timestamp:",(e-this.config.basePTS)/t.timescale,"gap duration:",r,"sample duration:",i);for(var o=Io.createSilentFrame(t.codec,t.channelCount),a=Math.ceil(r/i),s=0;s<a;s++)n.push({flag:E.DEPENDS_NO,trackType:I.AUDIO,dts:e+i*s,cts:0,duration:i,size:o.byteLength,data:o,isSync:!0});n.length&&(n[n.length-1].duration=r-(a-1)*i)}return n},N.prototype.recaculateAudioSamples=function(e,t){var r=[];this.prevAudioPacket&&(e.unshift(this.prevAudioPacket),this.prevAudioPacket=void 0);var i,n,o=Math.round(Io.FRAME_DURATION/t.sampleRate*t.timescale);!this.audioInited&&e.length&&(this.audioInited=!0,n=e[0].pts-this.config.basePTS,this.createSlientFrames(this.config.basePTS,t,n,o).forEach(function(e){r.push(e)}));for(var a,s,l=0,c=0,u=e.length;l<u;l++){if(i=e[l],a=e[l+1]){if((c=a.dts-i.dts)<0){if(!((a=e.findIndex(function(e){return i.dts<e.dts}))>l+1))break;c=e[a].dts-i.dts,l=a-1,this.logger.warn("remux audio found pts overlap at pts:",i.pts,"timestamp:",(i.pts-(this.config.basePTS||0))/t.timescale,"gap duration:",c,"sample duration:",o)}}else{if(!i.isLast||!r.length){this.prevAudioPacket=i;break}c=r[r.length-1].duration}0<c&&((a=this.createSlientFrames(i.pts+o,t,c-o,o)).length&&(c=o),s=w.concatUint8s(i.data),r.push({flag:E.DEPENDS_NO,trackType:I.AUDIO,size:s.byteLength,dts:i.dts,cts:i.pts-i.dts,duration:c,data:s,isSync:!0}),a.forEach(function(e){r.push(e)}))}return r.length&&this.recaculateSample(r[0],this.config.baseDTS),r},N.prototype.recaculateVideoSamples=function(o,a){var t;this.prevVideoPacket&&(o.unshift(this.prevVideoPacket),this.prevVideoPacket=void 0),this.videoInited||(this.videoInited=!0,t=Math.min.apply(Math,o.map(function(e){return e.pts})),o.find(function(e){return e.pts===t}).pts=this.config.basePTS);for(var s,l,c,u,p=[],d=this,e=0,r=0,i=0,n=o.length;e<n;e++){var h=function(e,t,r,i){if(s=o[e],l=o[e+1]){if((r=l.dts-s.dts)<0){for(l.dts=s.dts,t=e+1;t<i-1;t++)o[t].dts>o[t+1].dts&&(o[t+1].dts=o[t].dts);d.logger.warn("remux video found pts overlap at pts:",s.pts,"timestamp:",(s.pts-d.config.basePTS)/a.timescale,"gap packet number:",t-e,"gap duration:",r),r=0}}else{if(!s.isLast||!p.length)return d.prevVideoPacket=s,c=t,u=r,"break";r=p[p.length-1].duration}var n;0<=r&&(n=[],s.data.forEach(function(e){n.push(Q.createAVCCStartCode(e.length),e)}),e=w.concatUint8s(n),p.push({flag:s.isSync?E.DEPENDS_NO:E.IS_NON_SYNC|E.DEPENDS_YES,trackType:I.VIDEO,size:e.byteLength,dts:s.dts,cts:s.pts-s.dts,duration:r,data:e,isSync:s.isSync})),c=t,u=r}(e,r,i,n),r=c,i=u;if("break"===h)break}return p.length&&this.recaculateSample(p[0],this.config.baseDTS),p},N.prototype.recaculateSample=function(e,t){t=e.dts-t;return e.dts=t,e},N.prototype.flush=function(){this.prevAudioPacket=void 0,this.prevVideoPacket=void 0};var Lo=N;No=function(e,t){return(No=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}No(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})(Ho,Oo=Ge),Ho.prototype.end=function(){this.emit("end",void 0)},Ho.prototype.pipe=function(t,r){return r?this.on("data",function(e){return t.write(r(e))}):this.on("data",function(e){return t.write(e)}),this.on("end",function(){return t.end()}),t};e=Ho;Do=function(e,t){return(Do=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};var Ro,Do,Oo,No,Mo=function(){return(Mo=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},Uo=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Do(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(O,Ro=e),O.prototype.remux=function(e,t){var r=this.remuxerMap.get(e);r&&t.length&&this.emit("data",{type:e,buffer:r.createSegment(t).buffer,eos:!!t[t.length-1].isLast})},O.prototype.eos=function(){var r=this;this.pendingPacketsMap.forEach(function(e,t){r.pendingPacketsMap.delete(t),r.remux(t,e)})},O.prototype.writeMetadata=function(e){var t=this;(this.metadata=e).tracks.forEach(function(e){return t.writeTrackMetadata(e)})},O.prototype.writeTrackMetadata=function(e){this.eos();var t=this.remuxerMap.get(e.type);t&&(t.updateConfig(Mo(Mo({},this.metadata),{tracks:[e]})),this.emit("data",{type:e.type,buffer:t.createInitSegment().buffer,eos:!1}))},O.prototype.write=function(e){var r=this,e=e.packets,i=this.pendingPacketsMap;e.forEach(function(e){var t=i.get(e.trackType);t?(t.push(e),10<=t.length&&(i.set(e.trackType,[]),r.remux(e.trackType,t))):i.set(e.trackType,[e])})},O.prototype.flush=function(){this.remuxerMap.forEach(function(e){return e.flush()}),this.pendingPacketsMap.clear()},O.prototype.end=function(){this.eos(),Ro.prototype.end.call(this)},O);function O(){var e=Ro.call(this)||this;return e.remuxerMap=new Map,e.pendingPacketsMap=new Map,e.metadata={},e.remuxerMap.set(I.VIDEO,new Lo),e.remuxerMap.set(I.AUDIO,new Lo),e}function Ho(){return null!==Oo&&Oo.apply(this,arguments)||this}function N(){this.logger=new ve("remux"),this.generator=new ko,this.config={formatType:g.MP4,live:!1,progressive:!1,url:"",basePTS:0,baseDTS:0,timescale:0,duration:0,tracks:[]},this.sequenceNumber=0,this.offset=0,this.videoInited=!1,this.audioInited=!1,this.lastPacketMap=new Map}}(),Bo;function Fo(e){var t=i[e];return void 0!==t||(t=i[e]={id:e,loaded:!1,exports:{}},r[e](t,t.exports,Fo),t.loaded=!0),t.exports}var r,i,Bo},"object"==typeof r&&"object"==typeof t?t.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof r?r.VideoxMuxer=i():e.VideoxMuxer=i()},{"es6-promise":8}],53:[function(e,t,r){function a(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return(t>>>0).toString()}var s=e("./vttparse");t.exports={parse:function(e,t,r){var i,e=e.trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),n=[],o=new s;o.oncue=function(e){e.id=a(e.startTime)+a(e.endTime)+a(e.text),e.text=decodeURIComponent(escape(e.text)),e.isBig=!1;var t=e.text.split("#xywh=");2==t.length&&(t=t[1].split(","),e.x=t[0],e.y=t[1],e.w=t[2],e.h=t[3],e.isBig=!0),0<e.endTime&&n.push(e)},o.onparsingerror=function(e){i=e},o.onflush=function(){i&&r?(r(i),console.log(i)):t(n)},e.forEach(function(e){o.parse(e+"\n")}),o.flush()}}},{"./vttparse":55}],54:[function(e,t,r){function S(e){return"string"==typeof e&&!!n[e.toLowerCase()]&&e.toLowerCase()}function b(e){for(var t=1;t<arguments.length;t++){var r,i=arguments[t];for(r in i)e[r]=i[r]}return e}function i(e,t,r){var i=this,n=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),o={},a=(n?i=document.createElement("custom"):o.enumerable=!0,i.hasBeenReset=!1,""),s=!1,l=e,c=t,u=r,p=null,d="",h=!0,f="auto",y="start",_=50,g="middle",v=50,m="middle";if(Object.defineProperty(i,"id",b({},o,{get:function(){return a},set:function(e){a=""+e}})),Object.defineProperty(i,"pauseOnExit",b({},o,{get:function(){return s},set:function(e){s=!!e}})),Object.defineProperty(i,"startTime",b({},o,{get:function(){return l},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");l=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"endTime",b({},o,{get:function(){return c},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");c=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"text",b({},o,{get:function(){return u},set:function(e){u=""+e,this.hasBeenReset=!0}})),Object.defineProperty(i,"region",b({},o,{get:function(){return p},set:function(e){p=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"vertical",b({},o,{get:function(){return d},set:function(e){e="string"==typeof(e=e)&&!!T[e.toLowerCase()]&&e.toLowerCase();if(!1===e)throw new SyntaxError("An invalid or illegal string was specified.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"snapToLines",b({},o,{get:function(){return h},set:function(e){h=!!e,this.hasBeenReset=!0}})),Object.defineProperty(i,"line",b({},o,{get:function(){return f},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");f=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"lineAlign",b({},o,{get:function(){return y},set:function(e){e=S(e);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"position",b({},o,{get:function(){return _},set:function(e){if(e<0||100<e)throw new Error("Position must be between 0 and 100.");_=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"positionAlign",b({},o,{get:function(){return g},set:function(e){e=S(e);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");g=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"size",b({},o,{get:function(){return v},set:function(e){if(e<0||100<e)throw new Error("Size must be between 0 and 100.");v=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"align",b({},o,{get:function(){return m},set:function(e){e=S(e);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");m=e,this.hasBeenReset=!0}})),i.displayState=void 0,n)return i}var T,n;t.exports="undefined"!=typeof window&&window.VTTCue?window.VTTCue:(T={"":!0,lr:!0,rl:!0},n={start:!0,middle:!0,end:!0,left:!0,right:!0},i.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},i)},{}],55:[function(e,t,r){function i(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}}var s=e("./vttcue");function n(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new i,this.regionList=[]}function l(){this.values=Object.create(null)}function c(e,t,r,i){var n,o,a=i?e.split(i):[e];for(n in a)"string"==typeof a[n]&&2===(o=a[n].split(r)).length&&t(o[0],o[1])}l.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var i=0;i<r.length;++i)if(t===r[i]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(e,t),!0)}};var u=new s(0,0,0),p="middle"===u.align?"middle":"center";function d(i,e,o){var t,a,n=i;function r(){var e,t=(t=(t=i).match(/^(\d+):(\d{2})(:\d{2})?(\.\d{3})?/))?(e=(e=t[4])&&e.replace(".",""),t[3]?r(t[1],t[2],t[3].replace(":",""),e):59<t[1]?r(t[1],t[2],0,e):r(0,t[1],t[2],e)):null;function r(e,t,r,i){return 3600*(0|e)+60*(0|t)+(0|r)+(0|i)/1e3}if(null===t)throw new Error("Malformed timestamp: "+n);return i=i.replace(/^[^\sa-zA-Z-]+/,""),t}function s(){i=i.replace(/^\s+/,"")}if(s(),e.startTime=r(),s(),"--\x3e"!==i.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);i=i.substr(3),s(),e.endTime=r(),s(),t=i,e=e,a=new l,c(t,function(e,t){switch(e){case"region":for(var r=o.length-1;0<=r;r--)if(o[r].id===t){a.set(e,o[r].region);break}break;case"vertical":a.alt(e,t,["rl","lr"]);break;case"line":var i=t.split(","),n=i[0];a.integer(e,n),a.percent(e,n)&&a.set("snapToLines",!1),a.alt(e,n,["auto"]),2===i.length&&a.alt("lineAlign",i[1],["start",p,"end"]);break;case"position":i=t.split(","),a.percent(e,i[0]),2===i.length&&a.alt("positionAlign",i[1],["start",p,"end","line-left","line-right","auto"]);break;case"size":a.percent(e,t);break;case"align":a.alt(e,t,["start",p,"end","left","right"])}},/:/,/\s/),e.region=a.get("region",null),e.vertical=a.get("vertical",""),"auto"===(t=a.get("line","auto"))&&-1===u.line&&(t=-1),e.line=t,e.lineAlign=a.get("lineAlign","start"),e.snapToLines=a.get("snapToLines",!0),e.size=a.get("size",100),e.align=a.get("align",p),"auto"===(t=a.get("position","auto"))&&50===u.position&&(t="start"===e.align||"left"===e.align?0:"end"===e.align||"right"===e.align?100:50),e.position=t}n.prototype={parse:function(e){var i=this;function t(){for(var e=0,t=(t=i.buffer).replace(/<br(?: \/)?>/gi,"\n");e<t.length&&"\r"!==t[e]&&"\n"!==t[e];)++e;var r=t.substr(0,e);return"\r"===t[e]&&++e,"\n"===t[e]&&++e,i.buffer=t.substr(e),r}e&&(i.buffer+=i.decoder.decode(e,{stream:!0}));try{if("INITIAL"===i.state){if(!/\r\n|\n/.test(i.buffer))return this;var r,n=(r=t()).match(/^WEBVTT([ \t].*)?$/);if(!n||!n[0])throw new Error("Malformed WebVTT signature.");i.state="HEADER"}for(var o=!1;i.buffer;){if(!/\r\n|\n/.test(i.buffer))return this;switch(o?o=!1:r=t(),i.state){case"HEADER":/:/.test(r)?c(r,function(e,t){"Region"===e&&console.log("parse region",t)},/:/):r||(i.state="ID");continue;case"NOTE":r||(i.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){i.state="NOTE";break}if(!r)continue;if(i.cue=new s(0,0,""),i.state="CUE",-1===r.indexOf("--\x3e")){i.cue.id=r;continue}case"CUE":try{d(r,i.cue,i.regionList)}catch(e){i.cue=null,i.state="BADCUE";continue}i.state="CUETEXT";continue;case"CUETEXT":var a=-1!==r.indexOf("--\x3e");if(!r||a&&(o=!0)){i.oncue&&i.oncue(i.cue),i.cue=null,i.state="ID";continue}i.cue.text&&(i.cue.text+="\n"),i.cue.text+=r;continue;case"BADCUE":r||(i.state="ID");continue}}}catch(e){"CUETEXT"===i.state&&i.cue&&i.oncue&&i.oncue(i.cue),i.cue=null,i.state="INITIAL"===i.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),!this.cue&&"HEADER"!==this.state||(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return this.onflush&&this.onflush(),this}},t.exports=n},{"./vttcue":54}],56:[function(e,t,r){function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,t,r){t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1})}var o=e("./vtt-parser"),s=e("./vtt-renderer"),l=e("./vtt-loader"),c=e("../../player/base/event/eventtype"),u=e("../../lib/ua"),p=e("../../lib/event"),d=e("../../ui/component/util"),e=function(){function e(e){this.parser=null,this.activeRenderer=null,this.trackConfigs=null,this.hasUserTracks=!1,this.vttText={},this.tickTimer=null,this.prevPosition=null,this._enabled=!1,this._isShow=!1,this.sleeper=new h,this.player=(e=e||{}).player,this.loader=new l,this.parser=new o,this.createRendererInstance(),this.bindEvents()}var t=e.prototype;return t.bindEvents=function(){function e(e){e.paramData.splayer&&r.switchRenderer(s.VttBasicRenderer.RENDER_TYPE_CUSTOM)}var t,r=this,i=this,n=this.player,o=(n.on(c.Private.TextTrackFounded,function(e){if("user"===e.paramData.from)r.hasUserTracks=!0;else if(r.hasUserTracks)return;e=e.paramData.textTracks;e&&e.length&&(r.enabled=!0,r.trackConfigs=e.map(function(e){return a({},e,{label:e.label||e.srclang,language:e.srclang})}),r.trackConfigs.forEach(function(e){r.activeRenderer.addTrack(e),"always"===n.getOptions().controlBarVisibility&&r.activeRenderer.forceUpdateCuesStyle({transform:"translateY(-44px)"},r.parser.cues)}))}),n.on(c.Private.UserTrackReset,function(){r.hasUserTracks=!1}),n.on(c.Player.H265PlayInfo,e),n.on(c.Player.H266PlayInfo,e),u.IS_IOS?(t=!1,n.on(c.Player.RequestFullScreen,function(){t=!0}),p.on(n.tag,"webkitendfullscreen",function(){t=!1}),p.on(n.tag.textTracks,"change",function(){var e;r.sleeper.isSleep||(r.sleeper.sleep(1e3),r.isCustomRenderer)||t&&(e=n.tag.textTracks,(e=Array.from(e).find(function(e){return"showing"===e.mode}))?r.activeTrackConfig&&r.activeTrackConfig.language===e.language||(r.switchTrack(e.language),n.trigger(c.Private.SelectorValueChange,{type:"cc",text:e.label})):n.trigger(c.Private.CCStateChanged,{value:"off",lang:""}))})):(n.on(c.Player.RequestFullScreen,this.adjustLayout.bind(this)),n.on(c.Player.CancelFullScreen,this.adjustLayout.bind(this)),o=d.debounce(function(){i.isCustomRenderer&&i.activeRenderer.resetCuesStyle(r.parser.cues)},100),p.on(window,"resize",o)),d.throttle(function(){i.isShow&&(i.activeRenderer.forceUpdateCuesStyle({transform:"translateY(-44px)"},i.parser.cues),i.player.paused())&&(i.activeRenderer.hide(),i.activeRenderer.restore())},100)),o=(n.on(c.Private.ShowBar,o),d.throttle(function(){i.isShow&&(i.activeRenderer.forceUpdateCuesStyle({transform:"none"},i.parser.cues),i.player.paused())&&(i.activeRenderer.hide(),i.activeRenderer.restore())},100));n.on(c.Private.HideBar,o),n.on(c.Private.VttHide,function(){r.hide()}),n.on(c.Private.VttSwitchTrack,function(e){r.switchTrack(e.paramData)}),n.on(c.Private.VttClearTracks,function(){r.reset()})},t.createRendererInstance=function(e){this.activeRenderer&&this.activeRenderer.dispose();var t=this.player.getOptions(),r={player:this.player};this.adaptPlatform(),e?e===s.VttBasicRenderer.RENDER_TYPE_NATIVE?this.activeRenderer=new s.NativeRenderer(r):(r.overlayId=this.getOverlayId(),this.activeRenderer=new s.CustomRenderer(r)):t.useNativeTextRenderer?this.activeRenderer=new s.NativeRenderer(r):(r.overlayId=this.getOverlayId(),this.activeRenderer=new s.CustomRenderer(r))},t.switchTrack=function(t){var e,r=this;this.trackConfigs&&this.trackConfigs.length&&(this.activeTrackConfig&&(this.parser.dispose(),this.parser=new o,this.activeRenderer.clearTrack(this.activeTrackConfig.language),this.activeRenderer.hide()),this.activeTrackConfig=t,e=this.trackConfigs.find(function(e){return e.language===t}))&&(e=e._loaded?"":(e||{}).src,this.loadVtt(e,function(){r.parseVtt(),r.activeRenderer.addCues(r.parser.cues,r.activeTrackConfig.language),r.show()}))},t.adaptPlatform=function(){var e=this.player.getOptions();u.IS_IOS&&(e.useNativeTextRenderer=!0)},t.loadVtt=function(e,t){var r=this;e?this.loader.loadFromUrl(e,function(e){r.activeTrackConfig._loaded=!0,r.vttText[r.activeTrackConfig.language]=e,t&&t()}):t&&t()},t.show=function(){this._isShow=!0,this.isCustomRenderer&&this.startTickTimeListener(),this.activeRenderer.show(this.activeTrackConfig.language);var e=this.player.el().getElementsByClassName("prism-controlbar")[0];e&&"block"===(null==(e=e.style)?void 0:e.display)&&this.activeRenderer.forceUpdateCuesStyle({transform:"translateY(-44px)"},this.parser.cues)},t.hide=function(){this._isShow=!1,this.clearTicker(),this.activeRenderer.hide()},t.switchRenderer=function(e){var t=this,r=s.VttBasicRenderer.RENDER_TYPE_NATIVE,i=s.VttBasicRenderer.RENDER_TYPE_CUSTOM;(e===r&&this.activeRenderer.type!==r||e===i&&this.activeRenderer.type!==i)&&(this.createRendererInstance(e),this.trackConfigs.forEach(function(e){return t.activeRenderer.addTrack(e)}),this.activeRenderer.addCues(this.parser.cues,this.activeTrackConfig.language),this.show())},t.parseVtt=function(){this.parser.parse(this.vttText[this.activeTrackConfig.language])},t.adjustLayout=function(){var e=this;this.isShow&&this.isCustomRenderer&&(this.activeRenderer.hide(),setTimeout(function(){e.activeRenderer.restore()},300))},t.startTickTimeListener=function(){var t=this;this.clearTicker(),this.tick(function(){var e=t.player.getCurrentTime();isNaN(e)||t.activeRenderer.renderCues(t.findTargetCues(e))})},t.tick=function(e){var t=this;this.tickTimer=requestAnimationFrame(function(){try{e()}catch(e){console.log("e",e)}t.tick(e)})},t.clearTicker=function(){this.tickTimer&&(cancelAnimationFrame(this.tickTimer),this.tickTimer=null)},t.getOverlayId=function(){var e=(this.player.el().getElementsByClassName("prism-text-overlay")||[])[0];if(e)return e.id},t.findTargetCues=function(e){if(this.parser&&e!==this.prevPosition){this.prevPosition=e;for(var t=[],r=0;r<this.parser.cues.length;r++){var i=this.parser.cues[r];if(e>=i.startTime&&e<=i.endTime)t.push(i);else if(e<i.startTime)break}return t}},t.reset=function(){this.clearTicker(),this.parser&&this.parser.reset(),this.activeRenderer&&this.activeRenderer.reset()},t.dispose=function(){this.clearTicker(),this.parser&&(this.parser.dispose(),this.parser=null),this.activeRenderer&&(this.activeRenderer.dispose(),this.activeRenderer=null),this.trackConfigs=null,this.hasUserTracks=!1,this.vttText={},this.prevPosition=null,this._enabled=!1,this._isShow=!1},n(e,[{key:"isShow",get:function(){return this._isShow}},{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled=e}},{key:"isCustomRenderer",get:function(){if(this.activeRenderer)return this.activeRenderer.type===s.VttBasicRenderer.RENDER_TYPE_CUSTOM}},{key:"activeTrackConfig",get:function(){var e;return null==(e=this.trackConfigs)?void 0:e.find(function(e){return e._isActive})},set:function(t){this.trackConfigs.forEach(function(e){return e._isActive=e.language===t})}}]),e}(),h=function(){function e(){this.value=!1,this.timer=null}return e.prototype.sleep=function(e){var t=this;this.timer&&clearTimeout(this.timer),this.value=!0,this.timer=setTimeout(function(){t.value=!1},e)},n(e,[{key:"isSleep",get:function(){return this.value}}]),e}();t.exports=e},{"../../lib/event":33,"../../lib/ua":49,"../../player/base/event/eventtype":70,"../../ui/component/util":159,"./vtt-loader":58,"./vtt-parser":59,"./vtt-renderer":60}],57:[function(e,t,r){function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function n(e,t){e.prototype=Object.create(t.prototype),o(e.prototype.constructor=e,t)}function o(e,t){return(o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t,r){t&&a(e.prototype,t),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1})}var l=e("../../lib/data"),c={DISABLED:"disabled",SHOWING:"showing",HIDDEN:"hidden"},u={SUBTITLES:"subtitles",CAPTIONS:"captions",DESCRIPTIONS:"descriptions",METADATA:"metadata",CHAPTERS:"chapters"},e=function(r){function e(e){var e=i({},e=void 0===e?{}:e,{kind:e.kind||u.SUBTITLES,language:e.language||e.srclang||""}),t=e.mode||c.DISABLED;e.default;return-1<[u.METADATA,u.CHAPTERS].indexOf(e.kind)&&(t=c.HIDDEN),e.mode=t,(t=r.call(this,e)||this)._cues=[],t._activeCues=[],t._settings={},t._nativeTrack=null,t._extData={},t._settings=e,t}n(e,r);var t=e.prototype;return t.setExtData=function(e){this._extData=i({},this._extData,e=void 0===e?{}:e)},t.addCue=function(e){this._cues.push(e),this.nativeTrack&&this.nativeTrack.addCue(e)},t.removeCue=function(t){this._cues=this._cues.filter(function(e){return e!==t}),this.nativeTrack&&this.nativeTrack.removeCue(t)},s(e,[{key:"default",get:function(){return this._settings.default}},{key:"mode",get:function(){return this._settings.mode},set:function(e){this._settings.mode=e,this.nativeTrack&&(this.nativeTrack.mode=e)}},{key:"language",get:function(){return this._settings.language},set:function(e){this._settings.language=e,this.nativeTrack&&(this.nativeTrack.language=e)}},{key:"cues",get:function(){return this._cues}},{key:"activeCues",get:function(){return this._activeCues}},{key:"nativeTrack",get:function(){return this._nativeTrack},set:function(e){this._nativeTrack=e}}]),e}(function(){function e(e){this._id=(e=void 0===e?{}:e).id||"prism-track-"+l.guid(),this._kind=e.kind||"",this._language=e.language||"",this._label=e.label||""}return s(e,[{key:"label",get:function(){return this._label},set:function(e){this._label=e}},{key:"id",get:function(){return this._id}},{key:"kind",get:function(){return this._kind}},{key:"language",get:function(){return this._language}}]),e}()),p=function(e){function t(){return e.call(this)||this}return n(t,e),t}(function(){function e(){this._trackList=[]}return e.prototype.addTrack=function(e){var t=this.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this._trackList[t]}}),-1===this._trackList.indexOf(e)&&this._trackList.push(e)},s(e,[{key:"length",get:function(){return this._trackList.length}},{key:"list",get:function(){return this._trackList}}]),e}());t.exports.TextTrack=e,t.exports.TextTrackList=p,t.exports.TRACK_MODE=c,t.exports.TRACK_KIND=u},{"../../lib/data":30}],58:[function(e,t,r){var i=e("../io");t.exports=function(){function e(){}return e.prototype.loadFromUrl=function(e,t){i.get(e,function(e){t(e)},function(e,t){console.log("ERR",e,t)})},e}()},{"../io":40}],59:[function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=e("./vttjs").WebVTT,e=function(){function e(){var t=this;this._cues=[],this._regions=[],this.parser=new o.Parser(window,o.StringDecoder()),this.parser.onregion=function(e){t._regions.push(e)},this.parser.oncue=function(e){t._cues.push(e)},this.parser.onflush=function(){},this.parser.onparsingerror=function(e){console.log("onparsingerror",e)}}var t,r,i=e.prototype;return i.parse=function(e){this.parser.parse(e),this.parser.flush()},i.reset=function(){this.parser.flush(),this._cues=[],this._regions=[]},i.dispose=function(){this.parser.flush(),this.parser=null,this._cues=[],this._regions=[]},i=e,(t=[{key:"cues",get:function(){return this._cues}}])&&n(i.prototype,t),r&&n(i,r),Object.defineProperty(i,"prototype",{writable:!1}),e}();t.exports=e},{"./vttjs":61}],60:[function(e,t,r){function o(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function a(e,t){e.prototype=Object.create(t.prototype),n(e.prototype.constructor=e,t)}function n(e,t){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}e("../../player/base/event/eventtype");var s=e("./text-track"),l=e("./vttjs").WebVTT,c=e("../../lib/dom"),u=s.TextTrack,p=s.TextTrackList,d=s.TRACK_MODE,h=(s.TRACK_KIND,function(){function e(e){this.player=null,this.type=null,this.trackList=null,this.overrideStyle={},this.player=(e=e||{}).player,this.defineTextTrackGetter(),this.trackList=new p}var t=e.prototype;return t.log=function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=console).log.apply(e,["[LOG:"+this.type+"]"].concat(r))},t.defineTextTrackGetter=function(){var e=this;this.player.getTextTracks=function(){return e.trackList||[]}},t.show=function(e){e=this.findTrackByLanguage(e);e&&(e.mode=d.SHOWING)},t.findTrackByLanguage=function(t){return this.trackList.list.find(function(e){return e.language===t})},t.clearCurrentCues=function(e){if(e){var t=e.mode;if(t===d.DISABLED&&(e.mode=d.HIDDEN),e.cues)for(var r=e.cues.length;r--;)e.removeCue(e.cues[r]);t===d.DISABLED&&(e.mode=t)}},t.addTrack=function(){},t.addCues=function(){},t.restore=function(){},t.renderCues=function(){},t.updateCuesStyle=function(){},t.clearTrack=function(e){this.clearCurrentCues(this.findTrackByLanguage(e))},t.clearAllTracks=function(){var t=this;this.trackList&&this.trackList.length&&this.trackList.list.forEach(function(e){e.mode=d.DISABLED,t.clearCurrentCues(e)}),this.trackList=new p},t.reset=function(){this.hide(),this.clearAllTracks()},t.dispose=function(){this.hide(),this.clearAllTracks(),this.player&&this.player.getTextTracks&&(this.player.getTextTracks=null),this.player=null,this.type=null},e}()),e=(h.RENDER_TYPE_CUSTOM="CUSTOM",h.RENDER_TYPE_NATIVE="NATIVE",function(r){function e(e){var t=r.call(this,e)||this;return t.overlayId=null,t.currentCues=null,e=e||{},t.type=h.RENDER_TYPE_CUSTOM,t.overlayId=e.overlayId,t}a(e,r);var t=e.prototype;return t.addTrack=function(e){var t=new u({kind:e.kind,label:e.label,language:e.language,default:e.default});t.mode=e.default?d.SHOWING:d.DISABLED,this.trackList.addTrack(t)},t.hide=function(){return l.processCues(window,[],document.getElementById(this.overlayId))},t.restore=function(){this.currentCues&&(this.currentCues.forEach(function(e){return e.displayState=null}),l.processCues(window,this.currentCues,this.overlayEl),this.updateCuesStyle(this.currentCues))},t.renderCues=function(e){e&&(this.currentCues=e,this.overlayEl||(this.overlayEl=document.getElementById(this.overlayId)),l.processCues(window,e,this.overlayEl),this.updateCuesStyle(e))},t.updateCuesStyle=function(e){var i=this;e.forEach(function(e){var t,r=e.displayState;r._styleSetDone||r&&(r.setAttribute("class","prism-cue"),i.overlayEl||(i.overlayEl=document.getElementById(i.overlayId)),e=i.overlayEl.offsetWidth,t=i.overlayEl.offsetHeight,(e=Math.min(e,t))&&(r.style.fontSize=.05*e+"px",r.style.height="auto",r.style.top="auto"),Object.keys(i.overrideStyle).forEach(function(e){i.tryUpdateStyle(r,e,i.overrideStyle[e])}),r._styleSetDone=!0)})},t.updateOverrideStyle=function(e){this.overrideStyle=i({},this.overrideStyle,e=void 0===e?{}:e)},t.forceUpdateCuesStyle=function(e,t){void 0===t&&(t=[]),this.updateOverrideStyle(e=void 0===e?{}:e),this.resetCuesStyle(t)},t.tryUpdateStyle=function(e,t,r){try{e.style[t]=r}catch(e){}},t.resetCuesStyle=function(e){e&&e.length&&e.forEach(function(e){e.displayState&&(e.displayState=null)})},t.dispose=function(){r.prototype.dispose.call(this),this.overlayId=null,this.currentCues=null},e}(h)),s=function(t){function e(e){return(e=t.call(this,e=void 0===e?{}:e)||this).type=h.RENDER_TYPE_NATIVE,e}a(e,t);var r,i,n=e.prototype;return n.addTrack=function(t){var e=this.player.tag,r=Array.from(e.textTracks)||[],i=r.find(function(e){return e.language===t.language}),r=i?(this.log("sameLangTrack",i,r),this.clearCurrentCues(i),i.kind=t.kind,i.label=t.label,i):e.addTextTrack(t.kind,t.label,t.language),i=(r.mode=t.default?d.SHOWING:d.DISABLED,new u(t));i.nativeTrack=r,this.trackList.addTrack(i)},n.addCues=function(e,t){var r;e&&e.length&&(r=this.trackList.list.find(function(e){return e.language===t}))&&e.forEach(function(e){r.addCue(e)})},n.hide=function(){this.trackList.list.forEach(function(e){e.mode=e.mode===d.SHOWING?d.HIDDEN:e.mode})},n.invalidAllTracks=function(){},n.forceUpdateCuesStyle=function(e,t){c.addCssByStyle("video::-webkit-media-text-track-container{transform: "+e.transform+";}")},n.dispose=function(){t.prototype.dispose.call(this)},n=e,(r=[{key:"activeTrack",get:function(){return this.trackList.list.find(function(e){return e.mode===d.SHOWING})}}])&&o(n.prototype,r),i&&o(n,i),Object.defineProperty(n,"prototype",{writable:!1}),e}(h);t.exports.VttBasicRenderer=h,t.exports.CustomRenderer=e,t.exports.NativeRenderer=s},{"../../lib/dom":32,"../../player/base/event/eventtype":70,"./text-track":57,"./vttjs":61}],61:[function(e,t,r){t.exports={WebVTT:e("./vtt.js").WebVTT}},{"./vtt.js":62}],62:[function(e,t,r){var i=this;function o(e,t){return void 0===t&&(t=1),"rgba("+[parseInt(e.substring(0,2),16),parseInt(e.substring(2,4),16),parseInt(e.substring(4,6),16),t].join(",")+")"}var l,p=1;function n(e,t,r){switch(r){case"webvtt.font.color":case"webvtt.font.opacity":var i=Services.prefs.getCharPref("webvtt.font.color"),n=Services.prefs.getIntPref("webvtt.font.opacity")/100;l.fontSet=o(i,n);break;case"webvtt.font.scale":p=Services.prefs.getIntPref("webvtt.font.scale")/100;break;case"webvtt.bg.color":case"webvtt.bg.opacity":i=Services.prefs.getCharPref("webvtt.bg.color"),n=Services.prefs.getIntPref("webvtt.bg.opacity")/100;l.backgroundSet=o(i,n);break;case"webvtt.edge.color":case"webvtt.edge.type":i=Services.prefs.getIntPref("webvtt.edge.type"),n=Services.prefs.getCharPref("webvtt.edge.color");l.edgeSet=["","0px 0px ","4px 4px 4px ","-2px -2px ","2px 2px "][i]+o(n)}}"undefined"!=typeof Services&&(l={},["webvtt.font.color","webvtt.font.opacity","webvtt.font.scale","webvtt.bg.color","webvtt.bg.opacity","webvtt.edge.color","webvtt.edge.type"].forEach(function(e){n(0,0,e),Services.prefs.addObserver(e,n,!1)}));var a=Object.create||function(e){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return s.prototype=e,new s};function s(){}function c(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function h(e){function t(e,t,r,i){return 3600*(0|e)+60*(0|t)+(0|r)+(0|i)/1e3}e=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return e?e[3]?t(e[1],e[2],e[3].replace(":",""),e[4]):59<e[1]?t(e[1],e[2],0,e[4]):t(0,e[1],e[2],e[4]):null}function u(){this.values=a(null)}function d(e,t,r,i){var n,o,a=i?e.split(i):[e];for(n in a)"string"==typeof a[n]&&2===(o=a[n].split(r)).length&&t(o[0],o[1])}((c.prototype=a(Error.prototype)).constructor=c).Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},u.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var i=0;i<r.length;++i)if(t===r[i]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(e,t),!0)}};var f={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"\u200e","&rlm;":"\u200f","&nbsp;":"\xa0"},y={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},_={v:"title",lang:"lang"},g={rt:"ruby"};function v(e,t){function r(e){return f[e]}for(var i,n,o,a,s,l,c,u=e.document.createElement("div"),p=u,d=[];null!==(c=void 0,c=t?(c=(c=t.match(/^([^<]*)(<[^>]+>?)?/))[1]||c[2],t=t.substr(c.length),c):null);)"<"===c[0]?"/"===c[1]?d.length&&d[d.length-1]===c.substr(2).replace(">","")&&(d.pop(),p=p.parentNode):(o=h(c.substr(1,c.length-2)))?(i=e.document.createProcessingInstruction("timestamp",o),p.appendChild(i)):(n=c.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/))&&(o=n[1],a=n[3],l=s=void 0,l=y[o],i=l?((s=e.document.createElement(l)).localName=l,(l=_[o])&&a&&(s[l]=a.trim()),s):null)&&(o=p,g[(l=i).localName]&&g[l.localName]!==o.localName||(n[2]&&(i.className=n[2].substr(1).replace("."," ")),d.push(n[1]),p.appendChild(i),p=i)):p.appendChild(e.document.createTextNode(function(e){for(;n=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)e=e.replace(n[0],r);return e}(c)));return u}var m=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function S(e){var t=[],r="";if(e&&e.childNodes)for(o(t,e);r=function e(t){var r,i,n;return t&&t.length?(i=(r=t.pop()).textContent||r.innerText)?(n=i.match(/^.*(\n|\r)/))?n[t.length=0]:i:"ruby"===r.tagName?e(t):r.childNodes?(o(t,r),e(t)):void 0:null}(t);)for(var i=0;i<r.length;i++)if(function(e){for(var t=0;t<m.length;t++){var r=m[t];if(e>=r[0]&&e<=r[1])return 1}}(r.charCodeAt(i)))return"rtl";return"ltr";function o(e,t){for(var r=t.childNodes.length-1;0<=r;r--)e.push(t.childNodes[r])}}function b(){}function T(e,t,r){var i="undefined"!=typeof navigator&&/MSIE\s8\.0/.test(navigator.userAgent),n="rgba(255, 255, 255, 1)",o="rgba(0, 0, 0, 0.8)",a="",n=(void 0!==l&&(n=l.fontSet,o=l.backgroundSet,a=l.edgeSet),i&&(n="rgb(255, 255, 255)",o="rgb(0, 0, 0)"),b.call(this),this.cue=t,this.cueDiv=v(e,t.text),{color:n,backgroundColor:o,textShadow:a,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"}),s=(i||(n.writingMode=""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",n.unicodeBidi="plaintext"),this.applyStyles(n,this.cueDiv),this.div=e.document.createElement("div"),n={textAlign:"middle"===t.align?"center":t.align,font:r.font,whiteSpace:"pre-line",position:"absolute"},i||(n.direction=S(this.cueDiv),n.writingMode=""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"plaintext"),this.applyStyles(n),this.div.appendChild(this.cueDiv),0);switch(t.positionAlign){case"start":s=t.position;break;case"middle":s=t.position-t.size/2;break;case"end":s=t.position-t.size}""===t.vertical?this.applyStyles({left:this.formatStyle(s,"%"),width:this.formatStyle(t.size,"%")}):this.applyStyles({top:this.formatStyle(s,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function E(e){var t,r,i,n,o="undefined"!=typeof navigator&&/MSIE\s8\.0/.test(navigator.userAgent);e.div&&(t=e.div.offsetHeight,r=e.div.offsetWidth,i=e.div.offsetTop,n=(n=(n=e.div.childNodes)&&n[0])&&n.getClientRects&&n.getClientRects(),e=e.div.getBoundingClientRect(),n=n?Math.max(n[0]&&n[0].height||0,e.height/n.length):0),this.left=e.left,this.right=e.right,this.top=e.top||i,this.height=e.height||t,this.bottom=e.bottom||i+(e.height||t),this.width=e.width||r,this.lineHeight=void 0!==n?n:e.lineHeight,o&&!this.lineHeight&&(this.lineHeight=13)}function w(e,t,s,l){var r,i=new E(t),n=t.cue,o=function(e){if("number"==typeof e.line&&(e.snapToLines||0<=e.line&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,r=t.textTrackList,i=0,n=0;n<r.length&&r[n]!==t;n++)"showing"===r[n].mode&&i++;return-1*++i}(n),a=[];if(n.snapToLines){switch(n.vertical){case"":a=["+y","-y"],r="height";break;case"rl":a=["+x","-x"],r="width";break;case"lr":a=["-x","+x"],r="width"}var c=i.lineHeight,u=c*Math.round(o),p=s[r]+c,d=a[0];Math.abs(u)>p&&(u=u<0?-1:1,u*=Math.ceil(p/c)*c),o<0&&(u+=""===n.vertical?s.height:s.width,a=a.reverse()),i.move(d,u)}else{var h=i.lineHeight/s.height*100;switch(n.lineAlign){case"middle":o-=h/2;break;case"end":o-=h}switch(n.vertical){case"":t.applyStyles({top:t.formatStyle(o,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(o,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(o,"%")})}a=["+y","-x","+x","-y"],i=new E(t)}p=function(e,t){for(var r,i=new E(e),n=1,o=0;o<t.length;o++){for(;e.overlapsOppositeAxis(s,t[o])||e.within(s)&&e.overlapsAny(l);)e.move(t[o]);if(e.within(s))return e;var a=e.intersectPercentage(s);a<n&&(r=new E(e),n=a),e=new E(i)}return r||i}(i,a);t.move(p.toCSSCompatValues(s))}function x(){}b.prototype.applyStyles=function(e,t){for(var r in t=t||this.div,e)e.hasOwnProperty(r)&&(t.style[r]=e[r])},b.prototype.formatStyle=function(e,t){return 0===e?0:e+t},(T.prototype=a(b.prototype)).constructor=T,E.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},E.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},E.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},E.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},E.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},E.prototype.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},E.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},E.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,r=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,i=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||i,height:e.height||t,bottom:e.bottom||i+(e.height||t),width:e.width||r}},x.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},x.convertCueToDOMTree=function(e,t){return e&&t?v(e,t):null},x.processCues=function(e,t,r){if(!e||!t||!r)return null;for(;r.firstChild;)r.removeChild(r.firstChild);var i=e.document.createElement("div");if(i.style.position="absolute",i.style.left="0",i.style.right="0",i.style.top="0",i.style.bottom="0",i.style.margin="1.5%",r.appendChild(i),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return 1}(t))for(var n,o,a=[],s=E.getSimpleBoxPosition(i),l={font:Math.round(.05*s.height*100)/100*p+"px sans-serif"},c=0;c<t.length;c++)o=t[c],n=new T(e,o,l),i.appendChild(n.div),w(0,n,s,a),o.displayState=n.div,a.push(E.getSimpleBoxPosition(n));else for(var u=0;u<t.length;u++)i.appendChild(t[u].displayState)},(x.Parser=function(e,t){this.window=e,this.state="INITIAL",this.buffer="",this.decoder=t||new TextDecoder("utf8"),this.regionList=[]}).prototype={reportOrThrowError:function(e){if(!(e instanceof c))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var i=this;function t(){for(var e=i.buffer,t=0;t<e.length&&"\r"!==e[t]&&"\n"!==e[t];)++t;var r=e.substr(0,t);return"\r"===e[t]&&++t,"\n"===e[t]&&++t,i.buffer=e.substr(t),r}function r(e){d(e,function(e,t){var n;"Region"===e&&(e=t,n=new u,d(e,function(e,t){switch(e){case"id":n.set(e,t);break;case"width":n.percent(e,t);break;case"lines":n.integer(e,t);break;case"regionanchor":case"viewportanchor":var r,i=t.split(",");2===i.length&&((r=new u).percent("x",i[0]),r.percent("y",i[1]),r.has("x")&&r.has("y"))&&(n.set(e+"X",r.get("x")),n.set(e+"Y",r.get("y")));break;case"scroll":n.alt(e,t,["up"])}},/=/,/\s/),n.has("id"))&&((e=new i.window.VTTRegion).width=n.get("width",100),e.lines=n.get("lines",3),e.regionAnchorX=n.get("regionanchorX",0),e.regionAnchorY=n.get("regionanchorY",100),e.viewportAnchorX=n.get("viewportanchorX",0),e.viewportAnchorY=n.get("viewportanchorY",100),e.scroll=n.get("scroll",""),i.onregion&&i.onregion(e),i.regionList.push({id:n.get("id"),region:e}))},/:/)}e&&(i.buffer+=i.decoder.decode(e,{stream:!0}));try{if("INITIAL"===i.state){if(!/\r\n|\n/.test(i.buffer))return this;var n,o=(n=t()).match(/^WEBVTT([ \t].*)?$/);if(!o||!o[0])throw new c(c.Errors.BadSignature);i.state="HEADER"}for(var a=!1;i.buffer;){if(!/\r\n|\n/.test(i.buffer))return this;switch(a?a=!1:n=t(),i.state){case"HEADER":/:/.test(n)?r(n):n||(i.state="ID");continue;case"NOTE":n||(i.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){i.state="NOTE";break}if(!n)continue;if(i.cue=new i.window.VTTCue(0,0,""),i.state="CUE",-1===n.indexOf("--\x3e")){i.cue.id=n;continue}case"CUE":try{!function(t,e,o){var r,a,i=t;function n(){var e=h(t);if(null===e)throw new c(c.Errors.BadTimeStamp,"Malformed timestamp: "+i);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function s(){t=t.replace(/^\s+/,"")}if(s(),e.startTime=n(),s(),"--\x3e"!==t.substr(0,3))throw new c(c.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);t=t.substr(3),s(),e.endTime=n(),s(),r=t,e=e,a=new u,d(r,function(e,t){switch(e){case"region":for(var r=o.length-1;0<=r;r--)if(o[r].id===t){a.set(e,o[r].region);break}break;case"vertical":a.alt(e,t,["rl","lr"]);break;case"line":var i=t.split(","),n=i[0];a.integer(e,n),a.percent(e,n)&&a.set("snapToLines",!1),a.alt(e,n,["auto"]),2===i.length&&a.alt("lineAlign",i[1],["start","middle","end"]);break;case"position":i=t.split(","),a.percent(e,i[0]),2===i.length&&a.alt("positionAlign",i[1],["start","middle","end"]);break;case"size":a.percent(e,t);break;case"align":a.alt(e,t,["start","middle","end","left","right"])}},/:/,/\s/),e.region=a.get("region",null),e.vertical=a.get("vertical",""),e.line=a.get("line","auto"),e.lineAlign=a.get("lineAlign","start"),e.snapToLines=a.get("snapToLines",!0),e.size=a.get("size",100),e.align=a.get("align","middle"),e.position=a.get("position","auto"),e.positionAlign=a.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},e.align)}(n,i.cue,i.regionList)}catch(e){i.reportOrThrowError(e),i.cue=null,i.state="BADCUE";continue}i.state="CUETEXT";continue;case"CUETEXT":var s=-1!==n.indexOf("--\x3e");if(!n||s&&(a=!0)){i.oncue&&i.oncue(i.cue),i.cue=null,i.state="ID";continue}i.cue.text&&(i.cue.text+="\n"),i.cue.text+=n;continue;case"BADCUE":n||(i.state="ID");continue}}}catch(e){i.reportOrThrowError(e),"CUETEXT"===i.state&&i.cue&&i.oncue&&i.oncue(i.cue),i.cue=null,i.state="INITIAL"===i.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),!t.cue&&"HEADER"!==t.state||(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state)throw new c(c.Errors.BadSignature)}catch(e){t.reportOrThrowError(e)}return t.onflush&&t.onflush(),this}},i.WebVTT=x},{}],63:[function(e,t,r){var n=e("../lib/io");e("../lib/storage");function i(e){this._uploadDuration=e.logDuration||5,this._uploadCount=e.logCount||10,this._logReportTo=e.logReportTo,this._logs=[],this._retry=0,this._disposed=!1,this._supportLocalStorage=!0;var t,n=this;window&&(window.onbeforeunload=function(e){if(0<n._logs.length)if(n._supportLocalStorage)localStorage.setItem("__aliplayer_log_data",JSON.stringify(n._logs));else{n._report();for(var t=500,r=(new Date).getTime(),i=r;i<r+t;)i=(new Date).getTime()}});try{localStorage?(t=localStorage.getItem("__aliplayer_log_data"),localStorage.removeItem("__aliplayer_log_data"),t&&(this._logs=JSON.parse(t))):this._supportLocalStorage=!1}catch(e){this._supportLocalStorage=!1}this._start()}i.prototype.add=function(e){var t=this._logs.length;if(e.__time__=Math.round(new Date/1e3),0<t&&"4001"==e.e){t=this._logs[t-1];if("4001"==t.e&&t.__time__-e.__time__<5)return}this._logs.push(e),(this._logs.length>this._uploadCount||"4001"==e.e||"2002"==e.e)&&this._report()},i.prototype.dispose=function(){this._report(),this._disposed=!0},i.prototype._start=function(){this._disposed=!1;this._retry=0,this._report()},i.prototype._report=function(t){var e,r,i;this._tickHandler&&(clearTimeout(this._tickHandler),this._tickHandler=null),0<(t=t||this._logs.splice(0,this._uploadCount)).length?(i={"Content-Type":"application/json;charset=UTF-8","x-log-apiversion":"0.6.0","x-log-bodyrawsize":(e=JSON.stringify({__logs__:t,__source__:""})).length},n.postWithHeader((r=this)._logReportTo,e,i,function(e){r._tick()},function(e){0==r._retry?(r._retry=1,r._report(t)):r._tick()})):this._tick()},i.prototype._tick=function(){var e;this._disposed||(this._retry=0,(e=this)._logs.length>this._uploadCount?e._report():this._tickHandler=setTimeout(function(){e._report()},1e3*this._uploadDuration))},t.exports=i},{"../lib/io":40,"../lib/storage":48}],64:[function(e,t,r){function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}var i,n=e("../lib/oo"),s=e("../lib/object"),y=e("../lib/data"),l=e("../lib/io"),_=e("../lib/ua"),o=e("../lib/event"),g=e("../config"),c=e("../player/base/event/eventtype"),v=e("./util"),m=e("./log"),u=e("../lib/playerutil"),p=0,d={CREATE:1e3,STARTFETCHDATA:1003,COMPLETEFETCHDATA:1004,PREPARE:1101,PREPAREEND:1102,STARTPLAY:2e3,PLAY:2001,STOP:2002,PAUSE:2003,SEEK:2004,FULLSREEM:2005,QUITFULLSCREEM:2006,RESOLUTION:2007,RESOLUTION_DONE:2008,RECOVER:2010,SEEK_END:2011,PLAYABORT:2012,SEEKED:2014,CANPLAY:2018,FETCHEDIP:2020,CDNDETECT:2021,DETECT:2022,HEVCINFO:2023,UNDERLOAD:3002,LOADED:3001,RETRY:3003,HEARTBEAT:9001,TRACE:9002,ERROR:4001,ERRORRETRY:4002,RTSFALLBACK:4003,VOD_REQUEST_FATAL_ERROR:4004,VOD_REQUEST_FATAL_ERROR_RESUME:4005,LICENSE_RESULT:5004,SNAPSHOT:2027,ROTATE:2028,IMAGE:2029,THUMBNAILSTART:2031,THUMBNAILCOMPLETE:2032,CCSTART:2033,CCCOMPLETE:2034,AUDIOTRACKSTART:2033,AUDIOTRACKCOMPLETE:2034},e=n.extend({init:function(e,t,r){this.trackLog=r=void 0===r?!0:r,this.player=e,this.requestId="",this.sessionId=y.guid(),this.playId=0,this.firstPlay=!0,this.osName=_.os.name,this.osVersion=_.os.version||"",this.exName=_.browser.name,this.exVersion=_.browser.version||"",this.lightSaasVideoId="",this._logService="",this._h265ProbeInfo={},this.startPlayReported=!1,this.canplayReported=!1,this.doPlayReported=!1,this.seekingData={seekingStartTime:0},this.pendingPrepareEndData=null,this.h265RenderTypeTimer=null,this.prevStats={timestamp:0,bytesReceived:0,framesDecoded:0,packetsLost:0,packetsReceived:0,rtt:0},this.resetHeartBeatStatusData(),t.logBatched&&(this._logService=new m(g));var r=this.player.getOptions(),e=t.from||"",t=(r.isLive,r.isLive?"live":"vod"),i="pc",n=(_.IS_IPAD?i="pad":_.os.phone&&(i="phone"),this.encodeURL(_.getReferer())),o=_.getHref(),a=this.encodeURL(o),s="",o=(o&&(s=_.getHost(o)),g.h5Version),l=v.getUuid(),c=r.source?this.encodeURL(r.source):"",u=_.getHost(r.source),p=r.userId?r.userId+"":"0",d=this.sessionId,h=(new Date).getTime(),f=r.traceId||"";this._userNetInfo={cdnIp:"",localIp:""};this.opt={APIVersion:"0.6.0",t:h,ll:"info",lv:"1.0",pd:"player",md:"saas_player",ui:"saas_player",sm:"play",os:this.osName,ov:this.osVersion,et:this.exName,ev:this.exVersion,uat:_.USER_AGENT,hn:"0.0.0.0",bi:e,ri:d,e:"0",args:"0",li_ki:r.license.key||"",vt:t,tt:i,dm:"h5",av:o,uuid:l,vu:c,vd:u,ua:p,dn:"custom",cdn_ip:"0.0.0.0",app_n:s,r:n,pu:a,ti:f},this.bindEvent()},updateVideoInfo:function(e){e=e.from||"";this.opt.bi=e+"",this.updateSourceInfo()},updateSourceInfo:function(){var e,t=this.player.getOptions();t&&(e=t.source?this.encodeURL(t.source):"",t=_.getHost(t.source),this.opt.vu=e,this.opt.vd=t)},updateTraceId:function(e){this.opt.ti=e},updateLightSaasVideoId:function(e){this.lightSaasVideoId=e},replay:function(){this.reset(),this.player.trigger(c.Video.LoadStart),this.player.trigger(c.Video.LoadedMetadata),this.player.trigger(c.Video.LoadedData),this.startHeartBeat()},bindEvent:function(){var r=this;this.player.on(c.Private.Create,function(e){r._onCreate(e)}),this.player.on(c.Player.Init,function(){r._onPlayerInit()}),this.player.on(c.Video.LoadStart,function(){r._onPlayerloadstart()}),this.player.on(c.Video.LoadedMetadata,function(){r._onPlayerLoadMetadata()}),this.player.on(c.Video.LoadedData,function(){r._onPlayerLoaddata()}),this.player.on(c.Player.H265PlayInfo,function(e){r._onH265PlayInfo(e),r._onPlayerH265PlayInfo(e)}),this.player.on(c.Player.H266PlayInfo,function(e){r._onH265PlayInfo(e),r._onPlayerH265PlayInfo(e)}),this.player.on(c.Video.Play,function(){r._onPlayerPlay()}),this.player.on(c.Video.Playing,function(){r._onPlayerReady()}),this.player.on(c.Video.Ended,function(){r._onPlayerFinish()}),this.player.on(c.Video.Pause,function(){r._onPlayerPause()}),this.player.on("seeking",function(){r._onPlayerSeeking()}),this.player.on("seeked",function(){r._onPlayerSeeked()}),this.player.on(c.Private.LicenseHasResult,function(e){r._onLicenseHasResult(e)}),this.player.on(c.Private.SeekStart,function(e){r._onPlayerSeekStart(e)}),this.player.on(c.Private.EndStart,function(e){r._seekEndData=e.paramData}),this.player.on(c.Player.Waiting,function(){r._onPlayerLoaded()}),this.player.on(c.Video.CanPlayThrough,function(){}),this.player.on(c.Video.CanPlay,function(){r._waitingDelayLoadingShowHandle&&(clearTimeout(r._waitingDelayLoadingShowHandle),r._waitingDelayLoadingShowHandle=null),r._onPlayerUnderload(),r._onPlayerCanplay()}),this.player.on(c.Video.TimeUpdate,function(){r._waitingDelayLoadingShowHandle&&(clearTimeout(r._waitingDelayLoadingShowHandle),r._waitingDelayLoadingShowHandle=null),r._seekEndData&&r.player._seeking&&r._onPlayerSeekEnd()}),this.player.on(c.Player.Error,function(){r._onPlayerError()}),this.player.on(c.Player.RequestFullScreen,function(){r._onFullscreenChange(1)}),this.player.on(c.Player.CancelFullScreen,function(){r._onFullscreenChange(0)}),this.player.on(c.Private.PREPARE,function(e){r._prepareTime=(new Date).getTime(),r._log("PREPARE",{dn:e.paramData})}),this.player.on(c.Player.Snapshoted,function(){r._log("SNAPSHOT")}),this.player.on(c.Private.Retry,function(e){e=e.paramData||{};r._log("RETRY",{type:e.type,source:e.source})}),this.player.on(c.Player.RtsFallback,function(e){var t,e=e.paramData||{};r._log("RTSFALLBACK",{reason:null==(t=e.reason)?void 0:t.error_msg,url:e.fallbackUrl})}),this.player.on(c.Private.VodRequestException,function(e){e=e.paramData||{};r.reportVodException(e)}),this.player.on(c.Private.VodRequestExceptionResume,function(e){e=e.paramData||{};r.reportVodExceptionResume(e)}),this.player.on(c.Private.TraceLog,function(e){e=e.paramData||{};r._reportTrace(e)}),o.on(this.player.tag,c.Video.Playing,function(){r.reportPlaying()}),o.on(this.player.tag,c.Video.TimeUpdate,function(){r.reportPlaying()}),this.startHeartBeat.call(this)},reportPlaying:function(){var e;this.doPlayReported||this.player.paused()||0===this.player.readyState()||(this.doPlayReported=!0,this.first_play_time=(new Date).getTime(),e={dsm:"fix",tc:this.first_play_time-this.loadstartTime,fc:this.first_play_time-this.playstartTime},this._log("PLAY",e))},removeEvent:function(){this.player.off("init"),this.player.off("ready"),this.player.off("ended"),this.player.off("play"),this.player.off("pause"),this.player.off("seekStart"),this.player.off("seekEnd"),this.player.off("canplaythrough"),this.player.off("playing"),this.player.off("timeupdate"),this.player.off("error"),this.player.off("fullscreenchange"),this.player.off("seeking"),this.player.off("seeked"),this.player.off(c.Private.PREPARE),this.player.off(c.Player.RtsFallback),o.off(this.player.tag,c.Video.Playing),o.off(this.player.tag,c.Video.TimeUpdate),this._logService&&this._logService.dispose(),clearInterval(i)},reset:function(){this.stucking=!1,this.startTimePlay=0,this.pause_flag=0,this.firstPlay=!1,this.playId=0,this._LoadedData=0,this._canPlay=0,this.seekingStartTime=0,this.prevStats={timestamp:0,bytesReceived:0,framesDecoded:0,packetsLost:0,packetsReceived:0,rtt:0},p=0,this.lightSaasVideoId="",this.resetHeartBeatStatusData(),i&&(clearInterval(i),i=null)},encodeURL:function(e){var t;return e?(t=this.player.getOptions())&&!t.logBatched?encodeURIComponent(e):e:""},startHeartBeat:function(){var o=this;i&&clearInterval(i),i=setInterval(function(){var n;o.player.getCurrentTime()&&(n=Math.floor(1e3*o.player.getCurrentTime()),o.player.paused()&&(o.prevStats.timestamp=0),++p>=o.player._options.heartHeatInterval)&&o.updateStats.call(o,function(e){var t=o._imageInfo()||{},r=o.player.tag.playbackRate,i=o.player.getVolume(),t={vt:n,interval:1e3*p,imgLength:t.imgLength,playbackRate:r,volume:i};(t=e?a({},t,{dls:Math.floor(e.downloadSpeedPerSec),dfps:Math.floor(e.decodedFramesPerSec),pkl:Number((e.packageLossRate||0).toFixed(2)),rtt:1e3*e.rtt}):t).player_status=a({},o.heartBeatStatusData),o._log("HEARTBEAT",t),p=0})},1e3)},updateStats:function(o){o=o||function(){};var a=this;this.player.getStats().then(function(e){var t,r,i,n;e?(n=a.prevStats,e.bytesReceived=e.bytesReceived||0,e.framesDecoded=e.framesDecoded||0,e.packetsLost=e.packetsLost||0,e.packetsReceived=e.packetsReceived||0,t=((a.prevStats=e).timestamp-n.timestamp)/1e3,r=(e.bytesReceived-n.bytesReceived)/t,i=(e.framesDecoded-n.framesDecoded)/t,n=(e.packetsLost-n.packetsLost)/(e.packetsLost-n.packetsLost+(e.packetsReceived-n.packetsReceived)),e=e.rtt,o({downloadSpeedPerSec:r,decodedFramesPerSec:i,packageLossRate:n,rtt:e,timeGap:t})):o()}).catch(function(e){console.log("error in monitor getStats: ",e),o()})},reportStartPlay:function(){this.startPlayReported||(this._log("STARTPLAY",{vt:(new Date).getTime()}),this.startPlayReported=!0)},reportCanplay:function(){this.canplayReported||(this._log("CANPLAY",{vt:(new Date).getTime()}),this.canplayReported=!0)},reportPlayAbort:function(e){this._log("PLAYABORT",{vt:(new Date).getTime(),from:e})},reportVodException:function(e){console.log("VOD_REQUEST_FATAL_ERROR",e),this._log("VOD_REQUEST_FATAL_ERROR",e)},reportVodExceptionResume:function(e){console.log("VOD_REQUEST_FATAL_ERROR_RESUME",e),this._log("VOD_REQUEST_FATAL_ERROR_RESUME",e)},resetStartPlayReportFlag:function(){this.startPlayReported=!1},resetCanplayReportFlag:function(){this.canplayReported=!1},resetDoPlayReportFlag:function(){this.doPlayReported=!1},resetSessionId:function(){this.sessionId=y.guid()},resetHeartBeatStatusData:function(){this.heartBeatStatusData={t_last_pause:-1,t_last_resume:-1,t_last_load_start:-1,t_last_load_end:-1}},resetVV:function(){this.startPlayReported&&(this.resetStartPlayReportFlag(),this.resetDoPlayReportFlag(),this.resetCanplayReportFlag(),this.resetSessionId())},updateH265ProbeInfo:function(e){this._h265ProbeInfo=e||{}},_onFullscreenChange:function(e){e?this._log("FULLSREEM",{}):this._log("QUITFULLSCREEM",{})},_onPlayerloadstart:function(){this.loadstartTime=(new Date).getTime(),this.playId=y.guid()},_onPlayerLoadMetadata:function(){this.loadMetaDataCost=(new Date).getTime()-this.loadstartTime},_onPlayerLoaddata:function(){var e,t,r,i,n=this;this._LoadedData||(i=r=0,this.player.tag&&(r=this.player.tag.videoWidth,i=this.player.tag.videoHeight),e={tc:(new Date).getTime()-this._prepareTime,cc:(new Date).getTime()-this.loadstartTime,md:this.loadMetaDataCost,mi:JSON.stringify({type:"video",definition:r+"*"+i})},null!=(r=this.player.tag)&&r.duration&&(e.vdur=1e3*(null==(i=this.player.tag)?void 0:i.duration)),(5<this._h265ProbeInfo.codecCost||5<this._h265ProbeInfo.decoderCost)&&(r=Math.floor(this._h265ProbeInfo.codecCost)||0,i=Math.floor(this._h265ProbeInfo.decoderCost)||0,e.tc+=t=r+i,e.cc+=t,e.pcc=r,e.pdc=i),t=[{type:"audio"}],r={type:"video",codecType:null,isHardwareDecode:null},i=this._h265ProbeInfo.codecTag,u.isH265Codec(i)?r.codecType="h265":u.isH266Codec(i)?r.codecType="h266":u.isH264Codec(i)&&(r.codecType="h264"),t.push(r),e.decode_info=t,this._h265ProbeInfo.waitRenderType?(this.pendingPrepareEndData=e,this.h265RenderTypeTimer=setTimeout(function(){n._log("PREPAREEND",e),n.h265RenderTypeTimer=null},2e3)):this._log("PREPAREEND",e)),this._LoadedData=1},_onH265PlayInfo:function(e){var t,r;this.h265RenderTypeTimer&&(clearTimeout(this.h265RenderTypeTimer),this.h265RenderTypeTimer=null),this.pendingPrepareEndData&&(e=e.paramData,t=this.pendingPrepareEndData,this.pendingPrepareEndData=null,r=t.decode_info[1],"wasm"===e.renderType&&(r.isHardwareDecode=!1),this._log("PREPAREEND",t))},_onPlayerH265PlayInfo:function(e){e=e.paramData||{};this._log("HEVCINFO",{cd:e.codecTag,rd:e.renderType,si:e.simd,sio:e.simdOption,wt:e.wasmThreads,wto:e.wasmThreadsOption,sp:e.splayer})},_onPlayerCanplay:function(){this._canPlay=1,this.reportCanplay(),this.prevStats.timestamp||this.updateStats.call(this)},_onCreate:function(e){e=e.paramData||{};e.hasPa=!!e.playauth,delete e.playauth,e.hasSk=!!e.accessKeySecret,delete e.accessKeySecret,e.hasSt=!!e.securityToken,delete e.securityToken,this._log("CREATE",e)},_onPlayerInit:function(){this.stucking=!1,this.pause_flag=0,this.startTimePlay=0,this._LoadedData=0,this._canPlay=0,this.seekingStartTime=0},_onPlayerReady:function(){this.startTimePlay||(this.startTimePlay=(new Date).getTime())},_onPlayerFinish:function(){this._log("STOP",{vt:Math.floor(1e3*this.player.getCurrentTime())}),this.reset()},_onPlayerPlay:function(){var e;this.playstartTime=(new Date).getTime(),0==this.playId&&(this.playId=y.guid()),this.player._isPreload()||(this.loadstartTime=(new Date).getTime()),this.doPlayReported&&this.pause_flag&&(this.pause_flag=0,this.pauseEndTime=(new Date).getTime(),this.heartBeatStatusData.t_last_resume=this.pauseEndTime,e=this.pauseEndTime-this.pauseTime,this._log("RECOVER",{vt:Math.floor(1e3*this.player.getCurrentTime()),cost:e,pass:e,t_last_pause:this.pauseTime}))},_onPlayerPause:function(){!this.doPlayReported||this.startTimePlay&&!this.player._seeking&&(this.pause_flag=1,this.pauseTime=(new Date).getTime(),this.heartBeatStatusData.t_last_pause=this.pauseTime,this.heartBeatStatusData.t_last_resume=-1,this._log("PAUSE",{vt:Math.floor(1e3*this.player.getCurrentTime())}))},_onLicenseHasResult:function(e){e=e.paramData||{};this._log("LICENSE_RESULT",{li_ri:e.result,li_ti:e.featureId||"sdk"})},_onPlayerSeekStart:function(e){this.seekStartTime=e.paramData.fromTime,this.startTimePlay=0,this.seekStartStamp=(new Date).getTime()},_onPlayerSeekEnd:function(){this.seekEndStamp=(new Date).getTime(),this._log("SEEK",{drag_from_timestamp:Math.floor(1e3*this.seekStartTime),drag_to_timestamp:Math.floor(1e3*this._seekEndData.toTime)}),this._log("SEEK_END",{vt:Math.floor(1e3*this.player.getCurrentTime()),cost:this.seekEndStamp-this.seekStartStamp}),this._seekEndData=null},_onPlayerLoaded:function(){var e,t=this;this.doPlayReported&&!this.stucking&&(this.player._seeking?(this.seekingStartTime=this.player.getCurrentTime(),setTimeout(function(){var e=t.player.readyState()<4;t.player.readyState()||(e=!0),t.player.getCurrentTime()===t.seekingStartTime&&e&&(e=t._getbwEstimator(),t._log("UNDERLOAD",{vt:Math.floor(1e3*t.player.getCurrentTime()),bw:e,cbs:t._getCbs()}),t.stucking=!0,t.stuckStartTime=(new Date).getTime(),0===t._getCbs())&&(t.heartBeatStatusData.t_last_load_start=t.stuckStartTime,t.heartBeatStatusData.t_last_load_end=-1)},500)):(this.stuckStartTime=(new Date).getTime(),0===this._getCbs()&&(this.heartBeatStatusData.t_last_load_start=this.stuckStartTime,this.heartBeatStatusData.t_last_load_end=-1),this.stuckStartTime-this.startTimePlay<=1e3||(this.stucking=!0,e=this._getbwEstimator(),this._log("UNDERLOAD",{vt:Math.floor(1e3*this.player.getCurrentTime()),bw:e,cbs:this._getCbs()}),this.stuckStartTime=(new Date).getTime())))},_onPlayerUnderload:function(){var e,t,r,i;!this.doPlayReported&&this.player._options&&this.player._options.autoplay||this.stucking&&(e=Math.floor(1e3*this.player.getCurrentTime()),t=this.stuckStartTime||(new Date).getTime(),0<(r=Math.floor((new Date).getTime()-t))&&r<(1e3*this.player._options.waitingTimeout||6e4)&&(i=this._getbwEstimator(),0===this._getCbs()&&(this.heartBeatStatusData.t_last_load_end=(new Date).getTime()),this._log("LOADED",{vt:e,cost:r,bw:i,cbs:this._getCbs(),t_last_load_start:t})),this.seekStart=!1,this.stucking=!1)},_onPlayerSeeking:function(){this.seekStart=!0,this.seekingData.seekingStartTime=performance.now()},_onPlayerSeeked:function(){var e=this;this.player._splayer?this.player.one("canplay",function(){e._reportSeeked()}):this._reportSeeked()},_reportSeeked:function(){var e=performance.now(),e=Math.floor(e-this.seekingData.seekingStartTime);this._log("SEEKED",{vt:Math.floor(1e3*this.player.getCurrentTime()),cost:e})},_reportTrace:function(e){this._log("TRACE",{log:e})},_onPlayerError:function(){this.playId=0,this._LoadedData=1},_getbwEstimator:function(){var e=NaN;try{e=this.player._getbwEstimator&&this.player._getbwEstimator()}catch(e){}return e},_getCbs:function(){return!this.player.getOptions().isLive&&this.seekStart?1:0},_log:function(e,t){if(this.trackLog){this.updateSourceInfo();var r,i=s.copy(this.opt),n=(this.requestId=y.guid(),g.logReportTo),e=(i.e=d[e]+"",i.en=e,i.ri=this.sessionId,i.bi=i.bi&&String(i.bi),i.t=(new Date).getTime()+"",i.cdn_ip=this._userNetInfo.cdnIp,i.hn=this._userNetInfo.localIp,this.player.getCurrentQuality()),o=(""!=e&&(i.definition=e.definition),[]),e=(s.each(t,function(e,t){if("string"!=typeof t)try{t=JSON.stringify(t)}catch(e){}o.push(e+"="+t)}),""),t=this.player.getOptions(),e=((e=t&&t.vid||this.lightSaasVideoId?t.vid||this.lightSaasVideoId:e)&&o.push("vid="+e),"");(e=t&&t.mediaAuth?t.mediaAuth:e)&&o.push("pauth="+e);try{Aliplayer&&Aliplayer.__logCallback__&&(i.args=o,Aliplayer.__logCallback__(i))}catch(e){console.log(e)}return""==(o=o.join("&"))&&(o="0"),i.args=this.encodeURL(o),this._logService?this._logService.add(i):(r=[],s.each(i,function(e,t){r.push(e+"="+t)}),r=r.join("&"),l.jsonp(n+"?"+r,function(){},function(){})),this.sessionId}},_imageInfo:function(){try{var e,t,r,i,n,o,a;return/MSIE\s8\.0/.test(navigator.userAgent)?{}:(e=this.player.tag)?(t=document.createElement("canvas"),r=e.videoWidth,i=e.videoHeight,t.width=r,t.height=i,(n=t.getContext("2d")).save(),n.drawImage(e,0,0,r,i),n.restore(),o=t.toDataURL("image/jpeg",1),a="",{imgLength:(a=o?(a=o.substr(o.indexOf(",")+1))||"":a).length}):{}}catch(e){return{}}}});t.exports=e},{"../config":14,"../lib/data":30,"../lib/event":33,"../lib/io":40,"../lib/object":42,"../lib/oo":43,"../lib/playerutil":46,"../lib/ua":49,"../player/base/event/eventtype":70,"./log":63,"./util":65}],65:[function(e,t,r){var i=e("../lib/cookie"),n=e("../lib/data"),o=e("../lib/ua");t.exports.getUuid=function(){var e=i.get("p_h5_u");return e||(e=n.guid(),i.set("p_h5_u",e,730)),e},t.exports.getTerminalType=function(){var e="pc";return o.IS_IPAD?e="pad":o.IS_ANDROID?e="android":o.IS_IOS&&(e="iphone"),e},t.exports.returnUTCDate=function(e){var t=e.getUTCFullYear(),r=e.getUTCMonth(),i=e.getUTCDate(),n=e.getUTCHours(),o=e.getUTCMinutes(),a=e.getUTCSeconds(),e=e.getUTCMilliseconds();return Date.UTC(t,r,i,n,o,a,e)},t.exports.getRfc822=function(e){return e.toUTCString().replace("UTC","GMT")}},{"../lib/cookie":29,"../lib/data":30,"../lib/ua":49}],66:[function(e,t,r){var o=e("./base/player"),a=e("./flash/flashplayer"),s=e("./saas/mtsplayer"),l=e("./saas/vodplayer"),c=e("./saas/lightPlayer"),u=e("./audio/audioplayer"),p=e("./hls/hlsplayer"),d=e("./flv/flvplayer"),h=e("./rts/rtsplayer"),f=e("./drm/drmplayer"),y=e("./splayer/splayer"),_=e("../lib/ua"),g=e("../lib/playerutil"),v=(e("../lib/dom"),e("../lib/io"),e("../lang/index")),m=e("../lib/constants"),S=e("./base/event/eventtype");t.exports.create=function(e,t){e._userOptions||(e._userOptions=Object.assign({},e)),navigator&&navigator.userAgent&&-1<navigator.userAgent.indexOf("Olympic_Android")&&(e.useNativeControls=!0),e.readyCallback=t="function"!=typeof t?function(){}:t,v.setCurrentLanguage(e.language,"h5",e.languageTexts);var r,t=g.handleOption(e),e=t.source,i=g.isAudio(e),n=(i&&(t.mediaType="audio"),g.createWrapper(t));if(n.player)return n.player;if(i)r=new u(n,t);else if(g.isRts(e))r=new h(n,t);else if((t.forceH265||t.enableH265)&&(g.isMp4(e)||g.isFlv(e)||g.isHls(e)))r=new y(n,t);else if((t.forceH266||t.enableH266)&&g.isMp4(e))r=new y(n,t);else if(!t.useFlashPrism&&g.isFlv(e)&&g.isSupportFlv())r=new d(n,t);else if(_.IS_MOBILE||!t.useFlashPrism&&!g.isRTMP(e))if(-1!==[null,void 0].indexOf(t.mediaAuth)||t.source)if(t.vid&&!t.source)if(t.authInfo)r=new s(n,t);else{if(!(t.playauth||t.accessKeyId&&t.accessKeySecret))throw i="vid="+t.vid+" playauth='', playauth property is required by VOD(\u89c6\u9891\u70b9\u64ad) as new Aliplayer.",new Error(i);r=new l(n,t)}else g.isDash(e)&&g.isSupportMSE()?r=new f(n,t):g.isHls(e)?g.canPlayHls()?r=new(g.isSupportHls()&&(g.isUsedHlsPluginOnMobile()||g.isSafariUsedHlsPlugin(t.useHlsPluginForSafari))?t.isDrm?f:p:t.isDrm?f:o)(n,t):g.isSupportHls()?r=new(t.isDrm?f:p)(n,t):_.os.pc?t.userH5Prism||t.useH5Prism||(r=new a(n,t)):r=new o(n,t):(r=new o(n,t),t.source||(i={error_code:m.ErrorCode.InvalidSourceURL,error_msg:"InvalidSourceURL",display_msg:v.get("Error_Empty_Source")},r.trigger(S.Player.Error,i)));else r=new c(n,t);else r=new a(n,t);return r}},{"../lang/index":23,"../lib/constants":28,"../lib/dom":32,"../lib/io":40,"../lib/playerutil":46,"../lib/ua":49,"./audio/audioplayer":68,"./base/event/eventtype":70,"./base/player":91,"./drm/drmplayer":98,"./flash/flashplayer":99,"./flv/flvplayer":101,"./hls/hlsplayer":103,"./rts/rtsplayer":105,"./saas/lightPlayer":109,"./saas/mtsplayer":111,"./saas/vodplayer":117,"./splayer/splayer":126}],67:[function(e,t,r){var o=e("./base/player"),a=e("./flash/flashplayer"),s=e("./saas/mtsplayer"),l=e("./saas/vodplayer"),c=e("./saas/lightPlayer"),u=e("./audio/audioplayer"),p=e("./hls/hlsplayer"),d=e("./flv/flvplayer"),h=e("./rts/rtsplayer"),f=e("./drm/drmplayer"),y=e("./splayer/splayer"),_=e("../lib/ua"),g=e("../lib/playerutil"),v=(e("../lib/dom"),e("../lib/io"),e("../lang/index")),m=e("../lib/constants"),S=e("./base/event/eventtype");t.exports.create=function(e,t){e._userOptions||(e._userOptions=Object.assign({},e)),navigator&&navigator.userAgent&&-1<navigator.userAgent.indexOf("Olympic_Android")&&(e.useNativeControls=!0),e.readyCallback=t="function"!=typeof t?function(){}:t,v.setCurrentLanguage(e.language,"h5",e.languageTexts);var r,t=g.handleOption(e),e=t.source,i=g.isAudio(e),n=(i&&(t.mediaType="audio"),g.createWrapper(t));if(n.player)return n.player;if(i)r=new u(n,t);else if(g.isRts(e))r=new h(n,t);else if((t.forceH265||t.enableH265)&&(g.isMp4(e)||g.isFlv(e)||g.isHls(e)))r=new y(n,t);else if((t.forceH266||t.enableH266)&&g.isMp4(e))r=new y(n,t);else if(!t.useFlashPrism&&g.isFlv(e)&&g.isSupportFlv())r=new d(n,t);else if(_.IS_MOBILE||!t.useFlashPrism&&!g.isRTMP(e))if(-1!==[null,void 0].indexOf(t.mediaAuth)||t.source)if(t.vid&&!t.source)if(t.authInfo)r=new s(n,t);else{if(!(t.playauth||t.accessKeyId&&t.accessKeySecret))throw i="vid="+t.vid+" playauth='', playauth property is required by VOD(\u89c6\u9891\u70b9\u64ad) as new Aliplayer.",new Error(i);r=new l(n,t)}else g.isDash(e)&&g.isSupportMSE()?r=new f(n,t):g.isHls(e)?g.canPlayHls()?r=new(g.isSupportHls()&&(g.isUsedHlsPluginOnMobile()||g.isSafariUsedHlsPlugin(t.useHlsPluginForSafari))?t.isDrm?f:p:t.isDrm?f:o)(n,t):g.isSupportHls()?r=new(t.isDrm?f:p)(n,t):_.os.pc?t.userH5Prism||t.useH5Prism||(r=new a(n,t)):r=new o(n,t):(r=new o(n,t),t.source||(i={error_code:m.ErrorCode.InvalidSourceURL,error_msg:"InvalidSourceURL",display_msg:v.get("Error_Empty_Source")},r.trigger(S.Player.Error,i)));else r=new c(n,t);else r=new a(n,t);return r}},{"../lang/index":23,"../lib/constants":28,"../lib/dom":32,"../lib/io":40,"../lib/playerutil":46,"../lib/ua":49,"./audio/audioplayer":68,"./base/event/eventtype":70,"./base/player":91,"./drm/drmplayer":98,"./flash/flashplayer":99,"./flv/flvplayer":101,"./hls/hlsplayer":103,"./rts/rtsplayer":105,"./saas/lightPlayer":109,"./saas/mtsplayer":111,"./saas/vodplayer":117,"./splayer/splayer":126}],68:[function(e,t,r){var i=e("../base/player"),n=e("../../ui/component"),o=e("../../lib/dom"),a=e("../../lib/object"),s=e("../../lib/playerutil"),e=i.extend({init:function(e,t){this._isAudio=!0,void 0===t.skinLayout&&(t.skinLayout=s.defaultAudioLayout),i.call(this,e,t)}});e.prototype.createEl=function(){"AUDIO"!==this.tag.tagName&&(this._el=this.tag,this.tag=n.prototype.createEl.call(this,"audio"));var t=this._el,e=this.tag,r=(e.player=this,o.getElementAttributes(e));return a.each(r,function(e){t.setAttribute(e,r[e])}),this.setVideoAttrs(),e.parentNode&&e.parentNode.insertBefore(t,e),o.insertFirst(e,t),t},t.exports=e},{"../../lib/dom":32,"../../lib/object":42,"../../lib/playerutil":46,"../../ui/component":130,"../base/player":91}],69:[function(e,t,r){var a=e("../../../lib/event"),s=e("./eventtype"),i=e("../eventHandler/video/index"),n=e("../eventHandler/player/index");t.exports.offAll=function(e){var t,r,i,n=e.tag,o=e._el;for(t in s.Video)a.off(n,s.Video[t]);for(r in s.Player)a.off(o,s.Player[r]);for(i in s.Private)a.off(o,s.Private[i])},t.exports.offVideoAll=function(e){var t,r=e.tag;for(t in s.Video)a.off(r,s.Video[t])},t.exports.onAll=function(e){i.bind(e),n.bind(e)}},{"../../../lib/event":33,"../eventHandler/player/index":74,"../eventHandler/video/index":84,"./eventtype":70}],70:[function(e,t,r){t.exports={Video:{TimeUpdate:"timeupdate",Play:"play",Playing:"playing",Pause:"pause",CanPlay:"canplay",Waiting:"waiting",Ended:"ended",Error:"error",Suspend:"suspend",Stalled:"stalled",LoadStart:"loadstart",DurationChange:"durationchange",LoadedData:"loadeddata",LoadedMetadata:"loadedmetadata",Progress:"progress",CanPlayThrough:"canplaythrough",ContextMenu:"contextmenu",Seeking:"seeking",Seeked:"seeked",ManualEnded:"manualended",VolumeChange:"volumechange",RateChange:"ratechange"},Player:{TimeUpdate:"timeupdate",DurationChange:"durationchange",Init:"init",Ready:"ready",Play:"play",Playing:"playing",Pause:"pause",CanPlay:"canplay",Waiting:"waiting",Ended:"ended",Error:"error",RequestFullScreen:"requestFullScreen",CancelFullScreen:"cancelFullScreen",Snapshoted:"snapshoted",Snapshoting:"snapshoting",OnM3u8Retry:"onM3u8Retry",LiveStreamStop:"liveStreamStop",AutoPlayPrevented:"autoPlayPrevented",AutoPlay:"autoplay",StartSeek:"startSeek",CompleteSeek:"completeSeek",TextTrackReady:"textTrackReady",AudioTrackReady:"audioTrackReady",AudioTrackUpdated:"audioTrackUpdated",LevelsLoaded:"levelsLoaded",AudioTrackSwitch:"audioTrackSwitch",AudioTrackSwitched:"audioTrackSwitched",LevelSwitch:"levelSwitch",LevelSwitched:"levelSwitched",MarkerDotOver:"markerDotOver",MarkerDotOut:"markerDotOut",DefaultBandWidth:"defaultbandwidth",ResolutionChange:"resolutionChange",SeiFrame:"seiFrame",RtsFallback:"rtsFallback",RtsTraceId:"rtsTraceId",H265PlayInfo:"h265PlayInfo",H266PlayInfo:"h266PlayInfo",H265DecoderOverload:"h265DecoderOverload",SettingSelected:"settingSelected"},Private:{Create:"create",Play_Btn_Show:"play_btn_show",UiH5Ready:"uiH5Ready",Error_Hide:"error_hide",Error_Show:"error_show",Info_Show:"info_show",Info_Hide:"info_hide",H5_Loading_Show:"h5_loading_show",H5_Loading_Hide:"h5_loading_hide",HideProgress:"hideProgress",CancelHideProgress:"cancelHideProgress",UpdateProgress:"updateProgress",UpdateCursorPosition:"updateCursorPosition",Click:"click",MouseOver:"mouseover",MouseOut:"mouseout",MouseEnter:"mouseenter",MouseLeave:"mouseleave",TouchStart:"touchstart",TouchMove:"touchmove",TouchEnd:"touchend",HideBar:"hideBar",ShowBar:"showBar",ControlBarClick:"controlBarClick",ReadyState:"readyState",SourceLoaded:"sourceloaded",QualityChange:"qualitychange",Play_Btn_Hide:"play_btn_hide",Cover_Hide:"cover_hide",Cover_Show:"cover_show",SeekStart:"seekStart",EndStart:"endStart",UpdateProgressBar:"updateProgressBar",LifeCycleChanged:"lifeCycleChanged",Dispose:"dispose",Created:"created",Snapshot_Hide:"snapshot_hide",AutoStreamShow:"auto_stream_show",AutoStreamHide:"auto_stream_hide",VolumnChanged:"volumnchanged",LiveShiftQueryCompleted:"liveShiftQueryCompleted",LiveShiftSwitchToLive:"LiveShiftSwitchToLive",StreamSelectorHide:"streamSelectorHide",SpeedSelectorHide:"speedSelectorHide",SettingShow:"settingShow",SettingHide:"settingHide",SelectorShow:"selectorShow",SelectorHide:"selectorHide",SettingListShow:"settingListShow",SettingListHide:"settingListHide",ThumbnailHide:"thumbnailHide",ThumbnailShow:"thumbnailShow",ThumbnailLoaded:"thumbnailLoaded",TooltipShow:"tooltipShow",TooltipHide:"tooltipHide",SelectorUpdateList:"selectorUpdateList",SelectorValueChange:"selectorValueChange",SelectorGenerateList:"selectorGenerateList",VolumeVisibilityChange:"volumeVisibilityChange",VolumeUpdatePosition:"volumeUpdatePosition",ChangeURL:"changeURL",UpdateToSettingList:"updateToSettingList",CCChanged:"CCChanged",CCStateChanged:"CCStateChanged",CCReset:"ccReset",TextTrackFounded:"textTrackFounded",UserTrackReset:"userTrackReset",PlayClick:"click",ProgressMarkerLoaded:"progressMarkerLoaded",MarkerTextShow:"markerTextShow",MarkerTextHide:"markerTextHide",PREPARE:"prepare",ProgressMarkerChanged:"progressMarkerChanged",SeiFrame:"privateSeiFrame",PlayInfoLoaded:"playInfoLoaded",Retry:"retry",LicenseHasResult:"licenseHasResult",PatchWaiting:"patchWaiting",VttHide:"vttHide",VttSwitchTrack:"vttSwitchTrack",VttClearTracks:"vttClearTracks",SafariDrmLevelSwitch:"safariDrmLevelSwitch",VodRequestException:"vodRequestException",VodRequestExceptionResume:"vodRequestExceptionResume",TraceLog:"traceLog"}}},{}],71:[function(e,t,r){e("../../event/eventtype");var i=e("../../../../lib/dom"),n=e("../../../../lib/ua");t.exports.handle=function(){(!n.IS_IOS||n.IS_IOS&&this._splayer&&2===this._splayer.renderType)&&i.removeClass(this.el(),"prism-fullscreen")}},{"../../../../lib/dom":32,"../../../../lib/ua":49,"../../event/eventtype":70}],72:[function(e,t,r){var i=e("../../event/eventtype");t.exports.handle=function(e){var t=this;t.trigger(i.Player.CompleteSeek,e.paramData.toTime),t.one(i.Player.CanPlay,function(){t._enteredProgressMarker&&t.pause()})}},{"../../event/eventtype":70}],73:[function(e,t,r){var i=e("../../event/eventtype"),n=(e("../../../../lib/constants"),e("../../../../lang/index"),e("../../../../monitor/util"));t.exports.handle=function(e){var t=this,e=e.paramData;t.trigger(i.Private.H5_Loading_Hide),t.trigger(i.Private.Cover_Hide),t.trigger(i.Private.Play_Btn_Hide),t.trigger(i.Private.SettingListHide),t.trigger(i.Private.SelectorHide),t.trigger(i.Private.VolumeVisibilityChange,""),e=e||{},t._monitor&&(e.uuid=n.getUuid(),e.serverRequestId=t._serverRequestId,e.requestId=t._monitor.sessionId,e.cdnIp=t._monitor._userNetInfo.cdnIp,e.localIp=t._monitor._userNetInfo.localIp),t._isError=!0,t.trigger(i.Private.Error_Show,e),t.trigger(i.Private.LifeCycleChanged,{type:i.Player.Error,data:e})}},{"../../../../lang/index":23,"../../../../lib/constants":28,"../../../../monitor/util":65,"../../event/eventtype":70}],74:[function(e,t,r){var i=e("../../event/eventtype"),o=e("../../../../lib/event"),a=e("./lifecyclecommon"),n={endStart:e("./endstart"),seekStart:e("./seekstart"),requestFullScreen:e("./requestfullscreen"),cancelFullScreen:e("./cancelfullscreen"),error:e("./error"),privateSeiFrame:e("./seiframe"),patchWaiting:e("../video/waiting")},s=[i.Private.EndStart,i.Private.SeekStart,i.Player.RequestFullScreen,i.Player.CancelFullScreen,i.Player.Error,i.Player.Ready,i.Private.Dispose,i.Private.Created,i.Private.SeiFrame,i.Private.PatchWaiting];t.exports.bind=function(e){e.el();for(var t=0;t<s.length;t++){var r=s[t];"undefined"!=n[r]&&!function(r,i,n){var e=r.el();o.on(e,i,function(e){var t=(n&&n.handle?n:a).handle;t.call(r,e,i)})}(e,r,n[r])}}},{"../../../../lib/event":33,"../../event/eventtype":70,"../video/waiting":90,"./cancelfullscreen":71,"./endstart":72,"./error":73,"./lifecyclecommon":75,"./requestfullscreen":76,"./seekstart":77,"./seiframe":78}],75:[function(e,t,r){var i=e("../../event/eventtype");t.exports.handle=function(e,t){this.trigger(i.Private.LifeCycleChanged,{type:t,data:e})}},{"../../event/eventtype":70}],76:[function(e,t,r){e("../../event/eventtype");var i=e("../../../../lib/dom"),n=e("../../../../lib/ua");t.exports.handle=function(){(!n.IS_IOS||n.IS_IOS&&this._splayer&&2===this._splayer.renderType)&&i.addClass(this.el(),"prism-fullscreen")}},{"../../../../lib/dom":32,"../../../../lib/ua":49,"../../event/eventtype":70}],77:[function(e,t,r){var i=e("../../event/eventtype");t.exports.handle=function(e){this._seeking=!0,this.trigger(i.Player.StartSeek,e.paramData.fromTime)}},{"../../event/eventtype":70}],78:[function(e,t,r){e("../../event/eventtype");t.exports.handle=function(e){var t,r,e=e.paramData,i=e.pts;this._hls&&(t=e.pts,r=this._initPTS,i=parseInt((t-r)/90,10)),this._seis[i]=e.dataContent}},{"../../event/eventtype":70}],79:[function(e,t,r){var i=e("../../event/eventtype");t.exports.handle=function(e){var t=this,r=(t._retrySwitchUrlCount=0,t._liveRetryCount=0,t._clearLiveErrorHandle(),(new Date).getTime()-t.readyTime);t._options.autoplay||t._options._autoplay||!t.paused()||(t.trigger(i.Private.H5_Loading_Hide),t.trigger(i.Private.Play_Btn_Show)),t.trigger(i.Player.CanPlay,{loadtime:r})}},{"../../event/eventtype":70}],80:[function(e,t,r){var i=e("../../event/eventtype"),n=e("../../../../lib/dom"),o=e("../../../../lib/ua");t.exports.handle=function(e){this._seeking=!1;var t=this.tag;"none"===t.style.display&&o.IS_IOS&&setTimeout(function(){n.css(t,"display","block")},100),this.trigger(i.Video.CanPlayThrough)}},{"../../../../lib/dom":32,"../../../../lib/ua":49,"../../event/eventtype":70}],81:[function(e,t,r){t.exports.handle=function(e,t){var r="";e&&e.paramData&&(r=e.paramData),this.trigger(t,r)}},{}],82:[function(e,t,r){var i=e("../../event/eventtype");e("../../../../lang/index"),e("../../../../lib/event");t.exports.handle=function(e){var t=this;t.waiting=!1,t._ended=!0,t.traceLog("video/ended.js","event::ended"),t.trigger(i.Private.Play_Btn_Show),t.trigger(i.Player.Ended),t._monitor&&t._monitor._onPlayerInit(),t._options.rePlay?(t._monitor&&(t._monitor.startHeartBeat(),t._monitor._LoadedData=1),t.seek(0),t.tag.play()):t._options.isLive&&t.trigger(i.Private.H5_Loading_Hide)}},{"../../../../lang/index":23,"../../../../lib/event":33,"../../event/eventtype":70}],83:[function(e,t,r){var s=e("../../event/eventtype"),l=e("../../../../lib/constants"),c=e("../../../../lang/index"),u=e("../../../../lib/event"),p=e("../../../../lib/ua"),o=(e("../../../../lib/io"),e("../../../../lib/playerutil"));function d(t,e,r){var i=t._options,n=i.source||"";4===(e=4!==e&&p.IS_IOS&&/qqbrowser/i.test(p.USER_AGENT)?4:e)&&o.isHls(n)?o.detectRegionBlock(n,function(e){e?(e={mediaId:i.isLive?"ISLIVE":i.vid||"",error_code:l.ErrorCode.RegionBlock,error_msg:c.get("Error_Region_Block_Text")},t.logError(e),t.trigger("error",e)):r()}):r()}t.exports.handle=function(e){var i=this;if(i.waiting=!1,i._clearTimeout(),i.checkOnline()&&!i._splayer){var n,o="",e=e.target||e.srcElement,a=e.error&&e.error.message||"",o="";if(e.error&&e.error.code&&(n=e.error.code,o=l.VideoErrorCode[e.error.code],a=n+" || "+a),i.traceLog("video/error.js","event::error#"+n+"#"+a),i._options.isLive)d(i,n,function(){i._options.liveRetry>i._liveRetryCount?i._reloadAndPlayForM3u8():(i._liveRetryCount=0,i.trigger(s.Player.LiveStreamStop),i._liveErrorHandle=setTimeout(function(){var e={mediaId:"ISLIVE",error_code:o,error_msg:c.get("Error_Play_Text")+"\uff0c"+c.get("Error_Retry_Text")};i.logError(e),i.trigger("error",e)}),p.IS_UC&&(i._liveErrorHandle=null))});else if(-1<a.indexOf("NS_ERROR_DOM_MEDIA_FATAL_ERR")){var e=i.getCurrentTime(),t=i.getDuration();t-e<.5&&(i.pause(),i._ended=!0,i.tag.currentTime=t,u.trigger(i.tag,s.Video.ManualEnded))}else if(3==n){if(i._nudgeCount=i._nudgeCount||0,i._nudgeCount<5){i._nudgeCount++;e=+i._nudgeCount,t=i.getCurrentTime()+e;if(t<i.getDuration())return void i._loadByUrlInner(i._options.source,t,!0)}e={mediaId:i._options.vid||"",error_code:o,error_msg:a};i.logError(e),e.display_msg=l.VideoErrorCodeText[n],e.diagnosis_info=c.get("Tip_Err_Decode")+"<br />"+c.get("Tip_Err_Common_Short")+a,i.trigger(s.Player.Error,e)}else i._reloadForVod()||d(i,n,function(){var e,t,r;e=c.get("Error_Play_Text"),t=!1,n<3?e=l.VideoErrorCodeText[n]:i._eventState==l.SUSPEND?(e=c.get("Error_Load_Abort_Text"),o=l.ErrorCode.RequestDataError):i._eventState==l.LOAD_START?(e=c.get("Error_Network_Text"),0<i._options.source.indexOf("auth_key")&&(e=e+"\uff0c"+c.get("Error_AuthKey_Text")),o=l.ErrorCode.StartLoadData):i._eventState==l.LOADED_METADATA&&(e=c.get("Error_Play_Text"),o=l.ErrorCode.PlayingError),e=e+"\uff0c"+c.get("Error_Retry_Text"),1<i._urls.length&&i._retrySwitchUrlCount<3&&-1==i._options.source.indexOf(".mpd")&&(i.switchUrl(),t=!0),r={mediaId:i._options.vid||"",error_code:o,error_msg:a},t||(i.logError(r),r.display_msg=e,i.trigger(s.Player.Error,r))})}}},{"../../../../lang/index":23,"../../../../lib/constants":28,"../../../../lib/event":33,"../../../../lib/io":40,"../../../../lib/playerutil":46,"../../../../lib/ua":49,"../../event/eventtype":70}],84:[function(e,t,r){var n=e("../../../../lib/event"),o=e("../../event/eventtype"),i={canplay:e("./canplay"),canplaythrough:e("./canplaythrough"),common:e("./common"),ended:e("./ended"),error:e("./error"),pause:e("./pause"),play:e("./play"),playing:e("./playing"),waiting:e("./waiting"),timeupdate:e("./timeupdate"),manualended:e("./ended"),loadedmetadata:e("./loadedmetadata")};t.exports.bind=function(e){e.tag;for(var t in o.Video){t=o.Video[t];!function(t,r,i){var e=t.tag;n.on(e,r,function(e){i.handle.call(t,e,r),r!=o.Video.Error&&(r==o.Video.ManualEnded&&(r=o.Video.Ended),t.trigger(o.Private.LifeCycleChanged,{type:r,data:e}))})}(e,t,void 0!==i[t]?i[t]:i.common)}}},{"../../../../lib/event":33,"../../event/eventtype":70,"./canplay":79,"./canplaythrough":80,"./common":81,"./ended":82,"./error":83,"./loadedmetadata":85,"./pause":86,"./play":87,"./playing":88,"./timeupdate":89,"./waiting":90}],85:[function(e,t,r){var i=e("../../event/eventtype");t.exports.handle=function(e){var t=this.tag;this._duration=t.duration<1?0:t.duration,this.trigger(i.Private.ReadyState),this._splayer&&this.trigger(i.Video.DurationChange),this.trigger(i.Video.LoadedMetadata)}},{"../../event/eventtype":70}],86:[function(e,t,r){var i=e("../../event/eventtype"),n=e("../../../../lib/ua");t.exports.handle=function(e){var t=this;t._seeking&&t._splayer||(t._hls&&t._options&&t._options.isLive&&n.IS_FIREFOX&&t.trigger(i.Private.Play_Btn_Show),t._clearTimeout(),t.trigger(i.Private.AutoStreamHide),t.trigger(i.Player.Pause),t._isManualPause&&(t.trigger(i.Private.Play_Btn_Show),t.trigger(i.Private.H5_Loading_Hide)),t.waiting=!1)}},{"../../../../lib/ua":49,"../../event/eventtype":70}],87:[function(e,t,r){var i=e("../../event/eventtype");t.exports.handle=function(e){this.trigger(i.Private.Error_Hide),this.trigger(i.Private.Cover_Hide),this.trigger(i.Private.AutoStreamHide),this.waiting=!1,this.trigger(i.Player.Play)}},{"../../event/eventtype":70}],88:[function(e,t,r){var i=e("../../event/eventtype");t.exports.handle=function(e){var t=this,r=(t.trigger(i.Private.H5_Loading_Hide),t.trigger(i.Private.Cover_Hide),t.trigger(i.Private.Info_Hide),t.waiting=!1,t._ended=!1,t._liveRetryCount=0,t._vodRetryCount=0,t._seeking=!1,t.getCurrentTime());t._waitingReloadTime!=r&&(t._waitingTimeoutCount=0),t._checkTimeoutHandle&&(clearTimeout(t._checkTimeoutHandle),t._checkTimeoutHandle=null),t._waitingLoadedHandle&&(clearTimeout(t._waitingLoadedHandle),t._waitingLoadedHandle=null),t._ucSourceHandle&&(clearTimeout(t._ucSourceHandle),t._ucSourceHandle=null),t._waitingDelayLoadingShowHandle&&(clearTimeout(t._waitingDelayLoadingShowHandle),t._waitingDelayLoadingShowHandle=null),t._waitingTimeoutHandle&&(clearTimeout(t._waitingTimeoutHandle),t._waitingTimeoutHandle=null,t._ccService)&&t._options.isLive&&(r=t._ccService.getCurrentSubtitle(),t._setDefaultCC=!0,r)&&t._ccService.switch(r),t.trigger(i.Private.AutoStreamHide),t.trigger(i.Player.Playing),t.trigger(i.Private.Error_Hide),t.tag.paused||t.trigger(i.Private.Play_Btn_Hide)}},{"../../event/eventtype":70}],89:[function(e,t,r){var p=e("../../event/eventtype"),d=e("../../../../lib/ua"),h=e("../../../../lib/event"),f=e("../../plugin/status");t.exports.handle=function(e){var t,r=this,e=(r.trigger(p.Player.TimeUpdate,e.timeStamp),r._decodeErrorNudgeTimer||(r._decodeErrorNudgeTimer=setTimeout(function(){r._nudgeCount=0},3e3)),(d.IS_IOS||d.IS_MAC_SAFARI)&&(clearTimeout(r._waitingPatchTimer),r._waitingPatchTimer=setTimeout(function(){r.waiting||r._isError||r.paused()||r._disposed||(console.log("!!!!!!!manually waiting!!!!!!!"),r.trigger(p.Private.PatchWaiting))},3e3)),r.getCurrentTime()),i=(r.waiting&&!r._TimeUpdateStamp&&(r._TimeUpdateStamp=e),0!=r.waiting&&r._TimeUpdateStamp==e||(r.trigger(p.Private.H5_Loading_Hide),r.trigger(p.Private.AutoStreamHide),r._checkTimeoutHandle&&clearTimeout(r._checkTimeoutHandle),r._waitingTimeoutHandle&&clearTimeout(r._waitingTimeoutHandle),r._waitingLoadedHandle&&clearTimeout(r._waitingLoadedHandle),r._ucSourceHandle&&(clearTimeout(r._ucSourceHandle),r._ucSourceHandle=null),r.waiting=!1),d.IS_ANDROID&&d.IS_UC&&(r._timeNotUpdateCount=r._timeNotUpdateCount||0,r.waiting||e!==r._TimeUpdateStamp||(r._timeNotUpdateCount++,2<=r._timeNotUpdateCount&&(r._timeNotUpdateCount=0,r.trigger(p.Private.PatchWaiting)))),r._TimeUpdateStamp=e,r._options.isLive||(t=!1,(t=(i=r.getDuration())<e&&!r.paused()||i-e<.2&&0<=d.browser.version.indexOf("49.")&&!r.paused()||r.exceedPreviewTime(e)?!0:t)&&!r._ended&&(r.pause(),h.trigger(r.tag,p.Video.ManualEnded))),r._player.tag),n=(i&&r._options.isLive&&(r._player.resolution&&0<i.videoWidth&&0<i.videoHeight&&(0<r._player.resolution.width||0<r._player.resolution.height)&&(r._player.resolution.width!==i.videoWidth||r._player.resolution.height!==i.videoHeight)&&(t={oldResolution:{width:r._player.resolution.width,height:r._player.resolution.height},newResolution:{width:i.videoWidth,height:i.videoHeight}},r.trigger(p.Player.ResolutionChange,t)),r._player.resolution.width=0==i.videoWidth?r._player.resolution.width:i.videoWidth,r._player.resolution.height=0==i.videoHeight?r._player.resolution.height:i.videoHeight),d.IS_CHROME&&Number(d.CHROME_VERSION)<50&&(r._playingSlientPause&&(clearTimeout(r._playingSlientPause),r._playingSlientPause=null),r._playingSlientPause=setTimeout(function(){var e,t;r._status!=f.playing||r.paused()||r._drm||r._urls.length||(e=r.getCurrentTime(),t=r._options.isLive?0:e,r._loadByUrlInner(r._options.source,t,e,!0))},3e3)),r._seis||{}),o=Object.keys(n);if(0!==o.length){var a=parseInt(1e3*e,10);if(!(l=n[a]))for(var s=0;s<250;s++){var l,c=a+s;if(l=n[c]){for(var u=0;u<o.length&&o[u]<=c;u++)delete n[o[u]];break}}l&&r.trigger(p.Player.SeiFrame,l)}}},{"../../../../lib/event":33,"../../../../lib/ua":49,"../../event/eventtype":70,"../../plugin/status":95}],90:[function(e,t,r){var o=e("../../event/eventtype"),a=e("../../../../lib/constants"),s=e("../../../../lib/event"),l=e("../../../../lang/index"),c=e("../../../../lib/ua"),u=e("../../../../lib/playerutil");t.exports.handle=function(e){var t=this;if(!t._options.isLive){var r=this.getCurrentTime(),i=this.getDuration();if(!t._ended&&0<i&&(i-r<.5||i<r))return t.pause(),t._ended=!0,void s.trigger(this.tag,o.Video.ManualEnded)}t.waiting=!0;function n(){t._checkTimeoutHandle&&(clearTimeout(t._checkTimeoutHandle),t._checkTimeoutHandle=null),t._waitingTimeoutHandle&&(clearTimeout(t._waitingTimeoutHandle),t._waitingTimeoutHandle=null),t._waitingLoadedHandle&&(clearTimeout(t._waitingLoadedHandle),t._waitingLoadedHandle=null),t._waitingDelayLoadingShowHandle&&(clearTimeout(t._waitingDelayLoadingShowHandle),t._waitingDelayLoadingShowHandle=null),t._ucSourceHandle&&(clearTimeout(t._ucSourceHandle),t._ucSourceHandle=null)}n(),t._waitingDelayLoadingShowHandle=setTimeout(function(){t.trigger(o.Private.H5_Loading_Show)},1e3*t._options.delayLoadingShow),t._TimeUpdateStamp=null,t._checkTimeoutHandle=setTimeout(function(){t.trigger(o.Private.AutoStreamShow)},1e3*t._options.loadDataTimeout),t.trigger(o.Player.Waiting),t._waitingTimeoutHandle=setTimeout(function(){var e;t.tag&&t._options&&(t.pause(),e={mediaId:t._options.vid||"",error_code:a.ErrorCode.LoadingTimeout,error_msg:l.get("Error_Waiting_Timeout_Text")},t.logError(e),t.trigger("error",e))},1e3*t._options.waitingTimeout),t._waitingLoadedHandle=setTimeout(function(){var e=t.getCurrentTime();0==t._waitingTimeoutCount&&e!=t._waitingReloadTime&&(t.traceLog("video/waiting.js","half-retry::"+t._options.waitingTimeout/2),t._waitingTimeoutCount=1,t._waitingReloadTime=e,e=t._options.isLive?0:e,t._loadByUrlInner(t._options.source,e,!0))},t._options.waitingTimeout/2*1e3),c.IS_ANDROID&&c.IS_DINGTALK&&(t._ucSourceHandle=setTimeout(function(){u.detectRegionBlock(t._options.source,function(e){e&&(e={mediaId:t._options.vid,error_code:a.ErrorCode.RegionBlock,error_msg:l.get("Error_Region_Block_Text")},t.logError(e),t.trigger("error",e))})},5e3)),t.on("error",function(){n()})}},{"../../../../lang/index":23,"../../../../lib/constants":28,"../../../../lib/event":33,"../../../../lib/playerutil":46,"../../../../lib/ua":49,"../../event/eventtype":70}],91:[function(e,t,N){var n="undefined"==typeof Promise?e("es6-promise").Promise:Promise,o=e("../../ui/component"),a=e("../../lib/object"),s=e("../../lib/dom"),l=e("../../lib/event"),c=e("../../ui/exports"),u=e("../../monitor/monitor"),p=e("../../lib/ua"),d=e("../../lib/constants"),h=e("../../lib/playerutil"),i=e("./x5play"),r=e("../../lib/cookie"),f=e("../../lang/index"),y=e("../../feature/autoPlayDelay"),_=e("./event/eventmanager"),g=e("../../ui/component/cover"),v=e("../../ui/component/license-watermark"),m=e("../../feature/license"),S=e("../../ui/component/text-track-display"),b=e("../../ui/component/play-animation"),T=e("../../commonui/autostreamselector"),E=e("./event/eventtype"),w=e("./plugin/lifecyclemanager"),x=e("../service/export"),P=e("../../ui/component/progressmarker"),C=e("../../feature/keyboardControl"),k=e("../../feature/AntiRecord"),I=e("./eventHandler/video/index"),A=e("../../lib/vttnext/index"),L=e("../../lib/codec-probe"),R=e("../splayer/splayerinjector"),e=e("../../ui/component/util").throttle,D="base/player.js",O=o.extend({init:function(e,i){var t;function r(e){var t=this;if("native"!==e.paramData.renderType){var r,e=e.paramData.codecTag;if(h.isH265Codec(e))r=d.FEATURE_ID_H265;else{if(!h.isH266Codec(e))return;r=d.FEATURE_ID_H266}m.getLicense(i.license.domain,i.license.key).then(function(e){e=e.validate(d.PLAYER_SDK_CODE,r);if(console.log("license validate result => ",e),0===e)t.trigger(E.Private.LicenseHasResult,{result:d.LicenseResultCode.Success,featureId:r});else{if(1===e)return n.reject(d.LicenseResultCode.NotFound);{if(2===e)return n.reject(d.LicenseResultCode.Expired);console.error("license validate unknown error")}}}).catch(function(e){t.trigger(E.Private.LicenseHasResult,{result:e,featureId:r}),m.logError(e)})}}this.tag=e,this.loaded=!1,this.played=!1,this.oncePlayed=!1,this.waiting=!1,this._urls=[],this._currentPlayIndex=0,this._retrySwitchUrlCount=0,this._isError=!1,this._isHls=!1,this._liveRetryCount=0,this._liveRetryTimer=null,this._vodRetryCount=0,this._nudgeCount=0,this._seeking=!1,this._serverRequestId=0,this._waitingTimeoutCount=0,this._waitingReloadTime=0,this._created=!1,this._enteredProgressMarker=!1,this._liveShiftSeekStartTime=0,this._duration=0,this._seis={},this._initPTS=0,this.isMutiLevel=!1,this._antiRecord=null,this.__disposed=!1,this.resolution={width:0,height:0},void 0===i.skinLayout&&(i.skinLayout=h.defaultH5Layout),h.isRts(i.source)&&!i.autoplay&&(i.preload=!1),o.call(this,this,i),this.addClass("prism-player"),i.plugins&&a.each(i.plugins,function(e,t){this[e](t)},this),this._createService(),this.UI={},i.useNativeControls?this.tag.setAttribute("controls","controls"):(this.UI=c,0==i.errorDisplay&&(this.UI.errorDisplay=void 0)),this.initChildren(),this._options.trackLog&&(this._monitor=new u(this,{video_id:0,album_id:0,from:this._options.from,source:this._options.source,logBatched:this._options.logBatched},this._options.trackLog)),_.onAll(this),this.trigger(E.Private.Create,i._userOptions),this._options.preventRecord&&(this._antiRecord=new k({player:this}),this._antiRecord.start()),this._lifeCycleManager=new w(this),this._overrideNativePlay(),this._liveshiftService&&!this._liveshiftService.validate()?(e={mediaId:this._options.vid||"",error_code:d.ErrorCode.InvalidParameter,error_msg:f.get("ShiftLiveTime_Error")},this.trigger(E.Player.Error,e)):(this._options.extraInfo&&(e=this._options.extraInfo).liveRetry&&(this._options.liveRetry=e.liveRetry),this.on(E.Private.ReadyState,function(){this.trigger(E.Player.Ready)}),this.on(E.Player.H265PlayInfo,r),this.on(E.Player.H266PlayInfo,r),this.on(E.Private.LicenseHasResult,function(e){var t=d.LicenseResultCode;-1<[t.NotFound,t.Expired,t.CertInvalid,t.ResourceIncorrect,t.LicenseKeyInvalid,t.DomainInvalid].indexOf(e.paramData.result)&&(this.UI.licenseWatermark=v,this._licenseWatermark=this.addChild("licenseWatermark",this._options))}),this._thumbnailService&&this._options.thumbnailUrl&&this._thumbnailService.get(this._options.thumbnailUrl),0<this._options.progressMarkers.length&&this.trigger(E.Private.ProgressMarkerLoaded,this._options.progressMarkers),this._options.source&&this._options._native&&this._executeReadyCallback(),this._options.autoplay||this._options.preload?this.trigger(E.Private.H5_Loading_Show):this.trigger(E.Private.Play_Btn_Show),this._extraMultiSources(),this._options.source&&(this.trigger(E.Private.PREPARE,"custom"),this._options.autoPlayDelay?(this._autoPlayDelay=new y(this),(t=this)._autoPlayDelay.handle(function(){t.initPlay()})):this.initPlay()),C.init.call(this),this._vttBroker=new A({player:this}),this._getUserTextTracks())}});O.prototype.isSupportMSE=function(){return h.isSupportMSE()},O.prototype.initPlay=function(e){this._initPlayBehavior(e,this._options.source)},O.prototype.initChildren=function(){var e=this.options(),t=e.skinLayout;if(!1!==t&&!a.isArray(t))throw new Error("PrismPlayer Error: skinLayout should be false or type of array!");!1!==t&&0!==t.length&&(this.options({children:t}),o.prototype.initChildren.call(this)),this.UI.cover=g,e.className="",this.addChild("cover",e),this.UI.playanimation=b,this.addChild("playanimation",e),this.UI.autoStreamSelector=T,this.addChild("autoStreamSelector",e),this.UI.progressMarker=P,this.addChild("progressMarker",e),this.UI.textTrackDisplay=S,this.addChild("textTrackDisplay",e),this.trigger(E.Private.UiH5Ready)},O.prototype.createEl=function(){var e=!1,t=("VIDEO"!==this.tag.tagName?(this._el=this.tag,this.tag=o.prototype.createEl.call(this,"video"),this._options.playsinline&&(this.tag.setAttribute("webkit-playsinline",""),this.tag.setAttribute("playsinline",""),this.tag.setAttribute("x-webkit-airplay",""),this.tag.setAttribute("x5-playsinline",""))):(e=!0,this._el=this.tag.parentNode),this._el),r=this.tag,i=(this._options.enableSystemMenu||(r.addEventListener?r.addEventListener("contextmenu",function(e){e.preventDefault()},!1):r.attachEvent("oncontextmenu",function(){window.event.returnValue=!1})),r.player=this,s.getElementAttributes(r));return a.each(i,function(e){t.setAttribute(e,i[e])}),this.setVideoAttrs(),e||(r.parentNode&&r.parentNode.insertBefore(t,r),s.insertFirst(r,t)),t},O.prototype.setVideoAttrs=function(){var e=this._options.preload,t=this._options.autoplay;if(this.tag.style.width=this._options.videoWidth||"100%",this.tag.style.height=this._options.videoHeight||"100%",e&&this.tag.setAttribute("preload","preload"),t&&!this._isEnabledAILabel()&&"15"!==p.IOS_VERSION&&this.tag.setAttribute("autoplay","autoplay"),p.IS_IOS&&this.tag.setAttribute("poster","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAAAMZJREFUeAHt0DEBAAAAwqD1T20LL4hAYcCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMDAc2CcpAABaODCqQAAAABJRU5ErkJggg=="),(p.IS_UC||p.dingTalk())&&this.tag.setAttribute("renderer","standard"),this._options.extraInfo)for(var r in this._options.extraInfo)p.IS_OPPO&&"crossOrigin"===r||this.tag.setAttribute(r,this._options.extraInfo[r]);i.adaptX5Play(this)},O.prototype.checkOnline=function(){var e;return!(this._options&&!this._options.debug&&0==navigator.onLine&&((e={mediaId:this._options.vid||"",error_code:d.ErrorCode.NetworkUnavaiable,error_msg:f.get("Error_Offline_Text")}).display_msg=f.get("Error_Offline_Text"),this.trigger(E.Player.Error,e),1))},O.prototype.id=function(){return this.el().id},O.prototype.renderUI=function(){},O.prototype.switchUrl=function(){var e,t;this.traceLog(D,"switchUrl"),0!=this._urls.length&&(this._currentPlayIndex=this._currentPlayIndex+1,this._urls.length<=this._currentPlayIndex&&(this._currentPlayIndex=0,this._retrySwitchUrlCount++),e=this._urls[this._currentPlayIndex],r.set(d.SelectedStreamLevel,e.definition,365),this.trigger(E.Private.QualityChange,f.get("Quality_Change_Fail_Switch_Text")),t=this.getCurrentTime(),this._vodRetryCount=0,this._originalSource="",this._loadByUrlInner(e.Url,t,!0))},O.prototype.setControls=function(){var e=this.options();e.useNativeControls?this.tag.setAttribute("controls","controls"):"object"==typeof e.controls&&(e=this._initControlBar(e.controls),this.addChild(e))},O.prototype._initControlBar=function(e){return new ControlBar(this,e)},O.prototype.getMetaData=function(){},O.prototype.getReadyTime=function(){return this.readyTime},O.prototype.readyState=function(){return this.tag.readyState},O.prototype.getError=function(){return this.tag.error},O.prototype.getRecentOccuredEvent=function(){return this._eventState},O.prototype.getSourceUrl=function(){return this._options?this._options.source:""},O.prototype.getMonitorInfo=function(){return this._monitor?this._monitor.opt:{}},O.prototype.getCurrentQuality=function(){var e;return 0<this._urls.length?{width:(e=this._urls[this._currentPlayIndex]).width,url:e.Url,definition:e.definition}:""},O.prototype.getCurrentPDT=function(){var e;if((p.IS_SAFARI||p.IS_IOS)&&this.tag)return e=Date.parse(this.tag.getStartDate()),isNaN(e)?0:e+1e3*this.getCurrentTime()},O.prototype.setSpeed=function(e){this.tag&&(this._originalPlaybackRate=e,this.tag.playbackRate=e)},O.prototype.play=function(e){return this.traceLog(D,"play::"+e),this.tag&&(this.tag.ended||this._ended?this.replay():((this._options.preload||this.loaded)&&this.tag.src||this._initLoad(this._options.source),this.trigger(E.Private.Cover_Hide),this.tag.play())),this._isManualPlay=e||!1,this},O.prototype.replay=function(){return this._monitor&&this._monitor.replay(),this.seek(0),this.tag.play(),this},O.prototype.pause=function(e){return this.tag&&this.tag.pause(),this._isManualPause=e||!1,this},O.prototype.stop=function(){return this.traceLog(D,"stop"),this.tag.setAttribute("src",null),this},O.prototype.paused=function(){if(this.tag)return!1!==this.tag.paused},O.prototype.getDuration=function(){var e=0;return e=this.tag?this.isPreview()?this._vodDuration||this.tag.duration:this._duration&&this._duration!=1/0?this._duration:this.tag.duration:e},O.prototype.getDisplayDuration=function(){var e=0;return e=this.tag?this._vodDuration||this.getDuration():e},O.prototype.getCurrentTime=function(){return this.tag?this.tag.currentTime:0},O.prototype.seek=function(e){this._seeking=!0,this._ended=!1;var t=this.tag.duration;if(e=Math.floor(e),!Number.isNaN(e))return this._doSeek(this,e=t<=e?t:e),this},O.prototype._doSeek=e(function(e){var t=e[0],e=e[1];try{var r=t._originalPlaybackRate||t.tag.playbackRate;-1!==["16"].indexOf(p.IOS_VERSION)&&!t.oncePlayed||(t.tag.currentTime=e),t.traceLog(D,"doSeek::"+e),p.IS_IE11&&setTimeout(function(){t.tag&&(t.tag.playbackRate=r)})}catch(e){console.log(e)}},100),O.prototype.firstNewUrlloadByUrl=function(e,t){this._clearTimeout(),this._options.vid=0,this._options.source=e,this._monitor&&this._monitor.updateVideoInfo({video_id:0,album_id:0,source:e,from:this._options.from}),this.trigger(E.Private.ChangeURL),this.initPlay(),this._options.autoplay&&this.trigger(E.Private.Cover_Hide),this._options.autoplay?this.trigger(E.Player.Play):this.trigger(E.Player.Pause),!(t=t||0)&&0!=t||isNaN(t)||this.seek(t)},O.prototype.traceLog=function(e,t){this.trigger(E.Private.TraceLog,"["+e+"]"+t)},O.prototype._loadByUrlInner=function(e,t,r,i){var n=this,o=this.tag.volume;if(i&&p.IS_ANDROID_FIREFOX){for(var a in E.Video)l.off(this.tag,E.Video[a]);this.tag.remove(),this.tag=this._el,this.createEl()}this.loadByUrl(e,t,r,!0),this.tag.volume=o,i&&p.IS_ANDROID_FIREFOX&&this.tag.addEventListener(E.Video.LoadedData,function e(){n._player.trigger(E.Player.DurationChange),I.bind(n),n.tag.removeEventListener(E.Video.LoadedData,e)})},O.prototype.loadByUrl=function(n,o,e,t){var r=this,i=(this.traceLog(D,"loadByUrl::"+n+"#"+t),this._monitor&&this._monitor._onPlayerUnderload(),this._monitor&&!t&&(this._monitor.reportPlayAbort("loadByUrl"),this._monitor.resetVV()),/\.m3u8|\.flv|\.mp4|artc\:\/\/|rtmp\:\/\//gi),a=((this._options.source||"").match(i)||[])[0]!==((n||"").match(i)||[])[0];if(this._h265InfoReported=!1,this._probeInfo||(this._probeInfo={}),this._probeInfo.codecTag=void 0,!a&&(h.isMp4(n)||h.isFlv(n)||h.isHls(n)))return this._options.forceH265||this._options.forceH266||!this._options.enableH265&&!this._options.enableH266||p.IS_ANDROID&&p.dingTalk()&&!h.isFlv(n)?void s.call(this):void L(n,function(e){var e=h.getVideoTrack(e.tracks),t=(e||{}).codecTag||(null==(t=(e||{}).codec)?void 0:t.split(".")[0]);r._probeInfo.codecTag=t,e&&h.isH265Codec(t)?h.isFlv(n)||h.isHls(n)?(r._splayer||(a=!0),s.call(r)):h.shouldUseBasePlayer({codecTag:t,url:n},function(e){e?(r._splayer&&(a=!0),r._probeInfo.codecTag&&R.reportH265PlayInfo.call(r,{renderType:"native",codecTag:r._probeInfo.codecTag})):r._splayer||(a=!0),s.call(r)}):(e&&h.isH266Codec(t)?r._splayer||(a=!0):r._splayer&&(a=!0),s.call(r))},function(e){s.call(r)});function s(){var r,i=this;a&&this._splayer&&this.removeChild(this._licenseWatermark),a&&window.Aliplayer?(console.log("!!!!! NEED RELOAD INSTANCE !!!!!"),this.traceLog(D,"reloadInstance::"+n),this._options.source=n,window.Aliplayer.reloadInstance(this._options,function(){},this)):(t||(this._urls=[]),this._monitor&&!t&&this._monitor.reset(),this._isError=!1,this._duration=0,this._clearTimeout(),this.trigger(E.Private.Error_Hide),this._options.source=n,this._monitor&&this._monitor.updateVideoInfo({video_id:0,album_id:0,source:n,from:this._options.from}),t||(this.trigger(E.Private.ChangeURL),this._vodRetryCount=0),this._options._autoplay=e,this.initPlay(e),(r=this._options.autoplay||e)&&this.trigger(E.Private.Cover_Hide),r?this.trigger(E.Player.Play):this.trigger(E.Player.Pause),this._options.isLive||!o&&0!=o||isNaN(o)||l.one(this.tag,E.Video.CanPlay,function(e){r&&(p.IS_IOS||p.IS_MAC_SAFARI)&&i._splayer&&i.play();var t=i.getDuration();i.seek(t<=o?t:o)}))}s.call(this)},O.prototype.dispose=function(){this.__disposed=!0,this.trigger(E.Private.Dispose),this.tag.pause(),_.offAll(this),C.dispose.call(this),this._antiRecord&&(this._antiRecord.dispose(),this._antiRecord=null),this._monitor&&(this._monitor.reportPlayAbort("dispose"),this._monitor.removeEvent(),this._monitor=null),this._autoPlayDelay&&this._autoPlayDelay.dispose(),this._checkTimeoutHandle&&(clearTimeout(this._checkTimeoutHandle),this._checkTimeoutHandle=null),this._waitingTimeoutHandle&&(clearTimeout(this._waitingTimeoutHandle),this._waitingTimeoutHandle=null),this._playingSlientPause&&(clearTimeout(this._playingSlientPause),this._playingSlientPause=null),this._waitingLoadedHandle&&(clearTimeout(this._waitingLoadedHandle),this._waitingLoadedHandle=null),this._ucSourceHandle&&(clearTimeout(this._ucSourceHandle),this._ucSourceHandle=null),this._readyStateTimer&&(clearInterval(this._readyStateTimer),this._readyStateTimer=null),this._vodRetryCountHandle&&(clearTimeout(this._vodRetryCountHandle),this._vodRetryCountHandle=null),this._waitingDelayLoadingShowHandle&&(clearTimeout(this._waitingDelayLoadingShowHandle),this._waitingDelayLoadingShowHandle=null),this._liveRetryTimer&&(clearTimeout(this._liveRetryTimer),this._liveRetryTimer=null),this._disposeService(),this._clearLiveErrorHandle(),this._el.innerHTML="",this.destroy(),this._releaseMediaElement(),this._options.recreatePlayer=null,this._options=null,this.isMutiLevel=!1,this._seis={},this._initPTS=0},O.prototype._releaseMediaElement=function(){this.tag.removeAttribute("src"),this.tag.load(),this.tag=null},O.prototype.mute=function(){this._muteInner(),this._originalVolumn=this.tag.volume;var e=f.get("Volume_Mute");return this._player.trigger(E.Private.Info_Show,{text:e,duration:1e3,align:"lb"}),this._setInnerVolume(0),this},O.prototype._muteInner=function(){this.tag.muted=!0,this.trigger(E.Private.VolumnChanged,-1)},O.prototype.unMute=function(){this._unMuteInner();var e=f.get("Volume_UnMute");return this._player.trigger(E.Private.Info_Show,{text:e,duration:1e3,align:"lb"}),this._setInnerVolume(this._originalVolumn||.5),this},O.prototype._unMuteInner=function(){this.tag.muted=!1,this.trigger(E.Private.VolumnChanged,-2)},O.prototype.muted=function(){return this.tag&&this.tag.muted},O.prototype.getVolume=function(){return this.tag&&this.tag.volume},O.prototype.getOptions=function(){return this._options},O.prototype.setVolume=function(e,t){0!=(e=Math.min(1,Math.max(0,e)))?this._unMuteInner():0==e&&this._muteInner(),this._setInnerVolume(e);e=f.get("Curent_Volume")+"<span>"+(100*e).toFixed()+"%</span>";this._player.trigger(E.Private.Info_Show,{text:e,duration:1e3,align:"lb"})},O.prototype._setInnerVolume=function(e){this.tag.volume=e,this.trigger(E.Private.VolumnChanged,e)},O.prototype.hideProgress=function(){this.trigger(E.Private.HideProgress)},O.prototype.cancelHideProgress=function(){this.trigger(E.Private.CancelHideProgress)},O.prototype.setPlayerSize=function(e,t){this._el&&(this._el.style.width=e,this._el.style.height=t)},O.prototype.getBuffered=function(){return this.tag.buffered},O.prototype.setRotate=function(e){this.tag&&(this._rotate=e,this._setTransform(),this.log("ROTATE",{rotation:e}))},O.prototype.getRotate=function(e){return void 0===this._rotate?0:this._rotate},O.prototype.setImage=function(e){this.tag&&(this._image=e,this._setTransform(),this.log("IMAGE",{mirror:"horizon"==e?2:1,text:e}))},O.prototype.getImage=function(){return this._image},O.prototype.cancelImage=function(){this.tag&&(this._image="",this._setTransform(),this.log("IMAGE",{mirror:0}))},O.prototype.setCover=function(e){var t=document.querySelector("#"+this.id()+" .prism-cover");t&&e&&(t.style.backgroundImage="url("+e+")",this._options.cover=e,this.trigger(E.Private.Cover_Show))},O.prototype.setTextTracks=function(e){e=h.unqiueTextTracks(e||[]),this.trigger(E.Private.VttClearTracks),e&&e.length&&this.trigger(E.Private.TextTrackFounded,{from:"user",textTracks:e}),this.trigger(E.Private.CCReset)},O.prototype._setTransform=function(){this._transformProp||(this._transformProp=s.getTransformName(this.tag));var e=" translate(-50%, -50%)";this._rotate&&(e+=" rotate("+this._rotate+"deg)"),this._image&&("vertical"==this._image?e+=" scaleY(-1)":"horizon"==this._image&&(e+=" scaleX(-1)")),this.tag.style[this._transformProp]=e},O.prototype._startPlay=function(){this.tag.paused&&this.tag.play()},O.prototype._initPlayBehavior=function(e,t){return!this._checkSupportVideoType()&&(h.validateSource(t)?(void 0===e&&(e=!1),this._created||(this._created=!0,this.trigger(E.Private.Created)),this.loaded||this.trigger(E.Player.Init),this._options.autoplay||this._options._autoplay||this._options.preload||e?(this._options._preload=!0,this._initLoad(t),(this._options.autoplay||this._options._autoplay)&&this._startPlay()):this.trigger(E.Private.Play_Btn_Show),!0):((e={mediaId:this._options.vid||"",error_code:d.ErrorCode.InvalidSourceURL,error_msg:"InvalidSourceURL"}).display_msg=f.get("Error_Invalidate_Source"),this.trigger(E.Player.Error,e),!1))},O.prototype._isPreload=function(){return this._options.autoplay||this._options.preload||this._options._preload},O.prototype._initLoad=function(e){e&&(this._isPreload()&&!p.IS_MOBILE?this.trigger(E.Private.H5_Loading_Show):(this.trigger(E.Private.H5_Loading_Hide),this.trigger(E.Private.Play_Btn_Show)),this.tag.setAttribute("src",e),this.oncePlayed=!1,this.loaded=!0)},O.prototype._clearLiveErrorHandle=function(){this._liveErrorHandle&&(clearTimeout(this._liveErrorHandle),this._liveErrorHandle=null)},O.prototype._reloadAndPlayForM3u8=function(){0==this._liveRetryCount&&this.trigger(E.Player.OnM3u8Retry);var e=this._options,t=e.liveRetryInterval+e.liveRetryStep*this._liveRetryCount,r=this;this._liveRetryTimer&&(clearTimeout(this._liveRetryTimer),this._liveRetryTimer=null),this.traceLog(D,"reloadAndPlayForM3u8::#"+r._options.source+"#"+1e3*t),this._liveRetryTimer=setTimeout(function(){r._liveRetryCount++,r.tag.load(r._options.source),e.autoplay&&r.tag.play()},1e3*t)},O.prototype._checkSupportVideoType=function(){var e,t,r,i=this;return this.tag.canPlayType&&this._options.source&&p.IS_MOBILE?(t="",0<(e=this._options.source).indexOf("m3u8")?""!=this.tag.canPlayType("application/x-mpegURL")||h.isSupportHls()||(t=f.get("Error_Not_Support_M3U8_Text")):0<e.indexOf("mp4")?""==this.tag.canPlayType("video/mp4")&&(t=f.get("Error_Not_Support_MP4_Text")):(h.isRTMP(e)||h.isFlv(e))&&p.IS_MOBILE&&(t=f.get("Error_Not_Support_Format_On_Mobile")),t&&(r={mediaId:this._options.vid||"",error_code:d.ErrorCode.FormatNotSupport,error_msg:t},this.logError(r),r.display_msg=t,setTimeout(function(){i.trigger(E.Player.Error,r)})),t):""},O.prototype.getComponent=function(e){return this._lifeCycleManager.getComponent(e)},O.prototype.logError=function(e,t){(this._options.autoplay||this._options._autoplay)&&this._monitor&&this._monitor.reportStartPlay(),(e=e||{}).vt=this.getCurrentTime(),this.log(t?"ERRORRETRY":"ERROR",e)},O.prototype.log=function(e,t){var r=0,i=0;if(this._monitor)return this._options&&(r=this._options.vid||"0",i=this._options.from||"0"),this._monitor.updateVideoInfo({video_id:r,album_id:0,source:this._options.source,from:i}),this._monitor._log(e,t)},O.prototype.setSanpshotProperties=function(e,t,r){if(this._snapshotMatric||(this._snapshotMatric={}),this._snapshotMatric.width=e,this._snapshotMatric.height=t,1<r)throw new Error("rate doesn't allow more than 1");this._snapshotMatric.rate=r},O.prototype.getStatus=function(){return this._status||"init"},O.prototype.enterProgressMarker=function(){this._enteredProgressMarker=!0},O.prototype.isInProgressMarker=function(){return this._enteredProgressMarker},O.prototype.exitProgressMarker=function(){this._enteredProgressMarker=!1},O.prototype.setProgressMarkers=function(e){this.trigger(E.Private.ProgressMarkerChanged,e=e||[])},O.prototype.getProgressMarkers=function(){return this._progressMarkerService?this._progressMarkerService.progressMarkers:[]},O.prototype.setPreviewTime=function(e){this._options.playConfig||(this._options.playConfig={}),this._options.playConfig.PreviewTime=e},O.prototype.getPreviewTime=function(){var e=0;return e=this._options.playConfig?this._options.playConfig.PreviewTime:e},O.prototype.exceedPreviewTime=function(e){return this.isPreview()&&e>=this._options.playConfig.PreviewTime},O.prototype.isPreview=function(){var e=this._options.playConfig.PreviewTime,t=this._vodDuration||this.tag.duration;return 0<e&&e<t},O.prototype.getStats=function(){return new n(function(e){e()})},O.prototype.setTraceId=function(e){this._monitor&&this._monitor.updateTraceId(e)},O.prototype._getSanpshotMatric=function(){return this._snapshotMatric||(this._snapshotMatric={}),this._snapshotMatric},O.prototype._autoplayFailedHandler=function(){this.oncePlayed=!1,this.trigger(E.Private.Play_Btn_Show),this.trigger(E.Private.H5_Loading_Hide),this.trigger(E.Player.AutoPlayPrevented),this.trigger(E.Player.AutoPlay,!1),this._options.cover&&this.trigger(E.Private.Cover_Show)},O.prototype._overrideNativePlay=function(){var r=this.tag.play,i=this;this.tag.play=function(){var e,t;i._monitor&&i._monitor.reportStartPlay(),i._options.source?(i.readyTime=(new Date).getTime(),e=r.apply(i.tag),i.oncePlayed=!0,void 0!==e&&e.then(function(){i.trigger(E.Player.AutoPlay,!0)}).catch(function(e){!i.tag||!i.tag.paused||i._isError||i._options._autoplay||i._switchedLevel||i._autoplayFailedHandler()}),t=i._originalPlaybackRate||i.tag.playbackRate,setTimeout(function(){i.tag&&(i.tag.playbackRate=t)})):(e={mediaId:i._options.vid||"",error_code:d.ErrorCode.InvalidSourceURL,error_msg:"InvalidSourceURL"},i._options.vid?e.display_msg=f.get("Error_Vid_Empty_Source"):i._options.mediaAuth?e.display_msg=f.get("Error_Mediaauth_Empty_Source"):e.display_msg=f.get("Error_Empty_Source"),i.trigger(E.Player.Error,e))}},O.prototype._extraMultiSources=function(){var e=this._options.source;if(e&&-1<e.indexOf("{")&&-1<e.indexOf("}")){var t="";try{t=JSON.parse(e)}catch(e){console.error(e),console.error("\u5730\u5740json\u4e32\u683c\u5f0f\u4e0d\u5bf9")}var r,i=[];for(r in t){var n=d.QualityLevels[r];i.push({definition:r,Url:t[r],desc:n||r})}this._setupSourceList(i)}return i},O.prototype._setupSourceList=function(e){var t;(e=void 0===e?[]:e).length&&(this._currentPlayIndex=h.findSelectedStreamLevel(e),t=e[this._currentPlayIndex],this._urls=e,this._options.source=t.Url,this.trigger(E.Private.SourceLoaded,t))},O.prototype._isEnabledAILabel=function(){return this._options.ai&&this._options.ai.label},O.prototype._createService=function(){if(x)for(var e=x.length,t=0;t<e;t++){var r=x[t],i=r.condition;void 0===i?i=!0:"function"==typeof i&&(i=i.call(this)),i&&(this[r.name]=new r.service(this))}},O.prototype._disposeService=function(){if(x)for(var e=x.length,t=0;t<e;t++){var r=this[x[t].name];void 0!==r&&r.dispose&&r.dispose()}},O.prototype._executeReadyCallback=function(){this._options._readyCallbackCalled=!0;try{this._options.autoplay||this._options.preload||(this.trigger(E.Private.H5_Loading_Hide),this.trigger(E.Private.Play_Btn_Show)),this._options.readyCallback(this)}catch(e){console.log(e)}},O.prototype._clearTimeout=function(){this._checkTimeoutHandle&&(clearTimeout(this._checkTimeoutHandle),this._checkTimeoutHandle=null),this._waitingTimeoutHandle&&(clearTimeout(this._waitingTimeoutHandle),this._waitingTimeoutHandle=null),this._decodeErrorNudgeTimer&&(clearTimeout(this._decodeErrorNudgeTimer),this._decodeErrorNudgeTimer=null),this._clearLiveErrorHandle()},O.prototype._reloadForVod=function(){var e,t,r;return this._originalSource||(this._originalSource=this._options.source),!!(this._vodRetryCount<this._options.vodRetry&&navigator.onLine)&&(e=this.getCurrentTime(),(t=this._originalSource).indexOf("auth_key=")<0&&(t=t&&0<t.indexOf("?")?t+"&_t="+(new Date).valueOf():t+"?_t="+(new Date).valueOf()),this._vodRetryCountHandle&&clearTimeout(this._vodRetryCountHandle),(r=this).traceLog(D,"reloadForVod::#"+t+"#"+100*this._vodRetryCount),this._vodRetryCountHandle=setTimeout(function(){r._loadByUrlInner(t,e,r.getOptions().autoplay)},100*this._vodRetryCount),this._vodRetryCount=this._vodRetryCount+1,!0)},O.prototype._getUserTextTracks=function(){var e=this._options.textTracks||[];(e=h.unqiueTextTracks(e)).length&&this.trigger(E.Private.TextTrackFounded,{from:"user",textTracks:e})},t.exports=O},{"../../commonui/autostreamselector":11,"../../feature/AntiRecord":16,"../../feature/autoPlayDelay":17,"../../feature/keyboardControl":18,"../../feature/license":19,"../../lang/index":23,"../../lib/codec-probe":26,"../../lib/constants":28,"../../lib/cookie":29,"../../lib/dom":32,"../../lib/event":33,"../../lib/object":42,"../../lib/playerutil":46,"../../lib/ua":49,"../../lib/vttnext/index":56,"../../monitor/monitor":64,"../../ui/component":130,"../../ui/component/cover":134,"../../ui/component/license-watermark":139,"../../ui/component/play-animation":141,"../../ui/component/progressmarker":144,"../../ui/component/text-track-display":155,"../../ui/component/util":159,"../../ui/exports":162,"../service/export":120,"../splayer/splayerinjector":127,"./event/eventmanager":69,"./event/eventtype":70,"./eventHandler/video/index":84,"./plugin/lifecyclemanager":94,"./x5play":96,"es6-promise":8}],92:[function(e,t,r){e=e("../../../lib/oo").extend({});t.exports=e},{"../../../lib/oo":43}],93:[function(e,t,r){t.exports={createEl:"createEl",created:"created",ready:"ready",loading:"loading",play:"play",pause:"pause",playing:"playing",waiting:"waiting",timeUpdate:"timeupdate",error:"error",ended:"ended",dispose:"dispose",markerDotOver:"markerDotOver",markerDotOut:"markerDotOut"}},{}],94:[function(e,t,r){function i(i){(this._player=i)._status="init",this.components=[];var e=i.getOptions().components;if(e&&s.isArray(e)&&0<e.length)for(var t=0;t<e.length;t++){var r=e[t];if(!r)return void console.log("The "+t+" custome component is "+r);var n=void 0===r.type?r:r.type,o=void 0===r.args?[]:r.args,r=void 0===r.name?"":r.name;if(!n)return void console.log(r+" compenent is "+n);o=o&&0<o.length?[].concat.call([n],o):[],n=new(Function.prototype.bind.apply(n,o)),o=n[c.createEl];o&&"function"==typeof o&&o.call(n,i.el(),i),this.components.push({name:r,obj:n})}var a=this;i.on(l.Private.LifeCycleChanged,function(e){var t=e.paramData,r=t.type,t=t.data;r===l.Video.CanPlayThrough&&a._player.trigger(l.Player.TimeUpdate,t.target.currentTime),r===l.Video.Ended&&a._player.trigger(l.Player.TimeUpdate,a._player.getDuration()),0!=a.components.length&&u.call(a,i,e)})}var s=e("../../../lib/object"),l=e("../event/eventtype"),c=e("./lifecycle"),n=e("./status"),u=(i.prototype.getComponent=function(e){var t=null,r=this.components.length;if(e)for(var i=0;i<r;i++)if(this.components[i].name==e){t=this.components[i].obj;break}return t},function(e,t){if(t){for(var t=t.paramData,r=t.type,i=t.data,n=((t=r)!=l.Video.LoadStart&&t!=l.Video.LoadedData&&t!=l.Video.LoadedMetadata||(r=c.loading),p(e,r),this.components.length),o=0;o<n;o++){var a=this.components[o].obj,s=a[r];s&&"function"==typeof s&&s.call(a,e,i)}r==l.Private.Dispose&&(this.components=[])}}),p=function(e,t){void 0===n[t]||t==n.pause&&(e._status==n.error||e._status==n.ended)||t==n.ready&&e._status==n.playing||(e._status=t)};t.exports=i},{"../../../lib/object":42,"../event/eventtype":70,"./lifecycle":93,"./status":95}],95:[function(e,t,r){t.exports={init:"init",ready:"ready",loading:"loading",play:"play",pause:"pause",playing:"playing",waiting:"waiting",error:"error",ended:"ended"}},{}],96:[function(e,t,r){function i(e,t){var r=e.el().style.height,i=e.el().style.width,n=(e.originalLayout={container:{height:r,width:i},video:{width:e.tag.style.width,height:e.tag.style.height}},document.body.clientHeight*(window.devicePixelRatio||1)+"px"),o=document.body.clientWidth+"px";width=t?(height=n,o):(height=r.indexOf("%")?r:r+"px",i.indexOf("%")?i:i+"px"),e.tag.style.width=o,e.tag.style.height=n,e.el().style.height=t?n:height}var n=e("../../lib/ua"),o=e("../../lib/dom");t.exports.isAndroidX5=function(){return n.os.android&&n.is_X5||n.dingTalk()},t.exports.adaptX5Play=function(r){n.os.android&&n.is_X5&&("h5"==r._options.x5_type&&(r.tag.setAttribute("x5-video-player-type",r._options.x5_type),window.onresize=function(){var e,t;i(r,r._options.x5_fullscreen||"center"==r._options.x5_video_position),"landscape"==(e=r)._x5VideoOrientation&&(e._originalTagWidth=e.tag.style.width,e._originalTagHeight=e.tag.style.height,(t=document.querySelector("#"+e.id()+" .prism-controlbar"))&&parseFloat(t.offsetHeight),e.tag.style.height="100%",e.tag.style.width=window.screen.width+"px")},r.tag.addEventListener("x5videoenterfullscreen",function(){i(r,r._options.x5_fullscreen||"center"==r._options.x5_video_position),r.trigger("x5requestFullScreen")}),r.tag.addEventListener("x5videoexitfullscreen",function(){var e,t;(e=r).originalLayout&&(t=e.originalLayout,e.el().style.height=t.container.height,e.el().style.width=t.container.width,e.tag.style.width=t.video.width,e.tag.style.height=t.video.height),r.trigger("x5cancelFullScreen"),r.fullscreenService.getIsFullScreen()&&r.fullscreenService.cancelFullScreen()}),r.on("requestFullScreen",function(){"top"==r._options.x5_video_position&&o.removeClass(r.tag,"x5-top-left"),n.os.android&&n.is_X5&&r._options.x5LandscapeAsFullScreen&&(r.tag.setAttribute("x5-video-orientation","landscape"),r._x5VideoOrientation="landscape")}),r.on("cancelFullScreen",function(){"top"==r._options.x5_video_position&&o.addClass(r.tag,"x5-top-left"),n.os.android&&n.is_X5&&r._options.x5LandscapeAsFullScreen&&(r.tag.setAttribute("x5-video-orientation","portrait"),i(r,r._options.x5_fullscreen||"center"==r._options.x5_video_position),r._x5VideoOrientation="portrait")})),void 0!==r._options.x5_fullscreen&&r._options.x5_fullscreen&&(r.tag.setAttribute("x5-video-player-fullscreen",r._options.x5_fullscreen),o.addClass(r.tag,"x5-full-screen")),"top"==r._options.x5_video_position&&o.addClass(r.tag,"x5-top-left"),void 0!==r._options.x5_orientation)&&r.tag.setAttribute("x5-video-orientation",r._options.x5_orientation)}},{"../../lib/dom":32,"../../lib/ua":49}],97:[function(e,t,r){function _(){return(_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}var g=e("../../lib/io"),v=e("../../config"),m=e("../../lib/constants"),S=e("../../lib/util"),b=e("../../lib/playerutil"),T=(e("../../lib/dom"),e("../../lang/index")),E=e("../base/event/eventtype"),w=e("../saas/drm"),x=e("../../lib/ua"),P="drminjector.js",C=function(){function e(){}var t=e.prototype;return t.destroy=function(){},t.append=function(e){},t.remove=function(e,t){},t.isTextVisible=function(){},t.setTextVisibility=function(e){},e}();t.exports.inject=function(e,t,r,i,a,n,o){var s,l=i.source;function c(e){var t=shaka.util.Error.Code,r="",i=e.data||[];switch(e.code){case t.BAD_HTTP_STATUS:case t.HTTP_ERROR:case t.TIMEOUT:case t.LICENSE_REQUEST_FAILED:r=T.get("Tip_Drm_Request_Err")+u(i);break;case t.REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:case t.SESSION_TIMEOUT:window.isSecureContext?(r=T.get("Tip_Drm_Key_System_Unavailable"),i.length&&(r+="<br />"+T.get("Tip_Err_Common_Short")+i)):r=T.get("Tip_Drm_Secure_Context");break;case t.FAILED_TO_CREATE_CDM:"file:"===window.location.protocol&&(r=T.get("Tip_Drm_File_Not_Allowed"));break;case t.HLS_INVALID_PLAYLIST_HIERARCHY:r=T.get("Tip_Drm_Playlist_Hierarchy")}e=u(i);return r||e}function u(e){return T.get("Tip_Err_Common")+e}function p(i){var n=this;this._drm.load(this._options.source,i.startTime).then(function(){if(n.trigger(E.Private.H5_Loading_Hide),i.continuePlay&&(n.play(),i.prevVariant)&&0!==i.prevVariant){for(var e,t=n._drm.getVariantTracks(),r=0;r<t.length;r++)if(t[r].id===i.prevVariant){e=t[r];break}e&&n._drm.selectVariantTrack(e,!0)}}).catch(function(e){h.call(n,e)})}function d(){f();var e=m.ErrorCode.DrmNotSupported,t=T.get("Error_Drm_Not_Supported"),e={mediaId:this._options.vid||"",error_code:e,error_msg:t};this.logError(e),this.trigger(E.Player.Error,e)}function h(e){f();var t=m.ErrorCode.DrmLoadError,r=T.get("Error_Drm_Load"),t={mediaId:this._options.vid||"",error_code:t,error_msg:r+" | "+this._shakaCodeMap[e.code],drm_info:JSON.stringify({cdmData:this._cdmData,licenseData:this._licenseData})};this.logError(t),t.diagnosis_info=c.call(this,e),this.trigger(E.Player.Error,t)}function f(){this._sessionTimer&&(clearTimeout(this._sessionTimer),this._sessionTimer=null)}function y(e,t){t=t.getVariantTracks().find(function(e){return e.active});console.log("activeTrack",t),e.trigger(E.Private.QualityChange,{levelSwitch:!0,bitrate:t.bandwidth,desc:t.height})}!n&&(i=l,e._drm||!b.isDash(i)&&!b.isHls(i))||(e._isDrm=!0,e._drm=null,e._isLoadedDrm=!1,e._sessionTimer=null,e._isFairPlay=x.IS_MAC_SAFARI||x.IS_IOS,e._fairPlayHandlers={},e._shakaCodeMap={},e._cdmData="",e._licenseData="",console.log("use FairPlay",e._isFairPlay),t.prototype._checkDrmReady=function(){if(null==this._drm&&!this._isFairPlay)throw new Error("please invoke this method after ready event")},t.prototype.play=function(e){this.traceLog(P,"play::"+e),this._checkDrmReady(),this._isManualPlay=e||!1;return this.trigger(E.Private.Cover_Hide),this.tag.ended?this.replay():(this.getCurrentTime(),this.tag.paused&&this.tag.play()),this},t.prototype.initPlay=function(e){var t;function r(n,i){var o,t;if(n._antiRecord&&(console.log("Manual check before load source"),n._antiRecord.check()))return;!shaka.Player.isBrowserSupported()||function(){if(x.IS_ANDROID)return!(!x.IS_UC&&!x.IS_FIREFOX)}()?d.call(n):(o=!n._drm,t=function(){var t,r,e;n._drm=new shaka.Player(n.tag),s(n,n._drm),shaka.util.Error.Code.SESSION_TIMEOUT="SESSION_TIMEOUT",n._shakaCodeMap=(t=shaka.util.Error.Code,r={},Object.keys(t).forEach(function(e){r[t[e]]=e}),r),e=n._options.isLive?"https://"+b.getLiveHostByRegion(n._options.region):"https://vod."+n._options.region+".aliyuncs.com",n._drm.configure(_({drm:{servers:{"com.widevine.alpha":e,"com.microsoft.playready":e},retryParameters:{maxAttempts:1}}},n._options.drmOption||{},{textDisplayFactory:function(){return new C}})),n._drm.getNetworkingEngine().registerRequestFilter(function(e,t){shaka.util.StringUtils;var r=shaka.util.Uint8ArrayUtils;e==shaka.net.NetworkingEngine.RequestType.LICENSE&&(e=r.toBase64(new Uint8Array(t.body)),r=n._options.isLive?w.getRequestUrl(e,n):w.postData(e,n),n._cdmData=e,t.uris[0]=r.url,t.headers["content-type"]="application/x-www-form-urlencoded",t.body=r.data)}),n._drm.getNetworkingEngine().registerResponseFilter(function(e,t){var r=shaka.util.StringUtils,i=shaka.util.Uint8ArrayUtils;e==shaka.net.NetworkingEngine.RequestType.LICENSE&&(e=r.fromUTF8(t.data),r=JSON.parse(e),e=n._options.isLive?r.Response.B64License:JSON.parse(r.License).b64License,n._licenseData=e,t.data=i.fromBase64(e))}),n._drm.addEventListener("error",function(e){console.log("errorMessage"),console.log(e.detail.code),console.log(e.detail)}),n._drm.load(n._options.source).then(function(){n._initPlayBehavior(i)}).catch(function(e){h.call(n,e)}),f.call(n),n.one(E.Video.CanPlay,function(){f.call(n)}),n._sessionTimer=setTimeout(function(){n._isError||(h.call(n,{code:"SESSION_TIMEOUT"}),n._drm&&n._drm.destroy())},n._player.getOptions().drmSessionTimeout||5e3),a&&a(n._drm),o&&n._executeReadyCallback()},n.destroy(function(e){try{t()}catch(e){console.log(e)}}))}S.contentProtocolMixed(l)?(f(),(t={mediaId:this._options.vid||"",error_code:m.ErrorCode.InvalidSourceURL,error_msg:"InvalidSourceURL"}).display_msg=T.get("Request_Block_Text"),this.trigger(E.Player.Error,t)):(this._waitingTimeoutCount=1,this._isFairPlay?(this.trigger(E.Private.H5_Loading_Show),function(e,t){var r;this._isFairPlay&&(!function(){if(x.IS_IOS)return e=parseInt(x.os.version),console.log("osVersion",e),12<=e;{var e;if(x.IS_MAC_SAFARI)return e=parseInt(x.browser.version),console.log("browserVersion",e),12<=e}return}()?d.call(this):((r=this).destroy(),w.loadCertificate(this,function(){e&&e(),r._initPlayBehavior(t,r._options.source),r._executeReadyCallback()})))}.call(this,a,e)):this._isLoadedDrm&&"undefined"!=typeof shaka?r(this,e):(this.trigger(E.Private.H5_Loading_Show),function(e){var t="aliplayer-drm-min.js",r="",r=v.domain?"https://"+v.domain+v.path+v.h5Version+"/drm/"+t:"/build/drm/"+t,i=(this._options.shakaUrl&&(r=this._options.shakaUrl),this);g.loadJS(r,function(){shaka.polyfill.installAll(),e.apply(i)})}.call(this,function(){this._isLoadedDrm=!0,r(this,e)})))},t.prototype.destroy=function(e){var t;this._drm?(f.call(t=this),this._drm.destroy().then(function(){t._drm=null,"function"==typeof e&&e(t)})):(this._isFairPlay&&this._destroyFairPlay(),"function"==typeof e&&e(this))},t.prototype._destroyFairPlay=function(){w.destroyFairPlay.call(this)},t.prototype.dispose=function(){r.dispose.call(this),this.destroy()},t.prototype._switchLevel=function(e,t){if(t=t||{},this.trigger(E.Player.LevelSwitch),this._switchedLevel=!0,this._isFairPlay){this._manuallySwitchDrmLevel=!t.isAuto;var r=this.autoplay||"pause"!=this._status;this._loadByUrlInner(e,this.getCurrentTime(),r,!0)}else if(t.isAuto)this._drm.configure({abr:{enabled:!0}}),y(this._player,this._drm);else{for(var i,n=this._drm.getVariantTracks(),o=0;o<n.length;o++){var a=n[o];if(Number(a.bandwidth)===Number(t.bitrate)&&Number(a.height)===Number(t.resolution.split("x")[1])){i=a;break}}console.log("find track",i),this._drm.configure({abr:{enabled:!1}}),this._drm.selectVariantTrack(i,!this._options.seamlessHandover)}var s=this;setTimeout(function(){s.trigger(E.Player.LevelSwitched),this._switchedLevel=!1},1e3)},t.prototype._getDRMEncryptItem=function(){var e=this._urls;if(e&&0<e.length)for(var t=e.length,r=0;r<t;r++){var i=e[r];if(i.Url==this._options.source&&+i.encryption)return i}return""},t.prototype._getItemBySource=function(){var e=this._urls;if(e&&0<e.length)for(var t=e.length,r=0;r<t;r++){var i=e[r];if(i.Url==this._options.source)return i}return""},s=function(o,r){r.addEventListener("error",function(e){var t,r=o,e=e.detail,i="Error code:"+e.code+"message:"+e.message,n=(r.traceLog(P,i),console.log(i),m.ErrorCode.OtherError),i=T.get("Error_Play_Text");e.code==shaka.util.Error.Code.EXPIRED?function(){var t=this,e=(this.trigger(E.Private.H5_Loading_Show),null);this._options.isLive||(e=this.getCurrentTime());var r,i=!this.paused(),n=this._drm.getConfiguration().abr.enabled;if(!n)for(var o=this._drm.getVariantTracks(),a=0;a<o.length;a++)if(o[a].active){r=o[a].id;break}var s={startTime:e,continuePlay:i,prevVariant:r,isAdaptive:n};"function"==typeof this._options.refreshAccessInfo?this._options.refreshAccessInfo().then(function(e){(e=e||{}).accessKeyId&&(t._options.accessKeyId=e.accessKeyId),e.securityToken&&(t._options.securityToken=e.securityToken),e.accessKeySecret&&(t._options.accessKeySecret=e.accessKeySecret),p.call(t,s)}):p.call(t,s)}.call(r):(e.code==shaka.util.Error.Code.HTTP_ERROR?(n=m.ErrorCode.NetworkError,i=T.get("Http_Error")):e.code==shaka.util.Error.Code.TIMEOUT?(n=m.ErrorCode.LoadingTimeout,i=T.get("Error_Waiting_Timeout_Text")):e.code==shaka.util.Error.Code.LICENSE_REQUEST_FAILED?(n=m.ErrorCode.DrmLicenseRequestFailed,i=T.get("Error_Drm_License_Request_Failed")):e.Category==shaka.util.Error.NETWORK&&(n=m.ErrorCode.NetworkError,i=T.get("Error_Network_Text")),f.call(r),setTimeout(function(){r.trigger(E.Private.Play_Btn_Hide)}),r.checkOnline()&&(t=r._drm.drmInfo()||{},t={keyIds:Array.from(t.keyIds||[]),initData:String((null==(t=(t.initData||[])[0])?void 0:t.initData)||[]),cdmData:r._cdmData,licenseData:r._licenseData},t={mediaId:r._options.vid||"",error_code:n,error_msg:e.message,shaka_error:JSON.stringify(e.data||[]),drm_info:JSON.stringify(t)},r.logError(t),t.display_msg=i+" | "+r._shakaCodeMap[e.code],t.diagnosis_info=c.call(r,e),r.trigger(E.Player.Error,t)))}),r.addEventListener("variantchanged",function(e){console.log("DRM Event: variantchanged",e)}),r.addEventListener("abrstatuschanged",function(e){console.log("DRM Event: abrstatuschanged",e)}),r.addEventListener("drmsessionupdate",function(e){console.log("DRM Event: drmsessionupdate",e),f.call(o)}),r.addEventListener("expirationupdated",function(e){console.log("DRM Event: expirationupdated",e),console.log("Exp:",this.getExpiration())}),r.addEventListener("adaptation",function(e){console.log("adaptation",e),y(o,r)}),r.addEventListener("trackschanged",function(e){console.log("DRM EVENT: trackschanged",r.getTextLanguages(),r.getTextTracks());var t=r.getTextLanguages();t&&t.length&&(t=function(e){var t={subtitle:"subtitles",caption:"captions"},r=(console.log("Building track config"),e.getManifest().textStreams||[]),i=(console.log("textStreams",r),e.getTextLanguages()),n=(console.log("languageList",i),[]);try{r.forEach(function(e){i.includes(e.language)&&n.push({kind:t[e.kind]||e.kind,label:e.label,srclang:e.language,src:Array.from(e.segmentIndex)[0].getUris()[0]})})}catch(e){console.log("error in retrieving text track url: ",e)}return n}(r),o.trigger(E.Private.TextTrackFounded,{from:"drm",textTracks:t}),o.trigger(E.Private.CCReset))})})}},{"../../config":14,"../../lang/index":23,"../../lib/constants":28,"../../lib/dom":32,"../../lib/io":40,"../../lib/playerutil":46,"../../lib/ua":49,"../../lib/util":51,"../base/event/eventtype":70,"../saas/drm":107}],98:[function(e,t,r){var i=e("../base/player"),n=e("./drminjector"),o=i.extend({init:function(e,t){n.inject(this,o,i.prototype,t,function(e){}),t._native=!1,i.call(this,e,t)}});t.exports=o},{"../base/player":91,"./drminjector":97}],99:[function(e,t,r){var i=e("../../ui/component"),n=e("../../lib/data"),o=e("../../lib/ua"),a=e("../../lib/constants"),s=e("../../lib/dom"),l=e("../../lib/object"),c=e("../../config"),u=e("../../lang/index"),p=e("../../lib/playerutil"),d=e("../../lib/util"),h=e("../../ui/component/info-display"),f=e("../../ui/component/error-display"),y=e("../../feature/autoPlayDelay"),_=e("../../commonui/autostreamselector"),g=e("../base/event/eventtype"),v=e("../saas/ststoken"),e=i.extend({init:function(e,t){var r;void 0===t.skinLayout&&(t.skinLayout=p.defaultFlashLayout),i.call(this,this,t),this._id="prism-player-"+n.guid(),this.tag=e,this._el=this.tag,this._childrenUI=[f],this.initChildren(),this.id=this._id,window[this.id]=this,u.setCurrentLanguage(this._options.language,"flash",this._options.languageTexts),d.openInFile()?(t={mediaId:this._options.vid||"",error_code:a.ErrorCode.FormatNotSupport,error_msg:u.get("Open_Html_By_File","flash")},this.trigger(g.Private.Error_Show,t)):o.IS_MOBILE?this.trigger(g.Private.Error_Show,{mediaId:this._options.vid||"",error_code:a.ErrorCode.FormatNotSupport,error_msg:u.get("Cant_Use_Flash_On_Mobile","flash")}):(this._options.vid&&this._options.accessKeyId&&this._options.securityToken&&this._options.accessKeySecret?v.getPlayAuth((r=this)._options,function(e){r._options.playauth=e,r._createPlayer()},function(e){var t={mediaId:r._options.vid,error_code:e.Code,error_msg:e.Message};e.sri&&(t.sri=e.sri),t.display_msg=e.display_msg,r.trigger(g.Private.Error_Show,t)},"flash"):this._createPlayer(),this._status="init")},_createPlayer:function(){var e,t;this._options.autoPlayDelay?(t=new y(this),e=this,t.handle(function(){e._options.autoplay=!0,e._initPlayer(),e._childrenUI=[h,_],e.initChildren()})):(this._initPlayer(),this._childrenUI=[h,_],this.initChildren()),o.HAS_FLASH||(t=u.get("Flash_Not_Ready","flash"),this.trigger(g.Private.Info_Show,{text:t,align:"tc",isBlack:!1}))},_initPlayer:function(){var e="//"+c.domain+"/de/prismplayer-flash/"+c.flashVersion+"/PrismPlayer.swf",t=(this._options.playerSwfPath?e=this._options.playerSwfPath:c.domain?-1<c.domain.indexOf("localhost")&&(e="//"+c.domain+"/build/flash//PrismPlayer.swf"):e="de/prismplayer-flash/"+c.flashVersion+"/PrismPlayer.swf",this._comboFlashVars()),r=this._options.wmode||"opaque";this.tag.innerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=5,0,0,0" width="100%" height="100%" id="'+this.id+'"><param name=movie value="'+e+'"><param name=quality value=High><param name="FlashVars" value="'+t+'"><param name="WMode" value="'+r+'"><param name="AllowScriptAccess" value="always"><param name="AllowFullScreen" value="true"><param name="AllowFullScreenInteractive" value="true"><embed name="'+this.id+'" src="'+e+'" quality=high pluginspage="//www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash" type="application/x-shockwave-flash" width="100%" height="100%" AllowScriptAccess="always" AllowFullScreen="true" AllowFullScreenInteractive="true" WMode="'+r+'" FlashVars="'+t+'"></embed></object>'},_getPlayer:function(e){return-1!=navigator.appName.indexOf("Microsoft")?document.getElementById(e):document[e]},_getLowerQualityLevel:function(){var e,t=this._getVideoUrls();return t&&(e=t.Urls,t=t.index,!(e&&0==e.length||-1==t))&&0<t?{item:e[t-1],index:t-1}:""},_comboFlashVars:function(){var e=encodeURIComponent(o.getReferer()),t=o.getHref(),r=encodeURIComponent(t),i="",t=(t&&(i=o.getHost(t)),this._options),e={autoPlay:t.autoplay?1:0,isInner:0,actRequest:1,vid:t.vid,diagnosisButtonVisible:t.diagnosisButtonVisible?1:0,domain:t.domain||"//tv.taobao.com",statisticService:t.statisticService||c.logReportTo,videoInfoService:t.videoInfoService||"/player/json/getBaseVideoInfo.do",disablePing:t.trackLog?0:1,namespace:this.id,barMode:0!=t.barMode?1:0,isLive:t.isLive?1:0,waterMark:t.waterMark,environment:t.environment,vurl:t.source?encodeURIComponent(t.source):"",plugins:t.plugins||"",snapShotShow:t.snapshot?1:0,accessId:t.accId||"",accessKey:t.accSecret||"",apiKey:t.apiKey||"",flashApiKey:t.flashApiKey||"",disableSeek:t.disableSeek?1:0,disableFullScreen:t.disableFullScreen?1:0,stsToken:t.stsToken||"",domainRegion:t.domainRegion||"",authInfo:t.authInfo?encodeURIComponent(t.authInfo):"",playDomain:t.playDomain||"",stretcherZoomType:t.stretcherZoomType||"",playauth:t.playauth?t.playauth.replace(/\+/g,"%2B"):"",prismType:t.prismType||0,formats:t.formats||"",notShowTips:t.notShowTips?1:0,showBarTime:t.showBarTime||0,showBuffer:0==t.showBuffer?0:1,rePlay:t.rePlay?1:0,encryp:t.encryp||"",secret:t.secret||"",mediaType:"video",logInfo:{ud:o.getHost(t.source),os:o.os.name,ov:o.os.version||"",et:o.browser.name,ev:o.browser.version||"",uat:o.USER_AGENT,r:e,pu:r,app_n:i}},n=[];return void 0!==t.rtmpBufferTime&&(e.rtmpBufferTime=t.rtmpBufferTime),t.cover&&(e.cover=t.cover),t.extraInfo&&(e.extraInfo=encodeURIComponent(JSON.stringify(t.extraInfo))),e.logInfo&&(e.logInfo=encodeURIComponent(JSON.stringify(e.logInfo))),e.languageData=encodeURIComponent(JSON.stringify(u.getLanguageData("flash"))),e.language=u.getCurrentLanguage(),l.each(e,function(e,t){n.push(e+"="+t)}),n.join("&")},initChildren:function(){for(var e=this._childrenUI.length,t=0;t<e;t++){var r=new this._childrenUI[t](this,this._options),i=r.el();i.id=r.id(),this.contentEl().appendChild(i),r.bindEvent()}var n=document.querySelector("#"+this._options.id+" .prism-info-display");s.css(n,"display","none")},flashReady:function(){this.flashPlayer=this._getPlayer(this.id),this._isReady=!0;var e=this._options.skinRes,t=this._options.skinLayout;if(!1!==t&&!l.isArray(t))throw new Error("PrismPlayer Error: skinLayout should be false or type of array!");if("string"!=typeof e)throw new Error("PrismPlayer Error: skinRes should be string!");e=0!=t&&0!==t.length&&{skinRes:e,skinLayout:t},this.flashPlayer.setPlayerSkin(e),this.trigger("ready");var r=this;window.addEventListener("beforeunload",function(){try{r.flashPlayer.setPlayerCloseStatus()}catch(e){}})},jsReady:function(){return!0},snapshoted:function(e){var t=d.toBinary(e),e="data:image/jpeg;base64,"+e;this.trigger("snapshoted",{time:this.getCurrentTime(),base64:e,binary:t})},uiReady:function(){this._status="ready",this.trigger("uiReady")},loadedmetadata:function(){"ended"!=this._status&&(this._status="loading",this.trigger("loadedmetadata"))},onPlay:function(){this._status="play",this.trigger("play"),this._clearTimeoutHandle(),this.trigger(g.Private.AutoStreamHide)},onEnded:function(){this._clearTimeoutHandle(),this._status="ended",this.trigger("ended")},onPause:function(){this._status="pause",this._clearTimeoutHandle(),this.trigger(g.Private.AutoStreamHide),this.trigger("pause")},onBulletScreenReady:function(){this.trigger("bSReady")},onBulletScreenMsgSend:function(e){this.trigger("bSSendMsg",e)},onVideoRender:function(e){this._clearTimeoutHandle(),this.trigger("videoRender"),this.trigger("canplay",{loadtime:e})},onVideoError:function(e){this._clearTimeoutHandle(),this._status="error",this.trigger("error",{errortype:e})},onM3u8Retry:function(){this.trigger("m3u8Retry")},hideBar:function(){this.trigger("hideBar")},showBar:function(){this.trigger("showBar")},liveStreamStop:function(){this.trigger("liveStreamStop")},stsTokenExpired:function(){this._status="error",this.trigger("stsTokenExpired")},onVideoBuffer:function(){var e;"pause"!=this._status&&(this._status="waiting",this.trigger("waiting"),this._clearTimeoutHandle(),(e=this)._checkTimeoutHandle=setTimeout(function(){e.trigger(g.Private.AutoStreamShow)},1e3*this._options.loadDataTimeout),this._checkVideoStatus())},startSeek:function(e){this.trigger("startSeek",e)},completeSeek:function(e){this.trigger("completeSeek",e)},_invoke:function(){var e=arguments[0],t=arguments;if(Array.prototype.shift.call(t),!this.flashPlayer)throw new Error("PrismPlayer Error: flash player is not ready\uff0cplease use api after ready event occured!");if("function"!=typeof this.flashPlayer[e])throw new Error("PrismPlayer Error: function "+e+" is not found!");return this.flashPlayer[e].apply(this.flashPlayer,t)},play:function(){this._invoke("playVideo")},replay:function(){this._invoke("replayVideo")},pause:function(){this._invoke("pauseVideo")},stop:function(){this._invoke("stopVideo")},seek:function(e){this._invoke("seekVideo",e)},getCurrentTime:function(){return this._invoke("getCurrentTime")},getDuration:function(){return this._invoke("getDuration")},getStatus:function(){return this._status},_getVideoUrls:function(){var e=this._invoke("getVideoUrls"),t=[];if(e&&e.Urls)for(var r=0;r<e.Urls.length;r++){var i=e.Urls[r].value,n=i.desc.indexOf("_"),o=u.get(i.definition,"flash");i.desc=0<n?o+"_"+i.height:o,t.push(i)}return{Urls:t,index:e.index}},_getVideoStatus:function(){return this._invoke("getVideoStatus")},_checkVideoStatus:function(){var r;this.flashPlayer&&!this._checkVideoStatusHandler&&(r=this,function t(){r._checkVideoStatusHandler=setTimeout(function(){var e=r._getVideoStatus();"playing"==e.videoStatus&&"bufferFull"==e.bufferStatus?(r._status="playing",r._clearTimeoutHandle()):"videoPlayOver"==e.videoStatus&&(r._status="ended",r._clearTimeoutHandle()),t()},500)}())},_clearTimeoutHandle:function(){this._checkTimeoutHandle&&(clearTimeout(this._checkTimeoutHandle),this._checkTimeoutHandle=null)},_changeStream:function(e){return this._invoke("changeStream",e)},mute:function(){this.setVolume(0)},unMute:function(){this.setVolume(.5)},getVolume:function(){return this._invoke("getVolume")},setVolume:function(e){this._invoke("setVolume",e)},loadByVid:function(e){this._invoke("loadByVid",e,!1)},loadByUrl:function(e,t){this._invoke("loadByUrl",e,t)},dispose:function(){this._clearTimeoutHandle(),this._checkVideoStatusHandler&&(clearTimeout(this._checkVideoStatusHandler),this._checkVideoStatusHandler=null),this._invoke("pauseVideo");var e=this;setTimeout(function(){e.off("completeSeek"),e.off("startSeek"),e.off("stsTokenExpired"),e.off("liveStreamStop"),e.off("showBar"),e.off("hideBar"),e.off("m3u8Retry"),e.off("error"),e.off("canplay"),e.off("pause"),e.off("ended"),e.off("play"),e.off("loadedmetadata"),e.off("snapshoted"),e.off("uiReady"),e.off("ready"),e.flashPlayer=null,e._el&&(e._el.innerHTML="")})},showBSMsg:function(e){this._invoke("showBSMsg",e)},setToastEnabled:function(e){this._invoke("setToastEnabled",e)},setLoadingInvisible:function(){this._invoke("setLoadingInvisible")},setPlayerSize:function(e,t){this._el.style.width=e,this._el.style.height=t}});t.exports=e},{"../../commonui/autostreamselector":11,"../../config":14,"../../feature/autoPlayDelay":17,"../../lang/index":23,"../../lib/constants":28,"../../lib/data":30,"../../lib/dom":32,"../../lib/object":42,"../../lib/playerutil":46,"../../lib/ua":49,"../../lib/util":51,"../../ui/component":130,"../../ui/component/error-display":135,"../../ui/component/info-display":138,"../base/event/eventtype":70,"../saas/ststoken":114}],100:[function(e,t,r){var a=e("../../lib/io"),c=e("../../config"),u=e("../../lib/constants"),p=e("../../lib/util"),d=e("../../lib/playerutil"),h=e("../../lib/ua"),f=e("../../lang/index"),y=e("../base/event/eventtype"),_="flvinjector.js";t.exports.inject=function(e,t,r,i,s,n){var l,o=i.source;(n||(i=o,!e._flv&&d.isFlv(i)&&d.isSupportFlv()))&&(e._Type=t,e._superType=r,e._superPt=r.prototype,e._disposed=!1,t.prototype._checkFlvReady=function(){if(null==this._flv)throw new Error("please invoke this method after ready event")},e._isFlv=!0,e._flv=null,e._isLoadedFlv=!1,e._originalUrl="",t.prototype.play=function(e){this.traceLog(_,"play::"+e),this._checkFlvReady(),this._isManualPlay=e||!1;return this.trigger(y.Private.Cover_Hide),this._options.isLive&&e?this._loadByUrlInner(this._options.source,0,e):this.tag.ended||this._ended?this.replay():(0==this._seeking&&(e=0,this.tag.ended||this._ended||0==(e=this.getCurrentTime())&&(e=-1),-1!=e)&&this.seek(e),this.tag.paused&&(this._hasLoaded||this._flv.load(),this._flv.play())),this},t.prototype.seek=function(e){this._checkFlvReady(),this._seeking=!0;var t=this.getDuration();t<=(e=Math.floor(e))&&(e=t);try{this._flv.currentTime=e}catch(e){console.log(e)}return this},t.prototype.pause=function(e){return this._checkFlvReady(),this._isManualPause=e||!1,this._flv.pause(),this},t.prototype.getProgramDateTime=function(){var e;return this._checkFlvReady(),this._metadata?(e=(e=this._flv.getFirstSample())&&e.pts?e.pts:0,console.log("\u63a8\u6d41\u65f6\u95f4\uff1a"+this._metadata.NtpTime),console.log("\u9996\u5e27PTS\uff1a"+e),this._metadata.NtpTime+e):""},t.prototype.initPlay=function(e){var t;function r(t,e){var r,i=!t._flv,n=(t._destroyFlv(),t._options.isLive),o={isLive:n,enableWorker:t._options.enableWorker},a=(h.IS_IE11&&(o.enableWorker=!1),{type:"flv",isLive:n,url:t._options.source});for(r in n?(o.enableStashBuffer=t._options.enableStashBufferForFlv,o.stashInitialSize=t._options.stashInitialSizeForFlv,o.autoCleanupSourceBuffer=!1):o.lazyLoadMaxDuration=600,t._options.isLive&&(t._options.flvFrameChasing&&(o.flvFrameChasing=t._options.flvFrameChasing),t._options.chasingFirstParagraph&&(o.chasingFirstParagraph=t._options.chasingFirstParagraph),t._options.chasingSecondParagraph&&(o.chasingSecondParagraph=t._options.chasingSecondParagraph),t._options.chasingFirstSpeed&&(o.chasingFirstSpeed=t._options.chasingFirstSpeed),t._options.chasingSecondSpeed)&&(o.chasingSecondSpeed=t._options.chasingSecondSpeed),t._options.flvOption)"cors"==r||"hasAudio"==r||"withCredentials"==r||"hasVideo"==r||"type"==r?a[r]=t._options.flvOption[r]:o[r]=t._options.flvOption[r];t._originalUrl=t._options.source,flvjs.LoggingControl.enableAll=t._options.debug,t._flv=flvjs.createPlayer(a,o),l(t,t._flv),t._flv.on(flvjs.Events.MEDIA_INFO,function(e){t._metadata=e.metadata}),t._flv.on(flvjs.Events.METADATA_ARRIVED,function(e){e&&e.dataContent&&e.dataContent.length&&t.trigger(y.Private.SeiFrame,{dataContent:e.dataContent,pts:e.pts})}),t._flv.attachMediaElement(t.tag),t._initPlayBehavior(e)&&((t._options.preload||t._options.autoplay)&&(t._hasLoaded=!0,t._flv.load()),t._options.autoplay&&!t.tag.paused&&t._flv.play(),s&&s(t._flv),i)&&(t._executeReadyCallback(),t._urls)&&0<t._urls.length&&!t._options.defaultDefinition&&(t._currentPlayIndex=d.findSelectedStreamLevel(t._urls),n=t._urls[t._currentPlayIndex],t._options.source=n.Url,t.trigger(y.Private.SourceLoaded,n))}h.browser.safari&&this.trigger(y.Private.Snapshot_Hide),p.contentProtocolMixed(o)?((t={mediaId:this._options.vid||"",error_code:u.ErrorCode.InvalidSourceURL,error_msg:"InvalidSourceURL"}).display_msg=f.get("Request_Block_Text"),this.trigger(y.Player.Error,t)):(that=this)._isLoadedFlv&&"undefined"!=typeof Hls?setTimeout(function(){r(that,e)},1e3):(this.trigger(y.Private.H5_Loading_Show),function(e,t){var r="aliplayer-flv-min.js",i="",i=c.domain?"https://"+c.domain+c.path+c.h5Version+"/flv/"+r:"/build/flv/"+r,n=this;a.loadJS(i,function(){e.apply(n)})}.call(that,function(){this._isLoadedFlv=!0,r(this,e)},this._options.debug))},t.prototype._destroyFlv=function(){try{this._flv&&(this._flv.pause(),this._flv.destroy())}catch(e){console.log(e)}this.loaded=!1,this._hasLoaded=!1,this._flv=null},t.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._superPt&&this._superPt.dispose.call(this),this._destroyFlv(),this._superPt&&(t.prototype.play=this._superPt.play,t.prototype.pause=this._superPt.pause,t.prototype.initPlay=this._superPt.initPlay,t.prototype.seek=this._superPt.seek,t.prototype.canSeekable=this._superPt.canSeekable))},t.prototype.canSeekable=function(e){var t=this._flv.mediaInfo;return!(!this._flv._isTimepointBuffered(e)&&t&&!t.hasKeyframesIndex)},l=function(s,e){var l=!1;e.on(flvjs.Events.ERROR,function(e,t,r){var i,n,o,a;s.traceLog(_,"flvjs-error::"+e+"#"+t+"#"+r.code+"#"+r.msg),s._isError||(i=u.ErrorCode.OtherError,n=f.get("Error_Play_Text"),e!==flvjs.ErrorTypes.BUFFER_FULL&&(t==flvjs.ErrorDetails.NETWORK_EXCEPTION?!(e=s.getOptions().source)||0!=e.toLowerCase().indexOf("http://")&&0!=e.toLowerCase().indexOf("https://")?(i=u.ErrorCode.InvalidSourceURL,n=f.get("Error_Invalidate_Source_Widthout_Protocal"),l=!0):n=navigator.onLine?(i=u.ErrorCode.RequestDataError,f.get("Maybe_Cors_Error")):(i=u.ErrorCode.NetworkError,f.get("Error_Network_Text")):t==flvjs.ErrorDetails.NETWORK_STATUS_CODE_INVALID?"404"==r.code?(i=u.ErrorCode.NotFoundSourceURL,n=f.get("Error_Not_Found")):"403"==r.code?(i=u.ErrorCode.AuthKeyExpired,n=f.get("Error_AuthKey_Text"),l=!0):(i=u.ErrorCode.NetworkError,n=f.get("Error_Network_Text")):t==flvjs.ErrorDetails.NETWORK_TIMEOUT?(i=u.ErrorCode.LoadingTimeout,n=f.get("Error_Waiting_Timeout_Text")):t!=flvjs.ErrorDetails.MEDIA_FORMAT_UNSUPPORTED&&t!=flvjs.ErrorDetails.MEDIA_CODEC_UNSUPPORTED||(i=u.ErrorCode.FormatNotSupport,n=f.get("Error_H5_Not_Support_Text"),l=!0),e=function(){var e;setTimeout(function(){s.trigger(y.Private.Play_Btn_Hide)}),s.checkOnline()&&(e={mediaId:s._options&&s._options.vid?s._options.vid:"",error_code:i,error_msg:r.msg},s.logError(e),e.display_msg=n,c.cityBrain&&(s.flv=null),s.trigger(y.Player.Error,e))},s._options&&s._options.isLive&&!l?(o=s._options).liveRetry>s._liveRetryCount?(0==s._liveRetryCount&&s.trigger(y.Player.OnM3u8Retry),a=o.liveRetryInterval+o.liveRetryStep*s._liveRetryCount,s._liveRetryCount++,setTimeout(function(){s._loadByUrlInner(o.source)},1e3*a)):(s._liveErrorHandle&&clearTimeout(s._liveErrorHandle),s.trigger(y.Player.LiveStreamStop),s._liveErrorHandle=setTimeout(e,500)):t===flvjs.ErrorDetails.MEDIA_MSE_ERROR&&11===r.code&&s.getCurrentTime()<s.getDuration()?(s._flv.unload(),s._flv.load(),s._flv.detachMediaElement(),s._flv.attachMediaElement(s.tag)):l?(s._flv.unload(),e()):s._reloadForVod()||e()))})})}},{"../../config":14,"../../lang/index":23,"../../lib/constants":28,"../../lib/io":40,"../../lib/playerutil":46,"../../lib/ua":49,"../../lib/util":51,"../base/event/eventtype":70}],101:[function(e,t,r){var i=e("../base/player"),n=e("./flvinjector"),o=i.extend({init:function(e,t){n.inject(this,o,i,t,function(e){}),t._native=!1,i.call(this,e,t)}});t.exports=o},{"../base/player":91,"./flvinjector":100}],102:[function(e,t,r){var p,u=e("../../lib/io"),d=e("../../config"),h=e("../../lib/constants"),f=e("../../lib/util"),y=e("../../lib/playerutil"),_=e("../../lib/ua"),g=e("../../lang/index"),v=e("../base/event/eventtype"),m=e("../../lib/hls/hlsparse"),S="hlsinjector.js";function b(){this&&this._hls&&(this._hls.stopLoad(),this._hls.destroy(),this._hls=null)}t.exports.inject=function(e,t,r,i,n,l){e._hls2=!1;var o,a,s=i.source,c=i.useHlsPluginForSafari,i=i.useHlsPlugOnMobile;((n||"").length||l||(o=s,c=c,i=i,!e._hls&&y.isHls(o)&&(!y.canPlayHls()||y.isSafariUsedHlsPlugin(c)||i&&y.isUsedHlsPluginOnMobile())))&&(e._Type=t,e._superType=r,e._superPt=r.prototype,e._disposed=!1,t.prototype._checkHlsReady=function(){if(null==this._hls)throw new Error("please invoke this method after ready event")},e._isHls=!0,e._hls=null,e._isLoadedHls=!1,e._stopLoadAsPaused=!0,e._sce_dlgtqred_saved=n,t.prototype.play=function(e){this.traceLog(S,"play::"+e),this._checkHlsReady(),this._isManualPlay=e||!1;return this.trigger(v.Private.Cover_Hide),this._options.autoplay||this._options.preload||this._loadSourced||(this._loadSourced=!0,this._options._autoplay=!0,this._hls.loadSource(this._options.source)),this.tag.ended||this._ended?this.replay():this.tag.paused&&(this.tag.play(),this._stopLoadAsPaused)&&(e=this.getCurrentTime(),this._hls.startLoad(e)),this},t.prototype.replay=function(){return this._monitor&&this._monitor.replay(),this._hls.startLoad(0),this.tag.play(),this},t.prototype.pause=function(e){return this.tag&&(this._checkHlsReady(),this.tag.pause(),this._stopLoadAsPaused)&&this._hls.stopLoad(),this._isManualPause=e||!1,this},t.prototype.stop=function(){return this._checkHlsReady(),this.tag.setAttribute("src",null),this._hls.stopLoad(),this},t.prototype.seek=function(e){this._checkHlsReady();try{this._superPt.seek.call(this,e),this.tag.paused&&this._stopLoadAsPaused&&this._hls.startLoad(e)}catch(e){console.log(e)}return this},t.prototype.getProgramDateTime=function(){if(this._checkHlsReady(),-1==this._hls.currentLevel)return"";var e=this._hls.currentLevel,e=this._hls.levels[e].details;if(e){e=e.programDateTime;if(console.log("ProgramDateTime="+e),e)return new Date(e).valueOf()}return 0},t.prototype.getCurrentPDT=function(){var e,t;return this._checkHlsReady(),-1==this._hls.currentLevel?"":(e=(t=this._hls.streamController.fragPlaying||{}).pdt)?(t=1e3*t.startPTS,e+(1e3*this.getCurrentTime()-t)):0},t.prototype._reloadAndPlayForM3u8=function(){this.traceLog(S,"reloadAndPlayForM3u8"),0==this._liveRetryCount&&this.trigger(v.Player.OnM3u8Retry),this._liveRetryCount++},t.prototype._switchLevel=function(e){this.traceLog(S,"switchLevel::"+e);var t=this.getCurrentTime(),r=!this._qualityService.levels.length&&1<this._urls.length,i=(r&&(this.pause(),this._hls.stopLoad(),this._hls.detachMedia(),this._hls.destroy()),this.trigger(v.Player.LevelSwitch),this._hls.levels),n=!0;r&&this._loadByUrlInner(e,t,n,!0);for(var o=0;o<i.length;o++)if(i[o].url==e||i[o].url[0]==e){n=!1,this._hls2&&this._options.seamlessHandover?(this._hls.loadLevel=o,console.log("Seamlessly set nextLevel to",o)):(this._hls.currentLevel=o,console.log("Immediately set currentLevel to",o));break}n&&(this._hls.currentLevel=-1),this._switchedLevel=!0;var a=this;setTimeout(function(){a.trigger(v.Player.LevelSwitched),this._switchedLevel=!1},1e3)},t.prototype._getHlsVersion=function(i){var n,o,a;function s(e,t){this.traceLog(S,"handleHlsParseLoadError::"+e+"#"+t);var r=this.getOptions()||{},r={mediaId:r.vid||"",mediaAuth:r.mediaAuth||"",error_code:h.ErrorCode.LoadedMetadata,error_msg:g.get("Error_Play_Text")},t=Number(t);404===t?(r.error_code=h.ErrorCode.NotFoundSourceURL,r.error_msg=g.get("Error_Not_Found")):403===t?e===m.ERROR_REGION_BLOCK?(r.error_code=h.ErrorCode.RegionBlock,r.error_msg=g.get("Error_Region_Block_Text")):(r.error_code=h.ErrorCode.AuthKeyExpired,r.error_msg=g.get("Error_AuthKey_Text")):0===t&&navigator.onLine?(r.error_code=h.ErrorCode.RequestDataError,r.error_msg=r.error_msg+"\uff0c"+g.get("Maybe_Cors_Error")):r.error_msg=g.get("Error_Load_M3U8_Failed_Text"),this.logError(r),r.display_msg=r.error_msg,this.trigger(v.Player.Error,r)}!0===this._options.useHls2?(this._hls2=!0,i()):!1===this._options.useHls2||!this._options.isLive||l?i():this._options.lowLatencyMode?(this._hls2=!0,i()):(n=this,o=new m,a=n._options.source,o.load(a,function(e){var t,r;e.levels&&0!==e.levels.length?t=e.levels[0].url:(t=a,r=e.string),o.loadMediaPlaylist({url:t,string:r},function(e){e&&(n._hls2="number"==typeof e.partTarget),i()},s.bind(n))},s.bind(n)))},t.prototype.initPlay=function(t){var e,r;function i(s,t){if(s._antiRecord&&(console.log("Manual check before load source"),s._antiRecord.check()))return;var e,r=!s._hls,i=(s._destroyHls(),{xhrSetup:function(e,t){e.withCredentials=s._options.withCredentials||!1}}),n=s._options.loadingTimeOut||s._options.hlsLoadingTimeOut;for(e in n&&(i.manifestLoadingTimeOut=n,i.levelLoadingTimeOut=n,i.fragLoadingTimeOut=n),s._options.liveSyncDurationCount&&(i.liveSyncDurationCount=s._options.liveSyncDurationCount),s._options.defaultBandwidth&&(i.defaultBandwidth=s._options.defaultBandwidth),s._options.isLive&&(s._options.hlsFrameChasing&&(i.hlsFrameChasing=s._options.hlsFrameChasing),s._options.chasingFirstParagraph&&(i.chasingFirstParagraph=s._options.chasingFirstParagraph),s._options.chasingSecondParagraph&&(i.chasingSecondParagraph=s._options.chasingSecondParagraph),s._options.chasingFirstSpeed&&(i.chasingFirstSpeed=s._options.chasingFirstSpeed),s._options.chasingSecondSpeed)&&(i.chasingSecondSpeed=s._options.chasingSecondSpeed),!s._hls2||s._options.isLive&&!_.IS_IE11&&(i.backBufferLength=12,i.liveDurationInfinity=!0),s._options.nudgeMaxRetry&&(i.nudgeMaxRetry=s._options.nudgeMaxRetry),s._options.maxMaxBufferLength&&(i.maxMaxBufferLength=s._options.maxMaxBufferLength),s._options.maxBufferSize&&(i.maxBufferSize=s._options.maxBufferSize),s._options.fragLoadingRetryDelay&&(i.fragLoadingRetryDelay=s._options.fragLoadingRetryDelay),s._options.maxBufferLength&&(i.maxBufferLength=s._options.maxBufferLength),s._options.hlsBandWidthUpCacheTime&&(i.abrBandWidthUpCacheTime=s._options.hlsBandWidthUpCacheTime),s._options.seamlessHandover&&(i.seamlessHandover=s._options.seamlessHandover),s._options.accessKeyId&&(i.accessKeyId=s._options.accessKeyId),s._options.accessKeySecret&&(i.accessKeySecret=s._options.accessKeySecret),s._options.securityToken&&(i.securityToken=s._options.securityToken),s._options.app&&(i.app=s._options.app),s._options.stream&&(i.stream=s._options.stream),s._options.domain&&(i.domain=s._options.domain),s._options.regionId&&(i.regionId=s._options.regionId),s._sce_dlgtqred_saved&&(i._sce_dlgtqredxx=s._sce_dlgtqred_saved),i.enableWorker=s._options.enableWorker,i.debug=s._options.debug,s._stopLoadAsPaused=s._options.hlsOption.stopLoadAsPaused,s._options.hlsOption)i[e]=s._options.hlsOption[e];_.IS_IE11&&(i.enableWorker=!1),s._hls=new p(i),a(s,s._hls),s._loadSourced=!1,s._hls.attachMedia(s.tag),s._hls.on(p.Events.INIT_PTS_FOUND,function(e,t){s._initPTS=t.initPTS}),s._hls.on(p.Events.FRAG_PARSING_USERDATA,function(e,t){t&&t.dataContent&&t.dataContent.length&&s.trigger(v.Private.SeiFrame,{dataContent:t.dataContent,pts:t.pts})}),s._hls.on(p.Events.MEDIA_ATTACHED,function(){var e;s._hls.on(p.Events.MANIFEST_PARSED,function(){s._initPlayBehavior(t||s._loadSourced)}),s._hls.on(p.Events.AUDIO_TRACKS_UPDATED,function(e,t){s.trigger(v.Player.AudioTrackUpdated,t)}),s._hls.on(p.Events.MANIFEST_LOADED,function(e,t){s.trigger(v.Player.LevelsLoaded,t)}),s._hls.on(p.Events.LEVEL_SWITCHED,function(e,t){if(s._qualityService){for(var r=s._hls.levels[t.level].url,i=s._qualityService.levels,n="",o="",a=0;a<i.length;a++)if(i[a].Url==r){o=i[a].desc,n=i[a].bitrate;break}(o||n)&&s.trigger(v.Private.QualityChange,{levelSwitch:!0,url:r,bitrate:n,desc:o})}}),s._hls.on(p.Events.AUDIO_TRACK_SWITCH,function(e,t){s.trigger(v.Player.AudioTrackSwitch,t),setTimeout(function(){s.trigger(v.Player.AudioTrackSwitched,t)},1e3)}),(s._options.autoplay||s._options.preload||t)&&(s._loadSourced=!0,s._levels&&1<s._levels.length?(s._hls.trigger(p.Events.MANIFEST_LOADING,{}),s._hls.trigger(p.Events.MANIFEST_LOADED,{levels:s._levels})):s._hls.loadSource(s._options.source||"__INVALID__")),r?(s._executeReadyCallback(),s._urls&&0<s._urls.length&&!s._options.defaultDefinition&&(s._currentPlayIndex=y.findSelectedStreamLevel(s._urls),e=s._urls[s._currentPlayIndex],s._options.source=e.Url,s.trigger(v.Private.SourceLoaded,e))):s.trigger(v.Private.H5_Loading_Show)})}this.trigger(v.Private.H5_Loading_Show),f.contentProtocolMixed(s)?((e={mediaId:(e=this.getOptions()||{}).vid||"",mediaAuth:e.mediaAuth||"",error_code:h.ErrorCode.InvalidSourceURL,error_msg:"InvalidSourceURL"}).display_msg=g.get("Request_Block_Text"),this.trigger(v.Player.Error,e)):(r=this)._isLoadedHls&&void 0!==p?i(this,t):(this.trigger(v.Private.H5_Loading_Show),this._getHlsVersion(function(e){!function(e,t){var r="aliplayer-hls-min.js",t=((t=t||{}).hls2&&(r="aliplayer-hls2-min.js"),""),t=d.domain?"https://"+d.domain+d.path+d.h5Version+"/hls/"+r:"/build/hls/"+r,i=this;u.loadJS(t,function(){p=window.AliHls||window.Hls,e.apply(i)})}.call(r,function(){r._isLoadedHls=!0,i(r,t)},{debug:r._options.debug,hls2:r._hls2})}),this.on("error",b))},t.prototype._getbwEstimator=function(){var e,t=NaN;return t=this._hls?(e=this._hls.abrController._bwEstimator)?e.getEstimate():NaN:t},t.prototype._destroyHls=function(){this._hls&&this._hls.destroy(),this._hls=null},t.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._superPt&&this._superPt.dispose.call(this),this._destroyHls(),this._superPt&&(t.prototype.play=this._superPt.play,t.prototype.pause=this._superPt.pause,t.prototype.initPlay=this._superPt.initPlay,t.prototype.replay=this._superPt.replay,t.prototype.stop=this._superPt.stop,t.prototype.seek=this._superPt.seek))},a=function(c,u){u.on(p.Events.DEFAULT_BANDWIDTH,function(e,t){c.trigger(v.Player.DefaultBandWidth,{width:t.width,height:t.height,bitrate:t.bitrate})}),u.on(p.Events.ERROR,function(e,t){var r,i,n,o,a,s,l;c.traceLog(S,"hlsjs-error::"+t.type+"#"+t.details+"#"+(null==(l=t.networkDetails)?void 0:l.status)),!c._options||t.details==p.ErrorDetails.FRAG_LOOP_LOADING_ERROR||1==c._seeking||0==t.fatal&&t.type!=p.ErrorTypes.NETWORK_ERROR||(c._clearTimeout(),r=h.ErrorCode.LoadedMetadata,o=g.get("Error_Play_Text"),l=i=!1,t.details==p.ErrorDetails.MANIFEST_LOAD_ERROR||t.details==p.ErrorDetails.LEVEL_LOAD_ERROR?(i=!0,s=t.networkDetails,n=Number(s.status),c.liveShiftSerivce&&c.liveShiftSerivce.isLiveShiftPlaying()&&404===n?(r=h.ErrorCode.NotFoundSourceURL,o=g.get("Error_Liveshift_M3U8_Not_Found_Text"),l=!0):o=404===n?(r=h.ErrorCode.NotFoundSourceURL,g.get("Error_Not_Found")):403===n?(s=y.parseHttpHeaders(s)["x-tengine-error"])&&-1<h.RegionBlockMessages.indexOf(s)?(r=h.ErrorCode.RegionBlock,g.get("Error_Region_Block_Text")):(r=h.ErrorCode.AuthKeyExpired,g.get("Error_AuthKey_Text")):0===n&&navigator.onLine?(r=h.ErrorCode.RequestDataError,o+"\uff0c"+g.get("Maybe_Cors_Error")):g.get("Error_Load_M3U8_Failed_Text")):t.details==p.ErrorDetails.MANIFEST_LOAD_TIMEOUT||t.details==p.ErrorDetails.LEVEL_LOAD_TIMEOUT?(i=!0,o=g.get("Error_Load_M3U8_Timeout_Text")):t.details==p.ErrorDetails.MANIFEST_PARSING_ERROR||t.details==p.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR?(i=!0,o=g.get("Error_M3U8_Decode_Text")):t.type==p.ErrorTypes.NETWORK_ERROR?(r=h.ErrorCode.NetworkError,o=g.get("Error_Network_Text")):t.type!=p.ErrorTypes.MUX_ERROR&&t.type!=p.ErrorTypes.MEDIA_ERROR||(r=h.ErrorCode.PlayDataDecode,o=g.get("Error_TX_Decode_Text")),o=o+"("+t.details+")",a=function(){var e;setTimeout(function(){c.trigger(v.Private.Play_Btn_Hide)}),c.checkOnline()&&(e={mediaId:(e=c.getOptions()||{}).vid||"",mediaAuth:e.mediaAuth||"",error_code:r,error_msg:t.details},c.logError(e),e.display_msg=o,c.trigger(v.Player.Error,e))},s=function(){c._liveErrorHandle&&clearTimeout(c._liveErrorHandle),u.stopLoad(),c.trigger(v.Player.LiveStreamStop),c._liveErrorHandle=setTimeout(a,500)},c._options&&c._options.isLive?l?s():c._hls2?t.fatal&&s():(l=c._options).liveRetry>c._liveRetryCount?(0==c._liveRetryCount&&c.trigger(v.Player.OnM3u8Retry),l=l.liveRetryInterval+l.liveRetryStep*c._liveRetryCount,c._liveRetryCount++,c.trigger(v.Private.H5_Loading_Show),setTimeout(function(){i&&c._loadByUrlInner(c._options.source,0,!0)},1e3*l)):s():(i&&-1<[403,404].indexOf(n)||!c._reloadForVod())&&a())})})}},{"../../config":14,"../../lang/index":23,"../../lib/constants":28,"../../lib/hls/hlsparse":39,"../../lib/io":40,"../../lib/playerutil":46,"../../lib/ua":49,"../../lib/util":51,"../base/event/eventtype":70}],103:[function(e,t,r){var i=e("../base/player"),n=e("./hlsinjector"),o=i.extend({init:function(e,t){t._native=!1,n.inject(this,o,i,t),i.call(this,e,t)}});t.exports=o},{"../base/player":91,"./hlsinjector":102}],104:[function(e,t,r){var l="undefined"==typeof Promise?e("es6-promise").Promise:Promise,c=e("../../lib/io"),u=e("../../config"),p=e("../../lib/constants"),d=e("../../lang/index"),h=e("../base/event/eventtype"),i=e("../../lib/ua"),f="rtsinjector.js";function y(e){var t=this._options;t.rtsFallbackSource&&window.Aliplayer?(this.trigger(h.Player.RtsFallback,{reason:e,fallbackUrl:t.rtsFallbackSource}),this.loadByUrl(t.rtsFallbackSource)):(this.trigger(h.Player.Error,e),this.logError(e))}function _(e){var o=this,t=(this.trigger(h.Private.H5_Loading_Show),this.trigger(h.Private.Play_Btn_Hide),new n(o,e));return o._rts.subscribe(o._options.source,{mediaTimeout:o._options.rtsLoadDataTimeout}).then(function(e){return o._retryTimer&&(clearTimeout(o._retryTimer),o._retryTimer=null),t.preProcess(),o.tag.srcObject=null,e.play(o.tag),!0}).catch(function(e){o.traceLog(f,"subError::"+JSON.stringify(e));var t=null,r=null,i=null;switch(Number(e.errorCode)){case 10101:t=p.ErrorCode.RtsSignalError,r=d.get("Rts_Err_Http_Signal_Error");break;case 10114:t=p.ErrorCode.RtsCreateOfferError,r=d.get("Rts_Err_Create_Offer_Error");break;case 10202:t=p.ErrorCode.RtsPlayUrlError,r=d.get("Rts_Err_Play_Url_Error");break;case 10203:t=p.ErrorCode.RtsSubscribeNonthing,r=d.get("Rts_Err_Subscribe_Nonthing");break;case 10205:var n=null==(n=e.extraInfo)?void 0:n.response;if(403===(null==n?void 0:n.status)){n=n.headers["x-tengine-error"];if(n&&-1<p.RegionBlockMessages.indexOf(n)){t=p.ErrorCode.RegionBlock,r=d.get("Error_Region_Block_Text");break}}t=p.ErrorCode.RtsHttpRequestFaild,r=d.get("Rts_Err_Http_Request_Failed"),i=d.get("Tip_Err_Rts_Http_Failed");break;case 10206:t=p.ErrorCode.RtsHttpAnswerFaild,r=d.get("Rts_Err_Http_Answer_Failed")}return y.call(o,{error_code:t,error_msg:r,diagnosis_info:i}),!1})}function g(){this._noDataTimer&&(clearTimeout(this._noDataTimer),this._noDataTimer=null)}t.exports.inject=function(e,t,r,i,n,o){function a(e,t){var r,i,n;g.call(this),this._retryTimer||(e=e||p.ErrorCode.RtsPlayFailedError,t=t||d.get("Rts_Err_Play_Failed")+", "+this._options.rtsLoadDataTimeout*(this._options.liveRetry+1)+d.get("Rts_Err_No_Data_For"),(i=(r=this)._options)?i.liveRetry>r._liveRetryCount?(0==r._liveRetryCount&&r.trigger(h.Player.OnM3u8Retry),n=Number(i.liveRetryInterval||0)+Number(i.liveRetryStep*r._liveRetryCount||0),r._liveRetryCount++,r.stop(),setTimeout(function(){r.trigger(h.Private.H5_Loading_Show),r.trigger(h.Private.Play_Btn_Hide)},50),r._retryTimer=setTimeout(function(){r.trigger(h.Private.Retry,{type:"rts",source:i.source}),_.call(r,!0)},1e3*n)):(r._retryTimer&&clearTimeout(r._retryTimer),r._liveErrorHandle&&clearTimeout(r._liveErrorHandle),r.stop(),r._liveRetryCount=0,r.trigger(h.Player.LiveStreamStop),r._liveErrorHandle=setTimeout(s.call(this,e,t),500)):console.warn("no options!"))}function s(e,t){var r=this;r.pause(),setTimeout(function(){r.trigger(h.Private.Play_Btn_Hide)}),r.checkOnline()&&y.call(this,{error_code:e,error_msg:t})}e._Type=t,e._superType=r,e._superPt=r.prototype,e._disposed=!1,t.prototype._checkRtsReady=function(){if(null==this._rts)throw new Error("please invoke this method after ready event")},e._isRts=!0,e._rts=null,e._isLoadedRts=!1,e._liveErrorHandle=null,e._retryTimer=null,e._noDataTimer=null,e.bind_rtsPlayEventHandler=null,e.bind_rtsErrorEventHandler=null,t.prototype.play=function(e){this.traceLog(f,"play::"+e),this._checkRtsReady(),this._isManualPlay=e||!1;var t=this;return t.trigger(h.Private.Cover_Hide),t.trigger(h.Private.Play_Btn_Hide),_.call(t).then(function(e){e&&t._startPlay()}),this},t.prototype.seek=function(e){},t.prototype.setSpeed=function(e){},t.prototype.pause=function(e){return this._checkRtsReady(),this._superPt.pause.call(this,!0),this},t.prototype.stop=function(){return this._rts&&this._rts.unsubscribe(),this},t.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._superPt&&this._superPt.dispose.call(this),this._destroyRts(),this._superPt,this._liveErrorHandle&&(clearTimeout(this._liveErrorHandle),this._liveErrorHandle=null),this._retryTimer&&(clearTimeout(this._retryTimer),this._retryTimer=null),g.call(this))},t.prototype._destroyRts=function(){this._rts&&(this.stop(),this._rts.off("onError",this.bind_rtsErrorEventHandler),this._rts.off("onPlayEvent",this.bind_rtsPlayEventHandler)),this._rts=null},t.prototype.initPlay=function(e){function t(i,t){var r=!i._rts;i._destroyRts(),i._rts=new AliRTS.createClient({customReporter:function(e){if(126===Number(e.msgid)){var t={};try{t=JSON.parse(e.args)}catch(e){t={}}t.tcid&&i._rts&&(i._rts.traceid=t.tcid,i.trigger(h.Player.RtsTraceId,{traceId:t.tcid,source:i._options.source}))}}}),i._checkRtsSupport(function(e){!function(e){var t=this._rtsPlayEventHandler.bind(this),r=this._rtsErrorEventHandler.bind(this);this.bind_rtsPlayEventHandler=t,this.bind_rtsErrorEventHandler=r,e.on("onError",r),e.on("onPlayEvent",t)}.call(i,i._rts),i._options.autoplay?_.call(i).then(function(e){e&&i._initPlayBehavior(t)}):i._initPlayBehavior(t),r&&i._executeReadyCallback()},function(e){console.log("[RTS isSupport error]",e);var t=null,r=null;switch(Number(e.errorCode)){case 10110:t=p.ErrorCode.RtsNotSupportWebRtc,r=d.get("Rts_Err_Not_Support_Webrtc");break;case 10111:t=p.ErrorCode.RtsBrowserNotSupport,r=d.get("Rts_Err_Browser_Not_Support");break;case 10112:t=p.ErrorCode.RtsBrowserVersionTooLow,r=d.get("Rts_Err_Browser_Version_Too_Low");break;case 10113:t=p.ErrorCode.RtsNotSupportH264,r=d.get("Rts_Err_Not_Support_H264");break;case 10114:t=p.ErrorCode.RtsCreateOfferError,r=d.get("Rts_Err_Create_Offer_Error")}return y.call(i,{error_code:t,error_msg:r}),!1})}this._isLoadedRts?t(this,e):(this.trigger(h.Private.H5_Loading_Show),function(e,t){var r="",i=this._options,r="https://g.alicdn.com/apsara-media-box/imp-web-rts-sdk/"+(i.rtsVersion||u.rtsVersion)+"/aliyun-rts-sdk.js",n=(i.rtsSdkUrl&&(r=i.rtsSdkUrl),this);c.loadJS(r,function(){e.apply(n)})}.call(this,function(){this._isLoadedRts=!0,t(this,e)},this._options.debug))},t.prototype.getStats=function(){return this._rts&&this._rts.getTransportStats?l.all([this._rts.getTransportStats(),this._rts.getRemoteVideoStats(),this._rts.getRemoteAudioStats()]).then(function(e){var t=e[0],r=e[1],e=e[2];return{rtt:t.rtt,bytesReceived:t.bytesReceived,framesDecoded:r.framesDecoded,packetsLost:(r.packetsLost||0)+(e.packetsLost||0),packetsReceived:(r.packetsReceived||0)+(e.packetsReceived||0),timestamp:t.timestamp||Date.now()}}).catch(function(e){return console.log("ERR in RTS getstats: ",e),{}}):l.resolve()},t.prototype._rtsPlayEventHandler=function(e){var t="canplay",r="waiting",i="playing",n="ended",o="timeout";e.event===t?g.call(this):e.event!==r&&(e.event===i?g.call(this):e.event!==o&&e.event!==n||a.call(this))},t.prototype._checkRtsSupport=function(e,t){this._options.skipRtsSupportCheck?e():this._rts.isSupport({isReceiveVideo:!0}).then(e).catch(t)},t.prototype._rtsErrorEventHandler=function(e){console.log("RTS Error:",e);var t,r;switch(Number(e.errorCode)){case 10102:a.call(this);break;case 12e3:t=p.ErrorCode.RtsPeerConnectionUnknown,r=d.get("Rts_Err_PeerConnection_Unknown"),s.call(this,t,r)}}};var n=function(){function e(e,t){(this.isRetry=t)&&(this.isApple=i.IS_IOS||i.IS_SAFARI,this.player=e)}return e.prototype.preProcess=function(){var e,t,r;this.isRetry&&this.isApple&&(e=this.player.getVolume(),t=this.player.muted(),e)&&!t&&((r=this.player.tag).volume=0,this.player.one("canplay",function(){r.volume=e}))},e}()},{"../../config":14,"../../lang/index":23,"../../lib/constants":28,"../../lib/io":40,"../../lib/ua":49,"../base/event/eventtype":70,"es6-promise":8}],105:[function(e,t,r){var i=e("../base/player"),n=e("./rtsinjector"),o=i.extend({init:function(e,t){t.isLive&&(t._native=!1,n.inject(this,o,i,t),i.call(this,e,t))}});t.exports=o},{"../base/player":91,"./rtsinjector":104}],106:[function(e,t,r){var i=e("../../lib/constants"),e=e("../../lib/oo").extend({init:function(e){this.player=e,this.tickhandle=null}});e.prototype.tick=function(e,t){var r=this;this.tickhandle=setTimeout(function(){r.player&&r.player.trigger(i.AuthKeyExpiredEvent),t&&t()},1e3*e)},e.prototype.clearTick=function(e){this.tickhandle&&clearTimeout(this.tickhandle)},t.exports=e},{"../../lib/constants":28,"../../lib/oo":43}],107:[function(e,t,r){function s(e,t,r){var i=u.randomUUID(),n="https://mts."+e.domainRegion+".aliyuncs.com/?",i={AccessKeyId:e.accessId,Action:"GetLicense",MediaId:e.vid,LicenseUrl:n,data:e.data,SecurityToken:e.stsToken,Format:"JSON",Type:e.encryptionType,Version:"2014-06-18",SignatureMethod:"HMAC-SHA1",SignatureVersion:"1.0",SignatureNonce:i};e.header&&(i.Header=e.header),n+="Signature="+u.AliyunEncodeURI(u.makeChangeSiga(i,e.accessSecret,"POST")),e=u.makeUTF8sort(i,"=","&"),o.post(n,e,function(e){e?(e=JSON.parse(e),t&&(e=e.License,t(e))):r&&r(a.createError("MPS\u83b7\u53d6License\u5931\u8d25"))},function(e){if(r){var t={Code:"",Message:h.get("Error_MTS_Fetch_Urls_Text")};try{t=JSON.parse(e)}catch(e){}r({Code:c.ErrorCode.ServerAPIError,Message:t.Code+"|"+t.Message,sri:t.RequestId||""})}})}var o=e("../../lib/io"),l=(e("../../lib/ua"),e("../../lib/bufferbase64")),c=e("../../lib/constants"),u=e("./signature"),a=e("./util"),p=e("../../lib/url"),d=e("../../lib/playerutil"),h=e("../../lang/index"),f=e("../base/event/eventtype");function y(e){window.console.error("The license request failed.")}function _(e){window.console.error("A decryption key error was encountered"),window.console.error("A decryption key error was encountered",e)}function g(e){window.console.log("Decryption key was added to session.")}function v(e,t,r){r.addEventListener(e,function(){t(arguments[0])},!1)}t.exports.requestLicenseKey=function(e){var a=e;return a._options.vid&&(a.__vid=a._options.vid),function(e,t){var r,i,n=a._options,o=a._getDRMEncryptItem();o&&(r={vid:a.__vid,accessId:n.accId,accessSecret:n.accSecret,stsToken:n.stsToken,domainRegion:n.domainRegion,authInfo:n.authInfo,encryptionType:o.encryptionType},o.encryptionType==c.EncryptionType.Widevine?r.data=l.encode(e.message):o.encryptionType==c.EncryptionType.PlayReady&&(n=l.unpackPlayReady(e.message),r.data=n.changange,n.header)&&(r.header=JSON.stringify(n.header)),console.log(r.data),e=a.__licenseKeys,i=a.__vid+o.Url,e&&e[i],s(r,function(e){a.__licenseKeys||(a.__licenseKeys={}),10<r.data.length&&(a.__licenseKeys[i]=e);e=l.decode(e);t(e)},function(e){e={mediaId:a.__vid,error_code:e.Code,error_msg:e.Message};a.logError(e),a.trigger("error",e)}))}},t.exports.loadCertificate=function(e,t){var r,i,n,o=new XMLHttpRequest,a=(o.addEventListener("load",function(e,t){var r,t=t.target;if(200!==t.status){var i=c.ErrorCode.DrmLicenseRequestFailed,n=h.get("Error_Drm_License_Request_Failed"),i={mediaId:this._options.vid||"",error_code:i,error_msg:t.response};player.logError(i),i.display_msg=n,player.trigger(f.Player.Error,i)}else{try{r=this._options.isLive?JSON.parse(t.response).Response.B64ServCert:JSON.parse(JSON.parse(t.response).DRMCertInfo).b64ServCert}catch(e){console.log(e)}n=u.base64DecodeUint8Array(r),i=function(e,t){var r=t.target,t=t.initData,i=u.arrayToString(t).split("skd://")[1].split("?")[0],n=u.stringToArray(i);t=function(e,t,r){"string"==typeof t&&(t=stringToArray(t));var i=0,n=new ArrayBuffer(e.byteLength+4+t.byteLength+4+r.byteLength),o=new DataView(n),e=(new Uint8Array(n,0,e.byteLength).set(e),i+=e.byteLength,o.setUint32(i,t.byteLength,!0),i+=4,new Uint16Array(n,i,t.length));return e.set(t),i+=e.byteLength,o.setUint32(i,r.byteLength,!0),i+=4,new Uint8Array(n,i,r.byteLength).set(r),new Uint8Array(n,0,n.byteLength)}(t,n,e),r.webkitKeys||(function(){{if(!WebKitMediaKeys.isTypeSupported("com.apple.fps.1_0","video/mp4"))throw"Key System not supported";keySystem="com.apple.fps.1_0"}}(),r.webkitSetMediaKeys(new WebKitMediaKeys(keySystem)));if(!r.webkitKeys)throw"Could not create MediaKeys";n=r.webkitKeys.createSession("video/mp4",t);if(!n)throw"Could not create key session";n.contentId=i,v("webkitkeymessage",function(e){var t=this,r=e.target,i=e.message,n=new XMLHttpRequest,e=(e.sessionId,n.responseType="text",n.session=r,n.addEventListener("load",function(e){e=e.target;t=this._options.isLive?JSON.parse(e.response).Response.B64License:JSON.parse(JSON.parse(e.response).License).b64License;var t=u.base64DecodeUint8Array(t),t=u.Uint8ArrayToString(t);"<ckc>"===t.substr(0,5)&&"</ckc>"===t.substr(-6)&&(t=t.slice(5,-6));t=u.base64DecodeUint8Array(t);e.session.update(t)}.bind(this),!1),n.addEventListener("error",y,!1),btoa("spc="+u.base64EncodeUint8Array(i)+"&assetId="+encodeURIComponent(r.contentId))),o={Format:"JSON",SignatureMethod:"HMAC-SHA1",SignatureVersion:"1.0",Timestamp:u.ISODateString(new Date),SignatureNonce:u.randomUUID(),AccessKeyId:t._options.accessKeyId,SecurityToken:t._options.securityToken,CertId:t._options.certId};t._options.isLive?(o.RegionId=t._options.region,o.Action="DescribeDRMLicense",o.Version="2016-11-01",o.CdmData=e,o.Type="fairplay",o.Domain=p.parseUrl(t._options.source).hostname):(o.region=t._options.region,o.Action="GetDRMLicense",o.Version="2017-03-21",o.VideoId=t._options.vid,o.CDMData=e,o.DRMType="FairPlay");var a,s,i="Signature="+u.AliyunEncodeURI(u.makeChangeSiga(o,t._options.accessKeySecret,"POST"));r=t._options.isLive?"https://"+d.getLiveHostByRegion(t._options.region)+"/?"+i:"https://vod."+t._options.region+".aliyuncs.com/?"+i;for(s in n.open("POST",r,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o){var l;o.hasOwnProperty(s)&&(l=o[s],a=a?a+"&"+u.AliyunEncodeURI(s)+"="+u.AliyunEncodeURI(l):u.AliyunEncodeURI(s)+"="+u.AliyunEncodeURI(l))}n.send(a)}.bind(this),n),v("webkitkeyadded",g,n),v("webkitkeyerror",_,n)}.bind(this,n),t=(this._fairPlayHandlers.onNeedKey=i,function(e){window.console.error("A video playback error occurred")}.bind(this));this._fairPlayHandlers.onError=t,this.tag.addEventListener("webkitneedkey",i,!1),this.tag.addEventListener("error",t,!1),this.tag.src=this._options.source}e&&e()}.bind(e,t),!1),o.addEventListener("error",function(e){window.console.error("Failed to retrieve the server certificate.")}.bind(e),!1),{Format:"JSON",SignatureMethod:"HMAC-SHA1",SignatureVersion:"1.0",Timestamp:u.ISODateString(new Date),SignatureNonce:u.randomUUID(),AccessKeyId:e._options.accessKeyId,SecurityToken:e._options.securityToken,CertId:e._options.certId}),t=(e._options.isLive?(a.RegionId=e._options.region,a.Action="DescribeDRMCertificate",a.Version="2016-11-01"):(a.region=e._options.region,a.Action="GetDRMCertInfo",a.Version="2017-03-21",a.VideoId=e._options.vid),"Signature="+u.AliyunEncodeURI(u.makeChangeSiga(a,e._options.accessKeySecret,"POST"))),e=e._options.isLive?"https://"+d.getLiveHostByRegion(e._options.region)+"/?"+t:"https://vod."+e._options.region+".aliyuncs.com/?"+t;for(r in o.open("POST",e,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a)a.hasOwnProperty(r)&&(i=a[r],n=n?n+"&"+u.AliyunEncodeURI(r)+"="+u.AliyunEncodeURI(i):u.AliyunEncodeURI(r)+"="+u.AliyunEncodeURI(i),console.log(i));o.send(n)},t.exports.getRequestUrl=function(e,t){var e={AccessKeyId:t._options.accessKeyId,Format:"JSON",Version:"2016-11-01",SignatureMethod:"HMAC-SHA1",SignatureVersion:"1.0",Timestamp:u.ISODateString(new Date),SignatureNonce:u.randomUUID(),SecurityToken:t._options.securityToken,RegionId:t._options.region,Action:"DescribeDRMLicense",Type:"widevine",CdmData:e,Domain:p.parseUrl(t._options.source).hostname},r=(t._options.widevineCertId&&(e.CertId=t._options.widevineCertId),"Signature="+u.AliyunEncodeURI(u.makeChangeSiga(e,t._options.accessKeySecret,"POST")));return{url:"https://"+d.getLiveHostByRegion(t._options.region)+"/?"+r,data:u.makeUTF8sort(e,"=","&"),jsonData:u.makeUTF8sort(e,"=","&","json")}},t.exports.postData=function(e,t){var r=u.randomUUID(),r={AccessKeyId:t._options.accessKeyId,VideoId:t._options.vid,Format:"JSON",Version:"2017-03-21",SignatureMethod:"HMAC-SHA1",SignatureVersion:"1.0",SignatureNonce:r,SecurityToken:t._options.securityToken,region:t._options.region,Action:"GetDRMLicense",DRMType:"Widevine",CDMData:e},e=(t._options.widevineCertId&&(r.CertId=t._options.widevineCertId),"Signature="+u.AliyunEncodeURI(u.makeChangeSiga(r,t._options.accessKeySecret,"POST")));return{url:"https://vod."+t._options.region+".aliyuncs.com/?"+e,data:u.makeUTF8sort(r,"=","&"),jsonData:u.makeUTF8sort(r,"=","&","json")}},t.exports.destroyFairPlay=function(){this._fairPlayHandlers.onNeedKey&&this.tag.removeEventListener("webkitneedkey",this._fairPlayHandlers.onNeedKey),this._fairPlayHandlers.onError&&this.tag.removeEventListener("error",this._fairPlayHandlers.onError),this._fairPlayHandlers={}}},{"../../lang/index":23,"../../lib/bufferbase64":25,"../../lib/constants":28,"../../lib/io":40,"../../lib/playerutil":46,"../../lib/ua":49,"../../lib/url":50,"../base/event/eventtype":70,"./signature":113,"./util":115}],108:[function(e,t,r){var i=e("../../lib/io"),c=e("../../lib/constants"),n=e("../../lib/data"),u=e("./util");t.exports.getDataByAuthInfo=function(e,a,s,l){e={playAuth:e.playAuth,requestId:e.requestId},i.get("https://api.h5video.shop/api/page/getMediaPlayInfo"+function(r){return r.requestId=n.guid(),Object.keys(r).reduce(function(e,t){return e+(e?"&":"?")+t+"="+encodeURIComponent(r[t])},"")}(e),function(e){if(e){e=JSON.parse(e);if(200!==e.httpStatusCode)l&&l({Code:c.ErrorCode.ServerAPIError,Message:e.httpStatusCode+"|"+e.code,sri:e.requestId});else{for(var t=e.data.PlayInfoList,r=[],i=t.length-1;0<=i;--i)"AUTO"===t[i].Definition&&(r=[t.splice(i,1)[0]]);var n,o=null;(o=(o=0===r.length?u.objectPlayerMessageSort(t,a):u.objectPlayerMessageSort(r)).map(function(e){return"m3u8"===e.format&&(e.Url=e.Url+"&_ext=.m3u8"),e}))&&s&&(n=e.data.VideoBase||{},s({videoId:n.VideoId,userId:n.UserId,requestId:e.requestId,urls:o,encryptUrlArr:[],thumbnailUrl:"",coverUrl:n.CoverURL,playInfoAry:t,textTracks:e.data.SubtitlesList}))}}else l&&l(u.createError("\u8f7bSaaS\u670d\u52a1\u83b7\u53d6\u6570\u636e\u5931\u8d25"))},function(e){e&&"string"==typeof e&&-1<e.indexOf("Invalid CORS request")?l&&l({Code:c.ErrorCode.ServerAPIError,Message:e}):l&&l(u.createError("\u8f7bSaaS\u670d\u52a1\u83b7\u53d6\u6570\u636e\u5931\u8d25"))})}},{"../../lib/constants":28,"../../lib/data":30,"../../lib/io":40,"./util":115}],109:[function(e,t,r){var i=e("./saasplayer"),n=e("./light"),o=e("../base/event/eventtype"),e=i.extend({init:function(e,t){i.call(this,e,t),this.service=n,this.loadByLightSaas()}});e.prototype.loadByLightSaas=function(e){var t=this._options,r={playAuth:t.mediaAuth,defaultDefinition:t.defaultDefinition};this.log("STARTFETCHDATA",{it:"lightSaasPlayAuth",pa:{playAuth:t.mediaAuth}}),this.loadData(r,e)},e.prototype.replayByMediaAuth=function(e){this.trigger(o.Private.Error_Hide),this.tag&&(this.tag.pause(),this.tag.removeAttribute("src"),this.tag.load()),this.setTextTracks([]),this.trigger(o.Private.UserTrackReset),this._options.source="",this._options.mediaAuth=e,this._isError=!1,this._duration=0,this._options.cover="",this._vodRetryCount=0,this._clearTimeout(),this.loadByLightSaas(!0)},t.exports=e},{"../base/event/eventtype":70,"./light":108,"./saasplayer":112}],110:[function(e,t,r){var i=e("../../lib/io"),l=e("../../lib/constants"),s=e("./signature"),c=e("./util"),u=e("../../lang/index"),p=e("../../lib/ua");var d=function(e,r){for(var t="",i=(e.sort(function(e,t){e=parseInt(e.bitrate),t=parseInt(t.bitrate);return"desc"==r?t<e?-1:e<t?1:void 0:e<t?-1:t<e?1:void 0}),e.length),n=0;n<i;n++){var o=e[n],a=l.QualityLevels[o.definition],s="",s=void 0===a?o.bitrate:t==a?a+o.bitrate:a;o.desc=s,t=a}},h=function(e,r){for(var t="",i=(e.sort(function(e,t){e=parseInt(e.width),t=parseInt(t.width);return"desc"==r?t<e?-1:e<t?1:void 0:e<t?-1:t<e?1:void 0}),e.length),n=0;n<i;n++){var o=e[n],a=l.QualityLevels[o.definition],s="",s=void 0===a?"":t==a?a+o.height:a;o.desc=s,t=a}};t.exports.getDataByAuthInfo=function(e,n,o,a){s.returnUTCDate(),s.randomUUID();var t=s.randomUUID(),t={AccessKeyId:e.accessId,Action:"PlayInfo",MediaId:e.vid,Formats:e.format,AuthInfo:e.authInfo,AuthTimeout:e.authTimeout||l.AuthKeyExpired,IncludeSnapshotList:e.includeSnapshotList,Rand:e.rand,SecurityToken:e.stsToken,Format:"JSON",Version:"2014-06-18",SignatureMethod:"HMAC-SHA1",SignatureVersion:"1.0",Terminal:p.IS_CHROME?"Chrome":p.IS_EDGE?"Edge":p.IS_IE11?"IE":p.IS_SAFARI?"Safari":p.IS_FIREFOX?"Firefox":"",SignatureNonce:t},t=(e.hlsUriToken&&(e.MtsHlsUriToken=e.hlsUriToken),e.playConfig&&(t.PlayConfig=JSON.stringify(e.playConfig)),s.makeUTF8sort(t,"=","&")+"&Signature="+s.AliyunEncodeURI(s.makeChangeSiga(t,e.accessSecret))),e="https://mts."+e.domainRegion+".aliyuncs.com/?"+t;i.get(e,function(e){var t,r,i;e?(t=(e=JSON.parse(e)).PlayInfoList.PlayInfo,r="",(i=e.SnapshotList?e.SnapshotList.Snapshot:[])&&0<i.length&&(r=i[0].Url),i=function(e,t){for(var r=[],i=[],n=[],o=[],a=e.length-1;0<=a;a--){var s=e[a];("mp4"==s.format?i:"mp3"==s.format?n:"m3u8"==s.format?r:o).push(s)}return 0<n.length?(d(n,t),n):0<i.length?(h(i,t),i):0<r.length?(h(r,t),r):(h(o,t),o)}(t,n),o&&o({requestId:e.RequestId,urls:i,thumbnailUrl:r})):a&&a(c.createError("MPS\u83b7\u53d6\u53d6\u6570\u5931\u8d25"))},function(e){if(a){var t={Code:"",Message:u.get("Error_MTS_Fetch_Urls_Text")};try{t=JSON.parse(e)}catch(e){}a({Code:l.ErrorCode.ServerAPIError,Message:t.Code+"|"+t.Message,sri:t.RequestId||""})}})}},{"../../lang/index":23,"../../lib/constants":28,"../../lib/io":40,"../../lib/ua":49,"./signature":113,"./util":115}],111:[function(e,t,r){var i=e("./saasplayer"),n=(e("../../lib/constants"),e("./mts")),e=i.extend({init:function(e,t){i.call(this,e,t),this.service=n,this.loadByMts()}});e.prototype.loadByMts=function(e){var t={vid:this._options.vid,accessId:this._options.accId,accessSecret:this._options.accSecret,stsToken:this._options.stsToken,domainRegion:this._options.domainRegion,authInfo:this._options.authInfo,format:this._options.format,includeSnapshotList:this._options.includeSnapshotList||!1,defaultDefinition:this._options.defaultDefinition,authTimeout:this._options.authTimeout,hlsUriToken:this._options.hlsUriToken,playConfig:this._options.playConfig};this.loadData(t,e)},e.prototype.replayByVidAndAuthInfo=function(e,t,r,i,n,o){this.trigger("error_hide"),this._options.source="",this._isError=!1,this._duration=0,this._options.cover="",this._vodRetryCount=0,this._clearTimeout(),this.reloadNewVideoInfo(e,t,r,i,n,o)},e.prototype.reloadNewVideoInfo=function(e,t,r,i,n,o){if(this.trigger("error_hide"),this._options.source="",e&&(this._options.vid=e,this._options.accId=t,this._options.accessSecret=r,this._options.stsToken=i,this._options.domainRegion=o,this._options.authInfo=n),!(this._options.vid&&this._options.accId&&this._options.accessSecret&&this._options.stsToken&&this._options.domainRegion&&this._options.authInfo))throw new Error("\u9700\u8981\u63d0\u4f9bvid\u3001accId\u3001accessSecret\u3001stsToken\u3001domainRegion\u548cauthInfo\u53c2\u6570");this.log("STARTFETCHDATA",{it:"mps",pa:{vid:e}}),this.loadByMts(!0)},t.exports=e},{"../../lib/constants":28,"./mts":110,"./saasplayer":112}],112:[function(e,t,r){var d=e("../base/player"),i=e("../audio/audioplayer"),o=(e("../../lib/event"),e("../../lib/io")),h=e("../../lib/constants"),n=e("./signature"),a=e("./authkeyexpiredhandle"),f=e("../hls/hlsinjector"),y=e("../flv/flvinjector"),_=e("../drm/drminjector"),g=(e("../../lib/cookie"),e("../../lang/index")),v=e("../../lib/ua"),s=e("../../config"),m=e("../../lib/playerutil"),S=e("../base/event/eventtype"),l=e("../../protected/anti-injector-protected"),b=d.extend({init:function(e,t){l(t,this),this._authKeyExpiredHandle=new a(this),d.prototype._videoCreateEl||(d.prototype._videoCreateEl=d.prototype.createEl),"mp3"==t.format?(t.height="auto",t.mediaType="audio",d.prototype.createEl=i.prototype.createEl,i.call(this,e,t),b.prototype.play=d.prototype.play,b.prototype.pause=d.prototype.pause,b.prototype.initPlay=d.prototype.initPlay,b.prototype.replay=d.prototype.replay,b.prototype.stop=d.prototype.stop,b.prototype.seek=d.prototype.seek):(d.prototype.createEl=d.prototype._videoCreateEl,t._native=!1,d.call(this,e,t))}});function T(){var e,t=!1;return 1!==Number(this._options.encryptType)?(e={error_code:h.ErrorCode.InvalidParameter,error_msg:g.get("Error_Not_Support_encrypt_Text")},this.logError(e),this.trigger("error",e),!0):t}b.prototype.loadData=function(e,t){var r,i,n;"undefined"!=typeof _sce_r_skjhfnck||1!=this._options.encryptType?this._loadData(e,t):(r="aliplayer-vod-min.js",i="",i=s.domain?"https://"+s.domain+s.path+s.h5Version+"/hls/"+r:"/build/hls/"+r,n=this,o.loadJS(i,function(){n._loadData(e,t)}))},b.prototype._loadData=function(s,l){var c,u=(new Date).getTime(),p=this;this._urls=[],this._currentPlayIndex=0,this._retrySwitchUrlCount=0,this._authKeyExpiredHandle.clearTick(),""!=s.format&&"m3u8"!=s.format||1!=this._options.encryptType?s.rand=n.randomUUID():(c=_sce_r_skjhfnck(),s.rand=_sce_lgtcaygl(c,p._vdnct6f)),this._options.thumbnailUrl&&(s.thumbnailUrl=this._options.thumbnailUrl),this.trigger(S.Private.H5_Loading_Show),this.service.getDataByAuthInfo.call(this,s,this._options.qualitySort,function(e){if(p.trigger(S.Private.PlayInfoLoaded,e),e.userId&&(p._options.from=e.userId),e.videoId&&p._monitor&&p._monitor.updateLightSaasVideoId(e.videoId),e.textTracks&&e.textTracks.length&&(t=m.unqiueTextTracks(e.textTracks),p.trigger(S.Private.TextTrackFounded,{from:"saas",textTracks:t})),e.urls&&0==e.urls.length)p._mtsError_message(p,{Code:h.ErrorCode.URLsIsEmpty,Message:g.get("Error_Vod_URL_Is_Empty_Text")+(s.format?"(format:"+s.format+")":"")},"");else{p.log("COMPLETEFETCHDATA",{cost:(new Date).getTime()-u,mi:JSON.stringify(function(e){for(var t=[],r=0;r<e.length;r++)t.push({width:e[r].width,height:e[r].height,definition:e[r].definition,format:e[r].format,encryptionType:e[r].encryptionType,duration:e[r].duration});return t}(e.urls))}),p._urls=e.urls,p._currentPlayIndex=m.findSelectedStreamLevel(p._urls,s.defaultDefinition);var t=(r=e.urls[p._currentPlayIndex]).Url;if(p._vodDuration=r.duration||0,p._options.source=t,p.encType="",p.trigger(S.Private.PREPARE,r.definition),p.UI.cover&&e.coverUrl&&!p._options.cover&&p.setCover(e.coverUrl),m.isHls(t))if(e&&e.playInfoAry&&0<e.playInfoAry.length&&"Widevine-FairPlay"==e.playInfoAry[0].EncryptType)_.inject(p,b,d.prototype,p._options);else{if(e.encryptUrlArr&&0<e.encryptUrlArr.length){for(var r,i=[],n=0;n<e.encryptUrlArr.length;++n)if((r=e.encryptUrlArr[n]).encryptionType===h.EncryptionType.Private){if(T.call(p))return;var o=_sce_dlgtqred(c,r.rand,r.plaintext);i.push({url:r.Url,secData:o})}}else if(i="",r.encryptionType==h.EncryptionType.Private){if(T.call(p))return;p.encType=r.encryptionType;var a=m.checkSecuritSupport();if(a)return void p._mtsError_message(p,{Code:h.ErrorCode.EncrptyVideoNotSupport,Message:a,display_msg:a},"");i=_sce_dlgtqred(c,r.rand,r.plaintext)}p._hls&&(p._hls.destroy(),p._hls=null),f.inject(p,b,d,p._options,i)}else m.isFlv(t)?y.inject(p,b,d,p._options):m.isDash(t)?(console.log("isDash"),_.inject(p,b,d,p._options)):p._player._executeReadyCallback();p._authKeyExpiredHandle.tick(h.AuthKeyRefreshExpired),p.trigger(S.Private.SourceLoaded,r),p.initPlay(l),p.trigger(S.Private.ChangeURL,{from:"saas"}),e.thumbnailUrl&&p._thumbnailService.get(e.thumbnailUrl);a=p._player._isFlv,t=-1<p._player.getOptions().source.indexOf("mp4");1==p._player.encType||a||t||(v.IS_IOS||v.IS_MAC_SAFARI||v.IS_X5||v.IS_EDGE)&&(p._player._executeReadyCallback(),p._urls.length)&&p.trigger(S.Private.SourceLoaded,r)}},function(e){p._mtsError_message(p,e,"")})},b.prototype._changeStream=function(e,t){this._urls.length>e&&(this._loadByUrlInner(this._urls[e].Url,this.getCurrentTime(),!0),this._currentPlayIndex=e,this.trigger(S.Private.QualityChange,t||g.get("Quality_Change_Fail_Switch_Text")))},b.prototype._getLowerQualityLevel=function(){if(0!=this._urls.length&&-1!=this._currentPlayIndex)if("asc"==this.options().qualitySort){if(0<this._currentPlayIndex)return{item:this._urls[this._currentPlayIndex-1],index:this._currentPlayIndex-1}}else if(this._currentPlayIndex<this._urls.length-1)return{item:this._urls[this._currentPlayIndex+1],index:this._currentPlayIndex+1};return""},b.prototype._mtsError_message=function(e,t,r){e._serverRequestId=t.sri,e.trigger(S.Private.H5_Loading_Hide);var i=t.Code||"OTHER_ERR_CODE",n=t.Message||"OTHER_ERR_MSG",o=(h.ErrorCode.ServerAPIError,t.display_msg||""),a=(-1<n.indexOf("InvalidParameter.Rand")||-1<n.indexOf('"Rand" is not valid.')?(h.ErrorCode.EncrptyVideoNotSupport,o=g.get("Error_Not_Support_encrypt_Text")):-1<n.indexOf("SecurityToken.Expired")?(h.ErrorCode.AuthKeyExpired,o=g.get("Error_Playauth_Expired_Text")):-1<n.indexOf("InvalidVideo.NoneStream")?(h.ErrorCode.URLsIsEmpty,o=g.get("Error_Fetch_NotStream")+"("+e._options.format+"|"+e._options.definition+")"):-1<n.indexOf("DataNotFound")&&(h.ErrorCode.MediaNotFound,o=g.get("Error_Fetch_Media_Not_Found")),e._options.vid||""),a=(e._options.from,{mediaId:a,mediaAuth:e._options.mediaAuth||"",error_code:i,error_msg:n});t.sri&&(a.sri=t.sri),e.logError(a),a.display_msg=(o||g.get("Error_Vod_Fetch_Urls_Text"))+"</br>"+n,e.trigger("error",a),console.log("PrismPlayer Error: "+r+"! error_msg :"+n+";")},t.exports=b},{"../../config":14,"../../lang/index":23,"../../lib/constants":28,"../../lib/cookie":29,"../../lib/event":33,"../../lib/io":40,"../../lib/playerutil":46,"../../lib/ua":49,"../../protected/anti-injector-protected":129,"../audio/audioplayer":68,"../base/event/eventtype":70,"../base/player":91,"../drm/drminjector":97,"../flv/flvinjector":100,"../hls/hlsinjector":102,"./authkeyexpiredhandle":106,"./signature":113}],113:[function(e,u,t){var n=e("crypto-js/hmac-sha1"),o=e("crypto-js/enc-base64"),r=e("crypto-js/enc-utf8");u.exports.randomUUID=function(){for(var e=[],t="0123456789abcdef",r=0;r<36;r++)e[r]=t.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")},u.exports.returnUTCDate=function(){var e=new Date,t=e.getUTCFullYear(),r=e.getUTCMonth(),i=e.getUTCDate(),n=e.getUTCHours(),o=e.getUTCMinutes(),a=e.getUTCSeconds(),e=e.getUTCMilliseconds();return Date.UTC(t,r,i,n,o,a,e)},u.exports.AliyunEncodeURI=function(e){e=encodeURIComponent(e);return e=(e=(e=e.replace("+","%2B")).replace("*","%2A")).replace("%7E","~")},u.exports.makesort=function(e,t,r){if(!e)throw new Error("PrismPlayer Error: vid should not be null!");var i=[];for(s in e)i.push(s);for(var n=i.sort(),o="",a=n.length,s=0;s<a;s++)""==o?o=n[s]+t+e[n[s]]:o+=r+n[s]+t+e[n[s]];return o},u.exports.makeUTF8sort=function(e,t,r){if(!e)throw new Error("PrismPlayer Error: vid should not be null!");var i=[];for(s in e)i.push(s);for(var n=i.sort(),o="",a=n.length,s=0;s<a;s++){var l=u.exports.AliyunEncodeURI(n[s]),c=u.exports.AliyunEncodeURI(e[n[s]]);""==o?o=l+t+c:o+=r+l+t+c}return o},u.exports.makeChangeSiga=function(e,t,r){if(e)return o.stringify(n((r=r||"GET")+"&"+u.exports.AliyunEncodeURI("/")+"&"+u.exports.AliyunEncodeURI(u.exports.makeUTF8sort(e,"=","&")),t+"&"));throw new Error("PrismPlayer Error: vid should not be null!")},u.exports.ISODateString=function(e){function t(e){return e<10?"0"+e:e}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"Z"},u.exports.encPlayAuth=function(e){if(e=r.stringify(o.parse(e)))return JSON.parse(e);throw new Error("playuth\u53c2\u6570\u89e3\u6790\u4e3a\u7a7a")},u.exports.encRsa=function(){},u.exports.stringToArray=function(e){for(var t=new ArrayBuffer(2*e.length),r=new Uint16Array(t),i=0,n=e.length;i<n;i++)r[i]=e.charCodeAt(i);return r},u.exports.Uint8ArrayToString=function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},u.exports.arrayToString=function(e){e=new Uint16Array(e.buffer);return String.fromCharCode.apply(null,e)},u.exports.base64DecodeUint8Array=function(e){var t=window.atob(e),r=t.length,n=new Uint8Array(new ArrayBuffer(r));for(i=0;i<r;i++)n[i]=t.charCodeAt(i);return n},u.exports.base64EncodeUint8Array=function(e){for(var t,r,i,n,o,a,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",c=0;c<e.length;)i=(t=e[c++])>>2,n=(3&t)<<4|(t=c<e.length?e[c++]:Number.NaN)>>4,o=(15&t)<<2|(r=c<e.length?e[c++]:Number.NaN)>>6,a=63&r,isNaN(t)?o=a=64:isNaN(r)&&(a=64),l+=s.charAt(i)+s.charAt(n)+s.charAt(o)+s.charAt(a);return l}},{"crypto-js/enc-base64":3,"crypto-js/enc-utf8":4,"crypto-js/hmac-sha1":5}],114:[function(e,t,r){var o=e("../../lib/io"),a=e("../../lib/constants"),s=e("./signature"),l=e("./util"),c=e("../../lang/index");t.exports.getPlayAuth=function(e,t,r,i){s.randomUUID();var n=s.randomUUID(),n={AccessKeyId:e.accessKeyId,Action:"GetVideoPlayAuth",VideoId:e.vid,AuthTimeout:a.AuthInfoExpired,SecurityToken:e.securityToken,Format:"JSON",Version:"2017-03-21",SignatureMethod:"HMAC-SHA1",SignatureVersion:"1.0",SignatureNonce:n},n=s.makeUTF8sort(n,"=","&")+"&Signature="+s.AliyunEncodeURI(s.makeChangeSiga(n,e.accessKeySecret)),e="https://vod."+e.region+".aliyuncs.com/?"+n;o.get(e,function(e){e?(e=JSON.parse(e),t&&t(e.PlayAuth)):r&&r(l.createError("\u83b7\u53d6\u89c6\u9891\u64ad\u653e\u51ed\u8bc1\u5931\u8d25"))},function(e){if(r){var t={Code:"",Message:c.get("Fetch_Playauth_Error")};try{(t=JSON.parse(e)).Code}catch(e){}r({Code:a.ErrorCode.ServerAPIError,Message:t.Code+"|"+t.Message,sri:t.RequestId,display_msg:c.get("Fetch_Playauth_Error",i)})}})}},{"../../lang/index":23,"../../lib/constants":28,"../../lib/io":40,"./signature":113,"./util":115}],115:[function(e,c,t){var r=e("../../lib/constants");c.exports.createError=function(e,t){return{requestId:"",code:t||"",message:e}},c.exports.getItem=function(e){var t={};return t.width=e.Width,t.height=e.Height,t.definition=e.Definition,t.Url=e.PlayURL,t.format=e.Format,t.desc=r.QualityLevels[t.definition],t.encryptionType=r.VodEncryptionType[e.EncryptType],t.plaintext=e.Plaintext,t.rand=e.Rand,t.encrypt=e.Encrypt,t.duration=e.Duration,t.bitrate=e.Bitrate,t},c.exports.objectPlayerMessageSort=function(e,t){for(var r=[],i=[],n=[],o=[],a=e.length-1;0<=a;a--){var s=e[a],s=c.exports.getItem(s);("mp4"==s.format?i:"mp3"==s.format?n:"m3u8"==s.format?r:o).push(s)}var l=[],l=0<n.length?n:0<i.length?i:0<r.length?r:o;return"asc"==t&&l.reverse(),l}},{"../../lib/constants":28}],116:[function(e,t,r){var i=e("../../lib/io"),n=e("../../lib/constants"),o=e("./signature"),d=e("./util"),a=e("../../config"),h=e("../../lang/index"),f="saas/vod.js";t.exports.getDataByAuthInfo=function(s,l,c,u){o.randomUUID();var e=o.randomUUID(),e={AccessKeyId:s.accessId,Action:"GetPlayInfo",VideoId:s.vid,Formats:s.format,AuthTimeout:s.authTimeout||n.AuthKeyExpired,Rand:s.rand,SecurityToken:s.stsToken,StreamType:s.mediaType,Format:"JSON",Version:"2017-03-21",SignatureMethod:"HMAC-SHA1",SignatureVersion:"1.0",SignatureNonce:e,PlayerVersion:a.h5Version,Channel:"HTML5"},e=("AUTO"===s.definition?e.ResultType="Multiple":s.definition&&(e.Definition=s.definition),s.authInfo&&(e.AuthInfo=s.authInfo),s.outputType&&(e.OutputType=s.outputType),s.playConfig&&(e.PlayConfig=JSON.stringify(s.playConfig)),s.reAuthInfo&&(e.ReAuthInfo=JSON.stringify(s.reAuthInfo)),o.makeUTF8sort(e,"=","&")+"&Signature="+o.AliyunEncodeURI(o.makeChangeSiga(e,s.accessSecret))),e="https://vod."+s.domainRegion+".aliyuncs.com/?"+e,p=this;i.get.call(this,e,function(e){if(p.traceLog(f,"Vod request ok."),e){for(var e=JSON.parse(e),t="",r=e.VideoBase.ThumbnailList,i=(r&&r.Thumbnail&&0<r.Thumbnail.length?t=r.Thumbnail[0].URL:s.thumbnailUrl&&(t=String(s.thumbnailUrl)),e.PlayInfoList.PlayInfo),n=[],o=[],a=i.length-1;0<=a;--a)"AUTO"===i[a].Definition?n=[i.splice(a,1)[0]]:1===i[a].Encrypt&&o.push(i[a]);r=null,o=0===n.length?(r=d.objectPlayerMessageSort(i,l),[]):(r=d.objectPlayerMessageSort(n),d.objectPlayerMessageSort(o));r&&c&&c({requestId:e.RequestId,urls:r,encryptUrlArr:o,thumbnailUrl:t,coverUrl:e.VideoBase.CoverURL,playInfoAry:i})}else u&&u(d.createError("\u70b9\u64ad\u670d\u52a1\u83b7\u53d6\u6570\u636e\u5931\u8d25"))},function(e){if(p.traceLog(f,"Vod request error::"+e),u){var t={Code:"",Message:h.get("Error_Vod_Fetch_Urls_Text")};try{t=JSON.parse(e)}catch(e){}u({Code:n.ErrorCode.ServerAPIError,Message:t.Code+"|"+t.Message,sri:t.RequestId||""})}})}},{"../../config":14,"../../lang/index":23,"../../lib/constants":28,"../../lib/io":40,"./signature":113,"./util":115}],117:[function(e,t,r){var i=e("./saasplayer"),c=e("../../lib/constants"),n=e("./vod"),u=e("./signature"),o=(e("./authkeyexpiredhandle"),e("./ststoken"),e("../../lib/io")),a=e("../../config"),e=i.extend({init:function(e,t){i.call(this,e,t),this.service=n,this.loadByVod()}});e.prototype.loadByVod=function(e){var t,r,i;"undefined"!=typeof _pa_n4lto7xi?this._loadByVod(e):(t="aliplayer-vod-p-min.js",r="",r=a.domain?"https://"+a.domain+a.path+a.h5Version+"/hls/"+t:"/build/hls/"+t,i=this,o.loadJS(r,function(){i._loadByVod(e)}))},e.prototype._loadByVod=function(e){var t="",r="",i="",n="",o="";if(this._options.accessKeyId&&this._options.accessKeySecret)t=this._options.accessKeyId,r=this._options.accessKeySecret,i=this._options.securityToken,n=this._options.region,this.log("STARTFETCHDATA",{it:"sts",pa:{vid:this._options.vid}});else{try{var a=_pa_n4lto7xi(this._options.playauth),s=(this._options.playauth!==a&&(this._vdnct6f=!0),u.encPlayAuth(a)),t=s.AccessKeyId,r=s.AccessKeySecret,i=s.SecurityToken,n=s.Region,o=s.AuthInfo}catch(e){console.log("e",e);var l={Code:c.ErrorCode.PlayauthDecode,Message:"playauth decoded failed.",displayMessage:"playauth\u89e3\u6790\u9519\u8bef"};return void this._mtsError_message(this,l,a)}this._options.from=s.CustomerId||"",this.log("STARTFETCHDATA",{it:"playAuth",pa:{vid:this._options.vid}})}this._loadByVodBySTS(t,r,i,n,o,e)},e.prototype.replayByVidAndPlayAuth=function(e,t){this.trigger("error_hide"),this._options.source="",this._options.vid=e,this._options.playauth=t,this._isError=!1,this._duration=0,this._options.cover="",this._vodRetryCount=0,this._clearTimeout(),this.loadByVod(!0)},e.prototype.updateSourcesByVidAndPlayAuth=function(e,t){var r,i,n;"undefined"!=typeof _pa_n4lto7xi?this._updateSourcesByVidAndPlayAuth(e,t):(r="aliplayer-vod-p-min.js",i="",i=a.domain?"https://"+a.domain+a.path+a.h5Version+"/hls/"+r:"/build/hls/"+r,n=this,o.loadJS(i,function(){n._updateSourcesByVidAndPlayAuth(e,t)}))},e.prototype._updateSourcesByVidAndPlayAuth=function(e,t){if(e!=this._options.vid)console.log("\u4e0d\u80fd\u66f4\u65b0\u5730\u5740\uff0cvid\u548c\u64ad\u653e\u4e2d\u7684\u4e0d\u4e00\u81f4");else{this._options.vid=e,this._options.playauth=t;try{var r=_pa_n4lto7xi(this._options.playauth),i=(this._options.playauth!==r&&(this._vdnct6f=!0),u.encPlayAuth(r))}catch(e){return void console.log("playauth\u89e3\u6790\u9519\u8bef")}var t={vid:e,accessId:i.AccessKeyId,accessSecret:i.AccessKeySecret,stsToken:i.SecurityToken,domainRegion:i.Region,authInfo:i.AuthInfo,playDomain:i.PlayDomain,format:this._options.format,mediaType:this._options.mediaType},n=(this._authKeyExpiredHandle.clearTick(),this);this.service.loadData(t,this._options.qualitySort,function(e){n._serverRequestId=e.requestId,0!=e.urls.length&&(n._urls=e.urls),n._authKeyExpiredHandle.tick(c.AuthKeyRefreshExpired)},function(e){console.log(e)})}},e.prototype.reloaduserPlayInfoAndVidRequestMts=function(e,t){this.replayByVidAndPlayAuth(e,t,accessSecret)},e.prototype._loadByVodBySTS=function(e,t,r,i,n,o){e={vid:this._options.vid,accessId:e,accessSecret:t,stsToken:r,authInfo:n,domainRegion:i,format:this._options.format,mediaType:this._options.mediaType,definition:this._options.definition,defaultDefinition:this._options.defaultDefinition,authTimeout:this._options.authTimeout,outputType:this._options.outputType,playConfig:this._options.playConfig,reAuthInfo:this._options.reAuthInfo};this.loadData(e,o)},t.exports=e},{"../../config":14,"../../lib/constants":28,"../../lib/io":40,"./authkeyexpiredhandle":106,"./saasplayer":112,"./signature":113,"./ststoken":114,"./vod":116}],118:[function(e,t,r){function i(t){this._player=t,this._video=t.tag;var r=this;this._isCreated=!1,this._canPlayTriggered=!1,this._defaultTrack="",t.on(n.Private.ChangeURL,function(){r._isCreated=!1,r._canPlayTriggered=!1,r._defaultTrack=""}),t.on(n.Player.CanPlay,function(){var e;r._player._drm||r._canPlayTriggered||((e=r._getTracks())&&(r._isCreated=!0,r._player._options.isVBR||r._hls||(t.trigger(n.Player.AudioTrackReady,e),r._notifyDefaultValue(e))),r._canPlayTriggered=!0)}),t.on(n.Player.AudioTrackUpdated,function(e){r._isCreated||(e=r._getTracks(e.paramData.audioTracks))&&(r._isCreated=!0,t.trigger(n.Player.AudioTrackReady,e),r._notifyDefaultValue(e))})}var n=e("../base/event/eventtype");i.prototype._notifyDefaultValue=function(e){!this._defaultTrack&&0<e.length&&(this._defaultTrack=e[0]),this._defaultTrack&&this._player.trigger(n.Private.SelectorUpdateList,{type:"audio",text:this._defaultTrack.text})},i.prototype.support=function(){return!!this._video.audioTracks},i.prototype._getTracks=function(e){if(!this.support()&&!e)return null;for(var t=[],r=(e=!this._video||!this._video.audioTracks||e&&0!=e.length?e:this._video.audioTracks)?e.length:0,i=0;i<r;i++){var n=e[i],o={value:n.id,text:n.label||n.name||n.language};(n.default||n.enabled)&&(this._defaultTrack=o),t.push(o)}return t},i.prototype.switch=function(e){if(this._player._hls)this._player._hls.audioTrack=+e;else for(var t=this._video.audioTracks?this._video.audioTracks.length:0,r=0;r<t;r++){var i=this._video.audioTracks[r];i.id==e?i.enabled=!0:i.enabled=!1}},i.prototype.dispose=function(){this._player=null},t.exports=i},{"../base/event/eventtype":70}],119:[function(e,t,r){function i(e){this._video=e.tag,this._player=e,this._isCreated=!1,this._backupCC="",this.tracks=[],this._defaultTrack="",this._currentValue="",this._switchTimer=null,this._storedTracks=[];var o=this,t=(e.on(a.Player.LevelsLoaded,function(e){if(s.IS_MAC_SAFARI||s.IS_IOS)if(e&&e.paramData&&e.paramData.subtitles&&e.paramData.subtitles.length){for(var t=e.paramData.subtitles||[],r=[],i=0;i<t.length;i++){var n=t[i];n.vttUrl=n.url&&n.url.replace(".m3u8",".vtt"),r.push(n)}o._storedTracks=r}else o._resotreTracks()}),e.on(a.Private.SafariDrmLevelSwitch,function(){o._resotreTracks()}),e.on(a.Private.ChangeURL,function(e){e&&e.paramData&&"saas"===e.paramData.from||(o._disabledTracks(),o._isCreated=!1,o._defaultTrack="",o._backupCC="")}),e.on(a.Private.VttClearTracks,function(){o.switch("off"),o._disabledTracks(),o._isCreated=!1,o._defaultTrack={value:"off",text:"Off"},o.tracks=[o._defaultTrack],e.trigger(a.Private.SelectorGenerateList,{type:"cc"}),e.trigger(a.Private.CCStateChanged,{value:"off",lang:""})}),e.on(a.Player.CanPlay,function(){o._isCreated||(o.tracks=o._getTracks(),e.trigger(a.Player.TextTrackReady,o.tracks),e.trigger(a.Private.CCReset)),o._isCreated&&!o._player._setDefaultCC||!o._defaultTrack||(e.trigger(a.Private.SelectorUpdateList,{type:"cc",text:o._defaultTrack.text}),o.switch(o._defaultTrack.value),o._player._setDefaultCC=!1,o._isCreated=!0)}),s.os.ios&&parseFloat(s.os.version)<=15.1&&n.addCssByStyle("video::-webkit-media-text-track-container{position: relative; top: -44px !important;}"),"always"===e.getOptions().controlBarVisibility&&n.addCssByStyle("video::-webkit-media-text-track-container{transform: translateY(-44px);}"),l.throttle(function(){e._vttBroker&&e._vttBroker.enabled||n.addCssByStyle("video::-webkit-media-text-track-container{transform: translateY(-44px);}")},100)),t=(e.on(a.Private.ShowBar,t),l.throttle(function(){e._vttBroker&&e._vttBroker.enabled||n.addCssByStyle("video::-webkit-media-text-track-container{transform: none;}")},100));e.on(a.Private.HideBar,t),e.on(a.Private.CCReset,function(){o._updateSelectorList()})}var a=e("../base/event/eventtype"),n=(e("../../lib/event"),e("../../lib/dom")),s=e("../../lib/ua"),c=e("../../lib/cookie"),u=e("../../lib/constants"),l=e("../../ui/component/util");i.prototype._adaptiveCueStype=function(){var e,t=-10;s.IS_SAFARI?(t=-65,(e=this._player.fullscreenService)&&e.getIsFullScreen()&&(t=-95)):s.IS_MOBILE&&(t=-30),n.addCssByStyle("video::-webkit-media-text-track-container{transform: translateY("+t+"px) !important;}")},i.prototype.close=function(){for(var e=this.getTextTracks(),t=e.length,r=0;r<t;r++){var i=e[r];"expired"!=i.mode&&("showing"==i.mode&&(this._backupCC=i),i.mode="disabled")}this._player.trigger(a.Private.VttHide)},i.prototype.open=function(){var t,r,e;return!this.tracks||this.tracks.length<2||(r=this._backupCC?this._backupCC.language:"",e=this._backupCC?this._backupCC.label:"",this.tracks.forEach(function(e){r===e.value&&(t=!0)}),(r=t?r:e="")||(r=this.tracks[1].value,e=this.tracks[1].text),this.switch(r)),{label:e,language:r}},i.prototype.getCurrentSubtitle=function(){return this._currentValue},i.prototype._getTracks=function(){for(var e=this.getTextTracks(),t=e.length,r=(this._defaultTrack={value:"off",text:"Off"},[this._defaultTrack]),i=c.get(u.SelectedCC),n="",o=!1,a=0;a<t;a++){var s,l=e[a];"expired"==l.mode||"subtitles"!=l.kind&&"captions"!=l.kind||(s={value:l.language,text:l.label},l.default&&(this._defaultTrack=s,o=!0),s.value==i&&(n=s),r.push(s))}return!o&&n&&(this._defaultTrack=n),r},i.prototype._disabledTracks=function(){for(var e=this.getTextTracks(),t=e.length,r=0;r<t;r++)e[r].mode="expired"},i.prototype.switch=function(e){var t=this._player;if(this.close(),"off"!=e)for(var r=this.getTextTracks(),i=r.length,n=0;n<i;n++){var o=r[n];o.language===e&&"expired"!=o.mode&&(r[n].mode="showing",t.trigger(a.Private.VttSwitchTrack,o.language))}else this.close();this._currentValue=e,t.trigger(a.Private.CCChanged,e)},i.prototype.updateUI=function(t){var e="on",r="";r=t?(this.tracks.find(function(e){return e.value===t})||{}).text||"":(e="off","Off"),player.trigger(a.Private.CCChanged,e),player.trigger(a.Private.CCStateChanged,{value:e,lang:r})},i.prototype.dispose=function(){this._player=null,this._switchTimer&&(clearTimeout(this._switchTimer),this._switchTimer=null)},i.prototype._patchSafariTracks=function(){var t=this;if(s.IS_MAC_SAFARI||s.IS_IOS){if(!(this._video&&this._video.textTracks?this._video.textTracks.length:0)){var e=!1;if(e=this._video.textTracks&&this._video.textTracks.length?!0:e)return;for(var r=0;r<this._storedTracks.length;r++){var i=this._storedTracks[r],n=i.vttUrl,o=document.createElement("track");o.src=n,o.kind="subtitles",o.label=i.name,o.srclang=i.lang,this._video.appendChild(o)}}this._switchTimer&&clearTimeout(this._switchTimer),this._switchTimer=setTimeout(function(){var e=t.getCurrentSubtitle();e&&"off"!==e&&t.switch(e)},1e3)}},i.prototype.getTextTracks=function(){var e=this._player,t=e.tag;return e._vttBroker&&e._vttBroker.enabled&&e.getTextTracks?e.getTextTracks()||[]:t&&t.textTracks||[]},i.prototype._updateSelectorList=function(){var e=this._player;this.tracks=this._getTracks(),e.trigger(a.Private.SelectorGenerateList,{type:"cc",value:"Off"})},i.prototype._resotreTracks=function(){this._patchSafariTracks(),this.tracks=this._getTracks(),this._player.trigger(a.Player.TextTrackReady,this.tracks)},t.exports=i},{"../../lib/constants":28,"../../lib/cookie":29,"../../lib/dom":32,"../../lib/event":33,"../../lib/ua":49,"../../ui/component/util":159,"../base/event/eventtype":70}],120:[function(e,t,r){var i=e("../../lib/playerutil");t.exports=[{service:e("./ccservice"),name:"_ccService",condition:!0},{service:e("./audiotrackservice"),name:"_audioTrackService"},{service:e("./qualityservice"),name:"_qualityService"},{service:e("./fullscreenservice"),name:"fullscreenService",condition:function(){return!0}},{service:e("./liveshiftservice"),name:"_liveshiftService",condition:function(){var e=this.options();return i.isLiveShift(e)}},{service:e("./thumbnailservice"),name:"_thumbnailService",condition:function(){return!0}},{service:e("./progressmarkerservice"),name:"_progressMarkerService",condition:function(){return!0}}]},{"../../lib/playerutil":46,"./audiotrackservice":118,"./ccservice":119,"./fullscreenservice":121,"./liveshiftservice":122,"./progressmarkerservice":123,"./qualityservice":124,"./thumbnailservice":125}],121:[function(e,t,r){function i(e){this.isFullWindow=!1,this.isFullScreen=!1,this.isFullScreenChanged=!1,this._requestFullScreenTimer=null,this._cancelFullScreenTimer=null,this._player=e;var r=this,i=l;this._fullscreenChanged=function(e){var t;null!=r._player&&(e.target||e.srcElement)===(e=r._player.el())&&(t=document[i.fullscreenElement],r.isFullScreen=t===e,(r.isFullScreenChanged=!0)===r.isFullScreen?r._player.trigger(s.Player.RequestFullScreen):r._player.trigger(s.Player.CancelFullScreen))},i&&o.on(document,i.eventName,this._fullscreenChanged)}var a=e("../../lib/ua"),n=e("../../lib/dom"),o=e("../../lib/event"),s=e("../base/event/eventtype"),l=(e("../base/x5play"),e("../../lang/index"),function(){n.createEl("div");var e={},t=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullScreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","webkitfullScreen"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","webkitIsFullScreen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","mozFullScreen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","MSFullScreen"]],r=!1;if(!(r=a.IS_IOS&&(e.requestFn="webkitEnterFullscreen",e.cancelFn="webkitExitFullscreen",e.fullscreenElement="webkitFullscreenElement",e.eventName="webkitfullscreenchange",e.isFullScreen="webkitDisplayingFullscreen",document[e.requestFn])?!0:r)){for(var i=0;i<5;i++)if(t[i][1]in document){e.requestFn=t[i][0],e.cancelFn=t[i][1],e.fullscreenElement=t[i][2],e.eventName=t[i][4],e.isFullScreen=t[i][6];break}"requestFullscreen"in document?e.requestFn="requestFullscreen":"webkitRequestFullscreen"in document?e.requestFn="webkitRequestFullscreen":"webkitRequestFullScreen"in document?e.requestFn="webkitRequestFullScreen":"webkitEnterFullscreen"in document?e.requestFn="webkitEnterFullscreen":"mozRequestFullScreen"in document?e.requestFn="mozRequestFullScreen":"msRequestFullscreen"in document&&(e.requestFn="msRequestFullscreen"),"fullscreenchange"in document?e.eventName="fullscreenchange":"webkitfullscreenchange"in document||"webkitfullscreenchange"in document||"webkitfullscreenchange"in document?e.eventName="webkitfullscreenchange":"mozfullscreenchange"in document?e.eventName="mozfullscreenchange":"MSFullscreenChange"in document&&(e.eventName="MSFullscreenChange"),"fullScreen"in document?e.isFullScreen="fullScreen":"webkitfullScreen"in document?e.isFullScreen="webkitfullScreen":"webkitIsFullScreen"in document?e.isFullScreen="webkitIsFullScreen":"webkitDisplayingFullscreen"in document?e.isFullScreen="webkitDisplayingFullscreen":"mozFullScreen"in document?e.isFullScreen="mozFullScreen":"mozfullScreen"in document?e.isFullScreen="mozfullScreen":"MSFullScreen"in document&&(e.isFullScreen="MSFullScreen"),"fullscreenElement"in document?e.fullscreenElement="fullscreenElement":"webkitFullscreenElement"in document?e.fullscreenElement="webkitFullscreenElement":"webkitFullScreenElement"in document?e.fullscreenElement="webkitFullScreenElement":"mozFullScreenElement"in document?e.fullscreenElement="mozFullScreenElement":"msFullscreenElement"in document?e.fullscreenElement="msFullscreenElement":"MSFullscreenElement"in document&&(e.fullscreenElement="MSFullscreenElement")}return e.requestFn?e:null}()),c=(i.prototype.requestFullScreen=function(){var e=l,t=this._player.el(),r=this;if(a.IS_IOS){var i=this._player._splayer;if(!i||2!==i.renderType){t=this._player.tag,i&&2!==i.renderType&&(t=this._player.el().querySelector("video"));try{var n=t[e.requestFn]();n&&"function"==typeof n.catch&&n.catch(function(e){console.log(e)}),r._player.trigger(s.Player.RequestFullScreen)}catch(e){console.log(e)}return this}this._player._options.enableMockFullscreen=!0}this.isFullScreen=!0,this.isFullScreenChanged=!1,this._requestFullScreenTimer=null,this._cancelFullScreenTimer||clearTimeout(this._cancelFullScreenTimer);r=this;if(e&&!this._player._options.enableMockFullscreen)try{var o=t[e.requestFn]();o&&"function"==typeof o.catch&&o.catch(function(e){console.log(e)}),this._requestFullScreenTimer=setTimeout(function(){r.isFullScreenChanged||(c.apply(r),r._player.trigger(s.Player.RequestFullScreen)),r._requestFullScreenTimer=null},1e3)}catch(e){console.log(e)}else c.apply(r),this._player.trigger(s.Player.RequestFullScreen);return this._player},i.prototype.cancelFullScreen=function(){var e=l,t=(this.isFullScreen=!1,this.isFullScreenChanged=!1,this._cancelFullScreenTimer=null,this._requestFullScreenTimer||clearTimeout(this._requestFullScreenTimer),this);if(e&&!this._player._options.enableMockFullscreen){try{var r=document[e.cancelFn]();r&&"function"==typeof r.catch&&r.catch(function(e){console.log(e)})}catch(e){console.log(e)}t._cancelFullScreenTimer=setTimeout(function(){t.isFullScreenChanged||(u.apply(t),t._player.trigger(s.Player.CancelFullScreen)),t._cancelFullScreenTimer=null},500)}else u.apply(t),this._player.trigger(s.Player.CancelFullScreen);return this._player.tag.paused||this._player.trigger(s.Player.Play),this._player},i.prototype.getIsFullScreen=function(){return this.isFullScreen},i.prototype.dispose=function(){this._player=null,l&&o.off(document,l.eventName,this._fullscreenChanged)},function(){this.isFullWindow=!0,this.docOrigOverflow=document.documentElement.style.overflow,document.documentElement.style.overflow="hidden",n.addClass(document.getElementsByTagName("body")[0],"prism-full-window")}),u=function(){this.isFullWindow=!1,document.documentElement.style.overflow=this.docOrigOverflow,n.removeClass(document.getElementsByTagName("body")[0],"prism-full-window")};t.exports=i},{"../../lang/index":23,"../../lib/dom":32,"../../lib/event":33,"../../lib/ua":49,"../base/event/eventtype":70,"../base/x5play":96}],122:[function(e,t,r){function n(e,t){var r;if(e)return e=new Date(e),r=(t=new Date(t)).valueOf()/1e3-e.valueOf()/1e3,{start:e,end:t,endDisplay:s.extractTime(t),totalTime:r}}function o(e,t){t&&(e.currentTimestamp=t,e.currentTime=s.convertToDate(t),e.currentTimeDisplay=s.extractTime(e.currentTime),e.liveShiftStart=e.liveTimeRange.start,e.liveShiftEnd=e.liveTimeRange.end,e.liveShiftStartDisplay=s.extractTime(e.liveShiftStart),e.liveShiftEndDisplay=s.extractTime(e.liveShiftEnd),e.availableLiveShiftTime=t-e.liveShiftStart.valueOf()/1e3,e.timestampStart=s.convertToTimestamp(e.liveShiftStart),e.timestampEnd,s.convertToTimestamp(e.liveShiftEnd))}function i(t){function e(){var e=t._options.source;this._originalPlayUrl=e,this._liveShiftUrl=t._options.liveTimeShiftUrl,this.liveTimeRange=n(t._options.liveStartTime,t._options.liveOverTime),this.availableLiveShiftTime=0,this.seekTime=-1}this._player=t,this._isLiveShiftPlaying=!1;var i=this;e.call(this),t.liveShiftSerivce={setLiveTimeRange:function(e,t){i.setLiveTimeRange(e,t)},queryLiveShift:function(e,t,r){i.queryLiveShift(e,t,r)},isLiveShiftPlaying:function(){return i._isLiveShiftPlaying}},t.on(h.Private.ChangeURL,function(){e.call(i)})}var a=e("../../lib/io"),s=e("../../lib/util"),l=e("../../lib/playerUtil"),c=e("../../lang/index"),u=e("../flv/flvinjector"),p=e("../hls/hlsinjector"),d=e("../../lib/constants"),h=e("../base/event/eventtype");e("../../lib/url");i.prototype.validate=function(){return!(this.liveTimeRange.start>=this.liveTimeRange.end)},i.prototype.switchToLive=function(){this.seekTime=-1;var e=this._originalPlayUrl,t=this._player._options.liveShiftSource,r=this._player._options.source;l.isHls(r)&&l.isFlv(e)&&t&&l.isHls(t)&&(this._player._hls&&this._player._destroyHls(),r=this._player._superType,t=this._player._Type,this._player._options._autoplay=!0,u.inject(this._player,t,r,this._player._options,"",!0)),this._player._loadByUrlInner(e,null,!0),this._isLiveShiftPlaying=!1,this._player.trigger(h.Private.LiveShiftSwitchToLive)},i.prototype.getBaseTime=function(){this.liveShiftStartDisplay;return-1==this.seekTime?s.parseTime(this.currentTimeDisplay):s.parseTime(this.liveShiftStartDisplay)+this.seekTime},i.prototype.getSourceUrl=function(e,t){var r=this._originalPlayUrl;return this.availableLiveShiftTime<e||(this._isLiveShiftPlaying=!0,e=parseInt(e),r=(r=this._switchLiveShiftPlayer(t))&&this._cleanUrl(r),t=parseInt(this.currentTimestamp)-e,-1===(r=-1==r.indexOf("?")?r+"?lhs_start_unix_s_0="+t:r+"&lhs_start_unix_s_0="+t).indexOf("aliyunols=on")&&(r+="&aliyunols=on"),-1===r.indexOf("continue=on")&&(r+="&continue=on")),r},i.prototype._cleanUrl=function(e){var t;return-1===e.indexOf("?")?e:(e=(e=(t=e.split("?"))[1])&&(0===(e=e.replace(/&?lhs_start_unix_s_0=[0-9]*/g,"")).indexOf("&")?e.replace("&",""):e))?t[0]+"?"+e:t[0]},i.prototype._switchLiveShiftPlayer=function(e){var t,r=this._originalPlayUrl,i=this._player._options.liveShiftSource,n=this._player._options.source;if(l.isHls(n))r=n;else if(l.isFlv(r)&&i&&l.isHls(i))return this._player._flv&&this._player._destroyFlv(),n=this._player._superType,t=this._player._Type,this._player._options._autoplay=!0,p.inject(this._player,t,n,this._player._options,"",!0),i;return r},i.prototype.getTimeline=function(t,i){var r;this._player.trigger(h.Private.LiveShiftQueryCompleted),this._liveShiftUrl?(r=this).queryLiveShift(this._liveShiftUrl,function(e){e?0==(e=e).retCode?(o(r,e.content.current),t&&t()):i({Code:d.ErrorCode.ServerAPIError,Message:e.retCode+"|"+e.description+"|"+e.content}):console.log("\u83b7\u53d6\u76f4\u64ad\u65f6\u79fb\u6570\u636e\u5931\u8d25")},function(e){if(i&&e){var t={};if(e){if("string"==typeof e&&-1<e.indexOf("403 Forbidden"))t.Code=d.ErrorCode.AuthKeyExpired,t.Message="Query liveshift failed:"+c.get("Error_AuthKey_Text");else{var r,t=e;try{r=JSON.parse(e)}catch(e){}r&&(t.Code=d.ErrorCode.ServerAPIError,t.Message=r.retCode+"|"+r.description+"|"+r.content)}i(t)}}}):(o(this,(new Date).valueOf()/1e3),t&&t())},i.prototype.start=function(e,t){function r(){i._loopHandler&&clearTimeout(i._loopHandler),i._loopHandler=setTimeout(function(){i.getTimeline(function(){},t),r()},e)}var i=this;i.getTimeline(function(e){i._localLiveTimeHandler||i.tickLocalLiveTime()},t),r()},i.prototype.tickLocalLiveTime=function(){var t=this;(function e(){t._localLiveTimeHandler=setTimeout(function(){t.currentTimestamp++,o(t,t.currentTimestamp),t._player.trigger(h.Private.LiveShiftQueryCompleted),e()},1e3)})()},i.prototype.setLiveTimeRange=function(e,t){e=e||this._player._options.liveStartTime,t=t||this._player._options.liveOverTime,this.liveTimeRange=n(e,t),o(this,this.currentTimestamp),this._player.trigger(h.Private.LiveShiftQueryCompleted)},i.prototype.queryLiveShift=function(e,r,i){a.get(e,function(e){var t;e?0==(t=JSON.parse(e)).retCode?r&&r(t):i&&i(t):i&&i(e)},function(e){i&&i(e)})},i.prototype.stop=function(e){this._loopHandler&&(clearTimeout(this._loopHandler),this._loopHandler=null)},i.prototype.dispose=function(){this.stop(),this._localLiveTimeHandler&&(clearTimeout(this._localLiveTimeHandler),this._localLiveTimeHandler=null),this._loopHandler&&(clearTimeout(this._loopHandler),this._loopHandler=null),this._player=null},t.exports=i},{"../../lang/index":23,"../../lib/constants":28,"../../lib/io":40,"../../lib/playerUtil":45,"../../lib/url":50,"../../lib/util":51,"../base/event/eventtype":70,"../flv/flvinjector":100,"../hls/hlsinjector":102}],123:[function(e,t,r){function i(a){function t(){var e=document.querySelector("#"+a.id()+" .prism-progress-marker");if(e){e.innerHTML="";var o=s._player.getDuration();if(0<o){for(var t=0;t<s.progressMarkers.length;t++){var r,i=s.progressMarkers[t];void 0!==i.offset&&""!==i.offset&&(i=document.createElement("div"),c.addClass(i,"prism-marker-dot"),r=s.progressMarkers[t].offset/o,i.style.left=100*r+"%",e.appendChild(i),r=function(e,t){return function(){s._player.trigger(l.Private.MarkerTextShow,{left:e,progressMarker:t})}}(r,s.progressMarkers[t]),u.on(i,"mouseover",r),u.on(i,"mouseout",function(e){s._player.trigger(l.Private.MarkerTextHide)}),u.on(i,"touchstart",r),u.on(i,"mousemove",function(e){e.preventDefault()}),u.on(i,"touchmove",function(e){e.preventDefault()}))}var n=document.querySelector("#"+s._player.id()+" .prism-progress-cursor");s._player.on(n,"click",function(e){for(var t=s._player.getCurrentTime(),r=0;r<s.progressMarkers.length;r++){var i,n=s.progressMarkers[r];n&&t-1<n.offset&&n.offset<t+1&&(i=n.offset/o*100+"%",s._player.trigger(l.Private.MarkerTextShow,{left:i,progressMarker:n}))}})}}}this.progressMarkers=[],this._player=a;var s=this;a.on(l.Private.ProgressMarkerLoaded,function(e){e=e.paramData;e&&0<e.length&&(s.progressMarkers=e)}),a.on(l.Private.ProgressMarkerChanged,function(e){e=e.paramData;e&&0<e.length&&(s.progressMarkers=e,t())}),a.on(l.Video.LoadedMetadata,t)}var l=e("../base/event/eventtype"),c=(e("../../lang/index"),e("../../lib/hls/hlsparse"),e("../../lib/object"),e("../../lib/dom")),u=e("../../lib/event");e("../../lib/playerutil");i.prototype.dispose=function(){this._player=null,this.progressMarkers=[]},t.exports=i},{"../../lang/index":23,"../../lib/dom":32,"../../lib/event":33,"../../lib/hls/hlsparse":39,"../../lib/object":42,"../../lib/playerutil":46,"../base/event/eventtype":70}],124:[function(e,t,r){function i(o){this.levels=[],this.drmUrl={},this._player=o;var a=this;o.on(s.Private.PlayInfoLoaded,function(e){for(var t=e.paramData.encryptUrlArr||[],r=[],i=0;i<t.length;i++){var n=t[i];n.encryptionType===p.VodEncryptionType["Widevine-FairPlay"]&&r.push(n)}a.drmUrl=r}),o.on(s.Player.LevelsLoaded,function(e){if(0<a.levels.length&&(a.levels=[]),(e=e.paramData)&&e.levels){for(var t,r=e.levels.length-1;-1<r;r--){var i,n=e.levels[r];n.url&&0<n.url.length&&n.attrs&&n.attrs.BANDWIDTH&&(i=n.url,c.isArray(i)&&(i=i[0]),i={Url:i=!o._hls&&o._options.isVBR&&o._options.isDrm?d.call(a,n):i,desc:n.height||n.width,bitrate:n.bitrate,resolution:n.attrs.RESOLUTION,bandwidth:n.attrs.BANDWIDTH},a.levels.push(i))}"AUTO"===o._options.definition&&(o._urls=[],Object.assign(o._urls,this.levels)),a.levels.sort(function(e,t){return e.desc-t.desc}),0<a.levels.length&&(t="",this._player._options.isVBR&&(t=l.get("Auto")),a.levels.push({Url:e.url,desc:t}),o.trigger(s.Private.SelectorUpdateList,{type:"quality",text:t}))}}),o.on(s.Video.LoadStart,function(){var e,t;o._options&&(e=o._options.source,t=o._options.isVBR,!o._hls)&&e&&u.isHls(e)&&(o._manuallySwitchDrmLevel?(o._manuallySwitchDrmLevel=!1,o.trigger(s.Private.SafariDrmLevelSwitch)):t&&a.loadLevels(e))})}var s=e("../base/event/eventtype"),l=e("../../lang/index"),n=e("../../lib/hls/hlsparse"),c=e("../../lib/object"),u=e("../../lib/playerutil"),p=e("../../lib/constants");function d(e){for(var t,r=this.drmUrl,i=0;i<this.drmUrl.length;i++)if(Number(e.height)===Number(r[i].height)){t=r[i].Url;break}return t}(i.prototype={loadLevels:function(e){var t=new n,r=this;t.load(e,function(e){r._player.trigger(s.Player.LevelsLoaded,e)})}}).dispose=function(){this._player=null},t.exports=i},{"../../lang/index":23,"../../lib/constants":28,"../../lib/hls/hlsparse":39,"../../lib/object":42,"../../lib/playerutil":46,"../base/event/eventtype":70}],125:[function(e,t,r){function i(e){this._player=e,this.cues=[],this.baseUrl="";var t=this;e.on(s.Private.ChangeURL,function(){t.cues=[],t.baseUrl=""})}var n=e("../../lib/io"),o=e("../../lib/url"),a=e("../../lib/vtt/thumbnailvtt"),s=e("../base/event/eventtype");(i.prototype={get:function(e){var t,r,i=this;this.baseUrl=(t=e,(r=o.parseUrl(t))&&(r=r.segments)&&0<r.length&&(r=r[r.length-1],baseUrl=t.replace(r,"")),baseUrl),n.get(e,function(e){e&&a.parse(e,function(e){i.cues=e,i._player.trigger(s.Private.ThumbnailLoaded,e)})},function(e){console.log(e)})},findAvailableCue:function(e){for(var t=this.cues.length,r=0;r<t;r++){var i=this.cues[r];if(i.startTime<=e&&e<i.endTime)return i}return null},makeUrl:function(e){return e=-1==e.indexOf("://")?this.baseUrl+e:e}}).dispose=function(){this._player=null},t.exports=i},{"../../lib/io":40,"../../lib/url":50,"../../lib/vtt/thumbnailvtt":53,"../base/event/eventtype":70}],126:[function(e,t,r){function p(){return(p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}var d=e("../base/player"),h=e("./splayerinjector"),f=e("../flv/flvinjector"),y=e("../hls/hlsinjector"),_=e("../../lib/playerutil"),g=e("../base/event/eventtype"),i=e("../../lib/constants"),v=e("../../lib/codec-probe"),m=e("../../lib/ua"),S=i.USER_EVENT_NAME,b=_.isH265Codec,T=_.isH266Codec,E=_.getVideoTrack,w={},x={codecCost:0,decoderCost:0},P=d.extend({init:function(e,i){var n,o=this,a=(this._options=i,_.isFlv(i.source)),s=_.isHls(i.source),t=this._extraMultiSources(),l={};function c(){a?(f.inject(this,P,d,i),i._native=!1):s&&!_.canPlayHls()&&(y.inject(this,P,d,i),i._native=!1),d.call(this,e,i),this._monitor&&this._monitor.updateH265ProbeInfo(p({},x,w)),r.call(this),w.codecTag&&h.reportH265PlayInfo.call(this,{renderType:"native",codecTag:w.codecTag})}function u(){i._native=!1,h.inject(this,P,d,i,w),d.call(this,e,i),this._monitor&&this._monitor.updateH265ProbeInfo(p({},x,w,{waitRenderType:!0})),r.call(this)}function r(){var e,t,r=this,i=l,n=this[S];n&&(i=Object.assign({},l,n),e=Object.keys(l),t=Object.keys(n),e.forEach(function(e){-1<t.indexOf(e)&&(i[e]=l[e].concat(n[e]))})),Object.keys(i).forEach(function(t){i[t].forEach(function(e){e.binded||d.prototype.on.call(r,t,e)})})}l[g.Player.Ready]=[function(){o._setupSourceList(t),o.trigger(g.Private.SelectorGenerateList,{type:"quality"})}],"zhihu"===i.from||i.forceH265||i.forceH266?u.call(this):m.IS_ANDROID&&m.dingTalk()&&!a?c.call(this):(n=performance.now(),v(i.source,function(e){x.codecCost+=performance.now()-n;var t,e=E(e.tracks),r=(e||{}).codecTag||(null==(r=(e||{}).codec)?void 0:r.split(".")[0]);w.codecTag=r,e&&b(r)?(t=performance.now(),a||s&&!_.canPlayHls()?(x.decoderCost+=performance.now()-t,u.call(o)):_.shouldUseBasePlayer({codecTag:r,url:i.source},function(e){x.decoderCost+=performance.now()-t,(e?c:u).call(o)})):(e&&T(r)?u:c).call(o)},function(e){console.log("error in demuxer, fallback to basePlayer",e),x.codecCost+=performance.now()-n,c.call(o)}))}});t.exports=P},{"../../lib/codec-probe":26,"../../lib/constants":28,"../../lib/playerutil":46,"../../lib/ua":49,"../base/event/eventtype":70,"../base/player":91,"../flv/flvinjector":100,"../hls/hlsinjector":102,"./splayerinjector":127}],127:[function(e,t,r){function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}var o=e("../../lib/io"),s=e("../base/event/eventtype"),l=e("../base/event/eventmanager"),c=(e("../../lib/event"),e("../../lib/util")),u=e("../../lib/dom"),p=e("../../lib/playerutil"),d=e("../../lib/constants"),h=e("../../lang/index"),f="splayerinjector.js";function y(e){var t=this._options,r=(g.call(this),!function(){p.isVideoTag(this.tag)&&(l.offVideoAll(this),this.tag.parentNode&&this.tag.parentNode.removeChild(this.tag),this.tag=null)}.call(this),Videox.Videox),i=new r(a({container:this._el,wasmDomain:t.splayerWasmDomain,progressive:!0,skipFrame:r.DiscardType.NONE,loop:t.rePlay,controls:!1,muted:!1,threads:t.h265Threads,simd:t.h265Simd,autoplay:t.autoplay||t._autoplay,live:t.isLive,poster:t.cover||void 0,src:t.source,trackOptions:{disable:!0},preload:t.preload?"auto":"none",timeout:1e3*t.waitingTimeout},t.splayerOptions||{})),n=(t.debug&&(i.setLogLevel(r.LogLevel.LOG),i.setLogPrintLevel(r.LogLevel.LOG)),this._splayer=i,(this.tag=i).play),o=this;this.tag.play=function(){o._monitor&&o._monitor.reportStartPlay(),n.call(this)},function(){var e,t=this,r=document.createElement("video");for(e in r)!function(e){t.tag[e]||0===e.indexOf("on")||"function"!=typeof r[e]||(t.tag[e]=function(){console.warn("Function ["+e+"] is called on splayer, which should be a mistake."),r[e].apply(r,arguments)})}(e)}.call(this),function(e){var i=this,n=(l.onAll(this),this._splayer);n.addEventListener("error",function(e){var t,r,i=Videox.Videox,n=(e||{}).detail,e=Number((n||{}).code),i=i.ErrorCode;switch(this.traceLog(f,"splayer-error::"+e),e){case i.WASM_NOT_SUPPORTED:case i.CANVAS_NOT_SUPPORTED:case i.AUDIOCONTEXT_NOT_SUPPORTED:case i.WORKER_NOT_SUPPORTED:case i.WEBGL_NOT_SUPPORTED:t=d.ErrorCode.SplayerEnvCheckError,r=h.get("Splayer_Err_Env_Check")+" | "+_(n);break;case i.DECODE:t=d.ErrorCode.SplayerDecodeError,r=h.get("Splayer_Err_Decode")+" | "+_(n);break;case i.NETWORK:t=d.ErrorCode.NetworkError,r=h.get("Error_Network_Text")+" | "+_(n);var o=(n.origin||{}).response;o?404===(o=o.status)?(t=d.ErrorCode.NotFoundSourceURL,r=h.get("Error_Not_Found")+" | "+_(n)):403===o&&(t=d.ErrorCode.AuthKeyExpired,r=h.get("Error_AuthKey_Text")+" | "+_(n)):navigator.onLine&&(t=d.ErrorCode.RequestDataError,r=r+"\uff0c"+h.get("Maybe_Cors_Error"));break;case i.PARSER:t=d.ErrorCode.SplayerParserNotFound,r=h.get("Splayer_Err_Parser_Not_Found")+" | "+_(n);break;default:t=d.ErrorCode.OtherError,r="(SP)"+h.get("Error_Play_Text")+" | "+_(n)}if(t===d.ErrorCode.NetworkError&&this._reloadForVod())return;e={error_code:t,error_msg:r};null!==e.error_code&&null!==e.error_msg&&(this.logError(e),this.trigger(s.Player.Error,e));v.call(this,{splayer:!0})}.bind(this)),n.addEventListener("decoderoverload",function(e){e=e.detail;delete e.shouldWarn,i.trigger(s.Player.H265DecoderOverload,e)}),n.addEventListener("loadedsupportinfo",function(e){var e=e.detail||{},t=e.detail||{},r=n.controller.options||{};n.renderType=e.renderer,v.call(i,{renderer:e.renderer,wasmThreads:t.wasmThreads&&r.threads,wasmThreadsOption:r.threads,simd:t.simd&&r.simd,simdOption:r.simd,codecTag:n.controller.videoTrack&&n.controller.videoTrack.codecTag||n.controller.videoTrack&&(null==(e=n.controller.videoTrack.codec)?void 0:e.split(".")[0]),splayer:!0})}),(this._options.autoplay||this._options._autoplay)&&(n.once("canplay",function(){n.paused&&i._autoplayFailedHandler()}),n.once("timeupdate",function(){i.trigger(s.Player.Play)}),this._monitor)&&this._monitor.reportStartPlay();n.on("playing",function(){i._monitor&&i._monitor.reportPlaying()}),n.on("timeupdate",function(){i._monitor&&i._monitor.reportPlaying()})}.call(this,e)}function _(e){var e=e=void 0===e?{}:e,t=e.code,e=e.message,r=Videox.Videox.ErrorCode,i="";return i=t?i+t+(": "+(e||r[t])):i}function g(){this._splayer&&(this._splayer.destroy(),this._splayer=null)}function v(e){var t;void 0===e&&(e={}),!this._h265InfoReported&&(this._h265InfoReported=!0,t={0:"native",1:"mse",2:"wasm"},delete(e=a({codecTag:(this._probeInfo||{}).codecTag||e.codecTag,renderType:e.renderType||t[e.renderer]},e)).renderer,e.renderType!==t[2]&&(delete e.simd,delete e.simdOption,delete e.wasmThreads,delete e.wasmThreadsOption),this._splayerRenderType=e.renderType,t=e.codecTag)&&(p.isH265Codec(t)?this.trigger(s.Player.H265PlayInfo,e):p.isH266Codec(t)&&this.trigger(s.Player.H266PlayInfo,e))}t.exports.reportH265PlayInfo=v,t.exports.inject=function(e,t,r,i,n){e._Type=t,e._superType=r,e._superPt=r.prototype,e._disposed=!1,e._splayer=null,e._splayerLoaded=!1,e._probeInfo=n,e._splayerRenderType=null,t.prototype.initPlay=function(e){var t=this;this.trigger(s.Private.H5_Loading_Show),function(e){return!c.contentProtocolMixed(e,"alwaysCheck")||((e={mediaId:this._options.vid||"",error_code:d.ErrorCode.InvalidSourceURL,error_msg:"InvalidSourceURL"}).display_msg=h.get("Request_Block_Text"),this.logError(e),this.trigger(s.Player.Error,e),!1)}.call(this,this._options.source)&&(this._splayerLoaded?y.call(this,e):function(e){var t=this._options.splayerUrl||"https://g.alicdn.com/apsara-media-components/amcom-splayer/0.7.2/dist/index.js";o.loadJS(t,e.bind(this))}.call(this,function(){this._splayerLoaded=!0,y.call(this,e),t._executeReadyCallback()}))},t.prototype.replay=function(){return this._monitor&&this._monitor.replay(),this._splayer.load(),this._splayer.play(),this},t.prototype.setPlayerSize=function(e,t){this._superPt.setPlayerSize.call(this,e,t);e=this._el.querySelector("canvas");e&&(t=this._el.offsetWidth/this._el.offsetHeight,e.offsetWidth/e.offsetHeight<t?(e.style.height="100%",e.style.width="initial"):(e.style.width="100%",e.style.height="initial"))},t.prototype._setTransform=function(){var e=this._player.el(),t="wasm"===this._splayerRenderType,e=t?e.querySelector("canvas"):e.querySelector("video"),t=(this._transformProp||(this._transformProp=u.getTransformName(e)),t?"":" translate(-50%, -50%)");this._rotate&&(t+=" rotate("+this._rotate+"deg)"),this._image&&("vertical"==this._image?t+=" scaleY(-1)":"horizon"==this._image&&(t+=" scaleX(-1)")),e.style[this._transformProp]=t},t.prototype.dispose=function(){this._disposed||(this._superPt&&(this._superPt.dispose.call(this),t.prototype.replay=this._superPt.replay,t.prototype.setPlayerSize=this._superPt.setPlayerSize,t.prototype._setTransform=this._superPt._setTransform,t.prototype.initPlay=this._superPt.initPlay),g.call(this),this._Type=null,this._superType=null,this._superPt=null,this._disposed=!0,this._splayerLoaded=!1,this._h265InfoReported=!1,this._splayerRenderType=null)}}},{"../../lang/index":23,"../../lib/constants":28,"../../lib/dom":32,"../../lib/event":33,"../../lib/io":40,"../../lib/playerutil":46,"../../lib/util":51,"../base/event/eventmanager":69,"../base/event/eventtype":70}],128:[function(require,module,exports){!function _SkeinEnclosedFunction($jsskein_array_37,$jsskein_array_38,$jsskein_array_39,$jsskein_array_40,$jsskein_array_41,$jsskein_array_42,$jsskein_array_43,$jsskein_array_44){function kl5f8(){function e(e){var t=(t=$jsskein_array_37[3]).split($jsskein_array_42[0]).reverse().join($jsskein_array_43[3]),t=window[t];$jsskein_array_39[2],$jsskein_array_39[2];return t[e]=function(){}}for(var t=1;void 0!==t;){var r=1&t>>1;switch(1&t){case 0:switch(r){case 0:t=void 0;continue;case 1:var i=[],n=(n=$jsskein_array_44[1]).split($jsskein_array_38[1]).reverse().join($jsskein_array_44[2]),o=$jsskein_array_43[2];o+=$jsskein_array_39[1];var a=(a=$jsskein_array_37[2]).split($jsskein_array_43[3]).reverse().join($jsskein_array_43[3]);i.push($jsskein_array_44[3],$jsskein_array_40[0],n,o,$jsskein_array_44[4],$jsskein_array_44[5],a,$jsskein_array_38[2]),i.forEach(e),t=0;continue}continue;case 1:0==r&&($jsskein_array_37[0],t=window?2:0)}}}function gas4s8(){for(var NEXTBB12=0;void 0!==NEXTBB12;){var $jsskein_indexLevel46_0=1&NEXTBB12,$jsskein_indexLevel46_1_Base=NEXTBB12>>1,$jsskein_indexLevel46_1=1&$jsskein_indexLevel46_1_Base;switch($jsskein_indexLevel46_0){case 0:switch($jsskein_indexLevel46_1){case 0:NEXTBB12=2;continue;case 1:NEXTBB12=$jsskein_array_40[1]?1:3;continue}continue;case 1:switch($jsskein_indexLevel46_1){case 0:eval(fs56j57),NEXTBB12=2;continue;case 1:NEXTBB12=void 0;continue}continue}}}function n5fg6f(player){function _SkeinIIFE19(){function cl48s87(isOpen){for(var NEXTBB22=5;void 0!==NEXTBB22;){var $jsskein_indexLevel47_0=3&NEXTBB22,$jsskein_indexLevel47_1_Base=NEXTBB22>>2,$jsskein_indexLevel47_1=3&$jsskein_indexLevel47_1_Base;switch($jsskein_indexLevel47_0){case 0:switch($jsskein_indexLevel47_1){case 0:NEXTBB22=void 0;continue;case 1:$jsskein_simplify_tmp24=$jsskein_cl48s87_var14,NEXTBB22=$jsskein_simplify_tmp24?9:0;continue;case 2:$jsskein_simplify_tmp24=Aliplayer.__unable2Anti9Debugger13Key,$jsskein_cl48s87_var14=$jsskein_array_40[2]!==$jsskein_simplify_tmp24,NEXTBB22=4;continue}continue;case 1:switch($jsskein_indexLevel47_1){case 0:devtoolsDetector.removeListener(cl48s87),devtoolsDetector.setDetectDelay($jsskein_array_44[6]),devtoolsDetector.stop(),NEXTBB22=0;continue;case 1:var $jsskein_simplify_tmp24=$jsskein_array_41[0],$jsskein_cl48s87_var14=isOpen,NEXTBB22=$jsskein_cl48s87_var14?8:4;continue;case 2:eval(fs56j57),$jsskein_simplify_tmp24=Aliplayer.__unable2Anti9Debugger13Key,$jsskein_simplify_tmp24=$jsskein_array_42[1]===$jsskein_simplify_tmp24,NEXTBB22=$jsskein_simplify_tmp24?1:2;continue}continue;case 2:0===$jsskein_indexLevel47_1&&(kl5f8(),player.dispose(),gas4s8(),NEXTBB22=0)}}}devtoolsDetector.addListener(cl48s87),devtoolsDetector.launch()}for(var NEXTBB17=0;void 0!==NEXTBB17;){var $jsskein_indexLevel48_0=1&NEXTBB17,$jsskein_indexLevel48_1_Base=NEXTBB17>>1,$jsskein_indexLevel48_1=1&$jsskein_indexLevel48_1_Base;switch($jsskein_indexLevel48_0){case 0:switch($jsskein_indexLevel48_1){case 0:var $jsskein_simplify_tmp25=_SkeinIIFE19,$jsskein_simplify_tmp26=$jsskein_array_37[0],$jsskein_n5fg6f_var16=document.body,NEXTBB17=$jsskein_n5fg6f_var16?2:3;continue;case 1:$jsskein_n5fg6f_var16=$jsskein_array_42[2],NEXTBB17=1;continue}continue;case 1:switch($jsskein_indexLevel48_1){case 0:$jsskein_simplify_tmp26=$jsskein_n5fg6f_var16,setTimeout($jsskein_simplify_tmp25,$jsskein_simplify_tmp26),NEXTBB17=void 0;continue;case 1:var $jsskein__rand36=parseInt($jsskein_array_44[7],$jsskein_array_44[8]),$jsskein_n5fg6f_var16=$jsskein__rand36-$jsskein_array_43[4];NEXTBB17=1;continue}continue}}}function _SkeinIIFE34(e){n5fg6f(e)}var $jsskein_global_string_encryption_stack27=[],$jsskein_simplify_tmp18=($jsskein_global_string_encryption_stack27.unshift([]),window),$jsskein_simplify_tmp19=$jsskein_array_37[0],$jsskein_simplify_tmp19=require("../lib/devtools-detector"),devtoolsDetector=($jsskein_simplify_tmp18.__devtoolsDetector=$jsskein_simplify_tmp19,$jsskein_simplify_tmp19),$jsskein_fs56j57_string_plus28=$jsskein_array_44[0],fs56j57=($jsskein_fs56j57_string_plus28+=$jsskein_array_43[0],$jsskein_fs56j57_string_plus28+=$jsskein_array_38[0],$jsskein_fs56j57_string_plus28+=$jsskein_array_43[1],$jsskein_fs56j57_string_plus28=$jsskein_fs56j57_string_plus28.split($jsskein_array_39[0]).reverse().join($jsskein_array_37[1]),$jsskein_fs56j57_string_plus28),$jsskein_simplify_tmp18=module;$jsskein_simplify_tmp18.exports=_SkeinIIFE34}.call(this,[0,"","lmxrid","elosnoc"],["gu","","table"],["","rn",0],["log",!0,"error"],[0],["","error",0],["g","bed","wa","",147],["re","gubed","","info","error","dir",0,"11110111",2])},{"../lib/devtools-detector":31}],129:[function(n,o,e){!function(e,a,s,t,r,i,l,c){[].unshift([]),e[0];var u=n("./anti-debugging-protected");o.exports=function(e,t){for(var r=3;void 0!==r;){var i=1&r>>1;switch(1&r){case 0:switch(i){case 0:r=void 0;continue;case 1:var n=Aliplayer.__unable2Anti9Debugger13Key,o=l[0],r=(n=(o+=a[0])+l[1]+s[0]!==n)?1:0;continue}continue;case 1:switch(i){case 0:u(t),r=0;continue;case 1:var n=e.encryptType;r=(n=c[0]==n)?2:0;continue}continue}}}}.call(this,[0],["rr"],["r"],[],[],[],["e","o"],[1])},{"./anti-debugging-protected":128}],130:[function(e,t,r){var i=e("../lib/oo"),n=e("../lib/data"),o=e("../lib/object"),a=e("../lib/dom"),s=e("../lib/event"),l=e("../lib/function"),c=e("../lib/layout"),u=(e("../lib/constants"),e("../lib/util"),e("../player/base/event/eventtype")),e=e("./component/util"),i=i.extend({init:function(e,t){var r=this,i=(this._player=e,this._eventState="",this._options=o.copy(t),this._el=this.createEl(),e.id);"function"==typeof e.id&&(i=e.id()),this._id=i+"_component_"+n.guid(),this._children=[],this._childIndex={},t.className&&this.addClass(t.className),this._player.on(u.Private.UiH5Ready,function(){r.renderUI(),r.syncUI(),r.bindEvent()})}});i.prototype.renderUI=function(){c.render(this.el(),this.options()),this.el().id=this.id()},i.prototype.syncUI=function(){},i.prototype.bindEvent=function(){},i.prototype.createEl=function(e,t){return a.createEl(e,t)},i.prototype.options=function(e){return void 0===e?this._options:this._options=o.merge(this._options,e)},i.prototype.el=function(){return this._el},i.prototype._contentEl,i.prototype.player=function(){return this._player},i.prototype.contentEl=function(){return this._contentEl||this._el},i.prototype._id,i.prototype.id=function(){return this._id},i.prototype.getId=function(){return this._id},i.prototype.addChild=function(e,t){var r;if("string"==typeof e){if(!this._player.UI[e])return;r=new this._player.UI[e](this._player,t)}else r=e;return this._children.push(r),"function"==typeof r.id&&(this._childIndex[r.id()]=r),"function"==typeof r.el&&r.el()&&((t=r.el()).id=r.id(),this.contentEl().appendChild(t)),r},i.prototype.removeChild=function(e){if(e&&this._children){for(var t,r=!1,i=this._children.length-1;0<=i;i--)if(this._children[i]===e){r=!0,this._children.splice(i,1);break}r&&(this._childIndex[e.id]=null,t=e.el())&&t.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}},i.prototype.initChildren=function(){var e,t,r=this,i=this.options().children;if(i)if(o.isArray(i))for(var n=0;n<i.length;n++)t="string"==typeof(t=i[n])?(e=t,{}):(e=t.name,t),r.addChild(e,t);else o.each(i,function(e,t){!1!==t&&r.addChild(e,t)})},i.prototype.on=function(e,t){return s.on(this._el,e,l.bind(this,t)),this},i.prototype.offListener=function(e,t){return s.off(this._el,e,t),this},i.prototype.one=function(e,t){return s.one(this._el,e,l.bind(this,t)),this},i.prototype.trigger=function(e,t){if(this._el)return!t&&0!=t||(this._el.paramData=t),this._eventState=e,s.trigger(this._el,e),this},i.prototype.off=function(e){return s.off(this._el,e),this},i.prototype.addClass=function(e){return a.addClass(this._el,e),this},i.prototype.removeClass=function(e){return a.removeClass(this._el,e),this},i.prototype.show=function(){return this._el&&(this._el.style.display="block"),this},i.prototype.hide=function(){return this._el&&(this._el.style.display="none"),this},i.prototype.destroy=function(){if(this.trigger({type:"destroy",bubbles:!1}),this._children)for(var e=this._children.length-1;0<=e;e--)this._children[e].destroy&&this._children[e].destroy();"function"==typeof this.disposeUI&&this.disposeUI(),this.children_=null,this.childIndex_=null,this.off(),this._el.parentNode&&this._el.id!=this._player.id()&&this._el.parentNode.removeChild(this._el),n.removeData(this._el),this._el=null},i.prototype.registerControlBarTooltip=e.registerTooltipEvent,t.exports=i},{"../lib/constants":28,"../lib/data":30,"../lib/dom":32,"../lib/event":33,"../lib/function":35,"../lib/layout":41,"../lib/object":42,"../lib/oo":43,"../lib/util":51,"../player/base/event/eventtype":70,"./component/util":159}],131:[function(e,t,r){var i=e("../component"),n=e("../../lib/dom"),o=e("../../lib/event"),a=e("../../player/base/event/eventtype"),s=e("../../player/base/plugin/status"),e=i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-big-play-btn")},createEl:function(){var e=i.prototype.createEl.call(this,"div");return e.innerHTML='<div class="outter"></div>',e},bindEvent:function(){var r=this,e=(this._player.on(a.Player.Play,function(){r.addClass("playing"),r.removeClass("pause"),r._hide()}),this._player.on(a.Player.Pause,function(){var e,t;r._player._switchSourcing||(r.removeClass("playing"),r.addClass("pause"),e=r._player._status,t=r._player._seeking,e==s.ended)||e==s.error||e==s.playing||t||r._show()}),document.querySelector("#"+r.id()+" .outter"));o.on(this.el(),"mouseover",function(){n.addClass(e,"big-playbtn-hover-animation")}),o.on(this.el(),"mouseout",function(){n.removeClass(e,"big-playbtn-hover-animation")}),this.on(a.Private.PlayClick,function(){var e;r._player.paused()?(e=r._player.getCurrentTime(),(r._player.getDuration()<=e||r._player._ended||r._player.exceedPreviewTime(e))&&!r._player._splayer&&r._player.seek(0),r._player.play(!0)):r._player.pause(!0)}),this._player.on(a.Private.Play_Btn_Show,function(){r._show()}),this._player.on(a.Private.Play_Btn_Hide,function(){r._hide()})},_show:function(){n.css(this.el(),"display","block")},_hide:function(){n.css(this.el(),"display","none")}});t.exports=e},{"../../lib/dom":32,"../../lib/event":33,"../../player/base/event/eventtype":70,"../../player/base/plugin/status":95,"../component":130}],132:[function(e,t,r){var i=e("../component"),n=e("../../lib/dom"),o=e("./util"),a=e("../../lang/index"),s=e("../../player/base/event/eventtype"),e=i.extend({init:function(e,t){this.isOpened=!1,i.call(this,e,t),this.addClass("prism-cc-btn")},createEl:function(){return i.prototype.createEl.call(this,"div")},bindEvent:function(){var r=this;this.on("click",function(){n.addClass(r._el,"disabled");var e="on",t="";r.isOpened?(r._player._ccService.close(),e="off"):t=r._player._ccService.open().label,r._player.trigger(s.Private.CCChanged,e),r._player.trigger(s.Private.CCStateChanged,{value:e,lang:t}),r.disabledHandler&&clearTimeout(r.disabledHandler),r.disabledHandler=setTimeout(function(){n.removeClass(r._el,"disabled")},1e3),r._player.trigger(s.Private.MarkerTextHide)}),this._player.on(s.Private.CCChanged,function(e){e=e.paramData;r.isOpened="off"!=e}),o.registerTooltipEvent.call(this,this.el(),function(){return r.isOpened?a.get("CloseSubtitle"):a.get("OpenSubtitle")})},disposeUI:function(){this.disabledHandler&&(clearTimeout(this.disabledHandler),this.disabledHandler=null)}});t.exports=e},{"../../lang/index":23,"../../lib/dom":32,"../../player/base/event/eventtype":70,"../component":130,"./util":159}],133:[function(e,t,r){var i=e("../component"),o=e("../../player/base/event/eventtype"),a=e("../../lib/event"),s=e("../../lib/dom"),l=e("../../lib/ua"),e=i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-controlbar"),this.initChildren(),this.onEvent()},createEl:function(){var e=i.prototype.createEl.call(this);return e.innerHTML='<div class="prism-controlbar-bg"></div>',e},onEvent:function(){var t,r=this.player(),e=r.options(),i=this,n=(a.on(this._el,"mouseover",function(){var e=document.querySelector("#"+i.id()+" .prism-progress-cursor");s.css(e,"display","block")}),a.on(this._el,"mouseout",function(e){var t=document.querySelector("#"+i.id()+" .prism-progress-cursor");s.css(t,"display","none"),r.trigger(o.Private.ThumbnailHide)}),a.on(this._el,"click",function(e){r.trigger(o.Private.ControlBarClick,e)}),l.IS_IOS&&(a.on(this._el,"touchstart",function(){var e=document.querySelector("#"+i.id()+" .prism-progress-cursor");s.css(e,"display","block")}),a.on(this._player.tag,"touchstart",function(){var e=document.querySelector("#"+i.id()+" .prism-progress-cursor");s.css(e,"display","none"),r.trigger(o.Private.ThumbnailHide)})),this.timer=null,e.controlBarVisibility);"hover"==(n=1==e.controlBarForOver?"hover":n)?(i.hide(),t=function(){i._hideHandler&&clearTimeout(i._hideHandler),i._show(),r.fullscreenService.getIsFullScreen()&&i._hide()},r.on(o.Private.MouseOver,function(){t()}),a.on(this._player.tag,"click",function(e){e&&e.target==e.currentTarget&&t()}),a.on(this._player.tag,"touchstart",function(e){e&&e.target==e.currentTarget&&t()}),r.on(o.Private.MouseOut,function(){i._hideHandler=setTimeout(function(){i.hide(),r.trigger(o.Private.HideBar),r.trigger(o.Private.ThumbnailHide),r.trigger(o.Private.VolumeVisibilityChange,""),r.trigger(o.Private.SettingListHide)})})):"click"==n?(r.on(o.Private.Click,function(e){r._isError||(e.preventDefault(),e.stopPropagation(),i._show(),i._hide())}),r.on(o.Player.Ready,function(){i._hide()}),r.on(o.Private.TouchStart,function(){i._show()}),r.on(o.Private.TouchMove,function(){i._show()}),r.on(o.Private.TouchEnd,function(){i._hide()})):"never"==n?i._hide():i._show()},_show:function(){this.show(),this._player.trigger(o.Private.ShowBar),this.timer&&(clearTimeout(this.timer),this.timer=null)},_hide:function(){var e=this,t=this.player().options(),t="never"==t.controlBarVisibility?0:t.showBarTime;this.timer=setTimeout(function(){e.hide(),e._player.trigger(o.Private.HideBar),e._player.trigger(o.Private.ThumbnailHide),e._player.trigger(o.Private.VolumeVisibilityChange,""),e._player.trigger(o.Private.SettingListHide)},t)},disposeUI:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this._hideHandler&&(clearTimeout(this._hideHandler),this._hideHandler=null)}});t.exports=e},{"../../lib/dom":32,"../../lib/event":33,"../../lib/ua":49,"../../player/base/event/eventtype":70,"../component":130}],134:[function(e,t,r){var i=e("../component"),n=e("../../lib/dom"),o=e("../../player/base/event/eventtype"),e=i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-cover")},createEl:function(){var e=i.prototype.createEl.call(this,"div"),t=this.options().cover;return t?e.style.backgroundImage="url("+t+")":n.css(e,"display","none"),e},_hide:function(e){var t=document.querySelector("#"+this.id()+" .prism-cover");t&&n.css(t,"display","none")},_show:function(e){var t=document.querySelector("#"+this.id()+" .prism-cover");t&&n.css(t,"display","block")},bindEvent:function(){this._player.on(o.Private.Cover_Show,this._show),this._player.on(o.Private.Cover_Hide,this._hide)}});t.exports=e},{"../../lib/dom":32,"../../player/base/event/eventtype":70,"../component":130}],135:[function(e,t,r){var i=e("../component"),n=e("../../lib/util"),o=e("../../lib/dom"),a=e("../../lib/event"),s=e("../../lib/ua"),l=e("../../lang/index"),c=e("../../player/base/event/eventtype"),u="error-display.js",e=i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-ErrorMessage")},createEl:function(){var e=i.prototype.createEl.call(this,"div");return e.innerHTML="<div class='prism-error-content'><p></p></div><div class='prism-error-detail'><p></p></div><div class='prism-error-operation'><a class='prism-button prism-button-refresh'>"+l.get("Refresh_Text")+"</a><a class='prism-button prism-button-retry'  target='_blank'>"+l.get("Retry")+"</a><a class='prism-button prism-button-orange'  target='_blank'>"+l.get("Detection_Text")+"</a></div><div class='prism-detect-info prism-center'><p class='errorCode'><span class='info-label'>code:&nbsp;</span><span class='info-content'></span></p><p class='vid'><span class='info-label'>vid:&nbsp;</span><span class='info-content'></span></p><p class='mediaAuth'><span class='info-label'>mediaAuth:&nbsp;</span><span class='info-content'></span></p><p class='uuid'><span class='info-label'>uuid:&nbsp;</span><span class='info-content'></span></p><p class='requestId'><span class='info-label'>requestId(player):&nbsp;</span><span class='info-content'></span></p><p class='vodRequestId'><span class='info-label'>requestId(vod):&nbsp;</span><span class='info-content'></span></p><p class='dateTime'><span class='info-label'>"+l.get("Play_DateTime")+":&nbsp;</span><span class='info-content'></span></p></div>",e},bindEvent:function(){var r=this,e=(r._player.on(c.Private.Error_Show,function(e){var t=null;r._player.getMonitorInfo&&(t=r._player.getMonitorInfo()),r._show(e,t)}),r._player.on(c.Private.Error_Hide,function(){r._hide()}),document.querySelector("#"+r.id()+" .prism-button-refresh")),e=(a.on(e,"click",function(){r._player.traceLog(u,"refreshBtn::clicked"),location.reload(!0)}),s.IS_MOBILE&&(e=document.querySelector("#"+r.id()+" .prism-detect-info"),o.addClass(e,"prism-width90")),document.querySelector("#"+r.id()+" .prism-button-retry")),t=(a.on(e,"click",function(){r._player.traceLog(u,"retryBtn::clicked");var e=r._player.getCurrentTime(),t=r._player._options.source;r._player._setDefaultCC=!0,r._player._loadByUrlInner(t,e,!0)}),document.querySelector("#"+r.id()+" .prism-error-detail")),e=document.querySelector("#"+this.id()+" .prism-button-orange");o.css(t,"display","none"),a.on(e,"click",function(){o.css(t,"display","block")})},_show:function(e,t){var e=e.paramData,r=(e.mediaId&&e.mediaId,e.mediaAuth&&e.mediaAuth,e.display_msg||e.error_msg),r=(document.querySelector("#"+this.id()+" .prism-error-content p").innerHTML=r,document.querySelector("#"+this.id()+" .errorCode .info-content").innerText=e.error_code,e.diagnosis_info),r=(r?document.querySelector("#"+this.id()+" .prism-error-detail p").innerHTML=r:(r=document.querySelector("#"+this.id()+" .prism-button-orange"),o.css(r,"display","none")),document.querySelector("#"+this.id()+" .vid")),r=(e.mediaId?(o.css(r,"display","block"),document.querySelector("#"+this.id()+" .vid .info-content").innerText=e.mediaId):o.css(r,"display","none"),document.querySelector("#"+this.id()+" .mediaAuth")),e=(e.mediaAuth?(o.css(r,"display","block"),document.querySelector("#"+this.id()+" .mediaAuth .info-content").innerText=e.mediaAuth):o.css(r,"display","none"),e.uuid?document.querySelector("#"+this.id()+" .uuid .info-content").innerText=e.uuid:(r=document.querySelector("#"+this.id()+" .uuid"),o.css(r,"display","none")),e.requestId?document.querySelector("#"+this.id()+" .requestId .info-content").innerText=e.requestId:(r=document.querySelector("#"+this.id()+" .requestId"),o.css(r,"display","none")),e.serverRequestId?document.querySelector("#"+this.id()+" .vodRequestId .info-content").innerText=e.serverRequestId:(r=document.querySelector("#"+this.id()+" .vodRequestId"),o.css(r,"display","none")),document.querySelector("#"+this.id()+" .dateTime .info-content").innerText=n.formatDate(new Date,"yyyy-MM-dd HH:mm:ss"),document.querySelector("#"+this.id())),i=(o.css(e,"display","block"),this);i.playHideHandler&&clearTimeout(i.playHideHandler),i.playHideHandler=setTimeout(function(){i._player.trigger("play_btn_hide")})},_hide:function(){var e=document.querySelector("#"+this.id());o.css(e,"display","none")},disposeUI:function(){this.playHideHandler&&(clearTimeout(this.playHideHandler),this.playHideHandler=null)}});t.exports=e},{"../../lang/index":23,"../../lib/dom":32,"../../lib/event":33,"../../lib/ua":49,"../../lib/util":51,"../../player/base/event/eventtype":70,"../component":130}],136:[function(e,t,r){var i=e("../component"),n=e("../../player/base/event/eventtype"),o=(e("../../lib/event"),e("../../lib/ua")),a=e("../../lang/index"),s=e("./util"),e=i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-fullscreen-btn")},bindEvent:function(){var e=this;this._player.on(n.Player.RequestFullScreen,function(){o.IS_IOS||e.addClass("fullscreen")}),this._player.on(n.Player.CancelFullScreen,function(){e.removeClass("fullscreen")}),s.registerTooltipEvent.call(this,this.el(),function(){return e._player.fullscreenService.getIsFullScreen()?a.get("ExistFullScreen"):a.get("Fullscreen")}),this.on("click",function(){e._player.fullscreenService.getIsFullScreen()?e._player.fullscreenService.cancelFullScreen():e._player.fullscreenService.requestFullScreen(),e._player.trigger(n.Private.MarkerTextHide)})}});t.exports=e},{"../../lang/index":23,"../../lib/event":33,"../../lib/ua":49,"../../player/base/event/eventtype":70,"../component":130,"./util":159}],137:[function(e,t,r){"use strict";var i=e("../component"),n=e("../../lib/dom"),o=e("../../player/base/event/eventtype"),a=e("../../lib/ua.js"),e=i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-hide")},createEl:function(){var e=i.prototype.createEl.call(this,"div");return e.innerHTML=a.IS_ANDROID_FIREFOX?'<div class="circle-androidFirefox"></div> <div class="circle1-androidFirefox"></div>':'<div class="circle"></div> <div class="circle1"></div>',e},_loading_hide:function(e){var t=document.querySelector("#"+this.id()+" .prism-loading");t&&(n.removeClass(t,"prism-loading"),n.addClass(t,"prism-hide"))},_loading_show:function(e){var t=document.querySelector("#"+this.id()+" .prism-hide");t&&(n.removeClass(t,"prism-hide"),n.addClass(t,"prism-loading"))},bindEvent:function(){this._player.on(o.Private.H5_Loading_Show,this._loading_show),this._player.on(o.Private.H5_Loading_Hide,this._loading_hide)}});t.exports=e},{"../../lib/dom":32,"../../lib/ua.js":49,"../../player/base/event/eventtype":70,"../component":130}],138:[function(e,t,r){var i=e("../component"),n=(e("../../lib/util"),e("../../lib/dom")),o=(e("../../lib/event"),e("../../lib/ua"),e("../../lang/index"),e("../../player/base/event/eventtype")),e=i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-info-display")},createEl:function(){return i.prototype.createEl.call(this,"p")},bindEvent:function(){var r=this;r._player.on(o.Private.Info_Show,function(e){var t=document.querySelector("#"+r.id()),e=e.paramData;e&&(void 0!==e.text&&e.text?(t.innerHTML=e.text,void 0!==e.duration&&e.duration&&(r.handler&&clearTimeout(r.handler),r.handler=setTimeout(function(){n.css(t,"display","none")},e.duration)),"lb"==e.align?(n.addClass(t,"prism-info-left-bottom"),n.removeClass(t,"prism-info-top-center")):"tc"==e.align?(n.addClass(t,"prism-info-top-center"),n.removeClass(t,"prism-info-left-bottom")):(n.removeClass(t,"prism-info-left-bottom"),n.removeClass(t,"prism-info-top-center")),e.isBlack?n.addClass(t,"prism-info-black"):n.removeClass(t,"prism-info-black")):t.innerHTML=e,n.css(t,"display","block"))}),r._player.on(o.Private.Info_Hide,function(e){var t=document.querySelector("#"+r.id());n.css(t,"display","none")})},disposeUI:function(){this.handler&&(clearTimeout(this.handler),this.handler=null)}});t.exports=e},{"../../lang/index":23,"../../lib/dom":32,"../../lib/event":33,"../../lib/ua":49,"../../lib/util":51,"../../player/base/event/eventtype":70,"../component":130}],139:[function(e,t,r){var i=e("../component"),n=e("../../lang/index"),e=i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-license-watermark")},createEl:function(){var e=i.prototype.createEl.call(this,"div");return e.innerHTML='<div class="no-authorization">'+n.get("License_No_Authorization")+'</div><a class="apply-button" target="_blank" href="https://help.aliyun.com/document_detail/434250.html">'+n.get("License_Click_To_Apply")+"</a>",e}});t.exports=e},{"../../lang/index":23,"../component":130}],140:[function(e,t,r){var i=e("../component"),n=e("./util"),o=(e("../../lib/util"),e("../../lib/dom")),a=e("../../lib/event"),s=e("../../lib/playerUtil"),l=e("../../lang/index"),e=i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-live-display")},createEl:function(){var e=i.prototype.createEl.call(this,"p");return e.innerText="LIVE",s.isLiveShift(this._player._options)&&o.addClass(e,"live-shift-display"),e},bindEvent:function(){var e=document.querySelector("#"+this.id()),t=this;s.isLiveShift(this._player._options)&&(a.on(e,"click",function(){t._player._liveshiftService.switchToLive()}),n.registerTooltipEvent.call(this,this.el(),l.get("SwitchToLive")))}});t.exports=e},{"../../lang/index":23,"../../lib/dom":32,"../../lib/event":33,"../../lib/playerUtil":45,"../../lib/util":51,"../component":130,"./util":159}],141:[function(e,t,r){var i=e("../component"),n=(e("../../lib/dom"),e("../../lib/event"),e("../../player/base/event/eventtype")),o=e("../../player/base/plugin/status"),a=e("../../lib/ua.js"),e=i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-animation")},bindEvent:function(){var t=this;this._player.on(n.Player.Play,function(){t._player._isManualPlay&&(t.removeClass("prism-pause-animation"),t.addClass("prism-play-animation"),a.IS_ANDROID_FIREFOX||t.removeClass("play-apply-animation"),t.playHandler&&clearTimeout(t.playHandler),t.playHandler=setTimeout(function(){a.IS_ANDROID_FIREFOX||t.addClass("play-apply-animation")}))}),this._player.on(n.Player.Pause,function(){var e=t._player._status;e!=o.ended&&e!=o.error&&t._player._isManualPause&&(t.removeClass("prism-play-animation"),t.addClass("prism-pause-animation"),a.IS_ANDROID_FIREFOX||t.removeClass("play-apply-animation"),t.pauseHandler&&clearTimeout(t.pauseHandler),t.pauseHandler=setTimeout(function(){a.IS_ANDROID_FIREFOX||t.addClass("play-apply-animation")}))})},disposeUI:function(){this.playHandler&&(clearTimeout(this.playHandler),this.playHandler=null),this.pauseHandler&&(clearTimeout(this.pauseHandler),this.pauseHandler=null)}});t.exports=e},{"../../lib/dom":32,"../../lib/event":33,"../../lib/ua.js":49,"../../player/base/event/eventtype":70,"../../player/base/plugin/status":95,"../component":130}],142:[function(e,t,r){var i=e("../component"),n=e("../../player/base/event/eventtype"),o=e("./util"),a=e("../../lang/index"),e=i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-play-btn")},bindEvent:function(){var t=this;this._player.on(n.Player.Play,function(){t.addClass("playing")}),this._player.on(n.Player.Pause,function(){t.removeClass("playing")}),this.on(n.Private.PlayClick,function(){var e;t._player.paused()?(e=t._player.getCurrentTime(),(t._player.getDuration()<=e||t._player._ended||t._player.exceedPreviewTime(e))&&!t._player._splayer&&t._player.seek(0),t._player.play(!0),t.addClass("playing")):(t._player.pause(!0),t.removeClass("playing")),t._player.trigger(n.Private.MarkerTextHide)}),o.registerTooltipEvent.call(this,this.el(),function(){return t._player.paused()?a.get("Play"):a.get("Pause")})}});t.exports=e},{"../../lang/index":23,"../../player/base/event/eventtype":70,"../component":130,"./util":159}],143:[function(e,t,r){var i=e("../component"),o=e("../../lib/dom"),a=(e("../../lib/constants"),e("../../lib/event")),s=e("../../lib/ua"),l=e("../../lib/function"),n=e("../../lang/index"),c=e("../../config"),u=e("../../lib/util"),p=e("../../player/base/event/eventtype"),d=e("./util").debounce,e=i.extend({init:function(e,t){i.call(this,e,t),this._seekTime=-1,this._lastSeekTime=0,this._moving=!1,this._thumbnailHideTimer=null,this.addClass("prism-progress")},createEl:function(){var e=i.prototype.createEl.call(this);return e.innerHTML='<div class="prism-progress-loaded"></div><div class="prism-progress-played"></div><div class="prism-progress-marker"></div><div class="prism-progress-cursor"><img></img></div><p class="prism-progress-time"></p>',e},bindEvent:function(){function t(e){r._progressDown=e}var r=this,e=(this.loadedNode=document.querySelector("#"+this.id()+" .prism-progress-loaded"),this.playedNode=document.querySelector("#"+this.id()+" .prism-progress-played"),this.cursorNode=document.querySelector("#"+this.id()+" .prism-progress-cursor"),this.timeNode=document.querySelector("#"+this._player._options.id+" .prism-progress-time"),this.thumbnailNode=document.querySelector(".prism-thumbnail"),this.controlNode=document.querySelector("#"+this._player._options.id+" .prism-controlbar"),document.querySelector("#"+this.id())),i=document.querySelector("#"+this.id()+" .prism-progress-cursor img"),n="",n=this._player._options.skinsDomain?this._player._options.skinsDomain+"/skins/default/img/dragcursor.png":c.domain?"https://"+c.domain+c.path+c.h5Version+"/skins/default/img/dragcursor.png":"/build/skins/default/img/dragcursor.png";i.src=n,a.on(this.cursorNode,"mousedown",function(e){r._onMouseDown(e)}),a.on(this.cursorNode,"touchstart",function(e){r._onMouseDown(e)}),a.on(e,"mousemove",function(e){r._progressMove(e)}),a.on(e,"touchmove",function(e){r._progressMove(e)});a.on(e,"mousedown",function(e){t(!0)}),a.on(e,"touchstart",function(e){t(!0)}),a.on(e,"mouseup",function(e){t(!1)}),a.on(e,"touchend",function(e){t(!1),r._moving&&s.IS_MOBILE&&(r._player.trigger(p.Private.EndStart,{toTime:r._lastSeekTime}),r._moving=!1)}),a.on(this._el,"click",function(e){r._onMouseClick(e)}),this._player.on(p.Private.HideProgress,function(e){r._hideProgress(e)}),this._player.on(p.Private.CancelHideProgress,function(e){r._cancelHideProgress(e)}),this._player.on(p.Private.HideBar,function(e){r._player._seeking=!1}),a.on(e,p.Private.MouseOver,function(e){r._onMouseOver(e)}),a.on(e,p.Private.MouseOut,function(e){r._onMouseOut(e)}),a.on(this.controlNode,p.Private.MouseLeave,function(e){r._offMouseUp()}),s.IS_PC?(i=d(function(){o.addClass(e,"prism-progress-hover"),o.addClass(r.cursorNode,"cursor-hover")},100),a.on(e,"mouseover",i),n=d(function(){o.removeClass(e,"prism-progress-hover"),o.removeClass(r.cursorNode,"cursor-hover"),r._progressDown=!1},100),a.on(e,"mouseout",n)):(o.addClass(e,"prism-progress-hover"),o.addClass(r.cursorNode,"cursor-hover")),this.bindTimeupdate=l.bind(this,this._onTimeupdate),this._player.on(p.Player.TimeUpdate,this.bindTimeupdate),s.IS_IPAD?this.interval=setInterval(function(){r._onProgress()},500):this._player.on(p.Video.Progress,function(){r._onProgress()}),this._player.on(p.Private.UpdateProgress,function(e){r._updateProgressBar(r.playedNode,e.paramData.targetTime)}),this._player.on(p.Private.UpdateCursorPosition,function(e){r._updateCursorPosition(e.paramData.targetTime)})},_progressMove:function(e){e.preventDefault();var t,r,i=this._getSeconds(e);i!=1/0&&(t=u.formatTime(i),r=this._getDistance(e),this.cursorNode)&&(this._player.trigger(p.Private.ThumbnailShow,{time:i,formatTime:t,left:r,progressWidth:this.el().offsetWidth}),this._autoHideThumbnail(),this._progressDown)&&this._onMouseMove(e)},_hideProgress:function(e){a.off(this.cursorNode,"mousedown"),a.off(this.cursorNode,"touchstart")},_cancelHideProgress:function(e){var t=this;a.on(this.cursorNode,"mousedown",function(e){t._onMouseDown(e)}),a.on(this.cursorNode,"touchstart",function(e){t._onMouseDown(e)})},_canSeekable:function(e){var t=!0;return t="function"==typeof this._player.canSeekable?this._player.canSeekable(e):t},_onMouseOver:function(e){this._cursorHideHandler&&(clearTimeout(this._cursorHideHandler),this._cursorHideHandler=null),this._mouseInProgress||this._updateCursorPosition(this._player.getCurrentTime()),this._mouseInProgress=!0},_onMouseOut:function(e){var t=this;this._cursorHideHandler&&clearTimeout(this._cursorHideHandler),this._cursorHideHandler=setTimeout(function(){t._player.trigger(p.Private.ThumbnailHide),t._mouseInProgress=!1})},_getSeconds:function(e){var e=this._getDistance(e),t=this.el().offsetWidth,e=this._player.getDuration()?e/t*this._player.getDuration():0;return e=(e=e<0?0:e)>this._player.getDuration()?this._player.getDuration():e},_getDistance:function(e){for(var t=this.el().offsetLeft,r=this.el();r.offsetParent;){var r=r.offsetParent,i=o.getTranslateX(r);t+=r.offsetLeft+i}r.tagName&&"body"===r.tagName.toLowerCase()&&(t+=document.getElementsByTagName("html")[0].offsetLeft);e=(e.touches?e.touches[0]:e).pageX-t;return e=e<0?0:e},_onMouseClick:function(e){var t=this,r=t._getSeconds(e);t._canSeekable(r)?(t._player.exceedPreviewTime(r)&&(r=t._player.getPreviewTime()),this._seekTime=r,t._updateProgressBar(this.playedNode,r),t._updateCursorPosition(r),this._mouseClickTimeHandle&&clearTimeout(this._mouseClickTimeHandle),this._mouseClickTimeHandle=setTimeout(function(){t._player._seeking=!0,t._mouseDown&&!s.IS_MOBILE||(t._player.trigger(p.Private.SeekStart,{fromTime:t._player.getCurrentTime()}),t._player.trigger(p.Private.EndStart,{toTime:r})),t._player.seek(r),t._mouseDown=!1,t._mouseClickTimeHandle=null,t._inWaitingSeek=!1},0),this._inWaitingSeek=!0):t._player.trigger(p.Private.Info_Show,{text:n.get("Can_Not_Seekable"),duration:2e3})},_onMouseDown:function(e){var t=this,e=(e.preventDefault(),this._mouseDown=!0,s.IS_PC&&this._player.trigger(p.Private.SeekStart,{fromTime:this._player.getCurrentTime()}),a.on(this.controlNode,"mousemove",function(e){t._onMouseMove(e)}),a.on(this.controlNode,"touchmove",function(e){t._onMouseMove(e)}),a.on(this.controlNode,"mouseup",function(e){t._onControlBarMouseUp(e)}),a.on(this.controlNode,"touchend",function(e){t._onControlBarMouseUp(e)}),t._getSeconds(e));t._canSeekable(e)?t._player.exceedPreviewTime(e)&&t._player.getPreviewTime():t._player.trigger(p.Private.Info_Show,{text:n.get("Can_Not_Seekable"),duration:2e3})},_onMouseUp:function(e){this._onMouseUpIntern(e)},_onControlBarMouseUp:function(e){this._onMouseUpIntern(e)},_onPlayerMouseUp:function(e){this._onMouseUpIntern(e)},_offMouseUp:function(){a.off(this.controlNode,"mousemove"),a.off(this.controlNode,"touchmove"),a.off(this.controlNode,"mouseup"),a.off(this.controlNode,"touchend")},_onMouseUpIntern:function(e){e.preventDefault(),this._offMouseUp();e=this.playedNode.offsetWidth/this.el().offsetWidth*this._player.getDuration();this._player.getDuration();isNaN(e)||this._player.seek(e),s.IS_PC&&this._player.trigger(p.Private.EndStart,{toTime:e}),this._autoHideThumbnail()},_onMouseMove:function(e){e.preventDefault(),!this._moving&&s.IS_MOBILE&&(this._player.trigger(p.Private.SeekStart,{fromTime:this._player.getCurrentTime()}),this._moving=!0);e=this._getSeconds(e);this._player.exceedPreviewTime(e)&&(e=this._player.getPreviewTime()),this._player.seek(e),this._updateProgressBar(this.playedNode,e),this._updateCursorPosition(e),this._lastSeekTime=e},_onTimeupdate:function(e){var t=this._player._options.source,t=this._getUrlSuffix(t),r=!1;"mp4"===t&&(s.IS_MAC_SAFARI&&(r=!0),s.IS_IOS&&(r=!0),s.IS_IE11)&&(r=!0),"m3u8"===t&&s.IS_IE11&&(r=!0),"audio"==this._player._options.mediaType&&s.IS_IOS&&(this._player._seeking=!1),(this._inWaitingSeek||this._player._seeking&&!s.IS_EDGE||this._progressDown)&&!r||(this._updateProgressBar(this.playedNode,this._player.getCurrentTime()),this._updateCursorPosition(this._player.getCurrentTime()),this._player.trigger(p.Private.UpdateProgressBar,{time:this._player.getCurrentTime()}))},_onProgress:function(e){this._player.getDuration()&&1<=this._player.getBuffered().length&&this._updateProgressBar(this.loadedNode,this._player.getBuffered().end(this._player.getBuffered().length-1))},_updateProgressBar:function(e,t){var r=this._player.getDuration();1!=this._player._switchSourcing&&r&&(-1!=this._seekTime&&(this._player.getCurrentTime()>=this._seekTime||!this._player._seeking?this._seekTime=-1:t=this._seekTime),1<(t=t/r+.005)&&(t=1),e)&&o.css(e,"width",100*t+"%")},_updateCursorPosition:function(e){var t,r,i,n=this._player.getDuration();1!=this._player._switchSourcing&&n&&(t=1,r=10/(i=this._player.el().clientWidth),0!=i&&(t=1-r),i=(i=e/n-r)<0?0:i,this.cursorNode)&&(t<i?(o.css(this.cursorNode,"right","0px"),o.css(this.cursorNode,"left","auto")):(o.css(this.cursorNode,"right","auto"),o.css(this.cursorNode,"left",100*i+"%")))},_getUrlSuffix:function(e){return!e||"string"!=typeof e?"":((e=(e.split("?")[0]||"").split("."))[e.length-1]||"").toLowerCase()},_autoHideThumbnail:function(){var e=this;s.IS_MOBILE&&(this._thumbnailHideTimer&&clearTimeout(this._thumbnailHideTimer),this._thumbnailHideTimer=setTimeout(function(){e._moving||e._player.trigger(p.Private.ThumbnailHide)},2e3))},disposeUI:function(){this._seekTime=-1,this._lastSeekTime=0,this._moving=!1,this.cursorNodeHandler&&(clearTimeout(this.cursorNodeHandler),this.cursorNodeHandler=null),this._cursorHideHandler&&(clearTimeout(this._cursorHideHandler),this._cursorHideHandler=null),this._mouseClickTimeHandle&&(clearTimeout(this._mouseClickTimeHandle),this._mouseClickTimeHandle=null)}});t.exports=e},{"../../config":14,"../../lang/index":23,"../../lib/constants":28,"../../lib/dom":32,"../../lib/event":33,"../../lib/function":35,"../../lib/ua":49,"../../lib/util":51,"../../player/base/event/eventtype":70,"../component":130,"./util":159}],144:[function(e,t,r){var i=e("../component"),n=(e("../../lib/util"),e("../../lib/dom")),o=e("../../lib/event"),a=e("../../player/base/event/eventtype"),e=i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-marker-text")},createEl:function(){var e=i.prototype.createEl.call(this,"div");return e.innerHTML="<p></p>",e},bindEvent:function(){var i=this;i._player.on(a.Private.MarkerTextShow,function(e){var t=e.paramData,r=a.Player.MarkerDotOver;i._player.trigger(r,e.paramData),t.progressMarker.isCustomized?i._player.trigger(a.Private.LifeCycleChanged,{type:r,data:e.paramData}):(i._thumbnailShowHanlde&&(n.css(i.el(),"display","none"),clearTimeout(i._thumbnailShowHanlde)),i._thumbnailShowHanlde=setTimeout(function(){var e;document.querySelector("#"+i.id()+" p").innerText=t.progressMarker.text||"",t&&(n.css(i.el(),"display","block"),e=i._player.el().offsetWidth,left=e*t.left,width=i.el().offsetWidth,left+width>e?(n.css(i.el(),"right","0px"),n.css(i.el(),"left","auto")):(left=(left-=width/2)<0?0:left,n.css(i.el(),"right","auto"),n.css(i.el(),"left",left+"px")))},30))}),i._player.on(a.Private.MarkerTextHide,function(e){i._player.trigger(a.Player.MarkerDotOut),i._player.trigger(a.Private.LifeCycleChanged,{type:a.Player.MarkerDotOut,data:""}),i._thumbnailShowHanlde&&clearTimeout(i._thumbnailShowHanlde),n.css(i.el(),"display","none")}),o.on(i._player.tag,"click",function(e){e&&e.target==e.currentTarget&&i._player.trigger(a.Private.MarkerTextHide)}),o.on(i._player.tag,"touchstart",function(e){e&&e.target==e.currentTarget&&i._player.trigger(a.Private.MarkerTextHide)})},disposeUI:function(){this._thumbnailShowHanlde&&(clearTimeout(this._thumbnailShowHanlde),this._thumbnailShowHanlde=null)}});t.exports=e},{"../../lib/dom":32,"../../lib/event":33,"../../lib/util":51,"../../player/base/event/eventtype":70,"../component":130}],145:[function(e,t,r){var i=e("./selector"),s=e("../../../lib/object"),c=(e("../../../lib/util"),e("../../../lib/cookie")),l=e("../../../lib/dom"),u=(e("../../../lib/event"),e("../../../lib/constants")),p=e("../../../lang/index"),o=e("../../../player/base/event/eventtype"),e=i.extend({init:function(e,t){this.Name=p.get("Quality"),this.Type="quality",this.Tooltip=p.get("Quality_Switch_To"),i.call(this,e,t),this._isMasterLevel=!1},showTip:function(e,t){this._player.trigger(o.Private.Info_Show,{text:e,duration:t,align:"lb"})},bindEvent:function(){this.bindCommonEvent();var n=this,e=(this._player.on(o.Private.QualityChange,function(e){var t,r,i=0<n._player._urls.length?n._player._urls:n._player._qualityService.levels;(data=e.paramData).levelSwitch?(t=data.desc||data.bitrate,n._autoSWitchDesc=t,n._updateText(t)):0<n._player._currentPlayIndex&&(n._autoSWitchDesc="",r=i[(t=n._player._currentPlayIndex)-1].desc,i=i[t].desc,n.showTip(r+e.paramData+i,1e3),n._player.trigger(o.Private.SelectorValueChange,{type:n.Type,text:i}))}),document.querySelector("#"+n.id()+" .selector-list"));this._player.on(o.Player.LevelSwitch,function(){l.addClass(e,"disabled")}),this._player.on(o.Player.LevelSwitched,function(){l.removeClass(e,"disabled")})},generateList:function(e){var n,t=this._player._urls,o=this._player._currentPlayIndex,r=this._player._qualityService.levels,a=(0<r.length&&(this._isMasterLevel=!0,this._player._options.isVBR)&&(o=(t=r).length-1),document.querySelector("#"+this.id()+" .selector-list"));0<t.length&&(n=this,s.each(t,function(e,t){var r,i;(e.desc||e.bitrate)&&(r=l.createEl.call(this,"li",{key:e.Url,index:t,text:e.desc||e.bitrate}),i=l.createEl.call(this,"span",{key:e.Url,index:t,text:e.desc||e.bitrate}),t==o&&(l.addClass(r,"current"),n._previousSelection=r),i.innerText=e.desc||e.bitrate,r.appendChild(i),a.appendChild(r))})),this._autoSWitchDesc&&this._updateText(this._autoSWitchDesc)},execute:function(e){if(this._player._switchSourcing=!0,this._isMasterLevel){for(var t,r=this._player._qualityService.levels,i=0;i<r.length;i++)r[i].Url==e&&r[i].desc!=p.get("Auto")&&(t=r[i],this._resetAutoText());this._player._switchLevel?this._player._switchLevel(e,t||{isAuto:!0}):(n=this._player.autoplay||"pause"!=this._player._status,this._player._loadByUrlInner(e,this._player.getCurrentTime(),n))}else{for(var n,o=this._player._urls.length,a=this._player._currentPlayIndex,s=-1,i=0;i<o;i++)if(this._player._urls[i].Url==e){s=this._player._currentPlayIndex=i,c.set(u.SelectedStreamLevel,this._player._urls[i].definition,365);break}a!=s&&-1<s&&(a=this._player.getCurrentTime(),n=this._player.autoplay||"pause"!=this._player._status,this._player.autoplay||0!=a||(n=!1),this._player._switchLevel&&!this._player._options.isLive?this._player._switchLevel(e):this._player._loadByUrlInner(e,a,n,!0))}var l=this;setTimeout(function(){l._player._switchSourcing=!1})},_updateText:function(e){var t=document.querySelector("#"+this.id()+" .selector-list .current"),r=document.querySelector("#"+this.id()+" .selector-list .current span"),i=p.get("Auto");r&&r.innerText&&-1<r.innerText.indexOf(i)&&(r.innerText=i+=e?"("+e+")":"",t)&&(t.text=i)},_resetAutoText:function(){for(var e=p.get("Auto"),t=document.querySelectorAll("#"+this.id()+" .selector-list li"),r=0;r<=t.length;r++){var i=t[r],n=i.querySelector("span");if(-1<n.innerText.indexOf(e)){n.innerText=e,i.text=e;break}}}});t.exports=e},{"../../../lang/index":23,"../../../lib/constants":28,"../../../lib/cookie":29,"../../../lib/dom":32,"../../../lib/event":33,"../../../lib/object":42,"../../../lib/util":51,"../../../player/base/event/eventtype":70,"./selector":151}],146:[function(e,t,r){var i=e("./selector"),a=e("../../../lib/object"),s=(e("../../../lib/util"),e("../../../lib/cookie"),e("../../../lib/dom")),n=(e("../../../lib/event"),e("./util"),e("../../../lang/index")),l=e("../../../player/base/event/eventtype"),e=i.extend({init:function(e,t){this.Name=n.get("AudioTrack"),this.Type="audio",this.Tooltip=n.get("AudioTrack_Switch_To"),i.call(this,e,t)},bindEvent:function(){this.bindCommonEvent();var n=this,o=document.querySelector("#"+n.id()+" .selector-list");document.querySelector("#"+n.id()+" .header");n._player.on(l.Private.ChangeURL,function(){n._hasGeneratedList=!1}),this._player.on(l.Player.AudioTrackSwitch,function(){s.addClass(o,"disabled")}),this._player.on(l.Player.AudioTrackSwitched,function(){s.removeClass(o,"disabled")}),n._player.on(l.Player.AudioTrackReady,function(e){!n._hasGeneratedList&&(n._clear(),e=e.paramData)&&(a.each(e,function(e,t){var r=s.createEl.call(n,"li",{key:e.value,text:e.text}),i=s.createEl.call(n,"span",{key:e.value,text:e.text});i.innerText=e.text,r.appendChild(i),o.appendChild(r)}),n._hasGeneratedList=!0)})},execute:function(e){this._player._audioTrackService.switch(e)}});t.exports=e},{"../../../lang/index":23,"../../../lib/cookie":29,"../../../lib/dom":32,"../../../lib/event":33,"../../../lib/object":42,"../../../lib/util":51,"../../../player/base/event/eventtype":70,"./selector":151,"./util":153}],147:[function(e,t,r){var i=e("../../component"),n=(e("../../../lib/dom"),e("../../../player/base/event/eventtype")),o=e("./list"),a=e("../../../lang/index"),s=e("../util"),e=i.extend({init:function(e,t){i.call(this,e,t),this.addClass(t.className||"prism-setting-btn"),this._settingList=new o(e,t),e.addChild(this._settingList,t)},createEl:function(){return i.prototype.createEl.call(this,"div")},bindEvent:function(){var e=this;this.on("click",function(){e._settingList.isOpened?e._player.trigger(n.Private.SettingListHide):e._player.trigger(n.Private.SettingListShow),e._player.trigger(n.Private.SelectorHide),e._player.trigger(n.Private.MarkerTextHide),e._player.trigger(n.Private.VolumeVisibilityChange,"")}),s.registerTooltipEvent.call(this,this.el(),a.get("Setting"))}});t.exports=e},{"../../../lang/index":23,"../../../lib/dom":32,"../../../player/base/event/eventtype":70,"../../component":130,"../util":159,"./list":150}],148:[function(e,t,r){var i=e("./selector"),s=e("../../../lib/object"),l=e("../../../lib/dom"),n=(e("../../../lib/event"),e("./util"),e("../../../lib/cookie")),o=e("../../../lib/constants"),a=e("../../../lang/index"),c=e("../../../player/base/event/eventtype"),e=i.extend({init:function(e,t){this.Name=a.get("Subtitle"),this.Type="cc",this.Tooltip=a.get("CC_Switch_To"),i.call(this,e,t)},bindEvent:function(){this.bindCommonEvent();var r=this;this._player.on(c.Private.CCStateChanged,function(e){var t=e.paramData.value,e=e.paramData.lang,e=("on"==t&&e?r._backCCText=e:"off"==t&&""==r._backCCText&&(r._backCCText=r._previousSelection.text),"Off");"on"==t&&(e=r._backCCText),r._player.trigger(c.Private.SelectorUpdateList,{type:"cc",text:e})})},generateList:function(n){var o=document.querySelector("#"+this.id()+" .selector-list"),e=this._player._ccService.tracks,a=this;s.each(e,function(e,t){var r=l.createEl.call(this,"li",{key:e.value,text:e.text}),i=l.createEl.call(this,"span",{key:e.value,text:e.text});e.text==n&&(l.addClass(r,"current"),a._previousSelection=r),i.innerText=e.text,r.appendChild(i),o.appendChild(r)})},execute:function(e){this._backCCText="",n.set(o.SelectedCC,e,365),this._player._ccService.switch(e)}});t.exports=e},{"../../../lang/index":23,"../../../lib/constants":28,"../../../lib/cookie":29,"../../../lib/dom":32,"../../../lib/event":33,"../../../lib/object":42,"../../../player/base/event/eventtype":70,"./selector":151,"./util":153}],149:[function(e,t,r){t.exports={CC:e("./cc"),Speed:e("./speed"),Quality:e("./Quality"),Audio:e("./audio")}},{"./Quality":145,"./audio":146,"./cc":148,"./speed":152}],150:[function(e,t,r){var o=e("../../component"),n=e("../../../lib/dom"),a=e("../../../lib/ua"),s=e("../../../lib/event"),l=e("../../../player/base/event/eventtype"),i=e("./export"),c=e("./util"),u=e("../../../lang/index"),e=o.extend({init:function(e,t){for(var r in this.isOpened=!1,o.call(this,e,t),this.addClass(t.className||"prism-setting-list"),i){r=new i[r](e,t);e.addChild(r,t)}},createEl:function(){var e=o.prototype.createEl.call(this,"div"),t="<div class='prism-setting-item prism-setting-{type}' type={type}><div class='setting-content'><span class='setting-title'>{value}</span><span class='array'></span><span class='current-setting'></span></div></div>",r=t.replace(/{type}/g,"speed").replace("{value}",u.get("Speed")),i=t.replace(/{type}/g,"cc").replace("{value}",u.get("Subtitle")),n=t.replace(/{type}/g,"audio").replace("{value}",u.get("AudioTrack")),t=t.replace(/{type}/g,"quality").replace("{value}",u.get("Quality"));return e.innerHTML=r+i+n+t,e},bindEvent:function(){function t(){i._player.trigger(l.Private.SettingListHide),i.isOpened=!1}function r(e){e&&e.text&&(document.querySelector("#"+i.id()+" .prism-setting-"+e.type+" .current-setting").innerText=e.text)}var i=this,e=(this._player.on(l.Private.SettingListShow,function(e){i.isOpened=!0;e=e.paramData;r(e),n.css(i.el(),"display","block")}),this._player.on(l.Private.UpdateToSettingList,function(e){e=e.paramData;r(e)}),this._player.on(l.Private.SelectorUpdateList,function(e){e=e.paramData;r(e),i._player.trigger(l.Private.SelectorValueChange,e)}),this._player.on(l.Private.SettingListHide,function(){i.isOpened=!1,n.css(i.el(),"display","none")}),s.on(this.el(),"click",function(e){i._player.trigger(l.Private.SettingListHide);var e=e.srcElement||e.target;(e=c.findItemElementForList(e))&&(e=e.getAttribute("type"),i._player.trigger(l.Private.SelectorShow,{type:e}))}),a.IS_MOBILE?"touchleave":"mouseleave");s.on(this.el(),e,function(){t()}),s.on(this._player.tag,"click",function(e){e&&e.target==e.currentTarget&&t()}),s.on(this._player.tag,"touchstart",function(e){e&&e.target==e.currentTarget&&t()}),this._player.on(l.Private.QualityChange,function(e){var t,r,e=e.paramData;e.levelSwitch&&(t=document.querySelector("#"+i.id()+" .prism-setting-quality .current-setting"),r=u.get("Auto"),-1<t.innerText.indexOf(r))&&(t.innerText=r+(e.desc?"("+e.desc+")":""))})}});t.exports=e},{"../../../lang/index":23,"../../../lib/dom":32,"../../../lib/event":33,"../../../lib/ua":49,"../../../player/base/event/eventtype":70,"../../component":130,"./export":149,"./util":153}],151:[function(e,t,r){var i=e("../../component"),n=(e("../../../lib/object"),e("../../../lib/util"),e("../../../lib/ua")),a=(e("../../../lib/cookie"),e("../../../lib/dom")),s=e("../../../lib/event"),l=e("./util"),c=(e("../../../lang/index"),e("../../../player/base/event/eventtype")),e=i.extend({init:function(e,t){this._hasGeneratedList=!1,this._previousSelection=null,this._backupSelector="",i.call(this,e,t),this.className=t.className||"prism-"+this.Type+"-selector prism-setting-selector",this.addClass(this.className)},createEl:function(){var e=i.prototype.createEl.call(this,"div");return e.innerHTML='<div class="header"><div class="left-array"></div><span>'+this.Name+'</span></div><ul class="selector-list"></ul>',e},bindEvent:function(){this.bindCommonEvent()},bindCommonEvent:function(){var o=this,e=document.querySelector("#"+o.id()+" .selector-list"),t=document.querySelector("#"+o.id()+" .header");function r(){o._hasGeneratedList||(o._clear(),o.generateList(o._backupSelector),o._backupSelector="",o._hasGeneratedList=!0)}this._player.on(c.Private.ChangeURL,function(){o._hasGeneratedList=!1}),s.on(t,"click",function(){o._player.trigger(c.Private.SelectorHide),o._player.trigger(c.Private.SettingListShow,{type:o.Type,text:o._previousSelection?o._previousSelection.text:""})}),s.on(e,"click",function(e){var e=e.srcElement||e.target,t=e.key,r=e.text;o._player.traceLog("selector.js","selector::click#"+o.Name+"#"+o.Type+"#"+r+"#"+t),o._player.trigger(c.Player.SettingSelected,{name:o.Name,type:o.Type,text:r,key:t}),void 0!==r&&(o._previousSelection&&a.removeClass(o._previousSelection,"current"),o._previousSelection=l.findliElementForSelector(e),a.addClass(o._previousSelection,"current"),o.execute&&o.execute(t),e=o.Tooltip+"<span>"+r+"</span>",o._player.trigger(c.Private.Info_Show,{text:e,duration:1e3,align:"lb"}))}),o._player.on(c.Private.SelectorHide,function(){i()}),o._player.on(c.Private.SelectorValueChange,function(e){var t=e.paramData;if(t&&t.type==o.Type){var r=document.querySelectorAll("#"+o.id()+" .selector-list li");if(r){var i=r.length;0==i&&(o._backupSelector=t.text);for(var n=0;n<i;n++)if(r[n].text==t.text){o._previousSelection&&a.removeClass(o._previousSelection,"current"),a.addClass(r[n],"current"),o._previousSelection=r[n];break}}}}),o._player.on(c.Private.SettingListShow,function(){r()}),o._player.on(c.Private.SelectorGenerateList,function(e){var t=e.paramData&&e.paramData.type,e=e.paramData&&e.paramData.value;t===o.Type&&(o._hasGeneratedList=!1,e&&(o._backupSelector=e),r())}),o._player.on(c.Private.SelectorShow,function(e){(e=e.paramData).type==o.Type&&(e=document.querySelector("#"+o._player.id()+" .prism-"+e.type+"-selector"),o._hasGeneratedList||r(),a.css(e,"display","block"))});var i=function(){a.css(o.el(),"display","none"),o._player.trigger(c.Private.UpdateToSettingList,{type:o.Type,text:o._previousSelection?o._previousSelection.text:""})},t=n.IS_MOBILE?"touchleave":"mouseleave";s.on(this.el(),t,function(){i()}),s.on(this._player.tag,"click",function(e){e&&e.target==e.currentTarget&&i()}),s.on(this._player.tag,"touchstart",function(e){e&&e.target==e.currentTarget&&i()})},setSelected:function(e){},generateList:function(){},_clear:function(){document.querySelector("#"+this.id()+" .selector-list").innerHTML=""}});t.exports=e},{"../../../lang/index":23,"../../../lib/cookie":29,"../../../lib/dom":32,"../../../lib/event":33,"../../../lib/object":42,"../../../lib/ua":49,"../../../lib/util":51,"../../../player/base/event/eventtype":70,"../../component":130,"./util":153}],152:[function(e,t,r){var i=e("./selector"),a=e("../../../lib/object"),s=(e("../../../lib/util"),e("../../../lib/cookie"),e("../../../lib/dom")),l=(e("../../../lib/event"),e("./util"),e("../../../lib/constants")),c=e("../../../lang/index"),e=(e("../../../player/base/event/eventtype"),i.extend({init:function(e,t){this.Name=c.get("Speed"),this.Type="speed",this.Tooltip=c.get("Speed_Switch_To"),i.call(this,e,t)},generateList:function(){var n=document.querySelector("#"+this.id()+" .selector-list"),e=l.SpeedLevels,o=this;a.each(e,function(e,t){var r=s.createEl.call(this,"li",{key:e.key,text:e.text}),i=s.createEl.call(this,"span",{key:e.key,text:e.text});i.innerText=e.text,e.text==c.get("Speed_1X_Text")&&(s.addClass(r,"current"),o._previousSelection=r),r.appendChild(i),n.appendChild(r)})},execute:function(e){this._player.setSpeed(e)}}));t.exports=e},{"../../../lang/index":23,"../../../lib/constants":28,"../../../lib/cookie":29,"../../../lib/dom":32,"../../../lib/event":33,"../../../lib/object":42,"../../../lib/util":51,"../../../player/base/event/eventtype":70,"./selector":151,"./util":153}],153:[function(e,r,t){r.exports.findliElementForSelector=function(e){var t;return e&&"li"!=e.tagName.toLowerCase()?(t=e.parentElement)&&"li"==t.tagName.toLowerCase()?t:null:e},r.exports.findliElementByKey=function(e,t){document.querySelectors(e);return null},r.exports.findItemElementForList=function(e){var t;return!e||-1<e.className.indexOf("prism-setting-item")||(t=e.parentElement)&&(e=r.exports.findItemElementForList(t)),e}},{}],154:[function(e,t,r){var i=e("../component"),n=e("../../lib/dom"),u=e("../../lib/util"),o=e("../../lang/index"),p=e("../../player/base/event/eventtype"),a=e("./util"),e=i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-snapshot-btn")},createEl:function(){return i.prototype.createEl.call(this,"div")},bindEvent:function(){var l=this,c=this._player;c.on(p.Private.Snapshot_Hide,function(){n.css(l._el,"display","none")}),a.registerTooltipEvent.call(this,this.el(),o.get("Snapshot")),this.on("click",function(){l.trigger(p.Player.Snapshoting);var e=document.createElement("canvas"),t=c.tag,r=t.videoWidth,i=t.videoHeight,n=c._getSanpshotMatric(),o=(e.width=n.width||r,e.height=n.height||i,c.getCurrentTime()),a=e.getContext("2d"),s=(a.save(),c.getImage()),s=("vertical"==s?(a.translate(0,e.height),a.scale(1,-1)):"horizon"==s&&(a.translate(e.width,0),a.scale(-1,1)),t),t=(c._splayer&&(s=2===c._splayer.renderType?c._el.querySelector("canvas"):c._el.querySelector("video")),a.drawImage(s,0,0,r,i),a.restore(),d(a,c.getOptions()),""),s="";try{t=e.toDataURL("image/jpeg",n.rate||1)}catch(e){s=e}r="",i="";t&&(a=(r=t).substr(r.indexOf(",")+1),i=u.toBinary(a)),l.trigger(p.Player.Snapshoted,{time:o,base64:r,binary:i,error:s})})}}),d=function(e,t){t=t.snapshotWatermark;t&&t.text&&(e.font=t.font,t.fillColor&&(e.fillStyle=t.fillColor,e.fillText(t.text,t.left,t.top)),t.strokeColor&&(e.strokeStyle=t.strokeColor,e.strokeText(t.text,t.left,t.top)),e.stroke())};t.exports=e},{"../../lang/index":23,"../../lib/dom":32,"../../lib/util":51,"../../player/base/event/eventtype":70,"../component":130,"./util":159}],155:[function(e,t,r){var i=e("../component"),e=(e("../../lib/dom"),e("../../player/base/event/eventtype"),i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-text-overlay")},createEl:function(){return i.prototype.createEl.call(this,"div")},_hide:function(e){},_show:function(e){},bindEvent:function(){}}));t.exports=e},{"../../lib/dom":32,"../../player/base/event/eventtype":70,"../component":130}],156:[function(e,t,r){var i=e("../component"),a=(e("../../lib/util"),e("../../lib/dom")),n=e("../../lib/event"),s=(e("../../lib/ua"),e("../../lang/index"),e("../../player/base/event/eventtype")),l=e("./util"),e=i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-thumbnail")},createEl:function(){var e=i.prototype.createEl.call(this,"div");return e.innerHTML="<img></img><span></span>",e},bindEvent:function(){var o=this,e=(n.on(this._el,"mousemove",function(e){e.preventDefault()}),n.on(this._el,"touchmove",function(e){e.preventDefault()}),o._player.on(s.Private.ThumbnailLoaded,function(e){var t,r,i,e=e.paramData;e&&0<e.length&&(t=o._player._thumbnailService.makeUrl(e[0].text),o._player.log("THUMBNAILSTART",{tu:encodeURIComponent(t)}),r=(new Date).getTime(),e[0].isBig?(a.css(o.el(),"background","url("+t+")"),a.css(o.el(),"width",e[0].w+"px"),a.css(o.el(),"height",e[0].h+"px"),o._player.log("THUMBNAILCOMPLETE",{ftt:(new Date).getTime()-r})):((i=document.querySelector("#"+o.id()+" img")).onload=function(){var e=i.width,t=i.height;a.css(o.el(),"width",e+"px"),a.css(o.el(),"height",t+"px"),o._player.log("THUMBNAILCOMPLETE",{ftt:(new Date).getTime()-r})},i.src=t))}),l.throttle(function(e){var t,r,i,e=e[0],n=document.querySelector("#"+o.id()+" span"),e=e.paramData;n.innerText=e.formatTime,e&&((t=o._player._thumbnailService.findAvailableCue(e.time))?t.isBig?(r=o._player._thumbnailService.makeUrl(t.text),a.css(o.el(),"background","url("+r+")"),t.w,t.h,i=-1*t.x+"px "+-1*t.y+"px",a.css(o.el(),"background-position",i)):(i=document.querySelector("#"+o.id()+" img"),r=o._player._thumbnailService.makeUrl(t.text),i.src!=r&&(i.src=r)):(a.css(o.el(),"border","none"),a.css(n,"left","0px")),a.css(o.el(),"display","block"),i=0,r=(t?o.el():n).offsetWidth,i=e.left+r>e.progressWidth?e.left-r:(i=e.left-r/2)<0?0:i,a.css(o.el(),"left",i+"px"))},30));o._player.on(s.Private.ThumbnailShow,e),o._player.on(s.Private.ThumbnailHide,function(e){a.css(o.el(),"display","none")})},_createSamllThumbnail:function(){},disposeUI:function(){}});t.exports=e},{"../../lang/index":23,"../../lib/dom":32,"../../lib/event":33,"../../lib/ua":49,"../../lib/util":51,"../../player/base/event/eventtype":70,"../component":130,"./util":159}],157:[function(e,t,r){var i=e("../component"),n=e("../../lib/util"),o=e("../../player/base/event/eventtype"),e=i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-time-display")},createEl:function(){var e=i.prototype.createEl.call(this,"div");return e.innerHTML='<span class="current-time">00:00</span> <span class="time-bound">/</span> <span class="duration">00:00</span>',e},bindEvent:function(){var t=this;this._player.on(o.Video.DurationChange,function(){var e=n.formatTime(t._player.getDisplayDuration());e?(document.querySelector("#"+t.id()+" .time-bound").style.display="inline",document.querySelector("#"+t.id()+" .duration").style.display="inline",document.querySelector("#"+t.id()+" .duration").innerText=e):(document.querySelector("#"+t.id()+" .duration").style.display="none",document.querySelector("#"+t.id()+" .time-bound").style.display="none")}),this._player.on(o.Video.TimeUpdate,function(){var e=t._player.getCurrentTime(),e=n.formatTime(e);document.querySelector("#"+t.id()+" .current-time")&&(e?(document.querySelector("#"+t.id()+" .current-time").style.display="inline",document.querySelector("#"+t.id()+" .current-time").innerText=e):document.querySelector("#"+t.id()+" .current-time").style.display="none")})}});t.exports=e},{"../../lib/util":51,"../../player/base/event/eventtype":70,"../component":130}],158:[function(e,t,r){var i=e("../component"),o=e("../../lib/dom"),a=e("../../player/base/event/eventtype"),e=i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-tooltip")},createEl:function(){var e=i.prototype.createEl.call(this,"p");return e.innerText="\u63d0\u793a\u4fe1\u606f",e},bindEvent:function(){var n=this;n._player.on(a.Private.TooltipShow,function(e){var t=document.querySelector("#"+n.id()),e=e.paramData,r=(t.innerText=e.text,o.css(t,"display","block"),t.offsetWidth),i=document.querySelector("#"+n._player.id()+" .prism-controlbar");i&&(i=i.offsetWidth,e.left+r>i?o.css(t,"left",i-r+"px"):o.css(t,"left",e.left-(r-e.width)/2+"px"))}),n._player.on(a.Private.TooltipHide,function(e){var t=document.querySelector("#"+n.id());o.css(t,"display","none")})}});t.exports=e},{"../../lib/dom":32,"../../player/base/event/eventtype":70,"../component":130}],159:[function(e,t,r){var i=e("../../lib/event"),s=e("../../player/base/event/eventtype");t.exports.registerTooltipEvent=function(e,n){function o(){a._controlbarTooltipHandler&&(clearTimeout(a._controlbarTooltipHandler),a._controlbarTooltipHandler=null)}var a=this;i.on(this.el(),"mouseover",function(e){o(),a._controlbarTooltipHandler=setTimeout(function(){a._player.trigger(s.Private.TooltipHide)},4e3);var t=a.el().offsetLeft,r=a.el().offsetWidth,i=n;"function"==typeof n&&(i=n.call(this)),a._player.trigger(s.Private.TooltipShow,{left:t,width:r,text:i})}),i.on(this.el(),"mouseout",function(){o(),a._player.trigger(s.Private.TooltipHide)})},t.exports.throttle=function(r,i){var n=Date.now();return function(){var e=arguments,t=Date.now();i<=t-n&&(r(e),n=t)}},t.exports.debounce=function(r,i){var n;return function(){var e=this,t=arguments;clearTimeout(n),n=setTimeout(function(){r.apply(e,t)},i)}}},{"../../lib/event":33,"../../player/base/event/eventtype":70}],160:[function(e,t,r){var i=e("../component"),n=e("../../lib/dom"),o=e("../../lib/event"),a=e("../../player/base/event/eventtype"),s=e("./util"),l=e("../../lang/index"),c=e("./volumecontrol"),e=i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-volume");var r=new c(e,t);e.addChild(r,t),this.volumeControl=r},createEl:function(){var e=i.prototype.createEl.call(this,"div");return e.innerHTML='<div class="volume-icon"><div class="short-horizontal"></div><div class="long-horizontal"></div></div>',e},bindEvent:function(){var r=this,i=r._player,e=(this.icon=document.querySelector("#"+r.id()+"  .volume-icon"),s.registerTooltipEvent.call(this,this.el(),function(){return r._player.muted()||0==r._player.getVolume()?l.get("Muted"):l.get("Volume")}),o.on(this.icon,"click",function(e){var t;r.volumeControl._shown?i.muted()?i.unMute():i.mute():(t=r.el().offsetLeft,r._player.trigger(a.Private.SettingListHide),r._player.trigger(a.Private.SelectorHide),r._player.trigger(a.Private.VolumeVisibilityChange,t),r._player.trigger(a.Private.MarkerTextHide))}),document.querySelector("#"+r.id()+"  .long-horizontal")),t=document.querySelector("#"+r.id()+"  .short-horizontal");o.on(this.el(),"mouseover",function(){n.removeClass(e,"volume-hover-animation"),setTimeout(function(){n.addClass(e,"volume-hover-animation")}),setTimeout(function(){n.removeClass(e,"volume-hover-animation"),n.addClass(t,"volume-hover-animation"),setTimeout(function(){n.removeClass(t,"volume-hover-animation"),n.addClass(e,"volume-hover-animation")},300)},300)}),o.on(window,"resize",function(){var e;r.volumeControl._shown&&(e=r.el().offsetLeft,r._player.trigger(a.Private.VolumeUpdatePosition,e))})}});t.exports=e},{"../../lang/index":23,"../../lib/dom":32,"../../lib/event":33,"../../player/base/event/eventtype":70,"../component":130,"./util":159,"./volumecontrol":161}],161:[function(e,t,r){var i=e("../component"),n=e("../../lib/dom"),o=e("../../lib/event"),a=e("../../player/base/event/eventtype"),e=(e("./util"),e("../../lang/index"),i.extend({init:function(e,t){i.call(this,e,t),this.addClass("prism-volume-control"),this._shown=!1},createEl:function(){var e=i.prototype.createEl.call(this,"div");return e.innerHTML='<div class="volume-range"><div class="volume-value"></div><div class="volume-cursor"></div></div>',e},bindEvent:function(){var r=this;this.icon=document.querySelector("#"+r._player.id()+"  .volume-icon"),this.control=document.querySelector("#"+r.id()),this.volumnValue=document.querySelector("#"+r.id()+"  .volume-value"),this.volumnRange=document.querySelector("#"+r.id()+"  .volume-range"),this.volumnCursor=document.querySelector("#"+r.id()+"  .volume-cursor"),this._player.on(a.Private.VolumeVisibilityChange,function(e){var t,e=e.paramData;!r._shown&&e?(t=r._player.getVolume(),r._setVolumnUI(t),n.css(r.control,"display","block"),e&&r._updatePosition(e),r._shown=!0):r._hide()}),this._player.on(a.Private.VolumeUpdatePosition,function(e){e=e.paramData;r._shown&&r._updatePosition(e)}),this._player.on(a.Private.ControlBarClick,function(e){n.hasClass(e.paramData.target,"prism-controlbar-bg")&&r._hide()}),o.on(this.volumnRange,"click",function(e){e=n.getPointerPosition(r.volumnRange,e).y;e<0||1<e||(r._setVolumnUI(e=1<(e=e<0?0:e)?1:e),r._setMuteUI(e),r._player.setVolume(e))}),o.on(this._player.tag,"click",function(e){e&&e.target==e.currentTarget&&r._hide()}),o.on(this._player.tag,"touchstart",function(e){e&&e.target==e.currentTarget&&r._hide()}),o.on(this.volumnCursor,"mousedown",function(e){r._onMouseDown(e)}),o.on(this.volumnCursor,"touchstart",function(e){r._onMouseDown(e)}),this._player.on(a.Private.VolumnChanged,function(e){e=e.paramData;-1<e&&r._setVolumnUI(e),r._setMuteUI(e)}),o.on(this.control,"mouseleave",function(){r._offEvent(),r._hide()}),o.on(this.control,"mouseover",function(){n.addClass(r.control,"hover")}),r._rangeBottom=r._getBottom()},_getBottom:function(){var e;return window.getComputedStyle?(e=window.getComputedStyle(this.volumnRange,null).getPropertyValue("bottom"),parseFloat(e)):26},_onMouseDown:function(e){var t=this;e.preventDefault(),o.on(this.control,"mousemove",function(e){t._onMouseMove(e)}),o.on(this.control,"touchmove",function(e){t._onMouseMove(e)}),o.on(this._player.tag,"mouseup",function(e){t._onMouseUp(e)}),o.on(this._player.tag,"touchend",function(e){t._onMouseUp(e)}),o.on(this.control,"mouseup",function(e){t._onMouseUp(e)}),o.on(this.control,"touchend",function(e){t._onMouseUp(e)})},_onMouseUp:function(e){e.preventDefault(),this._offEvent(),this.volumnRange.offsetHeight&&(e=(this.volumnValue.offsetHeight/this.volumnRange.offsetHeight).toFixed(2),this._player.setVolume(e),this._setMuteUI(e))},_onMouseMove:function(e){e.preventDefault();e=n.getPointerPosition(this.volumnRange,e).y;e<0||1<e||this._setVolumnUI(e=1<(e=e<0?0:e)?1:e)},_getPosition:function(e){for(var t=this.volumnRange,r=0;t=t.offsetParent;)r+=t.offsetTop;var i=this.volumnRange.offsetHeight,n=this.volumnCursor.offsetHeight,o=(e.touches?e.touches[0]:e).pageY;return(i-((o=i<o-r?e.clientY:o)-r)+n)/this.volumnRange.offsetHeight},_offEvent:function(){o.off(this._player.tag,"mouseup"),o.off(this._player.tag,"touchend"),o.off(this.control,"mousemove"),o.off(this.control,"touchmove"),o.off(this.control,"mouseup"),o.off(this.control,"touchend")},_setMuteUI:function(e){isNaN(e)||(0==e||-1==e?n.addClass(this.icon,"mute"):n.removeClass(this.icon,"mute"))},_setVolumnUI:function(e){isNaN(e)||(n.css(this.volumnValue,"height",100*e+"%"),n.css(this.volumnCursor,"bottom",100*(e=1==e?.99:e)+"%"))},_hide:function(){n.css(this.control,"display","none"),this._shown=!1},_updatePosition:function(e){n.css(this.control,"left",e-5+"px")}}));t.exports=e},{"../../lang/index":23,"../../lib/dom":32,"../../lib/event":33,"../../player/base/event/eventtype":70,"../component":130,"./util":159}],162:[function(e,t,r){t.exports={H5Loading:e("./component/h5-loading"),bigPlayButton:e("./component/big-play-button"),controlBar:e("./component/controlbar"),progress:e("./component/progress"),playButton:e("./component/play-button"),liveDisplay:e("./component/live-display"),timeDisplay:e("./component/time-display"),fullScreenButton:e("./component/fullscreen-button"),volume:e("./component/volume"),snapshot:e("./component/snapshot"),errorDisplay:e("./component/error-display"),infoDisplay:e("./component/info-display"),liveShiftProgress:e("../commonui/liveshiftprogress"),liveShiftTimeDisplay:e("../commonui/livetimedisplay"),setting:e("./component/setting/button"),subtitle:e("./component/cc-button"),thumbnail:e("./component/thumbnail"),tooltip:e("./component/tooltip")}},{"../commonui/liveshiftprogress":12,"../commonui/livetimedisplay":13,"./component/big-play-button":131,"./component/cc-button":132,"./component/controlbar":133,"./component/error-display":135,"./component/fullscreen-button":136,"./component/h5-loading":137,"./component/info-display":138,"./component/live-display":140,"./component/play-button":142,"./component/progress":143,"./component/setting/button":147,"./component/snapshot":154,"./component/thumbnail":156,"./component/time-display":157,"./component/tooltip":158,"./component/volume":160}]},{},[15])(15)});